<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®° | GanSer</title><meta name="keywords" content="ğŸ“•çŸ¥è¯†,ğŸ–Šç¬”è®°"><meta name="author" content="GanSer"><meta name="copyright" content="GanSer"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°"><meta name="application-name" content="ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta name="description" content="ğŸ“•ğŸ“•ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹ï¼Œå­¦ä¹ ç¬”è®°(*^_^*)å¤§å®¶å¿«æ¥å˜²ç¬‘æˆ‘">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="https://www.gan1ser.top/post/dc68b377.html">
<meta property="og:site_name" content="GanSer">
<meta property="og:description" content="ğŸ“•ğŸ“•ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹ï¼Œå­¦ä¹ ç¬”è®°(*^_^*)å¤§å®¶å¿«æ¥å˜²ç¬‘æˆ‘">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://pic.gan1ser.top/post/1.webp">
<meta property="article:published_time" content="2023-03-13T22:14:00.000Z">
<meta property="article:modified_time" content="2023-03-13T22:14:00.000Z">
<meta property="article:author" content="GanSer">
<meta property="article:tag" content="ğŸ“•çŸ¥è¯†">
<meta property="article:tag" content="ğŸ–Šç¬”è®°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://pic.gan1ser.top/post/1.webp"><link rel="shortcut icon" href="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg"><link rel="canonical" href="https://www.gan1ser.top/post/dc68b377"><link rel="preconnect" href="//npm.elemecdn.com"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="manifest" href="/manifest.json"/><meta name="msapplication-TileColor" content="var(--anzhiyu-main)"/><link rel="mask-icon" href="/img/siteicon/apple-icon-180.png" color="#5bbad5"/><link rel="apple-touch-icon" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/siteicon/apple-icon-180.png"/><link rel="icon" type="image/png" sizes="32x32" href="/img/siteicon/32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/img/siteicon/16.png"/><link rel="bookmark" href="/img/siteicon/apple-icon-180.png"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-2732.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2732-2048.jpg" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2388.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2388-1668.jpg" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1536-2048.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2048-1536.jpg" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1668-2224.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2224-1668.jpg" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1620-2160.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2160-1620.jpg" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1290-2796.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2796-1290.jpg" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1179-2556.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2556-1179.jpg" media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1284-2778.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2778-1284.jpg" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1170-2532.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2532-1170.jpg" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1125-2436.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2436-1125.jpg" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2688.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2688-1242.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-828-1792.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1792-828.jpg" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1242-2208.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-2208-1242.jpg" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-750-1334.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1334-750.jpg" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-640-1136.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)"/><link rel="apple-touch-startup-image" href="/img/siteicon/apple-splash-1136-640.jpg" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)"/><script>if ('serviceWorker' in navigator) {
  if (navigator.serviceWorker.controller) {
    navigator.serviceWorker.addEventListener('controllerchange', function() {
      location.reload()
    })
  }
  window.addEventListener('load', function() {
    navigator.serviceWorker.register('/service-worker.js')
  })
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  friends_vue_info: undefined,
  navMusic: true,
  changeMainColorPost: true,
  algolia: {"appId":"BUJ589YK96","apiKey":"6f398a28bd13fccc3f0ec369fe5b2c45","indexName":"GanSer","hits":{"per_page":10},"languages":{"input_placeholder":"é”®å…¥åæŒ‰ä¸‹å›è½¦æœç´¢ï¼","hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼Œç”¨æ—¶ ${time} æ¯«ç§’"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç®€","rightMenuMsgToTraditionalChinese":"è½¬ä¸ºç¹ä½“","rightMenuMsgToSimplifiedChinese":"è½¬ä¸ºç®€ä½“"},
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“","cht_to_chs":"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“","day_to_night":"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#465855","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://npm.elemecdn.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-13 22:14:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="google-site-verification" content="Tfw3UBpa3L-1YpdcSpYfgEpo2yPLlJBOVXR_aAsqjT0" /><meta name="baidu-site-verification" content="codeva-lGhY19ZM6U" /><link rel="stylesheet" href="/css/home.css"><link rel="stylesheet" href="/css/imgloaded.css?1"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4177998_ufp3xnlc2xn.css"><link rel="stylesheet" href="https://cdn1.tianli0.top/gh/zhheo/Post-Abstract-AI@0.1/tianli_gpt.css"><link rel="stylesheet" href="/css/todolist.css"><style>#left-mid-img1 {
  position: fixed;
  left: 0;
  top: calc(50% - 50px);
  transform: translateY(-50%);
  width: 100px;
  height: auto;
}

#left-mid-img2 {
  position: fixed;
  left: 0;
  top: calc(50% + 50px);
  transform: translateY(-50%);
  width: 100px;
  height: auto;
}
#right-mid-img1 {
  position: fixed;
  right: 0;
  top: calc(50% - 50px);
  transform: translateY(-50%);
  width: 110px;
  height: auto;
}
#right-mid-img2 {
  position: fixed;
  right: 0;
  top: calc(50% + 50px);
  transform: translateY(-50%);
  width: 110px;
  height: auto;
}</style><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="GanSer" type="application/atom+xml">
</head><body data-type="anzhiyu"><img id="left-mid-img1" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/soyo.gif" alt="Image 1 Description"><img id="left-mid-img2" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/anno.gif" alt="Image 2 Description"><img id="right-mid-img1" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/daxiang.gif" alt="Image 1 Description"><img id="right-mid-img2" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/mu.gif" alt="Image 2 Description"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="åŠ è½½å¤´åƒ" src="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg"/><div class="loading-image-dot"></div><div id="loading-percentage">0%</div></div></div><script>const loadingPercentage = document.getElementById("loading-percentage");
let loadingPercentageTimer = setInterval(function() {
  var progressBar = document.querySelector(".pace-progress");
  if (!progressBar) return
  var currentValue = progressBar.getAttribute("data-progress-text");
  if (currentValue !== loadingPercentage.textContent) {
    loadingPercentage.textContent = currentValue;
    if (currentValue === "100%") {
      clearInterval(loadingPercentageTimer);
    }
  }
}, 100);
const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
    Pace.restart()
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/progress_bar/progress_bar.css"/><script async="async" src="https://npm.elemecdn.com/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div id="web_box"><div id="web_container"><div id="menu-mask"></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">åšå®¢çº¿è·¯</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.gan1ser.top" title="ä¸»åŸŸåçº¿è·¯" target="_blank"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg" alt="ä¸»åŸŸåçº¿è·¯"/><span class="back-menu-item-text">ä¸»åŸŸåçº¿è·¯</span></a><a class="back-menu-item" href="https://drive.gan1ser.top/" title="GanSer's OneDrive" target="_blank"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64400d200d2dde577785f5e5.jpg" alt="GanSer's OneDrive"/><span class="back-menu-item-text">GanSer's OneDrive</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">æ™ºèƒ½ä¼ é€</div><div class="back-menu-list"><a class="back-menu-item" href="https://www.github.com/Gan1Ser" title="Githubä¸»é¡µ" target="_blank"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64ae1f611ddac507cceb714c.jpg" alt="Githubä¸»é¡µ"/><span class="back-menu-item-text">Githubä¸»é¡µ</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">GanSer</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> éš§é“</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/memos/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> å³åˆ»çŸ­æ–‡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> ç•™è¨€æ¿</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7750616521&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> éŸ³ä¹é¦†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> å½±æ¼«ä½³é€‰</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/todolist/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> å¾…åŠæ¸…å•</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button only-home" id="travellings_button" title="éšæœºå‰å¾€ä¸€ä¸ªå¼€å¾€é¡¹ç›®ç½‘ç«™"><a class="site-page" onclick="anzhiyu.totraveling()" title="éšæœºå‰å¾€ä¸€ä¸ªå¼€å¾€é¡¹ç›®ç½‘ç«™" href="javascript:void(0);" rel="external nofollow" data-pjax-state="external"><i class="anzhiyufont anzhiyu-icon-train"></i></a></div><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="éšæœºå‰å¾€ä¸€ä¸ªæ–‡ç« " href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="æœç´¢ğŸ”" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> æœç´¢</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="ä¸­æ§å°" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage%20(1).webp" target="_blank"><img class="post-qr-code-img" alt="wechat" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage%20(1).webp"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage.webp" target="_blank"><img class="post-qr-code-img" alt="alipay" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage.webp"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">äº’åŠ¨</div><span class="author-content-item-title"> <span>æœ€æ–°è¯„è®º</span></span></div><div class="aside-list"><span>æ­£åœ¨åŠ è½½ä¸­...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags" onclick="anzhiyu.hideConsole()"><div class="card-content"><div class="author-content-item-tips">å…´è¶£ç‚¹</div><span class="author-content-item-title">å¯»æ‰¾ä½ æ„Ÿå…´è¶£çš„é¢†åŸŸ</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/Github/" style="font-size: 1.05rem;">Github<sup>1</sup></a><a href="/tags/Linux/" style="font-size: 1.05rem;">Linux<sup>1</sup></a><a href="/tags/MSP432/" style="font-size: 1.05rem;">MSP432<sup>4</sup></a><a href="/tags/PCB/" style="font-size: 1.05rem;">PCB<sup>1</sup></a><a href="/tags/Python/" style="font-size: 1.05rem;">Python<sup>2</sup></a><a href="/tags/python/" style="font-size: 1.05rem;">python<sup>3</sup></a><a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 1.05rem;">å•ç‰‡æœº<sup>6</sup></a><a href="/tags/%E5%A4%A7%E5%AD%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">å¤§å­¦å­¦ä¹ <sup>33</sup></a><a href="/tags/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">å¹´åº¦æ€»ç»“<sup>2</sup></a><a href="/tags/%E5%BD%B1%E8%AF%84/" style="font-size: 1.05rem;">å½±è¯„<sup>3</sup></a><a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">æœåŠ¡å™¨<sup>1</sup></a><a href="/tags/%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">çŸ¥è¯†<sup>10</sup></a><a href="/tags/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">ç¥ç»ç½‘ç»œ<sup>1</sup></a><a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">ç¬”è®°<sup>1</sup></a><a href="/tags/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/" style="font-size: 1.05rem;">è€ƒç ”æ•°å­¦<sup>1</sup></a><a href="/tags/%E9%9A%8F%E6%89%8B%E5%B0%8F%E8%AE%B0/" style="font-size: 1.05rem;">éšæ‰‹å°è®°<sup>84</sup></a><a href="/tags/%F0%9F%90%89%E9%9D%92%E9%BE%99%E9%9D%A2%E6%9D%BF/" style="font-size: 1.05rem;">ğŸ‰é’é¾™é¢æ¿<sup>1</sup></a><a href="/tags/%F0%9F%92%BB%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 1.05rem;">ğŸ’»æœåŠ¡å™¨<sup>3</sup></a><a href="/tags/%F0%9F%92%BB%E9%9A%8F%E8%BA%ABWIFI/" style="font-size: 1.05rem;">ğŸ’»éšèº«WIFI<sup>1</sup></a><a href="/tags/%F0%9F%93%95%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/" style="font-size: 1.05rem;">ğŸ“•å¹´åº¦æ€»ç»“<sup>1</sup></a><a href="/tags/%F0%9F%93%95%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">ğŸ“•çŸ¥è¯†<sup>41</sup></a><a href="/tags/%F0%9F%93%B1%E6%90%9E%E6%9C%BA/" style="font-size: 1.05rem;">ğŸ“±ææœº<sup>3</sup></a><a href="/tags/%F0%9F%96%8A%E7%AC%94%E8%AE%B0/" style="font-size: 1.05rem;">ğŸ–Šç¬”è®°<sup>33</sup></a><a href="/tags/%F0%9F%9A%97%E6%99%BA%E8%83%BD%E8%BD%A6/" style="font-size: 1.05rem;">ğŸš—æ™ºèƒ½è½¦<sup>20</sup></a><a href="/tags/%F0%9F%A4%BA%E6%B8%B8%E6%88%8F/" style="font-size: 1.05rem;">ğŸ¤ºæ¸¸æˆ<sup>3</sup></a><a href="/tags/%F0%9F%A5%A5%E5%A5%BD%E8%BD%AF%E5%88%86%E4%BA%AB/" style="font-size: 1.05rem;">ğŸ¥¥å¥½è½¯åˆ†äº«<sup>1</sup></a><a href="/tags/%F0%9F%A6%8BButterfly/" style="font-size: 1.05rem;">ğŸ¦‹Butterfly<sup>2</sup></a><a href="/tags/%F0%9F%A7%A0%E6%95%99%E7%A8%8B/" style="font-size: 1.05rem;">ğŸ§ æ•™ç¨‹<sup>14</sup></a><a href="/tags/%F0%9F%A7%A0%E9%9D%9E%E9%85%8B%E6%8A%BD%E5%8D%A1/" style="font-size: 1.05rem;">ğŸ§ éé…‹æŠ½å¡<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history" onclick="anzhiyu.hideConsole()"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>æ–‡ç« </span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>å½’æ¡£</span><a class="card-more-btn" href="/archives/" title="æŸ¥çœ‹æ›´å¤š">
    <i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/04/"><span class="card-archive-list-date">å››æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">ä¸€æœˆ 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/12/"><span class="card-archive-list-date">åäºŒæœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/11/"><span class="card-archive-list-date">åä¸€æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">åæœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/09/"><span class="card-archive-list-date">ä¹æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">å…«æœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>ç¯‡</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">ä¸ƒæœˆ 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">19</span><span>ç¯‡</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" onclick="anzhiyu.switchDarkMode()" title="æ˜¾ç¤ºæ¨¡å¼åˆ‡æ¢" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="è¾¹æ æ˜¾ç¤ºæ§åˆ¶"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="çƒ­è¯„å¼€å…³"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="éŸ³ä¹å¼€å…³"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="å¿«æ·é”®å¼€å…³"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div><div id="console-naoDark"><div class="container"><div class="components"><div class="main-button"><div class="moon"></div><div class="moon"></div><div class="moon"></div></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="daytime-backgrond"></div><div class="cloud"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="cloud-light"><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div><div class="cloud-son"></div></div><div class="stars"><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star big"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star medium"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div><div class="star small"><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div><div class="star-son"></div></div></div></div></div></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">åŸåˆ›</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E5%AD%A6%E5%AD%A6%E4%B9%A0/">å¤§å­¦å­¦ä¹ </a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%F0%9F%93%95%E7%9F%A5%E8%AF%86/" tabindex="-1"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>ğŸ“•çŸ¥è¯†</span></a><a class="article-meta__tags" href="/tags/%F0%9F%96%8A%E7%AC%94%E8%AE%B0/" tabindex="-1"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>ğŸ–Šç¬”è®°</span></a></span></div></div><h1 class="post-title">ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-03-13T22:14:00.000Z" title="å‘è¡¨äº 2023-03-13 22:14:00">2023-03-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2023-03-13T22:14:00.000Z" title="æ›´æ–°äº 2023-03-13 22:14:00">2023-03-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="æ–‡ç« å­—æ•°"></i><span class="post-meta-label" title="æ–‡ç« å­—æ•°">å­—æ•°æ€»è®¡:</span><span class="word-count" title="æ–‡ç« å­—æ•°">50.8k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="é˜…è¯»æ—¶é•¿"></i><span class="post-meta-label" title="é˜…è¯»æ—¶é•¿">é˜…è¯»æ—¶é•¿:</span><span>193åˆ†é’Ÿ</span></span><span class="post-meta-separator"></span><span id="" data-flag-title="ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="é˜…è¯»é‡">é˜…è¯»é‡:</span><span id="twikoo_visitors" title="è¯„è®ºæ•°"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="ä½œè€…IPå±åœ°ä¸ºéƒ‘å·"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>éƒ‘å·</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://pic.gan1ser.top/post/1.webp"></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><div class="note success modern"><p>ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å¼€è¯¾äº†(<em>^_^</em>)ï¼ï¼è¦å¥½å¥½å­¦ä¹ ï¼Œæé’±å•Šï¼ï¼ï¼</p>
</div>
<div class="note success modern"><p>æ„Ÿè°¢Bç«™UPçŒªçŸ¥å¼¦çš„æ•™å­¦æŒ‡å¯¼ </p>
</div>
<div class="note success modern"><p>æ–‡ç« ä¸­å®‰è£…çš„Keilè½¯ä»¶å’ŒProteusè½¯ä»¶åœ¨æˆ‘çš„ä¸ªäºº<a target="_blank" rel="noopener" href="https://www.liver.ltd/alist/%E9%98%BF%E9%87%8C%E4%BA%91%E7%9B%98/%E5%8D%95%E7%89%87%E6%9C%BA%E8%BD%AF%E4%BB%B6.zip">ç½‘ç›˜</a>ï¼Œè¿™é‡Œè¦æ„Ÿè°¢å•è€å¸ˆä¸Šä¼ çš„æ•™å­¦æ–‡ä»¶ä»¥åŠå­œå­œä¸å€¦çš„æ•™å¯¼</p>
</div>
<div class="note success modern"><p>æ–‡ç« ä¸­æ¶‰åŠçš„æºç ï¼Œå‡ä»¥æˆ‘è‡ªå·±çš„å•ç‰‡æœºä¸ºå‡†ï¼Œä¾‹å¦‚æˆ‘çš„LEDç¯æœ‰æ€»å¼€å…³ï¼Œå¦‚æœä½ æ²¡æœ‰è¯·è‡ªè¡Œä¿®æ”¹ä»£ç ï¼Œç¥ä½ å­¦æœ‰æ‰€æˆ(<em>^_^</em>)ï¼Œæˆ‘ä¼šæ³¨æ˜å®é™…å’Œç†è®ºçš„ä»£ç </p>
</div>
<h2 id="ä¸€ã€å•ç‰‡æœºå¼€å‘ä¸ä»¿çœŸç¯å¢ƒæ­å»º"><a href="#ä¸€ã€å•ç‰‡æœºå¼€å‘ä¸ä»¿çœŸç¯å¢ƒæ­å»º" class="headerlink" title="ä¸€ã€å•ç‰‡æœºå¼€å‘ä¸ä»¿çœŸç¯å¢ƒæ­å»º"></a>ä¸€ã€å•ç‰‡æœºå¼€å‘ä¸ä»¿çœŸç¯å¢ƒæ­å»º</h2><div class="note success modern"><p>ç®€å•çš„éƒ¨åˆ†æˆ‘å°±ç›´æ¥ç…§æ¬å•è€å¸ˆçš„è¯¾ä»¶äº†ï¼Œéƒ¨åˆ†éœ€è¦æ³¨æ„çš„åœ°æ–¹æˆ‘ä¼šåšGIFæ¼”ç¤ºï¼Œä¾µåˆ </p>
</div>
<h3 id="1-1-Keil-è½¯ä»¶"><a href="#1-1-Keil-è½¯ä»¶" class="headerlink" title="1.1 Keil è½¯ä»¶"></a>1.1 Keil è½¯ä»¶</h3><h4 id="1-1-1-Keilè½¯ä»¶çš„ç®€ä»‹"><a href="#1-1-1-Keilè½¯ä»¶çš„ç®€ä»‹" class="headerlink" title="1.1.1 Keilè½¯ä»¶çš„ç®€ä»‹"></a>1.1.1 Keilè½¯ä»¶çš„ç®€ä»‹</h4><p>å¤§å®¶å®‰è£…å®ŒKeilè½¯ä»¶è‚¯å®šæ˜¯è¦å­¦ä¹ ä½¿ç”¨çš„ï¼Œè¿™é‡Œä¸å»ºè®®å°†è½¯ä»¶æ±‰åŒ–ï¼Œè½¯ä»¶æœ¬æ¥åŸç”Ÿæ€çš„æ ·å­å°±å¾ˆçœ‹ï¼Œè¦å­¦ä¼šé€‚åº”è‹±åŒ–çš„è½¯ä»¶ã€‚</p>
<p><font color=#deb887>Keil C51</font> æ˜¯å¾·å›½ Keil Software å…¬å¸ï¼ˆç°å·²è¢« ARM æ”¶è´­ï¼‰æ¨å‡ºçš„ 8051 ç³»åˆ—çš„ IDE(Integrated Development,é›†æˆå¼€å‘ç¯å¢ƒ)ã€‚å®ƒä¸ä»…æ”¯æŒæ±‡ç¼–è¯­è¨€å¼€å‘ï¼Œæ›´æ”¯æŒ C/C++ç­‰é«˜çº§è¯­è¨€å¼€å‘å•ç‰‡æœºã€‚å…¶å¯ä»¥å®Œæˆä»å·¥ç¨‹å»ºç«‹å’Œç®¡ç†ã€ç¼–è¯‘ã€é“¾æ¥ã€ç›®æ ‡ä»£ç ç”Ÿæˆã€è½¯ä»¶ä»¿çœŸè°ƒè¯•ç­‰å®Œæ•´çš„å¼€å‘æµç¨‹ã€‚</p>
<h4 id="1-1-2-Keil-C51çš„å·¥ä½œç•Œé¢"><a href="#1-1-2-Keil-C51çš„å·¥ä½œç•Œé¢" class="headerlink" title="1.1.2 Keil C51çš„å·¥ä½œç•Œé¢"></a>1.1.2 Keil C51çš„å·¥ä½œç•Œé¢</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/image-20240517085113297.png" alt="1"></p>
<h4 id="1-1-3-Keil-C51å»ºç«‹å·¥ç¨‹"><a href="#1-1-3-Keil-C51å»ºç«‹å·¥ç¨‹" class="headerlink" title="1.1.3 Keil C51å»ºç«‹å·¥ç¨‹"></a>1.1.3 Keil C51å»ºç«‹å·¥ç¨‹</h4><p>é¦–å…ˆä½ éœ€è¦åœ¨ç”µè„‘æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾ä½ çš„å·¥ç¨‹ï¼Œä¸‹é¢æ˜¯æ–°å»ºå·¥ç¨‹çš„GIFæ¼”ç¤ºã€‚æ³¨æ„çš„<code>AT89C52</code>æ˜¯å•è€å¸ˆè¦æ±‚çš„ï¼Œå¦‚æœä¸ä¸€æ ·è¯·æ¢æˆä½ ä»¬çš„ï¼Œå¦‚æœç›´æ¥æ‰¾<code>AT89C52</code>æ˜¯æ‰¾ä¸åˆ°çš„ï¼Œè¦å…ˆæ‰¾å¯¹åº”çš„å‚å•†ç„¶åç‚¹å‡»<code>+</code>å°±å¯ä»¥çœ‹åˆ°ç›¸å¯¹åº”çš„èŠ¯ç‰‡å‹å·äº†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d8bdef144a0100715f193.gif" alt=""></p>
<h4 id="1-1-4-å»ºç«‹-ç¼–è¾‘Cè¯­è¨€æºç¨‹åºæ–‡ä»¶"><a href="#1-1-4-å»ºç«‹-ç¼–è¾‘Cè¯­è¨€æºç¨‹åºæ–‡ä»¶" class="headerlink" title="1.1.4 å»ºç«‹/ç¼–è¾‘Cè¯­è¨€æºç¨‹åºæ–‡ä»¶"></a>1.1.4 å»ºç«‹/ç¼–è¾‘Cè¯­è¨€æºç¨‹åºæ–‡ä»¶</h4><p>ä¸‹é¢æ˜¯GIFæ¼”ç¤ºï¼Œæ¯”è¾ƒç®€å•ï¼Œä¸€å®šè¦è®°å¾—åç¼€æ˜¯<code>.c</code>ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d8ecef144a010071b27be.gif" alt=""></p>
<p>ä»¥ä¸Šï¼Œæˆ‘ä»¬å°±å®Œæˆäº†æœ€åŸºæœ¬çš„è½¯ä»¶ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯ä¸€äº›è¿›é˜¶ä½¿ç”¨ã€‚</p>
<h4 id="1-1-5-å·¥ç¨‹çš„è®¾ç½®"><a href="#1-1-5-å·¥ç¨‹çš„è®¾ç½®" class="headerlink" title="1.1.5 å·¥ç¨‹çš„è®¾ç½®"></a>1.1.5 å·¥ç¨‹çš„è®¾ç½®</h4><p>åœ¨å·¥ç¨‹å»ºç«‹åï¼Œè¿˜éœ€è¦å¯¹å·¥ç¨‹è¿›è¡Œè®¾ç½®ã€‚åœ¨ Î¼Vision5 çš„ä¸Šæ–¹å·¥å…·æ ä¸­ï¼Œå³å‡»å·¥ç¨‹å Target 1 æ¡†æ—çš„é­”æœ¯æ£’   ï¼Œå³æ‰“å¼€å·¥ç¨‹è®¾ç½®å¯¹è¯æ¡†ã€‚å•Šï¼Œå¥½å¤šæˆ‘ä¹Ÿä¸æ‡‚ï¼Œçœ‹è€å¸ˆPPTå§ï¼Œè¿™äº›ä½ è¯´é‡è¦å§å®ƒä¹Ÿä¸æ˜¯é‚£ä¹ˆé‡è¦ï¼Œçœ‹ä¸€éè¿‡å»å§ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d8f81f144a010071c461b.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9022f144a010071d52f4.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9023f144a010071d5363.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9023f144a010071d53f9.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9023f144a010071d544f.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9025f144a010071d56d1.png" alt=""></p>
<h4 id="1-1-6-Keil-C51-çš„Debug"><a href="#1-1-6-Keil-C51-çš„Debug" class="headerlink" title="1.1.6 Keil C51 çš„Debug"></a>1.1.6 Keil C51 çš„Debug</h4><p>å¤§å®¶éƒ½çŸ¥é“Debugåœ¨è°ƒè¯•ç¨‹åºä¸­é‡è¦åœ°ä½ï¼Œæ‰€ä»¥æˆ‘å°†Keil C51çš„Debugå•ç‹¬æ‹¿å‡ºæ¥å­¦ä¹ ã€‚</p>
<p>æºç¨‹åºç¼–å†™å®Œæ¯•åè¿˜éœ€è¦ç¼–è¯‘å’Œé“¾æ¥æ‰èƒ½å¤Ÿè¿›è¡Œè½¯ä»¶å’Œç¡¬ä»¶ä»¿çœŸã€‚â‘  ç¼–è¯‘ï¼›â‘¡æ’é”™ï¼›åœ¨ç¨‹åºçš„ç¼–è¯‘/é“¾æ¥ä¸­ï¼Œå¦‚æœç”¨æˆ·ç¨‹åºå‡ºç°é”™è¯¯ï¼Œè¿˜éœ€è¦ä¿®æ­£é”™è¯¯åé‡æ–°ç¼–è¯‘/é“¾æ¥ï¼Œé‡æ–°çƒ§å½•ç¨‹åºæŸ¥çœ‹é”™è¯¯ç°è±¡ï¼Œååˆ†æ¶ˆè€—æ—¶é—´ã€‚å› æ­¤éœ€è¦å•æ­¥è°ƒè¯•ï¼Œä¸€æ­¥ä¸€æ­¥çš„æŸ¥çœ‹ä»£ç è¿è¡Œæ•ˆæœæ¥åŠ å¿«å¯¹é”™è¯¯çš„æ’æŸ¥é€Ÿåº¦ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d91baf144a010072027dd.png" alt=""></p>
<p>è¿›å…¥DEBUGæ¨¡å¼åï¼Œé»„è‰²ç®­å¤´ä¸ºæ±‡ç¼–ç¨‹åºè¿è¡Œä½ç½®å…‰æ ‡ï¼Œ<code>è“é»„ä¸‰è§’å½¢</code>ä¸ºå½“å‰ C è¯­è¨€è¿è¡Œä½ç½®ï¼ŒæŒ‡å‘å½“å‰ç­‰å¾…è¿è¡Œç¨‹åºè¡Œã€‚å…¶ç•Œé¢å¦‚ä¸‹,å…¶ä¸­<code>å•ä¸ªé»„è‰²ç®­å¤´</code>ä¸ºæ±‡ç¼–ç¨‹åºè¿è¡Œä½ç½®å…‰æ ‡(æ±‡ç¼–ä¸€ç”Ÿä¹‹ç—›)ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d92ebf144a01007222fa7.png" alt=""></p>
<p>åœ¨ Î¼Vision5 ä¸­ï¼Œæœ‰ 4 ç§DEBUGè¿è¡Œæ–¹å¼ ï¼šå•æ­¥è·Ÿè¸ª(Step Into)ï¼Œå•æ­¥è¿è¡Œ(Step Over)ï¼Œè¿è¡Œåˆ°å…‰æ ‡å¤„(Run to Cursor line)ï¼Œå…¨é€Ÿè¿è¡Œ(Go)ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9352f144a0100722f193.png" alt=""></p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨Debugè¿›è¡Œè°ƒè¯•çš„GIFå½•åƒï¼Œæµ‹è¯•ç”¨ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit led0 = P0^<span class="number">0</span>;</span><br><span class="line">sbit led1 = P0^<span class="number">1</span>;</span><br><span class="line">sbit led2 = P0^<span class="number">2</span>;</span><br><span class="line">sbit led3 = P0^<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sbit led4 = P0^<span class="number">4</span>;</span><br><span class="line">sbit led5 = P0^<span class="number">5</span>;</span><br><span class="line">sbit led6 = P0^<span class="number">6</span>;</span><br><span class="line">sbit led7 = P0^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span> <span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    led0 = <span class="number">0</span>;</span><br><span class="line">    led1 = <span class="number">0</span>;</span><br><span class="line">    led2 = <span class="number">0</span>;</span><br><span class="line">    led3 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    led4 = <span class="number">0</span>;</span><br><span class="line">    led5 = <span class="number">0</span>;</span><br><span class="line">    led6 = <span class="number">0</span>;</span><br><span class="line">    led7 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d952cf144a010072631a1.gif" alt=""></p>
<h4 id="1-1-7-å­˜å‚¨ç©ºé—´èµ„æºçš„æŸ¥çœ‹å’Œä¿®æ”¹"><a href="#1-1-7-å­˜å‚¨ç©ºé—´èµ„æºçš„æŸ¥çœ‹å’Œä¿®æ”¹" class="headerlink" title="1.1.7 å­˜å‚¨ç©ºé—´èµ„æºçš„æŸ¥çœ‹å’Œä¿®æ”¹"></a>1.1.7 å­˜å‚¨ç©ºé—´èµ„æºçš„æŸ¥çœ‹å’Œä¿®æ”¹</h4><p>è¿™ä¸€éƒ¨åˆ†å¯¹æˆ‘æ¥è¯´è¿˜æ˜¯å¤ªæ—©äº†ï¼Œå…ˆçœ‹PPTå§</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d95b1f144a01007270b88.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d95b1f144a01007270bdb.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d95b1f144a01007270c3f.png" alt=""></p>
<h3 id="1-2-Proteusè½¯ä»¶"><a href="#1-2-Proteusè½¯ä»¶" class="headerlink" title="1.2 Proteusè½¯ä»¶"></a>1.2 Proteusè½¯ä»¶</h3><h4 id="1-2-1-Proteusè½¯ä»¶çš„ç®€ä»‹"><a href="#1-2-1-Proteusè½¯ä»¶çš„ç®€ä»‹" class="headerlink" title="1.2.1 Proteusè½¯ä»¶çš„ç®€ä»‹"></a>1.2.1 Proteusè½¯ä»¶çš„ç®€ä»‹</h4><p>â‘  Proteus æ˜¯è‹±å›½ Lab Center Electronics å…¬å¸æ¨å‡ºçš„ç”¨äºä»¿çœŸå•ç‰‡æœºåŠå…¶å¤–å›´è®¾å¤‡çš„EDAå·¥å…·è½¯ä»¶ã€‚</p>
<p>â‘¡ Proteus ä¸ Keil C51 é…åˆä½¿ç”¨ï¼Œå¯ä»¥åœ¨ä¸éœ€è¦ç¡¬ä»¶æŠ•å…¥çš„æƒ…å†µä¸‹ï¼Œå®Œæˆå•ç‰‡æœº C è¯­è¨€åº”ç”¨ç³»ç»Ÿçš„ä»¿çœŸå¼€å‘ã€‚</p>
<p>â‘¢ Proteus å…·æœ‰é«˜çº§åŸç†å¸ƒå›¾(proteus)ã€æ··åˆæ¨¡å¼ä»¿çœŸ(PROSPICE)ã€PCB è®¾è®¡ä»¥åŠè‡ªåŠ¨å¸ƒçº¿(ARES)ç­‰åŠŸèƒ½ã€‚</p>
<h4 id="1-2-2-Proteusç®€å•ä½¿ç”¨"><a href="#1-2-2-Proteusç®€å•ä½¿ç”¨" class="headerlink" title="1.2.2 Proteusç®€å•ä½¿ç”¨"></a>1.2.2 Proteusç®€å•ä½¿ç”¨</h4><p>ç»§ç»­çœ‹PPTå§ï¼Œä¸€å®šè¦çœ‹å•Šï¼Œæˆ‘æ˜¯å¤ªæ‡’äº†å°±ä¸æƒ³æ‰“å­—ğŸ˜€</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9807f144a010072b0e45.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9807f144a010072b0eb6.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9807f144a010072b0f42.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9807f144a010072b0fdc.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9808f144a010072b1099.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9837f144a010072b5b0e.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9838f144a010072b5b72.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9838f144a010072b5bd1.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9838f144a010072b5c1c.png" alt=""><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9838f144a010072b5c79.png" alt=""></p>
<h4 id="1-2-3-Proteus-8-ä¸-Keil-C51-çš„è”åˆä½¿ç”¨"><a href="#1-2-3-Proteus-8-ä¸-Keil-C51-çš„è”åˆä½¿ç”¨" class="headerlink" title="1.2.3 Proteus 8 ä¸ Keil C51 çš„è”åˆä½¿ç”¨"></a>1.2.3 Proteus 8 ä¸ Keil C51 çš„è”åˆä½¿ç”¨</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d988bf144a010072bd8a1.png" alt=""></p>
<p>ä¸‹é¢è¿›è¡ŒåŸºæœ¬æ¼”ç¤ºï¼šâ‘  å°†æºç¨‹åºç¼–è¯‘ã€é“¾æ¥ç”Ÿæˆ<code>HEX</code>æ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦å°†å·¥ç¨‹è®¾ç½®ä¸­çš„Outputè®¾ç½®ä¸­çš„<code>Create HEX File</code>å‹¾é€‰ä¸Šã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9c4ef144a010073361a7.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640d9e4af144a01007384827.gif" alt=""></p>
<h4 id="1-2-4-Proteus-ç”»å‡ºå•ç‰‡æœºçš„æœ€å°ç³»ç»Ÿ"><a href="#1-2-4-Proteus-ç”»å‡ºå•ç‰‡æœºçš„æœ€å°ç³»ç»Ÿ" class="headerlink" title="1.2.4 Proteus ç”»å‡ºå•ç‰‡æœºçš„æœ€å°ç³»ç»Ÿ"></a>1.2.4 Proteus ç”»å‡ºå•ç‰‡æœºçš„æœ€å°ç³»ç»Ÿ</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640db370f144a01007609b6b.png" alt=""></p>
<p>ä½¿ç”¨Proteusé€‰æ‹©å…ƒå™¨ä»¶çš„æ–¹æ³•å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640db48ff144a010076277f0.png" alt=""></p>
<p>ç”µæ°”è¿æ¥æ–¹æ³•å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640db592f144a010076428a8.png" alt=""></p>
<h4 id="1-2-5-å®æˆ˜æ•™å­¦ï¼šæµæ°´ç¯çš„å®ç°"><a href="#1-2-5-å®æˆ˜æ•™å­¦ï¼šæµæ°´ç¯çš„å®ç°" class="headerlink" title="1.2.5 å®æˆ˜æ•™å­¦ï¼šæµæ°´ç¯çš„å®ç°"></a>1.2.5 å®æˆ˜æ•™å­¦ï¼šæµæ°´ç¯çš„å®ç°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED=P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;t;i++)</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">120</span>;j++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">led</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		P0=~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">		delay(<span class="number">50</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>;</span><br><span class="line">	ADDR2 = <span class="number">1</span>;</span><br><span class="line">	ADDR1 = <span class="number">1</span>;</span><br><span class="line">	ADDR0 = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		led();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­å»ºå¦‚å›¾æ‰€ç¤ºä»¿çœŸç”µè·¯ï¼Œè¿™é‡Œé‡‡ç”¨å…±é˜³æäºŒæç®¡æ¥æ³•</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de18cf144a01007c42ed0.png" alt=""></p>
<p>ç„¶åå¯¹Cæºç è¿›è¡Œç¼–è¯‘ç”Ÿæˆ<code>HEX</code>æ–‡ä»¶ï¼Œä¹‹åå¯¼å…¥èŠ¯ç‰‡ä¸­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de219f144a01007c5cadd.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de2f7f144a01007c7ca03.gif" alt=""></p>
<h3 id="1-3-STC-ISPè½¯ä»¶"><a href="#1-3-STC-ISPè½¯ä»¶" class="headerlink" title="1.3 STC-ISPè½¯ä»¶"></a>1.3 STC-ISPè½¯ä»¶</h3><h4 id="1-3-1-STC-ISPè½¯ä»¶çš„ç®€ä»‹"><a href="#1-3-1-STC-ISPè½¯ä»¶çš„ç®€ä»‹" class="headerlink" title="1.3.1 STC-ISPè½¯ä»¶çš„ç®€ä»‹"></a>1.3.1 STC-ISPè½¯ä»¶çš„ç®€ä»‹</h4><p> STC-ISPæ˜¯ä¸€æ¬¾åˆ STC ç ”å‘çš„å•ç‰‡æœºç¨‹åºä¸‹è½½çƒ§å½•è½¯ä»¶ï¼Œæ˜¯é’ˆå¯¹ STC ç³»åˆ—å•ç‰‡æœºè€Œè®¾è®¡çš„ï¼Œå¯ä¸‹è½½ STC89 ç³»åˆ—ã€STC12 ç³»åˆ—å’Œ STC15 ç­‰ç³»åˆ—çš„ STC å•ç‰‡æœºï¼Œä½¿ç”¨ç®€ä¾¿ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de41ff144a01007ca1c8a.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de44cf144a01007ca75c4.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de44cf144a01007ca75c4.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de44cf144a01007ca75c4.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640de44cf144a01007ca75c4.png" alt=""></p>
<h4 id="1-3-2-STC-ISPè½¯ä»¶çš„ä½¿ç”¨"><a href="#1-3-2-STC-ISPè½¯ä»¶çš„ä½¿ç”¨" class="headerlink" title="1.3.2 STC-ISPè½¯ä»¶çš„ä½¿ç”¨"></a>1.3.2 STC-ISPè½¯ä»¶çš„ä½¿ç”¨</h4><p>å®‰è£…å¥½STC-ISPå’Œé©±åŠ¨åï¼Œå½“æˆ‘ä»¬ç”µè„‘æ’ä¸Šæ¿å­ä¹‹åï¼Œæ‰“å¼€è®¾å¤‡ç®¡ç†å™¨ï¼ŒæŸ¥çœ‹ç«¯å£ï¼Œæˆ‘è¿™é‡Œæ˜¯<code>COM12</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640df64ff144a01007f07897.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640f2776f144a01007f2c334.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640f292ef144a01007f61feb.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/640f2d80f144a01007feb12a.gif" alt=""></p>
<h4 id="1-3-3-å®æˆ˜æ•™å­¦ï¼š-ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯"><a href="#1-3-3-å®æˆ˜æ•™å­¦ï¼š-ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯" class="headerlink" title="1.3.3 å®æˆ˜æ•™å­¦ï¼š ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯"></a>1.3.3 å®æˆ˜æ•™å­¦ï¼š ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED = P2^<span class="number">0</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>;</span><br><span class="line">	ADDR2 = <span class="number">1</span>;</span><br><span class="line">	ADDR1 = <span class="number">1</span>;</span><br><span class="line">	ADDR0 = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    LED = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6411727febf10e5d53f4ca25.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6411727eebf10e5d53f4c921.gif" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64117634ebf10e5d53fce4d3.jpg" alt=""></p>
<h3 id="1-4-å•ç‰‡æœºæœ€å°ç³»ç»Ÿ"><a href="#1-4-å•ç‰‡æœºæœ€å°ç³»ç»Ÿ" class="headerlink" title="1.4 å•ç‰‡æœºæœ€å°ç³»ç»Ÿ"></a>1.4 å•ç‰‡æœºæœ€å°ç³»ç»Ÿ</h3><p>å•ç‰‡æœºæœ€å°ç³»ç»Ÿä¹Ÿå«åšå•ç‰‡æœºæœ€å°åº”ç”¨ç³»ç»Ÿï¼Œæ˜¯æŒ‡ç”¨æœ€å°‘çš„åŸä»¶ç»„æˆå•ç‰‡æœºå¯ä»¥å·¥ä½œçš„ç³»ç»Ÿã€‚å•ç‰‡æœºæœ€å°ç³»ç»Ÿçš„ä¸‰è¦ç´ å°±æ˜¯<code>ç”µæºã€æ™¶æŒ¯ã€å¤ä½ç”µè·¯</code>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64268bc2a682492fccb2fc91.png" alt=""></p>
<h4 id="1-4-1-ç”µæº"><a href="#1-4-1-ç”µæº" class="headerlink" title="1.4.1 ç”µæº"></a>1.4.1 ç”µæº</h4><h4 id="1-4-2-æ™¶æŒ¯"><a href="#1-4-2-æ™¶æŒ¯" class="headerlink" title="1.4.2 æ™¶æŒ¯"></a>1.4.2 æ™¶æŒ¯</h4><h4 id="1-4-3-å¤ä½ç”µè·¯"><a href="#1-4-3-å¤ä½ç”µè·¯" class="headerlink" title="1.4.3 å¤ä½ç”µè·¯"></a>1.4.3 å¤ä½ç”µè·¯</h4><p>å¤ä½ç”µè·¯æ˜¯ä¸€ç§ç”¨æ¥ä½¿ç”µè·¯æ¢å¤åˆ°èµ·å§‹çŠ¶æ€çš„ç”µè·¯è®¾å¤‡ï¼Œå®ƒçš„æ“ä½œåŸç†ä¸<code>è®¡ç®—å™¨</code>æœ‰ç€å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œåªæ˜¯å¯åŠ¨åŸç†å’Œæ‰‹æ®µæœ‰æ‰€ä¸åŒã€‚å¤ä½ç”µè·¯ï¼Œå°±æ˜¯åˆ©ç”¨å®ƒæŠŠç”µè·¯æ¢å¤åˆ°èµ·å§‹çŠ¶æ€ã€‚å°±åƒè®¡ç®—å™¨çš„æ¸…é›¶æŒ‰é’®çš„ä½œç”¨ä¸€æ ·ï¼Œä»¥ä¾¿å›åˆ°åŸå§‹çŠ¶æ€ï¼Œé‡æ–°è¿›è¡Œè®¡ç®—ã€‚</p>
<p>å’Œè®¡ç®—å™¨æ¸…é›¶æŒ‰é’®æœ‰æ‰€ä¸åŒçš„æ˜¯ï¼Œå¤ä½ç”µè·¯å¯åŠ¨çš„æ‰‹æ®µæœ‰æ‰€ä¸åŒã€‚ä¸€æ˜¯åœ¨ç»™ç”µè·¯é€šç”µæ—¶é©¬ä¸Šè¿›è¡Œå¤ä½æ“ä½œï¼›äºŒæ˜¯åœ¨å¿…è¦æ—¶å¯ä»¥ç”±æ‰‹åŠ¨æ“ä½œï¼›ä¸‰æ˜¯æ ¹æ®ç¨‹åºæˆ–è€…ç”µè·¯è¿è¡Œçš„éœ€è¦è‡ªåŠ¨åœ°è¿›è¡Œã€‚å¤ä½ç”µè·¯éƒ½æ˜¯æ¯”è¾ƒç®€å•çš„å¤§éƒ½æ˜¯åªæœ‰ç”µé˜»å’Œç”µå®¹ç»„åˆå°±å¯ä»¥åŠåˆ°äº†ï¼Œå†å¤æ‚ç‚¹å°±æœ‰ä¸‰æç®¡ç­‰é…åˆç¨‹åºæ¥è¿›è¡Œäº†ã€‚ï¼ˆä¸Šç”µå¤ä½å’Œæ‰‹åŠ¨å¤ä½å’Œç¨‹åºè‡ªåŠ¨å¤ä½ï¼‰</p>
<p><code>ä¸Šç”µå¤ä½</code>ï¼šå‡å¦‚æˆ‘ä»¬çš„å•ç‰‡æœºç¨‹åºæœ‰ 100 è¡Œï¼Œå½“æŸä¸€æ¬¡è¿è¡Œåˆ°ç¬¬ 50 è¡Œçš„æ—¶å€™ï¼Œçªç„¶åœç”µäº†ï¼Œè¿™ä¸ªæ—¶å€™å•ç‰‡æœºå†…éƒ¨æœ‰çš„åŒºåŸŸæ•°æ®ä¼šä¸¢å¤±æ‰ï¼Œæœ‰çš„åŒºåŸŸæ•°æ®å¯èƒ½è¿˜æ²¡ä¸¢å¤±ã€‚é‚£ä¹ˆä¸‹æ¬¡æ‰“å¼€è®¾å¤‡çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å•ç‰‡æœºèƒ½æ­£å¸¸è¿è¡Œï¼Œæ‰€ä»¥ä¸Šç”µåï¼Œå•ç‰‡æœºè¦è¿›è¡Œä¸€ä¸ªå†…éƒ¨çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å¯ä»¥ç†è§£ä¸ºä¸Šç”µå¤ä½ï¼Œä¸Šç”µå¤ä½ä¿è¯å•ç‰‡æœºæ¯æ¬¡éƒ½ä»ä¸€ä¸ªå›ºå®šçš„ç›¸åŒçš„çŠ¶æ€å¼€å§‹å·¥ä½œã€‚è¿™ä¸ªè¿‡ç¨‹è·Ÿæˆ‘ä»¬æ‰“å¼€ç”µè„‘ç”µæºå¼€ç”µè„‘çš„è¿‡ç¨‹æ˜¯ä¸€è‡´çš„ã€‚ </p>
<p><code>æ‰‹åŠ¨å¤ä½</code>ï¼šå½“æˆ‘ä»¬çš„ç¨‹åºè¿è¡Œæ—¶ï¼Œå¦‚æœé­å—åˆ°æ„å¤–å¹²æ‰°è€Œå¯¼è‡´ç¨‹åºæ­»æœºï¼Œæˆ–è€…ç¨‹åºè·‘é£çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŒ‰ä¸‹ä¸€ä¸ªå¤ä½æŒ‰é”®ï¼Œè®©ç¨‹åºé‡æ–°åˆå§‹åŒ–é‡æ–°è¿è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšæ‰‹åŠ¨å¤ä½ï¼Œæœ€å…¸å‹çš„å°±æ˜¯æˆ‘ä»¬ç”µè„‘çš„é‡å¯æŒ‰é’®ã€‚</p>
<p><code>ç¨‹åºè‡ªåŠ¨å¤ä½</code>ï¼šå½“ç¨‹åºæ­»æœºæˆ–è€…è·‘é£çš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„å•ç‰‡æœºå¾€å¾€æœ‰ä¸€å¥—è‡ªåŠ¨å¤ä½æœºåˆ¶ï¼Œæ¯”å¦‚çœ‹é—¨ç‹—ï¼Œå…·ä½“åº”ç”¨ä»¥åå†äº†è§£ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœç¨‹åºé•¿æ—¶é—´å¤±å»å“åº”ï¼Œå•ç‰‡æœºçœ‹é—¨ç‹—æ¨¡å—ä¼šè‡ªåŠ¨å¤ä½é‡å¯å•ç‰‡æœºã€‚è¿˜æœ‰ä¸€äº›æƒ…å†µæ˜¯æˆ‘ä»¬ç¨‹åºæ•…æ„é‡å¯å¤ä½å•ç‰‡æœº</p>
<p><strong>ç¨‹åºè·‘é£æ˜¯æŒ‡ç³»ç»Ÿå—åˆ°æŸç§å¹²æ‰°å,ç¨‹åºè®¡æ•°å™¨PCçš„å€¼åç¦»äº†ç»™å®šçš„å”¯ä¸€å˜åŒ–å†ç¨‹,å¯¼è‡´ç¨‹åºè¿è¡Œåç¦»æ­£å¸¸çš„è¿è¡Œè·¯å¾„.ç¨‹åºè·‘é£å› ç´ åŠåæœå¾€å¾€æ˜¯ä¸å¯é¢„è®¡çš„.åœ¨å¾ˆå¤šæƒ…å†µä¸‹,ç¨‹åºè·‘é£åç³»ç»Ÿä¼šè¿›å…¥æ­»å¾ªç¯è€Œå¯¼è‡´æ­»æœºã€‚</strong></p>
<h4 id="1-4-4-å•ç‰‡æœºçœ‹é—¨ç‹—"><a href="#1-4-4-å•ç‰‡æœºçœ‹é—¨ç‹—" class="headerlink" title="1.4.4 å•ç‰‡æœºçœ‹é—¨ç‹—"></a>1.4.4 å•ç‰‡æœºçœ‹é—¨ç‹—</h4><p>çœ‹é—¨ç‹—(WDT)æ˜¯ä¸€ä¸ª<code>å®šæ—¶å™¨</code>ã€‚çœ‹é—¨ç‹—æ˜¯ç”¨æ¥é˜²æ­¢ä¸‡ä¸€å•ç‰‡æœºç¨‹åºå‡ºé”™é€ æˆé‡å¤§æŸå¤±çš„ã€‚é˜²é”™çš„åŸç†å¾ˆç®€å•ï¼Œå®ƒåœ¨ç¡¬ä»¶ä¸Šå°±æ˜¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå½“å®ƒæº¢å‡ºçš„æ—¶å€™å°±ä¼šè®©å•ç‰‡æœºå¼ºåˆ¶å¤ä½ä½¿ç¨‹åºé‡æ–°å¼€å§‹æ‰§è¡Œã€‚</p>
<p>æ­£å¸¸çš„æƒ…å†µä¸‹æ˜¯ä¸èƒ½è®©å®ƒæº¢å‡ºçš„ï¼Œæ‰€ä»¥åœ¨ç¨‹åºä¸Šæ¯éš”ä¸€æ®µæ—¶é—´è¦ç»™ä»–ç½®ä¸€æ¬¡å€¼ï¼ˆä¿—ç§°å–‚ç‹—ï¼‰ï¼Œåªè¦ç¨‹åºä¸­æ­£å¸¸ç»™å®ƒå–‚ä»–å°±ä¸ä¼šæº¢å‡ºã€‚</p>
<p>ä¸€æ—¦ç¨‹åºè·‘é£äº†ï¼Œæœ‰å¹²æ‰°æˆ–è€…è¿›å…¥æ­»å¾ªç¯ä¹‹ç±»çš„æƒ…å†µæ—¶ï¼Œä¸èƒ½æ­£å¸¸æ‰§è¡Œç¨‹åºäº†ï¼Œé‚£ä¹ˆå°±æ°¸è¿œæ‰§è¡Œä¸åˆ°å–‚ç‹—çš„æŒ‡ä»¤äº†ï¼Œä½†æ­¤æ—¶å®šæ—¶å™¨æ˜¯ç¡¬ä»¶æ§åˆ¶çš„ï¼Œä»ç„¶ä¼šèµ°ï¼Œæ‰€ä»¥æº¢å‡ºäº†ï¼Œå•ç‰‡æœºå°±å¤ä½äº†ã€‚</p>
<p>ä¸€èˆ¬å®‰å…¨æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„ï¼Œç³»ç»Ÿè·‘é£äº†ä¼šé€ æˆé‡å¤§äº‹æ•…çš„éƒ½ä¼šåŠ ä¸€ä¸ªâ€œç‹—â€ä¿å®‰å…¨ã€‚</p>
<p>é€šå¸¸ï¼Œçœ‹é—¨ç‹—çš„æº¢å‡ºæ—¶é—´è¶ŠçŸ­è¶Šçµæ•ï¼Œè·‘é£ä¹‹åå¤ä½çš„æ—¶é—´è¶ŠçŸ­ï¼Œä¹Ÿå°±è¶Šå®‰å…¨ï¼Œä½†æ˜¯ï¼Œå–‚ç‹—çš„æ“ä½œä¹Ÿè¦æ›´é¢‘ç¹ã€‚</p>
<h3 id="1-5-LEDå°ç¯åŸç†"><a href="#1-5-LEDå°ç¯åŸç†" class="headerlink" title="1.5 LEDå°ç¯åŸç†"></a>1.5 LEDå°ç¯åŸç†</h3><p>LED(light-emitting diode)ï¼Œå³å‘å…‰äºŒæç®¡ï¼Œä¿—ç§° LED å°ç¯ï¼Œå®ƒçš„ç§ç±»å¾ˆå¤šï¼Œå‚æ•°ä¹Ÿä¸å°½ç›¸åŒï¼Œæˆ‘ä»¬æ¿å­ä¸Šç”¨çš„æ˜¯æ™®é€šçš„è´´ç‰‡å‘å…‰äºŒæç®¡ã€‚è¿™ç§äºŒæç®¡é€šå¸¸çš„æ­£å‘å¯¼é€šç”µå‹æ˜¯ 1.8Våˆ° 2.2V ä¹‹é—´ï¼Œå·¥ä½œç”µæµä¸€èˆ¬åœ¨ 1mAï½20mA ä¹‹é—´ã€‚å…¶ä¸­ï¼Œå½“ç”µæµåœ¨ <code>1mAï½5mA</code>ä¹‹é—´å˜åŒ–æ—¶ï¼Œéšç€é€šè¿‡ LED çš„ç”µæµè¶Šæ¥è¶Šå¤§ï¼Œæˆ‘ä»¬çš„è‚‰çœ¼ä¼šæ˜æ˜¾æ„Ÿè§‰åˆ°è¿™ä¸ªå°ç¯è¶Šæ¥è¶Šäº®ï¼Œè€Œå½“ç”µæµä»5mAï½20mA ä¹‹é—´å˜åŒ–æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„å‘å…‰äºŒæç®¡çš„äº®åº¦å˜åŒ–å°±ä¸æ˜¯å¤ªæ˜æ˜¾äº†ã€‚å½“ç”µæµè¶…è¿‡20mA æ—¶ï¼ŒLED å°±ä¼šæœ‰çƒ§åçš„å±é™©äº†ï¼Œç”µæµè¶Šå¤§ï¼Œçƒ§åçš„ä¹Ÿå°±è¶Šå¿«ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­åº”è¯¥ç‰¹åˆ«æ³¨æ„å®ƒåœ¨ç”µæµå‚æ•°ä¸Šçš„è®¾è®¡è¦æ±‚ã€‚</p>
<h4 id="1-5-1-USBæ¥å£ç”µè·¯"><a href="#1-5-1-USBæ¥å£ç”µè·¯" class="headerlink" title="1.5.1 USBæ¥å£ç”µè·¯"></a>1.5.1 USBæ¥å£ç”µè·¯</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/12image-20230331162131030.png" alt="12image-20230331162131030"></p>
<p>é€šè¿‡ USB çº¿ï¼Œç”µè„‘ç»™æˆ‘ä»¬çš„å¼€å‘æ¿ä¾›ç”µå’Œä¸‹è½½ç¨‹åºä»¥åŠå®ç°ç”µè„‘å’Œå¼€å‘æ¿ä¹‹é—´çš„é€šä¿¡ã€‚ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼ŒUSB åº§å…±æœ‰ <code>6</code> ä¸ªæ¥å£ï¼Œå…¶ä¸­ 2<br>è„šå’Œ 3 è„šæ˜¯<code>æ•°æ®é€šä¿¡å¼•è„š</code>ï¼Œ1 è„šå’Œ 4 è„šæ˜¯<code>ç”µæºå¼•è„š</code>ï¼Œ1 è„šæ˜¯<code>VCC æ­£ç”µæº</code>ï¼Œ4 è„šæ˜¯ <code>GND å³åœ°çº¿</code>ã€‚5 è„šå’Œ 6 è„šæ˜¯<code>å¤–å£³</code>ï¼Œæˆ‘ä»¬ç›´æ¥æ¥åˆ°äº† GND ä¸Šï¼Œå¤§å®¶å¯ä»¥è§‚å¯Ÿä¸€ä¸‹å¼€å‘æ¿ä¸Šçš„è¿™ä¸ª USBåº§çš„ 6 ä¸ªå¼•è„šã€‚</p>
<p>æˆ‘ä»¬ç°åœ¨ä¸»è¦æ¥çœ‹ 1 è„š VCC å’Œ 4 è„š GNDã€‚1 è„šé€šè¿‡ F1ï¼ˆè‡ªæ¢å¤ä¿é™©ä¸ï¼‰æ¥åˆ°å³ä¾§ï¼Œåœ¨æ­£å¸¸å·¥ä½œçš„æƒ…å†µä¸‹ï¼Œä¿é™©ä¸å¯ä»¥ç›´æ¥çœ‹æˆå¯¼çº¿ï¼Œå› æ­¤å·¦å³ä¸¤è¾¹éƒ½æ˜¯ USB ç”µæº+5Vï¼Œè‡ªæ¢å¤ä¿é™©ä¸çš„ä½œç”¨æ˜¯ï¼Œ<code>å½“ä½ åçº§ç”µè·¯å“ªä¸ªåœ°æ–¹æœ‰å‘ç”ŸçŸ­è·¯çš„æ—¶å€™ï¼Œä¿é™©ä¸ä¼šè‡ªåŠ¨åˆ‡æ–­ç”µè·¯ï¼Œä¿æŠ¤å¼€å‘æ¿ä»¥åŠç”µè„‘çš„ USB å£</code>ï¼Œå½“ç”µè·¯æ­£å¸¸åï¼Œä¿é™©ä¸ä¼šæ¢å¤ç•…é€šï¼Œæ­£å¸¸å·¥ä½œã€‚å³ä¾§æœ‰ 2 æ¡æ”¯è·¯ï¼Œç¬¬ä¸€æ¡æ˜¯åœ¨+5V å’Œ GND æ¥äº†ä¸€ä¸ª 470uF çš„ç”µå®¹ï¼Œç”µå®¹æ˜¯éš”ç¦»ç›´æµçš„ï¼Œæ‰€ä»¥è¿™æ¡æ”¯è·¯æ˜¯æ²¡æœ‰ç”µæµçš„ï¼Œç”µå®¹çš„ä½œç”¨ï¼Œæˆ‘ä»¬ä¸‹èŠ‚è¯¾å†ä»‹ç»ï¼Œè¿™èŠ‚è¯¾æˆ‘ä»¬ä¸»è¦çœ‹ç¬¬äºŒæ¡æ”¯è·¯ã€‚æˆ‘ä»¬æŠŠç¬¬äºŒæ¡æ”¯è·¯æ‘˜å–å‡ºæ¥å°±æ˜¯å¦‚å›¾ 2-4 è¿™ä¸ªæ ·å­ã€‚</p>
<h4 id="1-5-2-LEDå°ç¯ç”µè·¯"><a href="#1-5-2-LEDå°ç¯ç”µè·¯" class="headerlink" title="1.5.2 LEDå°ç¯ç”µè·¯"></a>1.5.2 LEDå°ç¯ç”µè·¯</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/12image-20230331163030645.png" alt="12image-20230331163030645"></p>
<p>å‘å…‰äºŒæç®¡æ˜¯äºŒæç®¡ä¸­çš„ä¸€ç§ï¼Œå› æ­¤å’Œæ™®é€šäºŒæç®¡ä¸€æ ·ï¼Œè¿™ä¸ªäºŒæç®¡ä¹Ÿæœ‰é˜´æå’Œé˜³æï¼Œä¹ æƒ¯ä¸Šä¹Ÿç§°ä¹‹ä¸ºè´Ÿæå’Œæ­£æã€‚æˆ‘ä»¬æ¥å…¥çš„ VCC ç”µå‹æ˜¯ 5Vï¼Œå‘å…‰äºŒæç®¡è‡ªèº«<code>å‹é™</code>å¤§æ¦‚æ˜¯ 2Vï¼Œé‚£ä¹ˆåœ¨å³è¾¹ R34 è¿™ä¸ªç”µé˜»ä¸Šæ‰¿å—çš„ç”µå‹å°±æ˜¯ 3Vã€‚ç°åœ¨æˆ‘ä»¬è¦æ±‚ç”µæµèŒƒå›´æ˜¯ 1~20mA çš„è¯ï¼Œå°±å¯ä»¥æ ¹æ®æ¬§å§†å®šå¾‹ R=U/Iï¼ŒæŠŠè¿™ä¸ªç”µé˜»çš„ä¸Šé™å’Œä¸‹é™å€¼æ±‚å‡ºæ¥ï¼šU=3Vï¼Œå½“ç”µæµæ˜¯ 1mA çš„æ—¶å€™ï¼Œç”µé˜»å€¼æ˜¯ 3Kï¼›å½“ç”µæµæ˜¯ 20mA çš„æ—¶å€™ï¼Œç”µé˜»å€¼æ˜¯ 150æ¬§ï¼Œä¹Ÿå°±æ˜¯ R34 çš„å–å€¼èŒƒå›´æ˜¯ 150~3K æ¬§å§†ã€‚è¿™ä¸ªç”µé˜»å€¼å¤§å°çš„å˜åŒ–ï¼Œç›´æ¥å¯ä»¥é™åˆ¶æ•´æ¡é€šè·¯çš„ç”µæµçš„å¤§å°ï¼Œå› æ­¤è¿™ä¸ªç”µé˜»æˆ‘ä»¬é€šå¸¸ç§°ä¹‹<code>é™æµç”µé˜»</code>ã€‚åŒç†ï¼Œæˆ‘ä»¬åœ¨æ¿å­åçº§å¼€å…³æ§åˆ¶çš„åœ°æ–¹ï¼Œåˆæ·»åŠ äº†ä¸€ä¸ª LED10 å‘å…‰äºŒæç®¡ï¼Œä½œç”¨å°±æ˜¯å½“æˆ‘ä»¬æ‰“å¼€å¼€å…³æ—¶ï¼Œè¿™ä¸ªäºŒæç®¡æ‰ä¼šäº®èµ·ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/12image-20230331163621172.png" alt="12image-20230331163621172"></p>
<p>è¿™é‡Œçš„å¼€å…³è™½ç„¶åªæœ‰ä¸€ä¸ªï¼Œä½†æ˜¯æ˜¯ <code>2 è·¯</code>çš„ï¼Œ<code>2 è·¯å¼€å…³å¹¶è”</code>èƒ½æ›´å¥½çš„ç¡®ä¿ç»™åçº§æä¾›æ›´å¤§çš„ç”µæµã€‚ç”µå®¹ C19 å’Œ C10ï¼Œéƒ½æ˜¯éš”ç¦»æ–­å¼€ç›´æµçš„ã€‚æŠŠå³ä¾§çš„ GND å»æ‰ï¼Œæ”¹æˆä¸€ä¸ªå•ç‰‡æœºçš„<code>IO</code>å£ï¼Œå¦‚å›¾æ‰€ç¤º</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/12image-20230331163940682.png" alt="12image-20230331163940682"></p>
<p>æˆ‘ä»¬æŠŠå³ä¾§çš„åŸ GND å¤„æ¥åˆ°å•ç‰‡æœº P0.0 å¼•è„šä¸Šï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å•ç‰‡æœºè¾“å‡ºä¸€ä¸ª<code>ä½ç”µå¹³</code>ï¼Œä¹Ÿå°±æ˜¯è·Ÿ GND ä¸€æ ·çš„ 0V ç”µå‹ï¼Œå°±å¯ä»¥è®© LED<br>å°ç¯å‘å…‰äº†ã€‚æˆ‘ä»¬å¯ä»¥è®© P0.0 è¿™ä¸ªå¼•è„šè¾“å‡ºä¸€ä¸ªé«˜ç”µå¹³ï¼Œå°±æ˜¯è·Ÿ VCC ä¸€æ ·çš„ 5V ç”µå‹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œå·¦ä¾§ VCC ç”µå‹å’Œå³ä¾§çš„ P0.0 çš„ç”µå‹æ˜¯ä¸€è‡´çš„ï¼Œé‚£å°±æ²¡æœ‰ç”µå‹å·®ï¼Œæ²¡æœ‰ç”µå‹å·®å°±ä¸ä¼šäº§ç”Ÿç”µæµï¼Œæ²¡æœ‰ç”µæµ LED å°ç¯å°±ä¸ä¼šäº®ï¼Œä¹Ÿå°±æ˜¯ä¼šå¤„äºç†„ç­çŠ¶æ€ã€‚</p>
<h4 id="1-5-3-å•ç‰‡æœºç«¯å£"><a href="#1-5-3-å•ç‰‡æœºç«¯å£" class="headerlink" title="1.5.3 å•ç‰‡æœºç«¯å£"></a>1.5.3 å•ç‰‡æœºç«¯å£</h4><p><code>STC89C52RC</code>èŠ¯ç‰‡æœ‰<code>4*8=32</code>ä¸ªIOç«¯å£å¯ä»¥ä¾›æˆ‘ä»¬ç”¨ç¨‹åºè¾“å‡ºé«˜ä½ç”µå¹³ã€‚æ‹¿<code>P0</code>è¡¨ç¤ºå®ƒå¯ä»¥ä¸€æ¬¡æ€§æ§åˆ¶8ä¸ªå¼•è„šç«¯å£è¾“å‡ºæ¯ä¸ªå¼•è„šæƒ³è¾“å‡ºçš„ç”µå¹³çŠ¶æ€ã€‚<code>P0</code>æ˜¯ä¸€ä¸ªå¯„å­˜å™¨ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯æ§åˆ¶æ‰€å¯¹åº”çš„8ä¸ªIOå£(<code>P0.0-P0.7</code>)ã€‚å¦‚æœæˆ‘ä»¬æ§åˆ¶<code>P0.0</code>å•ä¸ªç«¯å£è¾“å‡ºä½ç”µå¹³ï¼Œ<code>P0.1~P0.7</code>è¿™7ä¸ªIOç«¯å£è¾“å‡ºé«˜ç”µå¹³ï¼Œç¨‹åºä¸­ä½¿ç”¨è¿™æ¡è¯­å¥<code>P0=0xFE</code>;ä¸ºä»€ä¹ˆæ˜¯<code>0xFE</code>å‘¢ï¼Ÿ</p>
<p>Cè¯­è¨€ä¸­çš„åå…­è¿›åˆ¶<code>0xFE</code>ç”¨äºŒè¿›åˆ¶è¡¨ç¤º<code>11111110</code>ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†å•ç‰‡æœºçš„<code>P0.0</code>æ’åœ¨è¿™å…«ä¸ªä½çš„æœ€ä½ç«¯ã€‚æˆ‘ä»¬æ§åˆ¶P0.2å•ä¸ªIOç«¯å£è¾“å‡ºä½ç”µå¹³ï¼Œå…¶ä»–IOç«¯å£è¾“å‡ºé«˜ç”µå¹³ï¼Œåˆ™æ˜¯<code>P0=0xFB</code>; äºŒè¿›åˆ¶è¡¨ç¤º<code>11111011</code>ã€‚</p>
<p>æ˜¾ç„¶æˆ‘ä»¬ä½¿ç”¨<code>P0=0xFE</code>å°±æ˜¯å¼ºåˆ¶æŠŠå…¶ä»–7ä¸ªIOç«¯å£éƒ½è¾“å‡ºäº†å›ºå®šé«˜ç”µå¹³çŠ¶æ€ã€‚è¦æƒ³å®ç°å•ç‹¬æ§åˆ¶ä¸€ä¸ªIOç«¯å£ï¼Œè¿™æ—¶æˆ‘ä»¬ç”¨è¿™æ¡è¯­å¥æ¥å£°æ˜<code>sbit LED=P0^0;</code>ä¹Ÿå°±æ˜¯åªæ§åˆ¶ä¸€ä¸ªä½ï¼Œæ­¤æ—¶æƒ³è®©å•ç‹¬çš„P0.0è¾“å‡ºä½ç”µå¹³åªéœ€<code>LED=0;</code>å³å¯ï¼ŒLEDä¸è¿‡æ˜¯è¡¨ç¤ºP0.0æ‰€ç”¨çš„åå­—è€Œå·²,ä½ å¯ä»¥æ ¹æ®å–œå¥½æ”¹å†™è¿™ä¸ªåå­—ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç¨‹åºä¹¦å†™ä¸­å¦‚æœæ²¡æœ‰<code>sbit LED=P0^0;</code>è¿™ä¸ªæå‰å®šä¹‰ï¼Œç›´æ¥<code>P0.0=0;</code>è¿™æ ·ä¹¦å†™æ˜¯ä¸ç¬¦åˆè¯­æ³•çš„ï¼Œå¿…é¡»å…ˆç»™IOç«¯å£ä¸€ä¸ªå‘½åï¼Œè€Œä¸”<code>sbit LED=P0.0;</code>è¿™æ ·çš„å†™æ³•åŒæ ·ä¹Ÿä¸ç¬¦åˆè¯­æ³•ï¼Œè§„å®šæ˜¯<code>P0^0</code>ã€‚è¿˜æœ‰æˆ‘ä»¬ä¹Ÿä¸èƒ½å‘½åå·²ç»åœ¨ <code>#include&lt;reg52.h&gt;</code>å¤´æ–‡ä»¶ä¸­å·²æœ‰çš„åå­—ï¼ŒæŸ¥çœ‹å¤´æ–‡ä»¶å†…å®¹å¯çŸ¥ï¼Œæœ‰äº›åå­—å·²ç»è¢«ä½¿ç”¨ï¼Œåƒ<code>sbit PSW=P0^0;</code>ï¼Œ<code>sbit CY=P0^0;</code>è¿™æ ·å®šä¹‰ä¼šç¼–è¯‘æŠ¥é”™çš„ï¼Œå› ä¸ºå‘½åå†²çªäº†ã€‚<code>#include&lt;reg52.h&gt;</code>å¤´æ–‡ä»¶ä¸­å·²æœ‰çš„åå­—æˆ‘ä»¬åæœŸä¼šä½¿ç”¨åˆ°çš„ã€‚</p>
<h4 id="1-5-4-å®é™…LEDç¡¬ä»¶è¿æ¥"><a href="#1-5-4-å®é™…LEDç¡¬ä»¶è¿æ¥" class="headerlink" title="1.5.4 å®é™…LEDç¡¬ä»¶è¿æ¥"></a>1.5.4 å®é™…LEDç¡¬ä»¶è¿æ¥</h4><h5 id="1-5-4-1-ä¸‰æç®¡è®¤è¯†"><a href="#1-5-4-1-ä¸‰æç®¡è®¤è¯†" class="headerlink" title="1.5.4.1 ä¸‰æç®¡è®¤è¯†"></a>1.5.4.1 ä¸‰æç®¡è®¤è¯†</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bb2916ea21b9a9e06a6d0.png" alt=""></p>
<p>å…ˆçœ‹å·¦è¾¹çš„å›¾ï¼Œæƒ³è¦ç‚¹äº®LEDç¯ï¼Œåªéœ€è¦<code>+5v</code>å’Œ<code>R1</code>å¤„äºçŸ­æ¥çŠ¶æ€å³å¯ï¼Œé‚£ä¹ˆPNPå‹ä¸‰æç®¡å°±æ˜¯èµ·åˆ°è¢«å•ç‰‡æœºIOç«¯å£æ§åˆ¶æ˜¯å¦å…è®¸æ­¤å¤„çŸ­æ¥çš„ä½œç”¨ï¼Œä¹Ÿå«ä¸‰æç®¡æ˜¯å¦å¯¼é€šã€‚å¦‚æœå•ç‰‡æœºIOç«¯å£è¾“å‡ºçš„æ˜¯<code>ä½ç”µå¹³</code>ï¼ˆ0Vï¼‰,æ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç›´è§‚çš„è®¤ä¸º<code>+5</code>é‚£ç«¯ä¸å•ç‰‡æœºIOç«¯å£å½¢æˆå‹å·®æœ‰ç”µæµé€šè¿‡ï¼Œè€Œç”µæµæµå‘æ­£å¦‚ç®­å¤´æ‰€ç¤ºï¼Œåˆ™è¡¨æ˜æ­¤æ—¶<code>+5</code>ä¸<code>R1</code>æ˜¯<code>çŸ­æ¥çŠ¶æ€</code>ï¼Œä¸‰æç®¡å¯¼é€šï¼Œç¯å°±è¢«ç‚¹äº®äº†ã€‚å¦‚æœå•ç‰‡æœºIOç«¯å£è¾“å‡ºçš„æ˜¯<code>é«˜ç”µå¹³</code>ï¼ˆ5Vï¼‰æ—¶ï¼Œåˆ™æ²¡æœ‰å½¢æˆå‹å·®ä¹Ÿå°±äº§ç”Ÿä¸äº†ç”µæµï¼Œé‚£ä¹ˆç®­å¤´ä¸èƒ½ä»£è¡¨æ­¤æ—¶æœ‰ç”µæµæµå‘è¿™ä¸ªæ–¹å‘ï¼Œæ‰€ä»¥<code>+5</code>ä¸<code>R1</code>æ˜¯æ–­å¼€çŠ¶æ€ï¼Œç¯æ²¡æœ‰è¢«ç‚¹äº®ã€‚ç®­å¤´èµ·åˆ°çš„å°±æ˜¯è¾…åŠ©æˆ‘ä»¬ç†è§£çš„ä¼˜åŠ¿ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥æ ¹æ®ç®­å¤´å¾ˆå½¢è±¡çš„åˆ¤æ–­å‡ºå•ç‰‡æœºIOç«¯å£è¾“å‡ºä»€ä¹ˆç”µå¹³çŠ¶æ€æ—¶å°±å¯ä»¥ç‚¹äº®LEDã€‚R1,R2ç”µé˜»èµ·åˆ°çš„æ˜¯é™æµä¿æŠ¤ï¼Œå³å›¾ä½¿ç”¨çš„æ˜¯NPNå‹ä¸‰æç®¡ï¼Œé‚£ä¹ˆå•ç‰‡æœºIOç«¯å£è¾“å‡ºé«˜ç”µå¹³æ—¶ç‚¹äº®LED,è¾“å‡ºä½ç”µå¹³æ—¶ç‚¹ä¸äº®LEDã€‚</p>
<div class="tip warning faa-horizontal animated"><p>è¯¦ç»†çš„å¯ä»¥çœ‹å®‹è€å¸ˆçš„ã€Šæ‰‹æŠŠè¯´æ•™ä½ 51å•ç‰‡æœºã€‹çš„ç¬¬3.3èŠ‚</p>
</div>
<h5 id="1-5-4-2-ä¸‰å…«è¯‘ç å™¨"><a href="#1-5-4-2-ä¸‰å…«è¯‘ç å™¨" class="headerlink" title="1.5.4.2 ä¸‰å…«è¯‘ç å™¨"></a>1.5.4.2 ä¸‰å…«è¯‘ç å™¨</h5><p>è¯¥å…ƒå™¨ä»¶åªéœ€è¦ç”¨åˆ°æˆ‘ä»¬å•ç‰‡æœºä¸‰ä¸ªIOç«¯å£å°±å¯ä»¥æ§åˆ¶å®ƒçš„å…«ä¸ªå¼•è„šå…¶ä¸­çš„ä¸€ä¸ªè¾“å‡ºä½ç”µå¹³ï¼Œå¼€å‘æ¿å°±ç”¨åˆ°è¿™ç§å«74HC138ä¸‰å…«è¯‘ç å™¨ã€‚æˆ‘ä»¬çœç•¥å®ƒçš„ç”µæºä¾›ç”µå¼•è„šï¼Œç”»å‡ºéœ€è¦è®²è§£çš„å¼•è„šã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bb66e6ea21b9a9e0fbd97.png" alt=""></p>
<p>é¦–å…ˆæœ‰ä¸‰ä¸ªå¼•è„š<code>E0,E0,E1</code>éœ€è¦å›ºå®šç»™å®ƒé»˜è®¤çš„ç”µå¹³å®ƒæ‰èƒ½æ­£å¸¸å·¥ä½œï¼Œä¿—ç§°<code>ä½¿èƒ½å™¨ä»¶</code>ã€‚</p>
<p>æ­¤æ—¶3ä¸ªå•ç‰‡æœºIOç«¯å£è¾“å‡ºä¸ä¸€æ ·çš„ç”µå¹³æ—¶ï¼ŒIO0~IO7çš„å…¶ä¸­ä¸€ä¸ªå¼•è„šå°±ä¼šè¾“å‡ºä½ç”µå¹³ï¼Œè€Œå…¶ä»–7ä¸ªIOéƒ½æ˜¯è¾“å‡ºé«˜ç”µå¹³ã€‚</p>
<p>å½“æˆ‘ä»¬çš„ä¸‰ä¸ªIOç«¯å£è¿™æ ·è¾“å‡ºæ—¶ï¼Œåˆ™æœ‰ä»¥ä¸‹æƒ…å†µ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bb70b6ea21b9a9e1173c2.png" alt=""></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸‰ä¸ªIOç«¯å£è¾“å‡ºçš„ä¸‰ä¸ªå€¼ä» IOç«¯å£3â†’IOç«¯å£2â†’IOç«¯å£1æ’æˆäºŒè¿›åˆ¶æ•°çš„å¾—æ•°å°±æ˜¯å“ªä¸ªIOxè¾“å‡ºä½ç”µå¹³ã€‚æ¯”å¦‚ä¸‰ä¸ªIOç«¯å£è¿™æ ·è¾“å‡ºï¼š1 1 0ã€‚æ­¤æ—¶äºŒè¿›åˆ¶å€¼ä¸ºåè¿›åˆ¶çš„6ï¼Œé‚£ä¹ˆIO6å°±è¾“å‡ºä½ç”µå¹³ï¼Œå…¶ä»–è¾“å‡ºé«˜ç”µå¹³</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bb80a6ea21b9a9e16b8d5.png" alt=""></p>
<h3 id="1-6-èœ‚é¸£å™¨åŸç†"><a href="#1-6-èœ‚é¸£å™¨åŸç†" class="headerlink" title="1.6 èœ‚é¸£å™¨åŸç†"></a>1.6 èœ‚é¸£å™¨åŸç†</h3><h4 id="1-6-1-å•ç‰‡æœºIOç«¯å£ç”µæµ"><a href="#1-6-1-å•ç‰‡æœºIOç«¯å£ç”µæµ" class="headerlink" title="1.6.1 å•ç‰‡æœºIOç«¯å£ç”µæµ"></a>1.6.1 å•ç‰‡æœºIOç«¯å£ç”µæµ</h4><p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ï¼Œç»å¤§éƒ¨åˆ†å•ç‰‡æœºä¸Šçš„LEDå°ç¯ç”µè·¯åŸºæœ¬éƒ½æ˜¯ç¡®å®š<code>+5v</code>æ­£å‹ï¼Œè€Œè®©å•ç‰‡æœºIOå£è¾“å‡ºä½ç”µå¹³ä½¿å°ç¯å‘å…‰ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹å®‹è€å¸ˆçš„è®²è§£å§ã€‚ä¸‹é¢æ˜¯ä¸¤ä¸ªLEDå°ç¯ç”µè·¯</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642beb826ea21b9a9e3c9f30.png" alt=""></p>
<p><code>å·¦è¾¹ç”µè·¯</code>å³ä½¿å•ç‰‡æœºIOç«¯å£è¾“å‡ºé«˜ç”µå¹³5Vï¼Œç¯çš„äº®åº¦æ˜¯å¾ˆä½çš„ï¼Œå› ä¸ºå•ç‰‡æœºIOç«¯å£æµå‡ºæ¥çš„<code>ç”µæµ</code>å¤ªå°ï¼Œæ— æ³•é©±åŠ¨LEDæ­£å¸¸å‘å…‰ã€‚è¿™ä¸ªæ˜¯å…³è”åˆ°å•ç‰‡æœºå†…éƒ¨çš„<code>é›†æˆç”µè·¯</code>åŸå› çš„ï¼Œå¤§å®¶å¯ä»¥ä¸Šç½‘ä¸ŠæŸ¥æŸ¥ã€‚</p>
<p><code>å³è¾¹ç”µè·¯</code>è¿™æ—¶å•ç‰‡æœºIOç«¯å£è¾“å‡ºä½ç”µå¹³æ—¶ç¯å´å¾ˆäº®ï¼ŒåŸå› è¿™æ˜¯ç”µæºä¾›ç»™çš„5Vï¼Œ<code>ç”µæµæ¯”è¾ƒå¤§</code>ï¼Œæ‰€ä»¥å¯ä»¥ä½¿LEDå‘å…‰è¾ƒäº®ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå……ç”µå®çš„æ¥å£è¾“å‡ºç”µå‹5Vï¼Œä½†æ˜¯å®ƒæµå‡ºçš„ç”µæµå¤§ï¼Œæ‰€ä»¥ç»™æ‰‹æœºå……ç”µå°±å¿«ï¼Œè™½ç„¶ç”µè„‘USBå£æ¥å£ç”µå‹ä¹Ÿæ˜¯5Vä½†å……ç”µå´éå¸¸æ…¢ï¼ŒåŸå› æ˜¯USBå£ç”µæµå¤ªå°ã€‚</p>
<p>STC89C52RCè¿™æ¬¾èŠ¯ç‰‡çš„P1ï¼ŒP2ï¼ŒP3è¿™ä¸€å…±24ä¸ªIOç«¯å£ç”±äºå†…éƒ¨ç¡¬ä»¶çš„åŸå› ä¸Šç”µçš„æ—¶å€™éƒ½æ˜¯è¾“å‡ºé«˜ç”µå¹³çš„ï¼Œè€ŒP0ä¸€å¼€å§‹æ˜¯ä¸€ç§ä¸ç¡®å®šçš„çŠ¶æ€ï¼ˆæœ‰æ—¶æ˜¯é«˜æœ‰æ—¶æ˜¯ä½ï¼‰ï¼Œä½†æˆ‘ä»¬ç”¨çš„å¼€å‘æ¿å·²ç»æŠŠP0ç«¯å£æ¥äº†ä¸Šæ‹‰ç”µé˜»ï¼Œæ‰€ä»¥å¼€å‘æ¿çš„P0.0~P0.7åˆå§‹æ—¶ä¹Ÿæ˜¯è¾“å‡ºé«˜ç”µå¹³çš„ã€‚</p>
<h4 id="1-6-2-æœ‰æºèœ‚é¸£å™¨"><a href="#1-6-2-æœ‰æºèœ‚é¸£å™¨" class="headerlink" title="1.6.2 æœ‰æºèœ‚é¸£å™¨"></a>1.6.2 æœ‰æºèœ‚é¸£å™¨</h4><p><code>èœ‚é¸£å™¨</code>åˆ†<code>æœ‰æºèœ‚é¸£å™¨</code>å’Œ<code>æ— æºèœ‚é¸£å™¨</code>ï¼Œä¸¤è€…è¡¨é¢é•¿ç›¸ç›¸åŒï¼Œæœ‰æºèœ‚é¸£å™¨æœ‰æ­£è´Ÿæä¹‹åˆ†ï¼Œæ­£ææ¥5Vï¼Œè´Ÿææ¥åœ°å°±å¯ä»¥å“ã€‚å’ŒLEDå°ç¯ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç®€åˆ°ç¹çš„ç†è§£æœ‰æºèœ‚é¸£å™¨ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bed2d6ea21b9a9e494b28.png" alt=""></p>
<h4 id="1-6-3-æ— æºèœ‚é¸£å™¨"><a href="#1-6-3-æ— æºèœ‚é¸£å™¨" class="headerlink" title="1.6.3 æ— æºèœ‚é¸£å™¨"></a>1.6.3 æ— æºèœ‚é¸£å™¨</h4><p>å¼€å‘æ¿ä¸­æ— æºèœ‚é¸£å™¨ç¡¬ä»¶è¿æ¥é™¤äº†ä¸€ä¸ªç»­æµäºŒæç®¡å¤–å°±å¦‚æœ‰æºèœ‚é¸£å™¨ä¸€æ ·äº†ï¼Œæ— æºèœ‚é¸£å™¨å®ç‰©å¯ä»¥ä¸åˆ†æ­£è´Ÿææ¥ï¼Œä½†å®ƒä¹Ÿæ ‡æœ‰â€œ+â€ç¬¦å·ï¼Œä¹Ÿè®¸æ˜¯ä¸ºäº†åœ¨æˆ‘ä»¬ä¸çŸ¥é“è¿™æ˜¯æœ‰æºèœ‚é¸£å™¨è¿˜æ˜¯æ— æºèœ‚é¸£å™¨çš„æƒ…å†µä¸Šç»Ÿä¸€è§„å®šæ¥æ³•å§ã€‚</p>
<p>è¦è®©æ— æºèœ‚é¸£å™¨å‘å£°ï¼Œéœ€è¦æˆ‘ä»¬åœ¨å•ç‰‡æœºIOç«¯å£ä¸Šè¾“å‡º<code>500Hz~4.5kHz</code>çš„è„‰å†²é¢‘ç‡ä¿¡å·ã€‚</p>
<p>ç”¨æ—¶é—´è¡¨ç¤ºå°±æ˜¯è¦è¾“å‡ºå‘¨æœŸä¸º<code>0.22ms~2msï¼ˆï¼ˆ1/4500sï¼‰~ï¼ˆ1/500sï¼‰ï¼‰</code>èŒƒå›´çš„æ–¹æ³¢,è¿™ä¸ªå‘¨æœŸå†…é«˜ç”µå¹³æ—¶é—´å’Œä½ç”µå¹³æ—¶é—´å„å ä¸€åŠã€‚</p>
<h4 id="1-6-4-æ— æºèœ‚é¸£å™¨é¸£å«"><a href="#1-6-4-æ— æºèœ‚é¸£å™¨é¸£å«" class="headerlink" title="1.6.4 æ— æºèœ‚é¸£å™¨é¸£å«"></a>1.6.4 æ— æºèœ‚é¸£å™¨é¸£å«</h4><ol>
<li>è¾“å‡ºæ–¹æ³¢å›¾è§£</li>
</ol>
<p>ç°åœ¨è¦ç»™å•ç‰‡æœºIOç«¯å£è¾“å‡º4KHzçš„æ–¹æ³¢ï¼Œå…¶æ–¹æ³¢å‘¨æœŸä¸ºï¼š$\frac{1}{4000}=0.25ms$ï¼Œé«˜ç”µå¹³æ—¶é—´ï¼š$\frac{0.25}{2}=0.125ms$ï¼Œä½ç”µå¹³æ—¶é—´ï¼š$\frac{0.25}{2}=0.25ms$ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642c4b9ca682492fccd05a3a.png" alt=""></p>
<h3 id="1-7-ç‹¬ç«‹æŒ‰é”®"><a href="#1-7-ç‹¬ç«‹æŒ‰é”®" class="headerlink" title="1.7 ç‹¬ç«‹æŒ‰é”®"></a>1.7 ç‹¬ç«‹æŒ‰é”®</h3><p>ç‹¬ç«‹æŒ‰é”®æ˜¯å•ç‰‡æœºæœ€å¸¸ç”¨çš„ç¡¬ä»¶éƒ¨åˆ†</p>
<h4 id="1-7-1-ç‹¬ç«‹æŒ‰é”®ä¸çŸ©é˜µæŒ‰é”®"><a href="#1-7-1-ç‹¬ç«‹æŒ‰é”®ä¸çŸ©é˜µæŒ‰é”®" class="headerlink" title="1.7.1 ç‹¬ç«‹æŒ‰é”®ä¸çŸ©é˜µæŒ‰é”®"></a>1.7.1 ç‹¬ç«‹æŒ‰é”®ä¸çŸ©é˜µæŒ‰é”®</h4><p>4ä¸ªç‹¬ç«‹æŒ‰é”®å·²ç»å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„ç¨‹åºæµ‹è¯•ã€‚å­¦ä¼šäº†ç‹¬ç«‹æŒ‰é”®ï¼ŒçŸ©é˜µæŒ‰é”®æ˜¯ååˆ†å¥½å­¦çš„ã€‚</p>
<p>é¦–å…ˆçœ‹ä¸€ä¸‹æˆ‘ä»¬æŒ‰é”®çš„åˆ†å¸ƒ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642f6fa3a682492fccdabc8c.png" alt=""></p>
<p>çœ‹ä¸€ä¸‹æ˜¯K4æŒ‰é”®çš„ç”µè·¯å›¾ï¼Œæˆ‘ä»¬è®©å•ç‰‡æœºçš„P2.3è¾“å‡º<code>ä½ç”µå¹³</code>ï¼ŒæŒ‰é”®è¢«æŒ‰ä¸‹ï¼Œåˆ™è¢«åœˆå‡ºéƒ¨åˆ†çš„ç”µå‹å‡ä¸º0Vï¼Œå› ä¸ºéƒ½æ¥åœ°äº†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642f7074a682492fccdb5ba0.png" alt=""></p>
<h4 id="1-7-2-æŒ‰é”®çš„åŸç†"><a href="#1-7-2-æŒ‰é”®çš„åŸç†" class="headerlink" title="1.7.2 æŒ‰é”®çš„åŸç†"></a>1.7.2 æŒ‰é”®çš„åŸç†</h4><p>å•ç‰‡æœºä¸Šçš„æŒ‰é”®ä½¿ç”¨çš„æ˜¯æ²¡æœ‰è‡ªé”çš„æŒ‰é’®ï¼Œå½“æˆ‘ä»¬æŒ‰ä¸‹æŒ‰é”®åä¸¤ä¸ªæ–­ç‚¹å°±è¢«çŸ­æ¥èµ·æ¥ï¼Œæ¾æ‰‹åï¼ŒæŒ‰é”®è‡ªåŠ¨å¼¹èµ·ä¸¤ä¸ªæ–­ç‚¹æ¢å¤åŸæ¥çš„çŠ¶æ€ä¸å†çŸ­æ¥ã€‚</p>
<p>ä½¿ç”¨P2.7è¿›è¡Œç†è§£ï¼Œæˆ‘ä»¬æŒ‰ä¸‹K4æŒ‰é”®ï¼Œåˆ™æ–­ç‚¹ä¹‹é—´å¯¼é€šï¼ŒP2.7ä¸GNDè¿æ¥è¢«æ¥åœ°ï¼Œæ­¤æ—¶P2.7çš„IOç«¯å£ä¸º0Vï¼Œä¹Ÿå°±æ˜¯ä½ç”µå¹³ï¼Œä¿—ç§°<code>è¢«æ‹‰ä½</code>ã€‚è¿™æ—¶å€™å³ä½¿æ˜¯ç¨‹åºä»¤P2.7è¾“å‡º5Vé«˜ç”µå¹³éƒ½äºäº‹æ— è¡¥ï¼Œå› ä¸ºè¿™æ˜¯<code>å¤–éƒ¨ç”µè·¯ç›´æ¥å¯¼è‡´</code>ï¼ŒIOç«¯å£å°±æ˜¯0Vã€‚å†…éƒ¨ç¡¬ä»¶ä¹Ÿèƒ½æ„Ÿè§‰åˆ°è¿™ä¸ªä¿¡å·å±äºè¢«å¼ºåˆ¶æ‹‰ä½ã€‚å› æ­¤<code>ç¨‹åºä¸­å¯„å­˜å™¨ä½çš„å€¼æ˜¯å¯ä»¥å—å¤–éƒ¨ç”µè·¯å½±å“è€Œæ”¹å˜çš„</code>ã€‚</p>
<p>åŸºäºä»¥ä¸Šæˆ‘ä»¬å¯¹æŒ‰é”®çš„è®¤è¯†æˆ‘ä»¬ç†æƒ³ä¸­çš„æŒ‰é”®è¿‡ç¨‹å›¾å¦‚ä¸‹ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://essay.gan1ser.top/post/12image-20230408175442749.png" alt="12image-20230408175442749"></p>
<h4 id="1-7-3-æŒ‰é”®ç”¨æ³•"><a href="#1-7-3-æŒ‰é”®ç”¨æ³•" class="headerlink" title="1.7.3 æŒ‰é”®ç”¨æ³•"></a>1.7.3 æŒ‰é”®ç”¨æ³•</h4><p>è”ç³»ç”Ÿæ´»æŒ‰é”®çš„å¸¸ç”¨åšæ³•å°±åƒç”Ÿæ´»ä¸­çš„ç”µç£ç‚‰æˆ–è€…é—¨é“ƒé‚£æ ·ï¼ŒæŒ‰ä¸‹ç”µç£ç‚‰ä¸Šçš„åŠ çƒ­åŠŸèƒ½é”®åé©¬ä¸Šæ¾å¼€ï¼Œå‘ç°ç”µç£ç‚‰ä¸Šçš„æ•°å°±å¢åŠ äº†ã€‚ç°åœ¨æˆ‘ä»¬æ‰“ç®—ç”¨å¼€å‘æ¿åƒæŒ‰ç”µç£ç‚‰ä¸Šçš„æŒ‰é”®ä¸€æ ·ï¼Œ<code>æŒ‰ä¸€ä¸‹ç¯è¢«ç‚¹äº®ï¼Œå†æŒ‰ä¸€æ¬¡ç¯è¢«ç†„ç­</code>è¿™æ ·çš„æ¥å›åˆ‡æ¢ç¯çš„çŠ¶æ€çš„åŠŸèƒ½ã€‚</p>
<p>æˆ‘ä»¬ä¹‹å‰æ‰€è®²çš„æŒ‰é”®è¿‡ç¨‹è§£æå›¾åªæ˜¯ç†æƒ³ä¸­çš„æ•ˆæœï¼ŒçœŸæ­£çš„æŒ‰é”®è¿‡ç¨‹å›¾æ˜¯è¿™æ ·çš„<code>(æŒ‰é”®çš„æŠ–åŠ¨)</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643144600d2dde57778b4215.png" alt=""></p>
<p>æŒ‰é”®æŒ‰ä¸‹çš„å‰æœŸï¼ŒIOç«¯å£å¹¶ä¸æ˜¯é©¬ä¸Šå°±æ¥é€šåœ°è€Œå¤„åœ¨ç¨³å®šçŠ¶æ€çš„ï¼ŒæŒ‰é”®æŒ‰ä¸‹æ—¶ï¼ŒIOç«¯å£æœ‰çŸ­æš‚çš„æ—¶é—´æ¥é€šåœ°ä¹‹ååˆæ¾å¼€äº†è¿™ä¹ˆçš„ä¸€ä¸ªæ¥å›çš„è¿‡ç¨‹ï¼Œè¿™æ˜¯è‡ªå¼¹å¼æŒ‰é”®æœ¬èº«çš„ç»“æ„å±æ€§ï¼Œæ­¤å¤„ç§°ä½œæŒ‰é”®æŠ–åŠ¨ã€‚å¦‚æœæˆ‘ä»¬ä¸€ç›´<code>æŒ‰ç€ä¸æ”¾</code>ï¼Œè¿™æ—¶IOç«¯å£å°±ä¼šå¤„åœ¨ä¸€ç§å¾ˆç¨³å®šçš„æ¥è§¦çŠ¶æ€ï¼Œå½“æˆ‘ä»¬<code>æ¾å¼€æŒ‰é”®</code>æ—¶ä¹Ÿä¼šäº§ç”Ÿå¼¹èµ·æŠ–åŠ¨ï¼Œè¿™ç§æŠ–åŠ¨æŒç»­æ—¶é—´ä¸€èˆ¬å°‘äº10msã€‚åœ¨ä¹‹å‰çš„å®éªŒä¸­ï¼ŒæŒ‰é”®åŠ¨ä½œå¸¸é€Ÿä¸‹â€œç¨³å®šæ¥è§¦çŠ¶æ€â€ä¹Ÿä¼šæŒç»­åœ¨50msï¼Œè¿™ä¸ªæ—¶å€™ç¨‹åºå»è¯»å–ç¨³å®šçš„çŠ¶æ€æ—¶æ˜¯0ï¼Œè¿™æ ·å°±å¯ä»¥åˆ¤æ–­æ˜¯å¦æŒ‰é”®å·²ç»æŒ‰ä¸‹ï¼ŒæŒ‰ä¸‹äº†å°±æ‰§è¡Œç›¸åº”çš„ç¨‹åºåŠŸèƒ½ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•å¤„ç†è¿™ç§<code>æŠ–åŠ¨çŠ¶æ€</code>å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬åœ¨è½¯ä»¶ä¸Šå¯ä»¥è¿™æ ·å¤„ç†ï¼Œå½“ç¨‹åºæ£€æµ‹åˆ°ä¸Šå›¾çš„Aæ®µæ—¶â€œif(KEY4==0)â€æ»¡è¶³äº†æ¡ä»¶ï¼Œä½†æ˜¯KEY4å› ä¸ºæŒ‰é”®çš„æŠ–åŠ¨ä¼šåœ¨çŸ­æ—¶é—´é‡Œæ—¶è€Œå˜ä¸º1æ—¶è€Œå˜ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ»¡è¶³ç¬¬ä¸€ä¸ªâ€œif(KEY4==0)â€æ¡ä»¶çš„æ—¶å€™é©¬ä¸Šåšå»¶æ—¶50msï¼Œç­‰å¾…æŠ–åŠ¨è¿‡å»ï¼Œç„¶åå†æ¬¡åˆ¤æ–­æ­¤æ—¶çš„KEY4è¿˜æ˜¯ç­‰äº0å—ï¼Œæ˜¯çš„è¯å°±æ‰§è¡Œåˆ‡æ¢ç¯çš„çŠ¶æ€ç¨‹åºã€‚ï¼ˆåŒå±‚ifåµŒå¥—ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªifåˆ¤æ–­æ˜¯å¦ä¸ºä½ç”µå¹³ï¼Œå»¶è¿Ÿååˆ¤æ–­æ˜¯å¦æ˜¯ç¨³å®šæ€ï¼‰,å›¾è§£å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64314c280d2dde57779cf4f7.png" alt=""></p>
<p>ä½†æ˜¯åœ¨ä»£ç å®ç°åï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ä¸‹æŒ‰é”®ä¸€ç›´ä¸æ¾æ‰‹ï¼Œåˆ™ç¯ä¼šä¸€ç›´é—ªçƒã€‚è¿™æ˜¯å› ä¸ºâ€œç¨³å®šæ¥è§¦çŠ¶æ€â€ä¸€ç›´ä¿æŒç€é•¿æ—¶é—´çš„ä½ç”µå¹³ï¼Œæ‰€ä»¥ç¨‹åºçš„äºŒæ¬¡â€œif(KEY4==0)â€åˆ¤æ–­ä¸€ç›´æ»¡è¶³æ¡ä»¶å°±ä¼šåœ¨â€œLED2=0;â€å’Œâ€œLED2=1;â€ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œå†åŠ ä¸Š50mså»¶æ—¶æ‰ä¼šä¿æŒäº®ä¸€æ®µæ—¶é—´ç­ä¸€æ®µæ—¶é—´æ‰€ä½“ç°çš„LEDé—ªçƒã€‚</p>
<h4 id="1-7-4-æŒ‰é”®æ¨¡å¼"><a href="#1-7-4-æŒ‰é”®æ¨¡å¼" class="headerlink" title="1.7.4 æŒ‰é”®æ¨¡å¼"></a>1.7.4 æŒ‰é”®æ¨¡å¼</h4><p>æŒ‰é”®æ¨¡å¼ä¸»è¦åˆ†ä¸ºä¸¤ç§<code>æ”¯æŒè¿æŒ‰</code>å’Œ<code>ä¸æ”¯æŒè¿æŒ‰</code>ã€‚å…¶ä¸­æ”¯æŒè¿æŒ‰å³æˆ‘ä»¬ä½¿ç”¨é¥æ§å™¨æ”¾å¤§ç”µè§†çš„éŸ³é‡æ—¶åªéœ€æŒ‰ä½â€œ+â€é”®ä¸æ”¾ï¼Œå±å¹•ä¸Šçš„éŸ³é‡å€¼åœ¨ä¸€ç›´ç´¯åŠ ï¼Œæ¾æ‰‹åå°±åœæ­¢ç´¯åŠ äº†ï¼Œè¿™ç§å°±å«åšæŒ‰é”®æ”¯æŒè¿æŒ‰åŠŸèƒ½ã€‚ä¸æ”¯æŒè¿æŒ‰â€ï¼Œä¾‹å¦‚æˆ‘ä»¬ç”¨çš„ç”µç£ç‚‰ä¸Šçš„â€œ+â€é”®ï¼ŒæŒ‰ä¸‹ä¸æ¾æ‰‹æ—¶æ•°å€¼åªåŠ ä¸€æ¬¡å°±ä¸åŠ äº†ï¼Œåªæœ‰æ¾æ‰‹åå†æŒ‰æ‰ä¼šè¿›è¡Œæ•°å€¼çš„ç¬¬äºŒæ¬¡ç´¯åŠ ã€‚ä¸¤ç§æŒ‰é”®æ¨¡å¼åœ¨å•ç‰‡æœºå¼€å‘ä¸­éƒ½ä¼šç»å¸¸ä½¿ç”¨ã€‚</p>
<h4 id="1-7-5-ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼"><a href="#1-7-5-ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼" class="headerlink" title="1.7.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼"></a>1.7.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼</h4><p>æˆ‘ä»¬è¦å®ç°<code>ç¨³å®šæ¥è§¦çŠ¶æ€</code>çš„æ—¶é—´å†æ€ä¹ˆé•¿ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡åŠŸèƒ½ä»£ç çš„ç›®çš„ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨<code>IOç«¯å£</code>æ£€æµ‹åˆ°æŒ‰é”®æŒ‰ä¸‹ç„¶åæ‰§è¡Œå®ŒåŠŸèƒ½ç¨‹åºä¹‹åï¼Œä¸‹ä¸€ä¸ªè¯­å¥å°±å†™ï¼šå¦‚æœIOç«¯å£è¿˜æ˜¯ä¿æŒç€ä½ç”µå¹³ï¼ˆä¸æ¾æ‰‹çŠ¶æ€ï¼‰ï¼Œé‚£ç¨‹åºå°±ä¸å¾€ä¸‹æ‰§è¡Œäº†ï¼Œè®©ç¨‹åºåœ¨è¿™é‡Œâ€œåœæ­¢â€ï¼Œåªæœ‰IOç«¯å£å˜æˆé«˜ç”µå¹³ï¼ˆå·²æ¾æ‰‹ï¼‰æ‰å…è®¸â€œæ”¾è¡Œâ€ç¨‹åºå»è¿è¡Œã€‚æˆ‘ä»¬çŸ¥é“æŒ‰é”®æŠ–åŠ¨çš„æ—¶é—´å°‘äº10msï¼Œæ‰€ä»¥åœ¨æ»¡è¶³ç¬¬ä¸€æ¬¡â€œif(KEY4==0)â€åˆ¤æ–­çš„æ—¶å€™åªåšâ€œdelay_ms(10);â€çš„å»¶æ—¶å·¦å³ï¼Œè¿‡äº†è¿™æ®µæ—¶é—´å°±æ˜¯â€œç¨³å®šæ¥è§¦çŠ¶æ€â€äº†ï¼Œäºæ˜¯å†å»äºŒæ¬¡åˆ¤æ–­â€œif(KEY4==0)â€å³å¯ã€‚</p>
<p>ä»¥ä¸Šè™½ç„¶æˆ‘ä»¬ä»…ç”¨<code>while(KEY4==0)</code>å°±æŠŠæŒ‰é”®æ¨¡å¼ç»™åˆ‡æ¢äº†ï¼Œä¸è¿‡è¿™æ¡è¯­å¥ä¸¥æ ¼æ¥è¯´æ˜¯æœ‰ç¼ºé™·çš„ã€‚å¦‚æœæˆ‘ä»¬ç¼–å†™æ›´åŠ å¤æ‚çš„ç¨‹åºæ—¶ï¼Œ<code>while(KEY4==0)</code>å°±æˆäº†Bugäº†ã€‚å¦‚æœæˆ‘ä»¬å¯¹æŒ‰é”®æŒ‰ä¸‹ä¸æ¾æ‰‹ï¼Œé‚£ç¨‹åºå°±ä¸€ç›´åœ¨å¾ªç¯ç­‰å¾…ï¼Œä¸é‡åˆ°é«˜ç”µå¹³å°±ä¸å¾€ä¸‹æ‰§è¡Œä»£ç ï¼Œå¦‚æœè¿™æ—¶æœ‰é‡è¦çš„ç¨‹åºè¦æ‰§è¡Œï¼Œé‚£å²‚ä¸æ˜¯å› æŒ‰é”®è€Œè€½è¯¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(KEY4==<span class="number">0</span>) &#123;</span><br><span class="line">        delay(<span class="number">50</span>);</span><br><span class="line">        <span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//è¦æ‰§è¡ŒæŸäº›åŠŸèƒ½çš„è¯­å¥</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å³ä½¿æˆ‘ä»¬ä¸ä½¿ç”¨<code>while(KEY4==0);</code>ï¼Œåªè¦æˆ‘ä»¬æŒ‰é”®ä¸æ¾æ‰‹ï¼Œæ¯æ¬¡éƒ½è¦æ‰§è¡Œ<code>delay_ms(10);</code>ï¼Œè¿™æ ·çš„ä»£ç ç§°ä¸ä¸Šé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬åªèƒ½å†æ¬¡å®Œå–„ä»£ç äº†ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ”¹å–„æˆ‘ä»¬çš„ç¨‹åºï¼Œè¿™é‡Œä¸ºäº†è®©ç¨‹åºåšåˆ°é€šç”¨æ€§ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª<code>key_up</code>ä¸º<code>unsigned char</code>ç±»å‹çš„å˜é‡ã€‚æˆ‘ä»¬æ–°å®šä¹‰çš„key_upå˜é‡æ˜¯ç”¨æ¥è®°å½•æ­¤æ—¶æŒ‰é”®IOç«¯å£çš„æ‰«æå€¼ï¼Œè¿›ä¸€æ­¥åˆ†æï¼Œå½“æŒ‰é”®æŒ‰ä¸‹ä¸æ¾æ‰‹æ—¶ï¼Œæ­¤æ—¶çš„key_upç­‰äºKEY4ï¼ˆä¹Ÿå°±æ˜¯0ï¼‰ï¼Œå½“æŒ‰é”®æ¾æ‰‹åï¼Œkey_upå°±ç­‰äº1äº†ã€‚ç„¶åæƒ³è¿›å…¥æ‰§è¡ŒåŠŸèƒ½è¯­å¥æ—¶ï¼Œå…ˆè¿‡äº†â€œif(key_up==0)â€è¿™ä¸€å…³ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€ç›´è®©key_upåœ¨æ­»å¾ªç¯é‡Œå­˜å–KEY4çš„å€¼ï¼Œæ‰€ä»¥åªè¦æ²¡æœ‰æŒ‰é”®åŠ¨ä½œï¼Œkey_upä¸€ç›´ç­‰äº1ï¼Œè¿™æ ·è¿è¿›å…¥åŠŸèƒ½è¯­å¥çš„ç¬¬ä¸€å…³éƒ½æ²¡æœ‰èµ„æ ¼ã€‚</p>
<p>å½“æœ‰æŒ‰é”®æŒ‰ä¸‹æ—¶ï¼Œkey_upç­‰äº0äº†ï¼Œè¿›å…¥äº†ç¬¬ä¸€å…³ï¼Œç„¶åæˆ‘ä»¬å†è®¾æœ€åä¸€å…³ï¼Œå¦‚æœé€šè¿‡äº†æœ€åä¸€å…³å°±å¯ä»¥æ‰§è¡ŒåŠŸèƒ½è¯­å¥äº†ï¼Œæœ€åä¸€å…³æ˜¯åˆ¤æ–­â€œif(KEY4==1)â€ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæŒ‰é”®æ²¡æ¾æ‰‹ï¼Œå°±æ— æ³•æ‰§è¡ŒåŠŸèƒ½è¯­å¥äº†ã€‚æ²¡é”™ï¼Œæˆ‘ä»¬è¿™æ¬¡çš„ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼æ˜¯åªæœ‰æŒ‰é”®æ¾æ‰‹ä¹‹åæ‰å»æ‰§è¡Œçš„ï¼Œä¸Šä¸€è®²åˆ™æ˜¯æŒ‰ä¸‹ä¹‹åè¿‡äº†10mså°±æ‰§è¡Œä»£ç äº†ã€‚å¤§å®¶å¯ä»¥æ ¹æ®è¿™ä¸€æ€è·¯å†™ä»£ç äº†ã€‚</p>
<h4 id="1-7-6-å›å½’æŒ‰é”®"><a href="#1-7-6-å›å½’æŒ‰é”®" class="headerlink" title="1.7.6 å›å½’æŒ‰é”®"></a>1.7.6 å›å½’æŒ‰é”®</h4><p>æŒ‰é”®çš„æ‰§è¡Œä»»åŠ¡ä¹Ÿå¯ä»¥å°è£…ä¸ºå‡½æ•°ï¼Œéœ€è¦é™æ€å˜é‡<code>static</code>å»å®šä¹‰key_upï¼Œå› ä¸ºå®ƒéœ€è¦è·Ÿç€KEY4å˜åŒ–ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½è¢«åˆå§‹åŒ–ä¸ºåŒä¸€ä¸ªå€¼ã€‚</p>
<h4 id="1-7-7-æ”¯æŒè¿æŒ‰ï¼ˆå…¨å±€å˜é‡ï¼‰"><a href="#1-7-7-æ”¯æŒè¿æŒ‰ï¼ˆå…¨å±€å˜é‡ï¼‰" class="headerlink" title="1.7.7 æ”¯æŒè¿æŒ‰ï¼ˆå…¨å±€å˜é‡ï¼‰"></a>1.7.7 æ”¯æŒè¿æŒ‰ï¼ˆå…¨å±€å˜é‡ï¼‰</h4><p><code>æ”¯æŒè¿æŒ‰</code>çš„ä»£ç å°±æ˜¯åœ¨<code>ä¸æ”¯æŒè¿æŒ‰</code>ä»£ç çš„æ€è·¯ä¸ŠæŠŠ<code>if(KEY4==1/0)</code>æ”¹ä¸º<code>if(KEY4==0/1)</code>ï¼Œè¿™æ ·çš„è¯æŒ‰é”®ä¸æ¾æ‰‹ç¨‹åºå°±èƒ½ä¸€ç›´è¿›å…¥<code>if(KEY4==0/1)</code>çš„å¤§æ‹¬å·é‡Œé¢ã€‚ç„¶åæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡timesï¼Œå¦‚æœä¸€ç›´æŒ‰ç€ä¸æ”¾ï¼Œtimeså°±ä¸€ç›´ç´¯åŠ ï¼Œç´¯åŠ åˆ°1000ï¼Œæ„å‘³ç€ä½ç”µå¹³å·²ç»æŒç»­äº†ä¸€å®šçš„æ—¶é—´ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡ŒåŠŸèƒ½ä»£ç äº†ï¼Œå¦‚å›¾æ‰€ç¤º</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64351aac0d2dde57776ffb23.png" alt=""></p>
<p>å…¨å±€å˜é‡å°±æ˜¯å…ˆåœ¨æ‰€æœ‰å‡½æ•°å‰å®šä¹‰ï¼Œè¿™ç§å˜é‡å¯ä»¥åœ¨æ‰€æœ‰å‡½æ•°ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚è¿™ä¸ªå˜é‡çš„å€¼å‘ç”Ÿæ”¹å˜æˆä¸ºå¦ä¸€ä¸ªå€¼æ—¶ï¼Œå‡è®¾æ˜¯12ï¼Œå…¶ä»–å‡½æ•°æ­¤æ—¶è¿ç”¨è¿™ä¸ªå˜é‡çš„å€¼å°±æ˜¯12ã€‚<code>å…¨å±€å˜é‡æœ‰åˆ©æœ‰å¼Šï¼Œå¯ä»¥è‡ªå·±å­¦ä¹ ä¸€ä¸‹</code>ã€‚</p>
<h4 id="1-7-8-åŒæ¨¡å¼å‡½æ•°å°è£…"><a href="#1-7-8-åŒæ¨¡å¼å‡½æ•°å°è£…" class="headerlink" title="1.7.8 åŒæ¨¡å¼å‡½æ•°å°è£…"></a>1.7.8 åŒæ¨¡å¼å‡½æ•°å°è£…</h4><p>ä»¥ä¸Šæˆ‘ä»¬å­¦ä¼šäº†ä¸¤ç§æŒ‰é”®æ¨¡å¼<code>(ä¸èƒ½è¿æŒ‰æ¨¡å¼å’Œè¿æŒ‰æ¨¡å¼)</code>çš„ä»£ç ï¼Œæˆ‘ä»¬ç°åœ¨å†³å®šå°†è¿™ä¸¤ç§æ¨¡å¼å°è£…æˆ<code>ä¸€ä¸ªå‡½æ•°</code>ï¼Œç„¶åé€šè¿‡å‚æ•°é€‰æ‹©æ˜¯æ”¯æŒè¿æŒ‰è¿˜æ˜¯ä¸æ”¯æŒè¿æŒ‰ã€‚</p>
<p>è€ƒè™‘åˆ°ï¼Œä¸¤ç§æ¨¡å¼çš„é€‰æ‹©ï¼Œç°åœ¨åˆ©ç”¨<code>ä¸¤ä¸ª</code>æŒ‰é”®æ¥å®ç°æŒ‰é”®æ¨¡å¼çš„åˆ‡æ¢ï¼ŒK3è´Ÿè´£ç”¨æ¥ç»™K4åš<code>æ”¯æŒè¿æŒ‰</code>è¿˜æ˜¯<code>ä¸æ”¯æŒè¿æŒ‰</code>çš„é€‰æ‹©ã€‚è¿™é‡Œå¯<code>ä¸æ˜¯</code>è¯´K3,K4å„è‡ªè´Ÿè´£ä¸€ä¸ªæ¨¡å¼ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643526be0d2dde577782f4e3.png" alt=""></p>
<p>åœ¨æˆ‘çš„å¼€å‘æ¿çš„åŸç†å›¾ï¼Œåœ¨P2.3è¾“å‡ºä½ç”µå¹³çš„æƒ…å†µä¸‹ï¼ŒK1,K2,K3,K4å°±å¯ä»¥å½“ç‹¬ç«‹æŒ‰é”®ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643527c40d2dde577784500c.png" alt=""></p>
<p>å¤§å®¶å¯ä»¥è‡ªå·±æƒ³ä¸€ä¸‹å¦‚ä½•å®ç°è¿™ä¸€åŠŸèƒ½ï¼Œå†™å†™ä»£ç ï¼Œç„¶åå‚è€ƒç¬¬äºŒç« çš„æŒ‰é”®éƒ¨åˆ†ã€‚</p>
<h3 id="1-8-å¤–éƒ¨ä¸­æ–­"><a href="#1-8-å¤–éƒ¨ä¸­æ–­" class="headerlink" title="1.8 å¤–éƒ¨ä¸­æ–­"></a>1.8 å¤–éƒ¨ä¸­æ–­</h3><h4 id="1-8-1-å¯„å­˜å™¨"><a href="#1-8-1-å¯„å­˜å™¨" class="headerlink" title="1.8.1 å¯„å­˜å™¨"></a>1.8.1 å¯„å­˜å™¨</h4><h5 id="1-8-1-1-å•ç‰‡æœºçš„å†…éƒ¨èµ„æº"><a href="#1-8-1-1-å•ç‰‡æœºçš„å†…éƒ¨èµ„æº" class="headerlink" title="1.8.1.1 å•ç‰‡æœºçš„å†…éƒ¨èµ„æº"></a>1.8.1.1 å•ç‰‡æœºçš„å†…éƒ¨èµ„æº</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic1.imgdb.cn/item/64422b2d0d2dde57772a3884.png" alt=""></p>
<p>æˆ‘ä»¬ç†ŸçŸ¥çš„<code>P0,P1,P2,P3</code>ï¼ŒåŒ…æ‹¬ä¸Šå›¾ä¸­çš„TCONä»¥åŠ<code>#inlcude &lt;reg52.h&gt;</code>å¤´æ–‡ä»¶ä¸­çš„<code>IEã€SCON</code>ç­‰ç­‰éƒ½å«åšå¯„å­˜å™¨ã€‚è¿™äº›å¯„å­˜å™¨éƒ½å¯ä»¥ç²—æµ…çš„è®¤ä¸ºå°±æ˜¯ä¸€ä¸ª8ä½çš„å˜é‡ï¼Œå…¶ä¸­åƒP0^0è¿™ä¸ªæœ€ä½ä½å°±æ˜¯æ§åˆ¶å•ç‰‡æœºçš„å¤–éƒ¨IOç«¯å£è¾“å‡ºé«˜ä½ç”µå¹³ã€‚è€Œåƒ<code>TOCN^1</code>(IEO)è¿™äº›æœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿè¿™å°±æ¶‰åŠåˆ°å•ç‰‡æœºçš„å†…éƒ¨èµ„æºäº†ã€‚</p>
<h5 id="1-8-1-2-IE0çš„ä½œç”¨"><a href="#1-8-1-2-IE0çš„ä½œç”¨" class="headerlink" title="1.8.1.2 IE0çš„ä½œç”¨"></a>1.8.1.2 IE0çš„ä½œç”¨</h5><p>æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹åŸç†å›¾ä¸­çš„P3ç«¯å£</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic1.imgdb.cn/item/644230620d2dde5777369732.png" alt=""></p>
<p><code>P3</code>å¯„å­˜å™¨ä¸­çš„æ¯ä¸€ä½éƒ½åœ¨<code>#include &lt;reg52.h&gt;</code>å¤´æ–‡ä»¶ä¸­å£°æ˜å¥½äº†ã€‚æˆ‘ä»¬æ‹¿P3^2æ¥è¯´ï¼Œå¦‚æœè¿™ä¸ªIOç«¯å£è¢«å¤–éƒ¨ç”µè·¯æ‹‰ä½ï¼Œé‚£ä¹ˆTCONçš„ç¬¬ä¸€ä½(ä¹Ÿå°±æ˜¯<code>TCON^1</code>)å°±ä¼šè¢«ç½®1ï¼Œåœ¨ç¨‹åºä¸­<code>IE0</code>å˜ä¸º1ã€‚</p>
<p>æˆ‘ä»¬æ¥éªŒè¯ä¸€ä¸‹ï¼Œæˆ‘ä»¬ç”¨ä¸€æ ¹æœé‚¦çº¿çš„ä¸€å¤´æ’å…¥<code>P3.2</code>çš„å¼•è„šï¼Œç„¶åå¦ä¸€å¤´æ’å…¥<code>GND</code>(æ‹‰ä½)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic1.imgdb.cn/item/644232560d2dde577739cbe6.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯·æå‰å°†P3.2å’ŒGNDç›¸è¿</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(IE0 == <span class="number">0</span>) &#123;</span><br><span class="line">			LED2 = !LED2;</span><br><span class="line">			delay_ms(<span class="number">50</span>);</span><br><span class="line">			LED2 = <span class="number">1</span>; <span class="comment">//å¦‚æœIE0ä¸ç­‰äº0äº†ï¼Œè¦ä¿è¯ç†„ç­LED2;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(IE0 == <span class="number">1</span>) &#123;</span><br><span class="line">			LED9 = !LED9;</span><br><span class="line">			delay_ms(<span class="number">50</span>);</span><br><span class="line">			LED9 = <span class="number">1</span>; <span class="comment">//å¦‚æœLED0ä¸ç­‰äº1äº†ï¼Œè¦ä¿è¯ç†„ç­LED9</span></span><br><span class="line">		&#125;</span><br><span class="line">		delay_ms(<span class="number">50</span>); <span class="comment">//æ€»è¦æ‰§è¡Œ`if(IE0 == 0)`æˆ–è€…`if(IE0 == 1)`ï¼Œè¿™ä¸ªå»¶æ—¶è¦ä¿è¯å…¶ä¸­ä¸€ç›ç¯ç­çš„æ—¶é—´ï¼Œä¿è¯æ€»æœ‰ç¯é—ªçƒçš„ç°è±¡</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°<code>LED9</code>åœ¨ä¸åœçš„é—ªçƒï¼Œæ­¤æ—¶æ‹”äº†è¿æ¥GNDé‚£å¤´çš„æœé‚¦çº¿çœ‹åˆ°LED9ç†„ç­ï¼ŒLED2ä¸åœçš„é—ªçƒï¼Œè¿ç€æ’æ‹”å‡ æ¬¡è§‚å¯Ÿå¾—åˆ°<code>å½“P3.2é‡åˆ°ä½ç”µå¹³çš„æ—¶å€™IE0ä¼šä¸€ç›´ç­‰äº1ï¼Œåªæœ‰å½“P3.2ä¸ºé«˜ç”µå¹³æ—¶IE0æ‰ä¼šç­‰äº0</code>ã€‚</p>
<h5 id="1-8-1-3-IT0çš„ä½œç”¨"><a href="#1-8-1-3-IT0çš„ä½œç”¨" class="headerlink" title="1.8.1.3 IT0çš„ä½œç”¨"></a>1.8.1.3 IT0çš„ä½œç”¨</h5><p>å†çœ‹çœ‹<code>TCON^0</code>(ä¹Ÿå°±æ˜¯IT0)ï¼Œæˆ‘ä»¬æŠŠä¸Šé¢çš„ä»£ç ä¸­çš„<code>IE0</code>æ”¹ä¸º<code>IT0</code>çš„åˆå§‹å€¼æ˜¯å¤šå°‘ã€‚ç»æµ‹è¯•ï¼Œ<code>IT0</code>åˆå§‹å€¼ä¸º0ã€‚è‹¥æ˜¯æˆ‘ä»¬å†ä¸»å‡½æ•°å¼€å¤´èµ‹å€¼ç»™IT0ä¸º1ï¼Œé‚£ä¹ˆIE0åªæœ‰å½“P3^2ä»é«˜ç”µå¹³å˜æˆä½ç”µå¹³(ä¿—ç§°ä¸‹é™æ²¿)å°±ä¼šè¢«1ï¼Œå³ä½¿P2^3åé¢å˜æˆé«˜ç”µå¹³<code>IE0</code>ä¹Ÿä¸ä¼šå˜æˆ0ï¼Œä¸€ç›´æ˜¯1ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6448c40a0d2dde57778a945f.png" alt=""></p>
<p>è¿™æ—¶éœ€è¦æˆ‘ä»¬åœ¨ç¨‹åºé‡Œè®©IE0æ¸…é›¶ï¼ˆä¿—ç§°è½¯ä»¶æ¸…é›¶ï¼‰æ‰è¡Œã€‚</p>
<p>æˆ‘ä»¬æŠŠä¸‹é¢çš„ä»£ç ä¸‹è½½è¿›å»</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span> <span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    IT0 = <span class="number">1</span>;</span><br><span class="line">    LED_Init();   <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å— </span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span>(IE0==<span class="number">1</span>)<span class="comment">//åªæœ‰å½“P3.2ä»é«˜ç”µå¹³å˜æˆä½ç”µå¹³è¿™ä¸ªç¬é—´ï¼ˆä¸‹é™æ²¿ï¼‰IE0æ‰ä¼šè¢«ç½®1ï¼Œåé¢P3.2ä¸ç®¡æ˜¯ä¸€ç›´ä¿æŒé«˜ç”µå¹³è¿˜æ˜¯ä½ç”µå¹³ï¼ŒIE0è¢«æ¸…0ä¹‹åéƒ½ä¸ä¼šå†æ¬¡è¢«ç½®1ï¼Œåªæœ‰P3.2å†æ¬¡äº§ç”Ÿä¸‹é™æ²¿æ‰ä¼šè¢«ç½®1</span></span><br><span class="line">        &#123;  </span><br><span class="line">            IE0=<span class="number">0</span>;</span><br><span class="line">            LED2=!LED2;  </span><br><span class="line">        &#125;     </span><br><span class="line">        delay_ms(<span class="number">50</span>);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å³ä½¿æœé‚¦çº¿ä¸€ç›´éƒ½æ’ç€GNDç«¯å£ï¼Œä¹Ÿå°±æ˜¯P3.2éƒ½ä¿æŒç€ä½ç”µå¹³ï¼ŒLED2ä¹Ÿä¸ä¼šé—ªçƒï¼Œåªæœ‰ä¸æ–­æ‹”æ’æœé‚¦çº¿ï¼ŒLED2æ‰ä¼šæœ‰äº®ç­çš„è·³å˜ã€‚</p>
<p>æ‰€ä»¥å½“IT0ç­‰äº1æ—¶ï¼ŒP3.2é‡åˆ°ä¸‹é™æ²¿IE0å°±ä¼šè¢«ç½®1ï¼Œæˆ‘ä»¬è½¯ä»¶æŠŠè¿™ä¸ªä½æ¸…0ä¹‹åï¼Œå¦‚æœP3.2æ²¡æœ‰å†æ¬¡é‡åˆ°ä¸‹é™æ²¿ï¼ŒIE0éƒ½ä¸ä¼šè¢«ç½®1ã€‚</p>
<h4 id="1-8-2-ä¸­æ–­å‡½æ•°"><a href="#1-8-2-ä¸­æ–­å‡½æ•°" class="headerlink" title="1.8.2 ä¸­æ–­å‡½æ•°"></a>1.8.2 ä¸­æ–­å‡½æ•°</h4><p>æ ¹æ®ä¸Šè¿°ï¼Œå½“èµ‹å€¼IT0ä¸º1æ—¶ï¼ŒP3.2é‡åˆ°ä¸‹é™æ²¿ï¼ŒIE0è¢«ç½®1ï¼Œè¦æƒ³ä½¿IE0è‡ªåŠ¨æ¸…é›¶ï¼Œéœ€è¦å¼•ç”¨ä¸­æ–­å‡½æ•°ã€‚<code>ä¸­æ–­å‡½æ•°</code>å°±æ˜¯å½“å®ƒæ»¡è¶³ä¸€å®šçš„æ¡ä»¶æ—¶å°±ä¼šæš‚åœä¸»å‡½æ•°çš„æ‰§è¡Œå†…å®¹ï¼Œè½¬è€Œå»æ‰§è¡Œä¸­æ–­å‡½æ•°ã€‚</p>
<h5 id="1-8-2-1-ä¸­æ–­å‡½æ•°çš„ä¹¦å†™"><a href="#1-8-2-1-ä¸­æ–­å‡½æ•°çš„ä¹¦å†™" class="headerlink" title="1.8.2.1 ä¸­æ–­å‡½æ•°çš„ä¹¦å†™"></a>1.8.2.1 ä¸­æ–­å‡½æ•°çš„ä¹¦å†™</h5><p>ä¸­æ–­å‡½æ•°ä¸å…¶ä»–æˆ‘ä»¬å°è£…è¿‡çš„å­å‡½æ•°çš„å†™æ³•ä¸åŒï¼Œæœ‰ä¸ªåŒºåˆ†æ ‡å¿—<code>interrupt</code>ã€‚è‡³äºåé¢ä¸ºä»€ä¹ˆä¼šæœ‰ä¸ªæ•°å­—0ï¼Œæˆ‘ä»¬åé¢ä¼šäº†è§£åˆ°ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">EXTI0_IRQHandler</span><span class="params">()</span> interrupt 0 &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šå‡½æ•°åæ˜¯å¯ä»¥éšæ„å–çš„ï¼Œåªè¦ä¸è·Ÿä»¥å‰å°è£…å®šä¹‰å¥½çš„å‡½æ•°åå†²çªå°±è¡Œã€‚è¿™é‡Œæˆ‘ä»¬å–<code>EXTI0_IRQHandler</code>ä½œä¸ºå‡½æ•°åæ˜¯æ¨¡ä»¿STN32å•ç‰‡æœºçš„å†™æ³•ã€‚</p>
<h5 id="1-8-2-2-EX0å’ŒEA"><a href="#1-8-2-2-EX0å’ŒEA" class="headerlink" title="1.8.2.2 EX0å’ŒEA"></a>1.8.2.2 EX0å’ŒEA</h5><p>æƒ³è¦è¿›å…¥ä¸­æ–­å‡½æ•°ï¼Œå¿…é¡»æ»¡è¶³å®ƒçš„ä¸€äº›å‰ææ¡ä»¶ã€‚è¿™é‡Œ<code>EX0(IE^0)</code>å’Œ<code>EA(IE^7)</code>è¦åˆå§‹åŒ–èµ‹å€¼ç»™<code>1</code>æ‰èƒ½è¿›å…¥ä¸­æ–­ç¨‹åºå–æ‰§è¡Œä»»åŠ¡ã€‚</p>
<p><code>EA</code>å«åšä¸­æ–­æ€»å¼€å…³ï¼Œ<code>EX0</code>æ˜¯é’ˆå¯¹<code>P3.2</code>çš„å¤–éƒ¨ä¸­æ–­çš„å¼€å…³ï¼Œä¹Ÿå°±æ˜¯è¯´æƒ³è¦è¿›å…¥ä¸­æ–­å­ç¨‹åºå¿…é¡»æ»¡è¶³ä¸¤ä¸ªå¼€å…³éƒ½è¦é—­åˆã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/64491dcc0d2dde57772691e2.png" alt=""></p>
<h4 id="1-8-3-è¿›ä¸€æ­¥ç†è§£ä¸­æ–­å‡½æ•°"><a href="#1-8-3-è¿›ä¸€æ­¥ç†è§£ä¸­æ–­å‡½æ•°" class="headerlink" title="1.8.3 è¿›ä¸€æ­¥ç†è§£ä¸­æ–­å‡½æ•°"></a>1.8.3 è¿›ä¸€æ­¥ç†è§£ä¸­æ–­å‡½æ•°</h4><h5 id="1-8-3-1-å¤–éƒ¨ä¸­æ–­1"><a href="#1-8-3-1-å¤–éƒ¨ä¸­æ–­1" class="headerlink" title="1.8.3.1 å¤–éƒ¨ä¸­æ–­1"></a>1.8.3.1 å¤–éƒ¨ä¸­æ–­1</h5><p>ä»¥ä¸Šæˆ‘ä»¬æ³¨æ„åˆ°æˆ‘ä»¬ä½¿ç”¨æ ‡å¿—<code>interrupt 0</code>ï¼Œè¿™è¡¨æ˜æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å¤–éƒ¨ä¸­æ–­0ï¼ˆP3.2çš„åŠŸèƒ½ï¼‰ã€‚è¿˜æœ‰ä¸€ä¸ªå¤–éƒ¨ä¸­æ–­1ï¼ˆP3.3çš„åŠŸèƒ½ï¼‰ï¼Œæƒ³è¦ä½¿ç”¨å¤–éƒ¨ä¸­æ–­1ï¼Œä»£ç ä¸­éœ€è¦æŠŠ<code>EX0</code>æ”¹ä¸º<code>EX1</code>ï¼Œ<code>IT0</code>æ”¹ä¸º<code>IT1</code>ã€‚interruptåé¢çš„0è¦æ”¹ä¸º2ï¼Œå‡½æ•°åæˆ‘ä»¬æ”¹ä¸º<code>EXTI1_IRQHandler()</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT1 = <span class="number">1</span>; <span class="comment">//ä¸‹é™æ²¿è§¦å‘æ¨¡å¼</span></span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	EX1 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶ç”µè·¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXIT1_IRQHandler</span><span class="params">()</span> interrupt 2 &#123;</span><br><span class="line">	LED2 = !LED2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸ºä»€ä¹ˆæ˜¯<code>interrupt 2</code>å‘¢ï¼Ÿ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/644928060d2dde577739c4d4.png" alt=""></p>
<h5 id="1-8-3-2-æŒ‰é”®è§¦å‘ä¸­æ–­"><a href="#1-8-3-2-æŒ‰é”®è§¦å‘ä¸­æ–­" class="headerlink" title="1.8.3.2 æŒ‰é”®è§¦å‘ä¸­æ–­"></a>1.8.3.2 æŒ‰é”®è§¦å‘ä¸­æ–­</h5><p>æ¯æ¬¡è¦æŠŠP3.2å’ŒP3.3å¤–éƒ¨æ‹‰ä½æˆ–é‡Šæ”¾ï¼Œéƒ½éœ€è¦æ‹”æ’æœé‚¦çº¿ï¼Œè¿™æ ·å¤ªéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æŒ‰é”®æ¥å–ä»£è¿™äº›æ‹”æ’åŠ¨ä½œï¼ŒæŒ‰é”®æŒ‰ä¸‹ä¸æ”¾å°±ç›¸å½“äºä¸€ç›´æ‹‰ä½ï¼Œè·Ÿæœé‚¦çº¿ä¸€ç›´æ’ç€GNDä¸€ä¸ªæ•ˆæœï¼Œæ¾å¼€æŒ‰é”®å°±è·Ÿæœé‚¦çº¿æ²¡æ’GNDä¸€æ ·ã€‚<code>æŠŠæœé‚¦çº¿è¿™æ ·æ¥ï¼Œè®©P3.3å’ŒP2.3ä¸€èµ·ç›¸è¿ï¼ŒK4çš„æŒ‰é”®åŠ¨ä½œå¯ä»¥ä½¿P2.3å’ŒP3.3åŒæ­¥ç”µå¹³ã€‚</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/64492a2f0d2dde57773fdc6b.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    IT1 = <span class="number">1</span>;   <span class="comment">//ä¸‹é™æ²¿è§¦å‘æ¨¡å¼</span></span><br><span class="line">    EX1 = <span class="number">1</span>;</span><br><span class="line">    EA  = <span class="number">1</span>;</span><br><span class="line">   </span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å— </span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®åŠŸèƒ½æ¨¡å—</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI1_IRQHandler</span><span class="params">()</span> interrupt 2</span><br><span class="line">&#123;</span><br><span class="line">    LED2=!LED2; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="1-8-3-3-æŒ‰é”®è§¦å‘ä¸­æ–­æ¶ˆæŠ–"><a href="#1-8-3-3-æŒ‰é”®è§¦å‘ä¸­æ–­æ¶ˆæŠ–" class="headerlink" title="1.8.3.3 æŒ‰é”®è§¦å‘ä¸­æ–­æ¶ˆæŠ–"></a>1.8.3.3 æŒ‰é”®è§¦å‘ä¸­æ–­æ¶ˆæŠ–</h5><p>ä»¥ä¸ŠæŒ‰é”®ä¼¼ä¹æ²¡èƒ½å¾ˆçµæ•çš„æŒ‰ä¸€ä¸‹æ¾æ‰‹LED2å°±è·³å˜ä¸€æ¬¡äº®æˆ–ç­çš„æ•ˆæœï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å»¶æ—¶æ¶ˆæŠ–ï¼Œä¸€ä¸ªæŒ‰é”®åŠ¨ä½œå°±å­˜åœ¨å¥½å‡ ä¸ªä¸‹é™æ²¿äº†ï¼Œå¯¼è‡´ä¸­æ–­å‡½æ•°è¢«æ‰§è¡Œäº†å‡ éã€‚</p>
<p>åœ¨ä¸­æ–­å‡½æ•°ä¸­åŠ å»¶æ—¶å°±å¯ä»¥æ¶ˆé™¤è¿™ç§å¤±çµç°è±¡äº†ï¼Œä¸è¿‡åœ¨ä»¥åç¼–ç¨‹é‡Œä¸èƒ½åœ¨ä¸­æ–­å‡½æ•°é‡Œä½¿ç”¨å»¶æ—¶ï¼Œè¿™æ ·ä¼šä½¿ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡å¤§æ‰“æŠ˜æ‰£ï¼Œæˆ‘ä»¬æœ¬æ¬¡åªæ˜¯ä½œä¸ºæµ‹è¯•ä»£ç æ‰åœ¨ä¸­æ–­å‡½æ•°é‡Œç”¨å»¶æ—¶ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    IT1 = <span class="number">1</span>;   <span class="comment">//ä¸‹é™æ²¿è§¦å‘æ¨¡å¼</span></span><br><span class="line">    EX1 = <span class="number">1</span>;</span><br><span class="line">    EA  = <span class="number">1</span>;</span><br><span class="line">   </span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å— </span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®åŠŸèƒ½æ¨¡å—</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="comment">//è¯·æŠŠP3.3å’ŒP2.3ç”¨æœé‚¦çº¿è¿æ¥èµ·æ¥</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI1_IRQHandler</span><span class="params">()</span> interrupt 2</span><br><span class="line">&#123;</span><br><span class="line">    delay_ms(<span class="number">50</span>);<span class="comment">//å»æŠ–åŠ¨</span></span><br><span class="line">    <span class="keyword">if</span>(INT1==<span class="number">0</span>)  <span class="comment">//P3.3æ˜¯å¦è¿˜å¤„äºä½ç”µå¹³çš„ç¨³å®šæ¥è§¦çŠ¶æ€ï¼ŒINT1å·²åœ¨â€œ#include &lt;reg52.h&gt;â€ä¸­å®šä¹‰å¥½äº†</span></span><br><span class="line">    &#123;</span><br><span class="line">        LED2=!LED2; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-9-å®šæ—¶å™¨"><a href="#1-9-å®šæ—¶å™¨" class="headerlink" title="1.9 å®šæ—¶å™¨"></a>1.9 å®šæ—¶å™¨</h3><p>ä»¥ä¸Šå¯¹<code>ä¸­æ–­</code>çŸ¥è¯†çš„äº†è§£ï¼Œå¤–éƒ¨ä¸­æ–­è¿™ç§éœ€è¦<code>ç‰©ç†åŠ¨ä½œ</code>æ‰èƒ½è§¦å‘ä¸­æ–­å‡½æ•°æ‰§è¡Œï¼Œä½†å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸­æ–­å‡½æ•°åœ¨é€‚å½“æ—¶åˆ»å¯ä»¥è‡ªåŠ¨çš„å»æ‰§è¡Œï¼Œæ‰€ä»¥å°±éœ€è¦<code>å®šæ—¶å™¨</code>æ¥è¾…åŠ©äº†ã€‚</p>
<p>å®šæ—¶å™¨æ˜¯å•ç‰‡æœºå†…éƒ¨çš„ä¸€ä¸ªç¡¬ä»¶èµ„æºã€‚</p>
<p>ç”¨ç”Ÿæ´»å¸¸è§ç°è±¡ä¸¾ä¾‹ï¼šå®šæ—¶å™¨ç›¸å½“äºä¸€ä¸ªé—¹é’Ÿï¼Œæˆ‘ä»¬è°ƒ5åˆ†é’Ÿåé—¹é’Ÿå°±å“ï¼Œåœ¨è¿™5åˆ†é’Ÿé‡Œæˆ‘ä»¬æƒ³åšä»€ä¹ˆå°±åšä»€ä¹ˆï¼Œç›¸å½“äºæˆ‘ä»¬è‡ªå·±æ˜¯ä¸»å‡½æ•°é‡Œçš„ä»»åŠ¡ï¼Œæƒ³è¿è¡Œä»€ä¹ˆä»»åŠ¡å°±è¿è¡Œä»€ä¹ˆï¼Œä¹Ÿä¸ç”¨å»ç†ä¼šé—¹é’Ÿè¿˜å‰©å¤šå°‘æ—¶é—´å°±å“ï¼Œæˆ‘ä»¬åªæ˜¯ä¸€ç›´åšæˆ‘ä»¬æƒ³åšçš„äº‹å°±è¡Œã€‚</p>
<p>ä¹‹åé—¹é’Ÿå“äº†ï¼Œè¿™æ—¶æˆ‘ä»¬ä¸èƒ½å†ä»»æ€§å»åšä¸»å‡½æ•°çš„äº‹äº†ï¼Œå¾—èµ¶ç´§æŠŠä¸­æ–­å‡½æ•°é‡Œçš„äº‹åŠå®Œå…ˆï¼Œä¹Ÿå°±æ˜¯è¦å»æ‰§è¡Œä¸­æ–­å‡½æ•°äº†ï¼Œä¸»å‡½æ•°çš„äº‹è¦æš‚åœä¸åšå…ˆï¼Œæ‰§è¡Œå®Œä¸­æ–­å‡½æ•°ä¹‹åç»§ç»­å›åˆ°ä¸»å‡½æ•°åšæˆ‘ä»¬çš„äº‹ã€‚å¯æ˜¯åˆè¿‡äº†5åˆ†é’Ÿé—¹é’Ÿåˆå“äº†ï¼Œæ²¡åŠæ³•ï¼Œæˆ‘ä»¬åˆè¦æ”¾åœè‡ªå·±çš„äº‹å»æ‰§è¡Œä¸­æ–­å‡½æ•°äº†ï¼Œå½“ç„¶é—¹é’Ÿæ˜¯å¯ä»¥å…³é—­çš„ï¼Œè¿™å°±ç›¸å½“äºæ˜¯æŠŠä¸­æ–­å‡½æ•°çš„è§¦å‘å¼€å…³ç»™æ–­å¼€äº†ã€‚</p>
<h4 id="1-9-1-æº¢å‡º"><a href="#1-9-1-æº¢å‡º" class="headerlink" title="1.9.1 æº¢å‡º"></a>1.9.1 æº¢å‡º</h4><p>æˆ‘ä»¬çŸ¥é“ç§’è¡¨è®¡æ—¶åˆ°59ç§’çš„æ—¶å€™ï¼Œå†è¿‡1ç§’å°±å˜æˆäº†00ã€‚åŒç†ï¼Œå½“æˆ‘ä»¬çš„unsigned charç±»å‹çš„å˜é‡çš„æ•°å€¼ä¸º<code>255</code>æ—¶ï¼Œå†åŠ 1å°±å˜ä¸º0äº†, unsigned intçš„å˜é‡å¦‚æœæ­¤æ—¶çš„å€¼ä¸º<code>65535</code>ï¼Œåé¢å†åŠ 1ä¹ŸåŒæ ·æˆä¸º0ï¼Œè¿™äº›éƒ½å«<code>æº¢å‡º</code>ã€‚</p>
<p>å†ä¸¾ä¸€ä¸ªä¾‹å­æ¥ç†è§£å®šæ—¶å™¨æº¢å‡ºæ¦‚å¿µï¼Œä¸­å­¦æ—¶æˆ‘ä»¬åšè¿‡ä¸€äº›åŒ–å­¦å®éªŒï¼Œå…¶ä¸­æœ‰ä¸€ç§å®¹å™¨å«åšè¯•ç®¡ï¼Œå¦‚æœè¯•ç®¡æ˜¯ç©ºçš„ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå¯¼ç®¡å¾€è¯•ç®¡é‡ŒåŠ æ°´ï¼Œå¯¼ç®¡çš„æ°´æµæµé€Ÿæ˜¯å‡åŒ€ä¸å˜çš„ï¼Œè¯•ç®¡é‡Œçš„æ°´è¦æƒ³æº¢å‡ºï¼Œéœ€è¦çš„æ˜¯xä¸ªå•ä½çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠè·ç¦»æº¢å‡ºçš„æ—¶é—´ç¼©çŸ­ä¸ºä¸€åŠï¼Œé‚£æˆ‘ä»¬æå‰æŠŠè¯•ç®¡é‡Œçš„æ°´è£…æ»¡åˆ°ä¸€åŠï¼Œè¿™æ ·å°±å¯ä»¥æ”¹å˜äº†æº¢å‡ºæ—¶é—´ã€‚</p>
<p>é€šè¿‡è¿™ä¸ªä¾‹å­æˆ‘ä»¬å°±å¯ä»¥æ˜ç™½ï¼Œ<code>è¦æƒ³ç¡®å®šå¥½å®šæ—¶å™¨æº¢å‡ºäº§ç”Ÿä¸­æ–­çš„é—´éš”æ—¶é—´</code>ï¼Œæˆ‘ä»¬å°±è¦å¾€è¿™ä¸ªâ€œè¯•ç®¡â€æå‰è£…å¥½åˆé€‚çš„æ°´é‡ã€‚</p>
<h4 id="1-9-2-ä¸¤ç§å®šæ—¶æ¨¡å¼"><a href="#1-9-2-ä¸¤ç§å®šæ—¶æ¨¡å¼" class="headerlink" title="1.9.2 ä¸¤ç§å®šæ—¶æ¨¡å¼"></a>1.9.2 ä¸¤ç§å®šæ—¶æ¨¡å¼</h4><p><code>è¯•ç®¡</code>æœ‰65535ä¸ªåˆ»åº¦çš„å‹å·ï¼Œä¹Ÿæœ‰255ä¸ªåˆ»åº¦çš„å‹å·ï¼Œä¸è¿‡æˆ‘ä»¬çš„å¯¼ç®¡æ°´æµæµé€Ÿæ˜¯æ°¸è¿œä¸å˜çš„ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ç”¨çš„æ˜¯å¤§è¯•ç®¡ï¼ˆ65535ä¸ªåˆ»åº¦ï¼‰ï¼Œé‚£ä¹ˆæº¢å‡ºæ—¶é—´æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„é•¿ä¸€äº›ï¼Œä¹Ÿå°±æ˜¯å®šæ—¶æ—¶é—´å¯ä»¥å¤šä¸€ç‚¹ã€‚æˆ‘ä»¬è¦æ˜¯æƒ³å®šæ—¶36ä¸ªå•ä½åˆ»åº¦çš„æ—¶é—´ï¼Œé‚£å°±å…ˆå¾€è¯•ç®¡è£…å¥½65500ä¸ªåˆ»åº¦çš„æ°´é‡å…ˆï¼Œè¿™æ ·ç­‰åˆ°æ°´ä½åˆ°è¾¾65535é‚£ä¸ªåˆ»åº¦æ—¶ï¼Œå†åŠ ä¸€ä¸ªåˆ»åº¦å°±æº¢å‡ºäº†ï¼Œè¿™æ—¶æº¢å‡ºçš„å°±æ˜¯36ä¸ªå•ä½åˆ»åº¦çš„æ—¶é—´ã€‚<code>è¯•ç®¡</code>æ¯æ¬¡æ°´æº¢å‡ºï¼Œè¯•ç®¡é‡Œçš„æ°´å°±ä¼šæ¶ˆå¤±ä¸è§ï¼ˆå½’0ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬è¿˜æƒ³å®šæ—¶36ä¸ªå•ä½åˆ»åº¦çš„æ—¶é—´ï¼Œè¿˜éœ€è¦é‡æ–°æŠŠ65500ä¸ªåˆ»åº¦çš„æ°´é‡å†æ¬¡è£…å¥½ç»™<code>è¯•ç®¡</code>ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ç”¨çš„æ˜¯å°è¯•ç®¡ï¼ˆ255ä¸ªåˆ»åº¦ï¼‰ï¼Œè™½ç„¶å®ƒçš„å®šæ—¶æ—¶é—´è¿œè¿œæ²¡æœ‰å¤§è¯•ç®¡çš„å®šæ—¶æ—¶é—´é•¿ï¼Œä½†æ˜¯åªè¦æˆ‘ä»¬ç¬¬ä¸€æ¬¡è£…å¥½æ°´é‡ï¼Œæ¯æ¬¡å®ƒæº¢å‡ºä¹‹åï¼Œä¸ä¼šé©¬ä¸Šå½’0ï¼Œè€Œæ˜¯è¯•ç®¡é‡Œçš„æ°´<code>é‡æ–°å½’ä¸º</code>æˆ‘ä»¬ç¬¬ä¸€æ¬¡é‚£ä¸ªæ—¶å€™è£…å¥½çš„æ°´é‡ï¼Œæ‰€ä»¥<code>åªè¦åœ¨ç¬¬ä¸€æ¬¡ç¡®å®šäº†æ°´é‡ï¼Œä¹Ÿå°±ç¡®å®šäº†ä»¥åçš„æ‰€æœ‰å®šæ—¶æ—¶é•¿</code>ã€‚</p>
<p>è¿™ç§å«åš<code>è¯•ç®¡</code>çš„ä¸œè¥¿å°±æ˜¯æˆ‘ä»¬å•ç‰‡æœºå†…éƒ¨çš„å¦ä¸€ä¸ªå¯„å­˜å™¨ï¼Œ51å•ç‰‡æœºæœ‰ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œåˆ†åˆ«å«åšå®šæ—¶å™¨0å’Œå®šæ—¶å™¨1ï¼Œè·Ÿå¤–éƒ¨ä¸­æ–­æœ‰ 0å’Œ1çš„ä¸¤ä¸ªç¡¬ä»¶èµ„æºä¸€æ ·ã€‚è¿™é‡Œæˆ‘ä»¬å…ˆæ‹¿å®šæ—¶å™¨0æ¥è®²è§£ï¼Œå®šæ—¶å™¨1å¤§ä½“åŸç†éƒ½ä¸€æ ·ã€‚</p>
<h4 id="1-9-3-å®šæ—¶å™¨æ¨¡å¼çš„é€‰æ‹©"><a href="#1-9-3-å®šæ—¶å™¨æ¨¡å¼çš„é€‰æ‹©" class="headerlink" title="1.9.3 å®šæ—¶å™¨æ¨¡å¼çš„é€‰æ‹©"></a>1.9.3 å®šæ—¶å™¨æ¨¡å¼çš„é€‰æ‹©</h4><p>æˆ‘ä»¬æƒ³é€‰ç”¨å“ªä¸ª<code>è¯•ç®¡</code>ä½œä¸ºå®šæ—¶æ—¶é•¿ï¼Œé¦–å…ˆéœ€è¦åˆå§‹åŒ–å¯„å­˜å™¨TMODç›¸å¯¹åº”çš„ä½çš„å€¼ã€‚å…ˆçœ‹åˆ°ä¸‹é¢è¿™å¼ å›¾</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6453a8320d2dde5777f75280.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°åœˆå‡ºæ¥çš„å·¦å³ä¸¤ä¸ªç´«è‰²æ¡†ï¼Œ4-7ä½æ˜¯æ§åˆ¶å®šæ—¶å™¨1çš„ï¼Œ0-3ä½æ˜¯æ§åˆ¶å®šæ—¶å™¨0çš„ã€‚æˆ‘ä»¬è¦ç¡®å®šé€‰æ‹©çš„å®šæ—¶å™¨æ¨¡å¼ä»¬ä¸»è¦çœ‹<code>M1</code>å’Œ<code>M0</code>ä¸¤ä¸ªå‚æ•°ã€‚</p>
<ol>
<li>å¦‚æœ<code>M1=0ï¼ŒM0=1</code>ï¼Œé€‰ç”¨çš„æ˜¯<code>å¤§è¯•ç®¡å®šæ—¶æ¨¡å¼</code>ã€‚</li>
<li>å¦‚æœ<code>M1=1ï¼ŒM1=0</code>ï¼Œé€‰ç”¨çš„æ˜¯<code>å°è¯•ç®¡å®šæ—¶æ¨¡å¼</code>ã€‚</li>
</ol>
<p>å› ä¸ºæˆ‘ä»¬æš‚æ—¶æ²¡æœ‰ä½¿ç”¨åˆ°å®šæ—¶å™¨1ï¼Œæ‰€ä»¥4-7ä½(ä¿—ç§°é«˜å››ä½)å¯ä»¥å…¨ç½®ä¸º<code>0</code>.2-3ä½ç”¨ä¸åˆ°ï¼Œä¹Ÿæ˜¯ç½®ä¸º0ï¼Œæˆ‘ä»¬å…ˆé€‰æ‹©å¤§ä½¿é¦†ä½œä¸ºå®šæ—¶æ¨¡å¼ï¼Œæ‰€ä»¥TMODè¿™ä¸ªå¯„å­˜å™¨åˆå§‹åŒ–ä¸º<code>TOMD=0x01;</code>ã€‚è¿™é‡Œæ³¨æ„ï¼Œå› ä¸º<code>M1å’ŒM0</code>åœ¨<code>#include&lt;reg52.h&gt;</code>å¤´æ–‡ä»¶ä¸­å¹¶æ²¡æœ‰<code>sbit M0=TMOD^0;</code>çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆå§‹åŒ–åªèƒ½æ˜¯<code>TMOD=0x01</code>ï¼Œä¸€æ¬¡æ€§æ“ä½œ8ä¸ªä½ï¼Œè€Œåœ¨ç¨‹åºé‡Œä¹¦å†™<code>M1=0</code>æˆ–<code>M0=1</code>æ˜¯é”™ä½çš„ã€‚</p>
<p>ä¹‹åæˆ‘ä»¬æŠŠä½¿ç”¨â€œå¤§è¯•ç®¡â€ç§°ä¸ºå®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼1ï¼Œä½¿ç”¨â€œå°è¯•ç®¡â€ç§°ä¸ºå®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼2ã€‚</p>
<h4 id="1-9-4-å®šæ—¶æ—¶é•¿çš„åšæ³•"><a href="#1-9-4-å®šæ—¶æ—¶é•¿çš„åšæ³•" class="headerlink" title="1.9.4 å®šæ—¶æ—¶é•¿çš„åšæ³•"></a>1.9.4 å®šæ—¶æ—¶é•¿çš„åšæ³•</h4><p>å®šæ—¶å™¨0æœ‰ä¸¤ä¸ªå¯„å­˜å™¨åˆ†åˆ«æ˜¯<code>TH0</code>å’Œ<code>TL0</code>ï¼Œå¤§å®¶å†æ¬¡ç²—æµ…çš„æŠŠTH0å’ŒTL0è®¤ä¸ºæ˜¯ä¸¤ä¸ª8ä½çš„å˜é‡å§ã€‚å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯å®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼1ï¼Œè¿™ä¸¤ä¸ª8ä½çš„å˜é‡ç›¸å½“äºç»„åˆæˆäº†16ä½çš„å˜é‡ï¼ŒTH0æ˜¯é«˜8ä½ï¼ˆH:Highï¼‰ï¼ŒTL0æ˜¯ä½8ä½ï¼ˆL:Lowï¼‰ã€‚å‡å¦‚æ­¤æ—¶å†è¿‡ä¸€ä¸ªåˆ»åº¦çš„æ—¶é—´å°±æº¢å‡ºï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šæœ‰<code>TH0ç­‰äº255ï¼ŒTL0ç­‰äº255</code>ï¼Œå› ä¸ºäºŒè¿›åˆ¶çš„1111111111111111ç­‰äºåè¿›åˆ¶çš„65535ã€‚65535å†åŠ 1å°±æº¢å‡ºå˜›ã€‚å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯11.0592Mçš„æ™¶æŒ¯ï¼Œæ‰€ä»¥æ¯å¢åŠ 1èŠ±è´¹çš„æ—¶é—´æ˜¯ï¼ˆ12/11059200ï¼‰ç§’ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬ç”¨å®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼1å®šæ—¶20æ¯«ç§’åè§¦å‘ä¸­æ–­è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿé¦–å…ˆæˆ‘ä»¬å…ˆå¾€è¿™ä¸¤ä¸ªå¯„å­˜å™¨å¡«å……æ•°å€¼</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6453ac430d2dde5777ff2c9d.png" alt=""></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œä¸¤ä¸ªâ€œ8ä½çš„å˜é‡â€ä»é«˜åˆ°ä½åˆèµ·æ¥æˆä¸º16ä½çš„å˜é‡ï¼Œè‡³äºå®šæ—¶20msä¸ºä»€ä¹ˆæ˜¯è¿™æ ·å¡«å……ï¼Œæˆ‘ä»¬å…ˆç”¨åæ¨æ³•ç»™å¤§å®¶æ¼”ç¤ºã€‚</p>
<p>åå…­è¿›åˆ¶çš„0XB800æ¢ç®—æˆåè¿›åˆ¶çš„å€¼ä¸º47104ï¼Œäºæ˜¯å®šæ—¶çš„æ—¶é•¿ä¸ºï¼ˆ65536-47104ï¼‰=18432ä¸ªåˆ»åº¦çš„å•ä½æ—¶é—´ã€‚18432*ï¼ˆ12/11059200ï¼‰=0.02ç§’=20æ¯«ç§’ã€‚</p>
<p>æˆ‘ä»¬å†æ­£æ¨ï¼Œè¦å®šæ—¶50æ¯«ç§’æ€ä¹ˆç»™TH0å’ŒTL0èµ‹åˆå€¼ï¼Ÿè®¾è·ç¦»æº¢å‡ºè¿˜å‰©xä¸ªåˆ»åº¦ï¼Œx*ï¼ˆ12/11059200ï¼‰=0.05ï¼Œè§£å¾—x=46080ã€‚æ‰€ä»¥éœ€è¦æå‰è£…å¥½65536-46080=19456ä¸ªåˆ»åº¦çš„æ°´é‡ã€‚ä¹Ÿå°±æ˜¯å¡«å……ç»™TH0å’ŒTL0åˆæˆçš„<code>16ä½çš„å˜é‡</code>çš„å€¼å°±æ˜¯19456ã€‚19456æ¢ç®—æˆ<code>åå…­è¿›åˆ¶</code>ä¸º0x4C00ã€‚æ‰€ä»¥è¦å®šæ—¶50æ¯«ç§’ï¼Œé‚£ä¹ˆ<code>TH0=0x4C;ã€â€œTL0=0x00;</code>ã€‚</p>
<h4 id="1-9-5-å®šæ—¶å™¨ç®€å•è¿ç”¨"><a href="#1-9-5-å®šæ—¶å™¨ç®€å•è¿ç”¨" class="headerlink" title="1.9.5 å®šæ—¶å™¨ç®€å•è¿ç”¨"></a>1.9.5 å®šæ—¶å™¨ç®€å•è¿ç”¨</h4><p>Â·<code>æ³¨</code>ï¼šæˆ‘ä»¬çŸ¥é“TH0å’ŒTL0åˆæˆçš„â€œ16ä½çš„å˜é‡â€çš„åˆå€¼æœ€å°è¦ä¸º0ï¼Œä¸èƒ½æ˜¯è´Ÿæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ»¡è¶³ï¼š65536-( x/(12/11059200) )&gt;=0ã€‚è§£å¾—x&lt;= 0.071111ç§’=71.111æ¯«ç§’ã€‚ä¹Ÿå°±æ˜¯ç”¨å®šæ—¶å™¨çš„å·¥ä½œæ¨¡å¼1æœ€é•¿çš„å®šæ—¶æ—¶é—´ä¸º71æ¯«ç§’å·¦å³è€Œå·²ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬æ¥å­¦ä¹ å®šæ—¶å™¨çš„ç®€å•è¿ç”¨ï¼Œè¿™æ–¹ä¾¿æˆ‘ä»¬ç†è§£ç›¸å…³çš„ç†è®ºçŸ¥è¯†ã€‚</p>
<ol>
<li>é¦–å…ˆå®šæ—¶å™¨ä¹Ÿæ˜¯æœ‰å¼€å…³çš„ï¼Œè¿™ä¸ªç›¸å½“äºæˆ‘ä»¬çš„å¯¼ç®¡æ˜¯å¦æ‰“å¼€è®©æ°´æµè¿›â€œè¯•ç®¡â€é‡Œã€‚å› ä¸ºæˆ‘ä»¬ç”¨çš„æ˜¯å®šæ—¶å™¨0ï¼ŒTCON^4è¿™ä¸ªä½å°±æ˜¯æ§åˆ¶å®šæ—¶å™¨0æ˜¯å¦æ‰“å¼€æˆ–å…³é—­ï¼Œæ‰€ä»¥<code>TR0=1;</code>å°±æ˜¯æ‰“å¼€äº†å®šæ—¶å™¨å¼€å§‹è®¡æ—¶ï¼Œ<code>TR0=0;</code>æ˜¯å…³é—­äº†å®šæ—¶å™¨è®¡æ—¶åŠŸèƒ½ã€‚åªè¦æ‰“å¼€äº†å®šæ—¶å™¨ï¼ŒTH0å’ŒTL0åˆæˆçš„â€œ16ä½çš„å˜é‡â€å°±ä¼šæ¯è¿‡(12/11059200)ç§’å°±è‡ªåŠ 1ï¼Œç›´åˆ°å®šæ—¶å™¨æº¢å‡ºã€‚</li>
<li>æˆ‘ä»¬çš„å®šæ—¶å™¨0ä¸€æ—¦æº¢å‡ºï¼ŒTCON^5å°±ä¼šè¢«ç½®1<code>ï¼ˆTF0==1ï¼‰</code>,å¦‚æœæˆ‘ä»¬ä¸ä½¿ç”¨ä¸­æ–­å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥åœ¨ä¸»å‡½æ•°é‡Œç­‰å¾…åˆ¤æ–­â€œif(TF0==1)â€ã€‚TF0è·Ÿå¤–éƒ¨ä¸­æ–­0çš„IE0ä¸€æ ·ï¼Œè¢«ç½®1äº†éœ€è¦è½¯ä»¶æ¸…é›¶ã€‚</li>
</ol>
<p>ç”¨å®šæ—¶å™¨0æ¥å®ç°é—´éš”50msçš„æµæ°´ç¯å®éªŒ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    u8 i = <span class="number">0</span>;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä½å·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH0 = <span class="number">0x4C</span>; <span class="comment">//è‰²æ¹–ä¹‹å®šæ—¶æ—¶é—´ä½50ms</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(TF0 == <span class="number">1</span>) &#123; <span class="comment">//åˆ¤æ–­å®šæ—¶å™¨0æ˜¯å¦æº¢å‡ºï¼Œæ¯éš”50mså°±å¯ä»¥è¿›å…¥ä¸€æ¬¡è¿™ä¸ªifè¯­å¥å†…éƒ¨</span></span><br><span class="line">            TF0 = <span class="number">0</span>; <span class="comment">//è½¯ä»¶æ¸…é›¶ï¼Œå®šæ—¶å™¨0æº¢å‡ºåï¼Œæ¸…0æº¢å‡ºæ ‡å¿—</span></span><br><span class="line">            TH0 = <span class="number">0x4C</span>; <span class="comment">//é‡æ–°èµ‹å€¼ï¼Œä¿è¯ä¸‹æ¬¡æº¢å‡ºæ—¶é—´é—´éš”è¿˜æ˜¯50ms</span></span><br><span class="line">            TL0 = <span class="number">0x00</span>;</span><br><span class="line">            P0 = ~(<span class="number">0x01</span> &lt;&lt; i); <span class="comment">//æ¯ç›ç¯çš„ç‚¹äº®æ—¶é—´éƒ½ä¿æŒè€…50ms</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”¨å®šæ—¶å™¨1æ¥å®ç°é—´éš”50msçš„æµæ°´ç¯å®éªŒ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    u8 i=<span class="number">0</span>;</span><br><span class="line">    LED_Init();   <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å— </span></span><br><span class="line">    TMOD = <span class="number">0x10</span>;  <span class="comment">//è®¾ç½®å®šæ—¶å™¨1ä¸ºå·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH1  = <span class="number">0x4C</span>;  <span class="comment">//è®¾ç½®å®šæ—¶æ—¶é—´ä¸º50ms</span></span><br><span class="line">    TL1  = <span class="number">0x00</span>;</span><br><span class="line">    TR1  = <span class="number">1</span>;     <span class="comment">//å¯åŠ¨å®šæ—¶å™¨1</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (TF1 == <span class="number">1</span>)     <span class="comment">//åˆ¤æ–­å®šæ—¶å™¨1æ˜¯å¦æº¢å‡ºï¼Œæ¯éš”50mså°±å¯ä»¥è¿›å…¥ä¸€æ¬¡è¿™ä¸ªifè¯­å¥</span></span><br><span class="line">        &#123;</span><br><span class="line">            TF1 = <span class="number">0</span>;      <span class="comment">//å®šæ—¶å™¨1æº¢å‡ºåï¼Œæ¸…0æº¢å‡ºæ ‡å¿—</span></span><br><span class="line">            TH1 = <span class="number">0x4C</span>;   <span class="comment">//é‡æ–°èµ‹åˆå€¼ï¼Œä¿è¯ä¸‹æ¬¡æº¢å‡ºé—´éš”æ—¶é—´è¿˜æ˜¯50ms</span></span><br><span class="line">            TL1 = <span class="number">0x00</span>;</span><br><span class="line">            P0=~(<span class="number">0x01</span>&lt;&lt;i);<span class="comment">//æ¯ç›ç¯çš„ç‚¹äº®æ—¶é—´éƒ½ä¿æŒç€50ms</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-9-6-å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2"><a href="#1-9-6-å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2" class="headerlink" title="1.9.6 å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2"></a>1.9.6 å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2</h4><p>è¿™é‡Œæˆ‘ä»¬è®²è§£ä¸€ä¸‹<code>å®šæ—¶å™¨0</code>çš„å·¥ä½œæ¨¡å¼2ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨<code>å°è¯•ç®¡</code>çš„æ–¹å¼ï¼ŒTMODçš„åˆå§‹åŒ–å°±ä¸º<code>TMOD=0x02;</code>ã€‚æˆ‘ä»¬çŸ¥é“å·¥ä½œæ¨¡å¼2çš„æœ€é•¿æº¢å‡ºæ—¶é—´ä»…ä¸º256*(12/11059200)=0.000277ç§’=277å¾®ç§’ã€‚</p>
<p>æˆ‘ä»¬æƒ³å®ç°é—´éš”51msçš„æµæ°´ç¯å®éªŒè¯¥æ€ä¹ˆåšï¼Ÿæˆ‘ä»¬éœ€è¦åˆ©ç”¨å¾ªç¯ï¼Œé¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡cntç”¨æ¥è®°å½•æ¯æ¬¡çš„æº¢å‡ºæ¬¡æ•°ï¼Œç„¶åæˆ‘ä»¬çš„å®šæ—¶æ—¶é—´ä¸º51å¾®ç§’ï¼ˆå› ä¸ºæœ€å¤§å®šæ—¶åªæœ‰278å¾®ç§’ï¼‰ï¼Œcntè®°å½•çš„å€¼ç­‰äº1000çš„æ—¶å€™ï¼Œè¯æ˜æ—¶é—´å·²ç»è¿‡å»äº†51msï¼Œäºæ˜¯å†å»æ‰§è¡Œæµæ°´ç¯çš„ä»»åŠ¡ã€‚</p>
<p>æˆ‘ä»¬å·²ç»çŸ¥é“å·¥ä½œæ¨¡å¼2æ˜¯ä¸éœ€è¦åœ¨æº¢å‡ºä¹‹åå†å¡«å……åˆå§‹å€¼çš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å®šæ—¶çš„æ—¶é—´ä¸º51å¾®ç§’ï¼Œé‚£ä¹ˆè®¡ç®—å‡ºâ€œè·ç¦»æº¢å‡ºçš„åˆ»åº¦â€å°±ä¸º47ï¼ˆå®é™…è®¡ç®—å‡ºçš„æ˜¯47.0016ï¼Œæ‰€ä»¥å®šæ—¶ä¸º51å¾®ç§’è¯¯å·®å°±ä¸å¤§ï¼‰ã€‚æ‰€ä»¥ç»™TL0èµ‹åˆå€¼ä¸º256-47=209=0xD1ã€‚é‚£ä¹ˆTH0ä¹Ÿæ˜¯ç»™åˆå€¼ä¸º0xD1ï¼Œè¿™æ˜¯ä¿è¯æ¯æ¬¡TL0æº¢å‡ºä¹‹åæ–°çš„åˆå§‹å€¼æ˜¯ç­‰äºTH0çš„å€¼çš„ï¼Œæ‰€ä»¥å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2åˆå«åš8ä½<code>è‡ªåŠ¨é‡è£…è½½æ¨¡å¼</code>ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    u8 i = <span class="number">0</span>;</span><br><span class="line">    u16 cnt = <span class="number">0</span>;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    TMOD = <span class="number">0x02</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼2</span></span><br><span class="line">    TH0 = <span class="number">0xD1</span>; <span class="comment">// å®šæ—¶51us</span></span><br><span class="line">    TL0 = <span class="number">0xD1</span>;</span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">// å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(TF0 == <span class="number">1</span>) &#123; <span class="comment">//æ¯éš”51us,cntåŠ 1</span></span><br><span class="line">            TF0 = <span class="number">0</span>; <span class="comment">//å®šæ—¶å™¨æº¢å‡ºTF0è½¯ä»¶æ¸…é›¶</span></span><br><span class="line">            cnt ++; <span class="comment">//è®°å½•æº¢å‡ºæ¬¡æ•°</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt;= <span class="number">1000</span>) &#123; <span class="comment">// æº¢å‡ºæ¬¡æ•°ä¸º1000æ—¶è¡¨æ˜è¿‡å»äº†51ms</span></span><br><span class="line">            cnt = <span class="number">0</span>;</span><br><span class="line">            P0 = ~(<span class="number">0X01</span> &lt;&lt; i); <span class="comment">// æ‰§è¡Œæµæ°´ç¯ï¼Œä¿è¯æ¯ä¸ªæµæ°´ç¯äº®51ms</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-9-7-å®šæ—¶å™¨ä¸­æ–­å‡½æ•°çš„ä½¿ç”¨"><a href="#1-9-7-å®šæ—¶å™¨ä¸­æ–­å‡½æ•°çš„ä½¿ç”¨" class="headerlink" title="1.9.7 å®šæ—¶å™¨ä¸­æ–­å‡½æ•°çš„ä½¿ç”¨"></a>1.9.7 å®šæ—¶å™¨ä¸­æ–­å‡½æ•°çš„ä½¿ç”¨</h4><p>å®šæ—¶å™¨å’Œæ©é¥°å…¶çš„æ¦‚å¿µä¸åŒï¼Œå»¶æ—¶å‡½æ•°éœ€è¦å ç”¨CPUçš„ä½¿ç”¨æƒï¼Œæ­£åœ¨å»¶æ—¶çš„æ—¶å€™å…¶ä»–ä»»åŠ¡æ²¡æœ‰CPUä½¿ç”¨æƒå°±ä¼šæ‹–æ…¢æ‰§è¡Œæ•ˆç‡ã€‚è€Œå®šæ—¶å™¨æ˜¯ä¸éœ€è¦å ç”¨CPUçš„ä½¿ç”¨æƒï¼Œå®ƒæ˜¯ç‹¬ç«‹è¿è¡Œçš„ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç çš„å®ç°åŸç†å°±æ˜¯æ¯éš”51å¾®å¦™ï¼Œæœ‰ä¸ªå˜é‡ä¼šè‡ªåŠ¨åŠ 1ï¼Œè¿‡äº†1000ä¸ª51å¾®å¦™çš„æ—¶å€™LEDçš„çŠ¶æ€æ‰ä¼šå‘ç”Ÿæ”¹å˜ï¼Œå¯ä»¥è¯´CPUåœ¨51msçš„æ—¶é—´é‡ŒåŸºæœ¬ä»€ä¹ˆéƒ½æ²¡æœ‰åšï¼Œåªæ˜¯åœ¨51å¾®å¦™åˆ°äº†çš„æ—¶å€™åšäº†<code>cnt++;</code>çš„å·¥ä½œã€‚</p>
<p>ä¸å¤–éƒ¨ä¸­æ–­ä¸€æ ·ï¼Œå®šæ—¶å™¨ä¸­æ–­ä¹Ÿæœ‰ä¸­æ–­å‡½æ•°ï¼ŒåŒç†ï¼Œç¨‹åºå»æ‰§è¡Œä¸­æ–­å‡½æ•°å°±ä¼šæŠŠTF0çš„ä¸­æ–­æ ‡å¿—ä½è‡ªåŠ¨æ¸…0ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬ç”¨äº†å®šæ—¶å™¨ä¸­æ–­å‡½æ•°ï¼Œé‚£ä¹ˆTF0å°±å¯ä»¥ä¸ç”¨å†å‡ºç°åœ¨ç¨‹åºä¹¦å†™ä¸­äº†ã€‚</p>
<p>å¤–éƒ¨ä¸­æ–­</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6454b5a90d2dde57771cdff2.png" alt=""></p>
<p>å®šæ—¶å™¨0çš„ä¸­æ–­å‡½æ•°</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6454b6dd0d2dde57771e27c4.png" alt=""></p>
<p>interruptâ€åé¢çš„æ•°å­—ä¸ºä»€ä¹ˆæ˜¯1?</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6454b7420d2dde57771e8daf.png" alt=""></p>
<ol>
<li>è¿™äº›ç¼–å·æ˜¯ä¸ºäº†åŒºåˆ†å“ªäº›ç¡¬ä»¶èµ„æºçš„ç›¸å…³ä¸­æ–­å‡½æ•°ï¼Œå¦‚æœæˆ‘ä»¬åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œé‚£ä¹ˆåªèƒ½ç”¨â€œinterrupt 1â€å’Œâ€œinterrupt 3â€æ¥åŒºåˆ†è°æ˜¯è°çš„ä¸­æ–­å‡½æ•°äº†ã€‚</li>
<li>ä½¿ç”¨â€œTIM0_IRQHandlerâ€ä½œä¸ºå‡½æ•°åä¹Ÿæ˜¯æ¨¡ä»¿STM32å®šæ—¶å™¨ä¸­æ–­å‡½æ•°åçš„å†™æ³•ã€‚</li>
<li>å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å·¥ä½œæ¨¡å¼1ï¼Œæ¯æ¬¡è§¦å‘ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œå†…å®¹é¦–å…ˆå°±æ˜¯å†æ¬¡ç»™TH0å’ŒTL0èµ‹åˆå€¼ä¿è¯ä¸‹æ¬¡çš„å®šæ—¶æ—¶é—´è¿˜æ˜¯ä¸€æ ·ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸­æ–­å‡½æ•°çš„æ‰§è¡Œæ–¹å¼æ¥å®ç°30msçš„é—´éš”æµæ°´ç¯ï¼Œç®—å‡ºTH0å’ŒTL0åˆæˆçš„â€œ16ä½çš„å˜é‡â€è¦å¡«å……çš„å€¼ä¸º37888=0x9400ã€‚</li>
<li>åœ¨ä¸­æ–­å‡½æ•°é‡Œä¹Ÿæ˜¯å¯ä»¥å®šä¹‰å±€éƒ¨å˜é‡çš„ï¼Œå½“ç„¶å¦‚æœè¿™ä¸ªå˜é‡æ˜¯ç”¨æ¥è¾…åŠ©æµæ°´ç¯çš„ï¼Œé‚£ä¹ˆè‚¯å®šæ˜¯è¦å®šä¹‰æˆé™æ€å˜é‡çš„ã€‚</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//æ‰“å¼€æ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH0 = <span class="number">0x94</span>; <span class="comment">// è®¾ç½®å®šæ—¶æ—¶é—´ä¸º30ms</span></span><br><span class="line">    ET0 = <span class="number">1</span>; <span class="comment">//æ‰“å¼€å®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³</span></span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    <span class="type">static</span> u8 i;</span><br><span class="line">    TH0 = <span class="number">0x94</span>; <span class="comment">//é‡æ–°è®¾å®šæ—¶é—´ä¸º30ms</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    </span><br><span class="line">    P0 = ~(<span class="number">0x80</span> &gt;&gt; i); <span class="comment">//æµæ°´ç¯å‘å·¦ç§»åŠ¨</span></span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è§‰å¾—30msçš„æµé€Ÿå¤ªå¿«ï¼Œæƒ³æ”¹ä¸º300msçš„è¯ï¼Œä¿®æ”¹ä¸€ä¸‹ä¸­æ–­å‡½æ•°å³å¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	LED_Init();</span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	TMOD = <span class="number">0x01</span>;</span><br><span class="line">	TH0 = <span class="number">0x94</span>;</span><br><span class="line">	TL1 = <span class="number">0x00</span>;</span><br><span class="line">	ET0 = <span class="number">1</span>;</span><br><span class="line">	TR0 = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é€šè¿‡é‡å¤10æ¬¡30mså®ç°å®šæ—¶300ms</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">	<span class="type">static</span> u8 i = <span class="number">0</span>;</span><br><span class="line">	<span class="type">static</span> u8 cnt = <span class="number">0</span>;</span><br><span class="line">	TH0 = <span class="number">0x94</span>;</span><br><span class="line">	TL0 = <span class="number">0x00</span>;</span><br><span class="line">	cnt++;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (cnt &gt;= <span class="number">10</span>) &#123;</span><br><span class="line">		cnt = <span class="number">0</span>;</span><br><span class="line">		P0 = ~(<span class="number">0x80</span> &gt;&gt; i);</span><br><span class="line">		i++;</span><br><span class="line">		<span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-9-8-å®šæ—¶å™¨åˆå§‹åŒ–ä¼˜åŒ–"><a href="#1-9-8-å®šæ—¶å™¨åˆå§‹åŒ–ä¼˜åŒ–" class="headerlink" title="1.9.8 å®šæ—¶å™¨åˆå§‹åŒ–ä¼˜åŒ–"></a>1.9.8 å®šæ—¶å™¨åˆå§‹åŒ–ä¼˜åŒ–</h4><p>ä¹‹å‰æˆ‘ä»¬å¯¹å®šæ—¶å™¨è¿›è¡Œåˆå§‹åŒ–ï¼ˆå³å¡«å……åˆå§‹å€¼ï¼‰æˆ‘ä»¬å†™<code>TH0=0x94;TL0=0x00;</code>ã€‚æˆ‘ä»¬è¿™æ ·å†™æ˜¯å› ä¸ºæˆ‘ä»¬æå‰è®¡ç®—äº†éœ€è¦è£…å¡«çš„æ•°å­—ï¼Œæ˜¾ç„¶å¦‚æœæ²¡æœ‰æ³¨é‡Šæˆ‘ä»¬å¾ˆéš¾æŒ‡å¯¼è¿™æ˜¯è¦å®šæ—¶å¤šé•¿æ—¶é—´ï¼Œæ‰€ä»¥ä¸ºäº†å¢å¼º<code>ç¨‹åºçš„å¯è¯»æ€§</code>ï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–å®šæ—¶å™¨åˆå§‹åŒ–çš„å†™æ³•ã€‚</p>
<p>è¦ä¼˜åŒ–åˆå§‹åŒ–çš„å†™æ³•ï¼Œé¦–å…ˆè¦æ˜ç™½åœ¨ç¨‹åºä¹¦å†™è¿‡ç¨‹ä¸­ï¼Œèµ‹å€¼ç»™å¯„å­˜å™¨çš„å€¼å¯ä»¥ä¹¦å†™æˆ16è¿›åˆ¶çš„æ•°ä¹Ÿå¯ä»¥æ˜¯åè¿›åˆ¶çš„æ•°ã€‚<code>TH0</code>å¡«å……çš„æ˜¯é«˜å…«ä½ï¼Œ<code>TL0</code>å¡«å……çš„æ˜¯ä½8ä½ï¼Œé‚£ä¹ˆå¦‚æœè¿™ä¸ª16ä½çš„å˜é‡çš„åè¿›åˆ¶å€¼æ˜¯258ï¼ŒäºŒè¿›åˆ¶çš„å€¼å°±æ˜¯<code>0000000100000010</code>ã€‚æ‰€ä»¥é«˜å…«ä½çš„å€¼ä½1<code>(258/256=1)</code>ï¼Œä½å…«ä½çš„å€¼æ˜¯2<code>(258%256=2)</code>ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è®¤ä¸º<code>258/256=1</code>æ˜¯0x0102(258)å³ç§»äº†8ä½ç­‰äº0x0001,ç®€åŒ–ä¹¦å†™å°±æ˜¯0x01ã€‚è€Œ<code>58%256=2</code>æ˜¯0x0102(258)èˆå»äº†é«˜8ä½ç­‰äº0x0002ï¼Œç®€åŒ–ä¹¦å†™å°±æ˜¯0x02ã€‚</p>
<p>ä¸‹é¢æ˜¯å›¾è§£ï¼Œä»¥ä¸€ä¸ª16ä½çš„å˜é‡çš„åè¿›åˆ¶å€¼æ˜¯<code>47104</code>ï¼ŒäºŒè¿›åˆ¶çš„å€¼æ˜¯<code>1011100000000000</code>ï¼Œæ‰€ä»¥é«˜å…«ä½çš„å€¼æ˜¯184<code>(47104/256=184)</code>ï¼Œç¬¬å…«ä½çš„å€¼æ˜¯0<code>(47104%256=0)</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6454ff120d2dde5777861523.png" alt=""></p>
<p>ç»¼ä¸Šæ‰€è¿°æˆ‘ä»¬è¦å®šæ—¶20msçš„è¯ï¼Œç»™TH0å’ŒTL0èµ‹å€¼æ–¹å¼å¯ä»¥ä¸º<code>TH0=184;TL0=0;</code>ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡å¯¹<code>TH0å’ŒTL0</code>ä¼ é€’åè¿›åˆ¶æ•°å­—å¯¹åˆå§‹åŒ–è¿‡ç¨‹è¿›è¡Œäº†ä¼˜åŒ–ï¼Œä½†è¿™ä»éœ€è¦æˆ‘ä»¬è‡ªå·±è¿›è¡Œè®¡ç®—ã€‚å‡å®šå®šæ—¶çš„æ—¶é—´ä¸º<code>1ms</code>ã€‚ç®—å‡ºè¦å¡«çš„16ä½çš„å˜é‡ä¸º<code>64614=0xFC66</code>æŒ‰ç…§ä¹‹å‰çš„å†™æ³•å°±æ˜¯<code>TH0=0xFC/252;TL0=0x66/102</code>ã€‚è€Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ä»¥æ‰“æ‰ç›¸åŒçš„æ•ˆæœã€‚</p>
<ol>
<li>TH0=( 65536-( 0.001/(12/11059200) ) )/256</li>
<li>TL0=( 65536-( 0.001/(12/11059200) ) )%256</li>
</ol>
<p>å› ä¸º( 65536-( 0.001/(12/11059200) ) )/256 = 252ï¼›( 65536-( 0.001/(12/11059200) ) )%256 = 102ã€‚æœ‰äº†è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†åˆå§‹åŒ–èµ‹å€¼è¿‡ç¨‹çš„å†™æ³•æ”¹å†™ä¸ºä¸€ä¸²æ•°å­—å…¬å¼å³å¯ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å®šæ—¶çš„æœ€å°å•ä½æ—¶é—´ä¸º1å¾®ç§’ï¼Œé‚£ä¹ˆå®šæ—¶50000å¾®ç§’ï¼ˆ50æ¯«ç§’ï¼‰å°±å¯ä»¥è¿™æ ·å†™æ¥ç»™TH0å’ŒTL0èµ‹åˆå€¼</p>
<ol>
<li><p>TH0=( 65536-( (50000/1000000)/(12/11059200) )/256;</p>
</li>
<li><p>TL0=( 65536-( (50000/1000000)/(12/11059200) )%256;</p>
</li>
</ol>
<p>è¿™é‡Œçš„(50000/1000000)ä»£è¡¨å®šæ—¶çš„æ˜¯0.05ç§’ï¼Œä¹Ÿå°±æ˜¯50æ¯«ç§’ã€‚</p>
<p>å¦‚æœè¦å®šæ—¶å…¶ä»–æ¯«ç§’æ•°, æ•°å­—å…¬å¼ä¸­çš„å…¶ä»–æ•°å­—æˆ‘ä»¬ä¸éœ€è¦ä¿®æ”¹ï¼Œåªéœ€è¦æŠŠ50000æ”¹ä¸ºæƒ³å®šæ—¶çš„æ—¶é—´å°±å¯ä»¥äº†ï¼Œè®¡ç®—è¿‡ç¨‹äº¤ç»™å•ç‰‡æœºç®—å‡ºæ¥ï¼Œæˆ‘ä»¬ä¹Ÿå°±ä¸éœ€è¦è‡ªå·±ç”¨è®¡ç®—å™¨æŠŠæœ€ç»ˆå€¼ç®—å‡ºæ¥å†èµ‹ç»™TH0å’ŒTL0è¿™ä¹ˆéº»çƒ¦äº†ã€‚</p>
<p>æˆ‘ä»¬å†åŒ–ç®€ä¸Šå¼å°±æ˜¯</p>
<ol>
<li><p>TH0=( 65536-( (50000*110592)/120000) )/256;</p>
</li>
<li><p>TH0=( 65536-( (50000*110592)/120000) )%256;</p>
</li>
</ol>
<h4 id="1-9-9-åˆå§‹åŒ–éœ€è¦æ³¨æ„çš„ç‚¹"><a href="#1-9-9-åˆå§‹åŒ–éœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="1.9.9 åˆå§‹åŒ–éœ€è¦æ³¨æ„çš„ç‚¹"></a>1.9.9 åˆå§‹åŒ–éœ€è¦æ³¨æ„çš„ç‚¹</h4><p>æŒ‰ä¸Šä¸€è®²è¯´çš„ä¹¦å†™æ–¹å¼ï¼Œå®ç°å®šæ—¶50msé—´éš”çš„æµæ°´ç¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶ç”µè·¯</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//æ‰“å¼€ä¸­æ–­æ€»å¼€å…³</span></span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH0 = (<span class="number">65536</span> - ( (<span class="number">50000</span> * <span class="number">110592</span>) / <span class="number">120000</span> )) / <span class="number">256</span>; <span class="comment">//è®¾ç½®å®šæ—¶æ—¶é—´ä¸º50ms</span></span><br><span class="line">    TL0 = (<span class="number">65536</span> - ( (<span class="number">50000</span> * <span class="number">110592</span>) / <span class="number">120000</span> )) % <span class="number">256</span>; </span><br><span class="line">    ET0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³</span></span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHanler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    <span class="type">static</span> u8 i;</span><br><span class="line">    TH0 = (<span class="number">65536</span> - ( (<span class="number">50000</span> * <span class="number">110592</span>) / <span class="number">120000</span> )) / <span class="number">256</span>; <span class="comment">//é‡æ–°åˆå§‹åŒ–å¡«å……</span></span><br><span class="line">    TL0 = (<span class="number">65536</span> - ( (<span class="number">50000</span> * <span class="number">110592</span>) / <span class="number">120000</span> )) % <span class="number">256</span>;</span><br><span class="line">    P0 = ~(<span class="number">0x01</span> &lt;&lt; i);</span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½è¿›å¼€å‘æ¿å‘ç°æ ¹æœ¬ä¸æ˜¯é—´éš”50msï¼é ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ï¼Œ51å•ç‰‡æœºèƒ½å­˜å‚¨æœ€å¤§çš„ä¸€ä¸ªæ•´å‹æ•°çš„å¤§å°åªæœ‰4ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯æœ€å¤šèƒ½è®°å¿†è¿™ä¸ªæ•°åˆ°4294967296ï¼ˆ2çš„32æ¬¡æ–¹ï¼‰ï¼Œè€Œåœ¨</p>
<p>( 65536-( (50000<em>110592)/120000 )ä¸­æ˜æ˜¾ä¸èƒ½æŠŠ(50000\</em>110592)ç»™ä¸´æ—¶å­˜å‚¨ï¼Œå› ä¸ºè¿™ä¸ªç­‰å¼çš„å¾—æ•°å·²ç»å¤§è¿‡2çš„32æ¬¡æ–¹ã€‚æ‰€ä»¥æˆ‘ä»¬çš„å®šæ—¶å™¨æ‰ä¼šæ— æ³•å®ç°å‡†ç¡®çš„50mså®šæ—¶ã€‚å¦‚æœæˆ‘ä»¬å¯¹ç¼–ç¨‹æ²¡æœ‰ä¸€å®šçš„ç§¯ç´¯æ˜¯å¾ˆéš¾å¯Ÿè§‰å‡ºè¿™ä¸ªéšå½¢æ¼æ´çš„ã€‚</p>
<p>è§£å†³åŠæ³•å°±æ˜¯ï¼Œæˆ‘ä»¬çš„å®šæ—¶æœ€å°å•ä½åªèƒ½æ˜¯<code>10å¾®ç§’</code>ï¼Œä¹Ÿå°±æ˜¯å®šæ—¶çš„æ—¶é—´å¿…é¡»æ˜¯10å¾®ç§’çš„æ•´æ•°å€ã€‚ä¹¦å†™å¦‚ä¸‹TH0=( 65536-(5000*110592)/12000 ) )/256;æŠŠä¹‹å‰çš„<code>50000</code>å’Œ<code>120000</code>éƒ½å»æ‰ä¸€ä¸ªé›¶ï¼Œè¿™æ ·å°±å¯ä»¥å‡†ç¡®çš„å®šæ—¶50msäº†ï¼Œå› ä¸ºâ€œ(5000)*110592)â€æ²¡æœ‰è¶…è¿‡2çš„32æ¬¡æ–¹ï¼Œè¯»è€…è‡ªè¡Œä¿®æ”¹æœ¬è®²æä¾›çš„ä»£ç ä¸­çš„4å¤„ä¹‹åä¸‹è½½è¿›å¼€å‘æ¿è§‚å¯Ÿç°è±¡æ˜¯ä¸æ˜¯åˆå®ç°50msçš„é—´éš”æµæ°´äº†ã€‚</p>
<p>ä½†æ˜¯è¿™æ ·å¥½åƒä¸æ˜¯å¾ˆé€šç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ­¤ä¼˜åŒ–åˆå§‹åŒ–çš„å†™æ³•</p>
<p>ä¸Šè¿°ç¨‹åºä¸­çš„<code>500</code>0æ„ä¸ºå®šæ—¶çš„æ˜¯<code>50ms</code>ï¼Œä¹Ÿå°±æ˜¯<code>5000*10</code>å¾®ç§’ï¼Œä½†æˆ‘ä»¬å¸Œæœ›æ½œæ„è¯†é‡Œå‡å¦‚è¦å®šæ—¶200å¾®ç§’ï¼Œå¦‚æœå†™æˆ20æˆ‘ä»¬çš„æ€ç»´è¿˜è¦ç»•ä¸ªå¼¯å†æŠŠ20é»˜é»˜ä¹˜ä»¥10æ‰é¢†æ‚Ÿå‡ºè¿™æ˜¯å®šæ—¶200å¾®ç§’ã€‚å€’ä¸å¦‚è¿™æ ·ï¼Œæˆ‘ä»¬çœ‹åˆ°å…³é”®çš„æ•°å­—æ˜¯å¤šå°‘é‚£å°±æ˜¯è¦å®šæ—¶å¤šå°‘å¾®ç§’ã€‚</p>
<p>æ¯”å¦‚çœ‹åˆ°å…³é”®æ•°å­—ä¸º50000æ—¶å°±çŸ¥é“å®šæ—¶çš„æ˜¯50000å¾®ç§’ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™æ ·æ”¹å†™ï¼šTH0=( 65536-( (50000/10)<em>110592)/12000 )/256;è¿™æ ·æ—¢ä¿è¯äº†â€œ(50000/10)\</em>110592â€æ²¡æœ‰è¶…è¿‡2çš„32æ¬¡æ–¹ï¼Œä¹Ÿä½¿â€œ50000â€æ›´ç›´è§‚çš„è®©æˆ‘ä»¬çŸ¥é“è¦å®šæ—¶çš„æ˜¯50000å¾®ç§’ã€‚ä½†æ˜¯å¤§å®¶è¦è®°ä½ï¼Œ<code>å…³é”®æ•°å­—å¿…é¡»æ˜¯10çš„æ•´æ•°å€ï¼Œå¦‚æœæƒ³å®šæ—¶ä¸ª208å¾®ç§’ï¼Œâ€œ(208/10)â€è¿˜æ˜¯ç­‰äº20ï¼Œæ‰€ä»¥å®šæ—¶æ—¶é—´è¿˜æ˜¯200å¾®ç§’</code>ã€‚</p>
<h4 id="1-9-10-ä»£ç å‚è€ƒ"><a href="#1-9-10-ä»£ç å‚è€ƒ" class="headerlink" title="1.9.10 ä»£ç å‚è€ƒ"></a>1.9.10 ä»£ç å‚è€ƒ</h4><p>æˆ‘ä»¬åˆ†æå¦‚ä¸‹çš„ä»£ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">ConfigTimer0</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> tmp;              <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">     </span><br><span class="line">    tmp = <span class="number">11059200</span> / <span class="number">12</span>;            <span class="comment">//å®šæ—¶å™¨è®¡æ•°é¢‘ç‡</span></span><br><span class="line">    tmp = (tmp * ms) / <span class="number">1000</span>;        <span class="comment">//è®¡ç®—æ‰€éœ€çš„è®¡æ•°å€¼</span></span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;              <span class="comment">//è®¡ç®—å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    tmp = tmp + <span class="number">13</span>;                 <span class="comment">//è¡¥å¿ä¸­æ–­å“åº”å»¶æ—¶é€ æˆçš„è¯¯å·®</span></span><br><span class="line">    T0RH = (<span class="type">unsigned</span> <span class="type">char</span>)(tmp&gt;&gt;<span class="number">8</span>); <span class="comment">//å®šæ—¶å™¨é‡è½½å€¼æ‹†åˆ†ä¸ºé«˜ä½å­—èŠ‚</span></span><br><span class="line">    T0RL = (<span class="type">unsigned</span> <span class="type">char</span>)tmp;</span><br><span class="line">    TMOD &amp;= <span class="number">0xF0</span>;                   <span class="comment">//æ¸…é›¶T0çš„æ§åˆ¶ä½</span></span><br><span class="line">    TMOD |= <span class="number">0x01</span>;                   <span class="comment">//é…ç½®T0ä¸ºæ¨¡å¼1</span></span><br><span class="line">    TH0 = T0RH;                     <span class="comment">//åŠ è½½T0é‡è½½å€¼</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    ET0 = <span class="number">1</span>;                        <span class="comment">//ä½¿èƒ½T0ä¸­æ–­</span></span><br><span class="line">    TR0 = <span class="number">1</span>;                        <span class="comment">//å¯åŠ¨T0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€å¥ï¼š<code>tmp = 11059200 / 12;</code>ã€‚å®šæ—¶å™¨çš„å¯„å­˜å™¨è®¡æ•°ï¼Œæ¯åŠ 1è®¡æ•°å°±æ˜¯ç»è¿‡ï¼ˆ12/11059200ï¼‰ç§’ã€‚é‚£ä¹ˆè®¡æ•°äº†11059200æ¬¡å°±æ˜¯ç»è¿‡12ç§’äº†ã€‚ç»è¿‡1ç§’è®¡æ•°å°±æ˜¯ï¼ˆ11059200/12ï¼‰= 921600ã€‚è¿™æ ·æˆ‘ä»¬å°±æ˜ç™½äº†ç¬¬ä¸€æ¡è¯­å¥çš„æ„æ€ã€‚</p>
<p>ç¬¬äºŒå¥ï¼š<code>tmp = (tmp * ms) / 1000;</code>æˆ‘ä»¬æƒ³å®šæ—¶1msï¼Œéœ€è¦çš„è®¡æ•°å°±æ˜¯ï¼ˆ921600/1000ï¼‰=921.6ï¼Œéœ€è¦å®šæ—¶<code>xms</code>å°±æ˜¯éœ€è¦è®¡æ•°<code>921.6x</code>ã€‚ä¾‹å¦‚ï¼šå¦‚æœæˆ‘ä»¬æƒ³å®šæ—¶5msï¼Œé‚£ä¹ˆéœ€è¦çš„è®¡æ•°å€¼å°±æ˜¯921.6*5=4608ã€‚</p>
<p>å®šæ—¶å™¨åˆå§‹åŒ–ï¼šTH0=(65536-4608)/256ï¼ŒTL0=(65536-4608)%256ã€‚å½“ç„¶ä¹Ÿå¯ä»¥è¿™æ ·è¡¨è¾¾ï¼Œä¸¤ç§ä¹¦å†™æ–¹å¼çš„åŠŸèƒ½ä½œç”¨éƒ½ä¸€æ ·ï¼šTH0= (unsigned char)(65536-4608)&gt;&gt;8ï¼›TL0= (unsigned char)(65536-4608)ã€‚è¿™é‡Œå…ˆä¸è€ƒè™‘<code>ä¸­æ–­å“åº”å»¶æ—¶é€ æˆçš„è¯¯å·®</code>ã€‚T0RHï¼ŒT0RLæ˜¯ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œä¸ºçš„æ˜¯åœ¨ä¸­æ–­å‡½æ•°ä¸­å¯ä»¥é‡æ–°èµ‹åˆå€¼ç»™å¯„å­˜å™¨TH0å’ŒTL0ã€‚</p>
<p>è§£é‡Š<code>tmp + 13</code>ï¼šç”±äºä¸­æ–­å‡½æ•°çš„æ‰§è¡Œæœ‰æ—¶éœ€è¦æ¶ˆè€—ä¸åŒçš„æ—¶é—´ï¼Œæ‰€ä»¥å®šæ—¶æ—¶é—´ä¼šæœ‰è¯¯å·®å¯¼è‡´è¿›å…¥ä¸­æ–­å‡½æ•°æ—¶ä¼šäº§ç”Ÿä¸è®¾æƒ³æ—¶çš„æ—¶é—´ä¸åŒï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´è®¡æ•°å€¼ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢ä»£ç ä¸­çš„tmpéœ€è¦å¾®è°ƒèŠ‚æˆä¸€ä¸ªåˆé€‚çš„æ•°ï¼Œä¸Šé¢æ˜¯å›ºå®šåŠ äº†13è¿™ä¸ªæ•°ï¼Œä½†æ˜¯æœ‰æ—¶éœ€è¦çµæ´»æ”¹å˜è¿™ä¸ªå¾®è°ƒå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æ”¹ä¸ºä¼ å…¥ä¸åŒçš„å‚æ•°æ¥æ”¹å˜è¿™ä¸ªå¾®è°ƒå€¼ã€‚</p>
<p>åŸºäºå¾®è°ƒæˆ‘ä»¬æ”¹è¿›ä»¥ä¸Šä»£ç ï¼Œä¸Šè¿°ä»£ç å®šæ—¶çš„æœ€å°å•ä½ä¸º1msï¼Œä¸‹ä¸€ç« ç”±äºæˆ‘ä»¬è¦å­¦èˆµæœºï¼Œéœ€è¦å®šæ—¶çš„æœ€å°å•ä½æ˜¯<code>0.1ms</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä»£ç å®šæ—¶çš„æœ€å°å•ä½å¿…é¡»æ˜¯0.1msï¼Œä¹Ÿå°±æ˜¯100usã€‚çœ‹åˆ°æˆ‘ä»¬çš„ä»£ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">TIM0_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span><span class="comment">//trim:å¾®è°ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">    u32 tmp;                        <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">      </span><br><span class="line">    tmp = <span class="number">11059200</span> / <span class="number">12</span>;            <span class="comment">//å®šæ—¶å™¨è®¡æ•°é¢‘ç‡</span></span><br><span class="line">    tmp = ( tmp * (us/<span class="number">100</span>) )/<span class="number">10000</span>; <span class="comment">//è®¡ç®—æ‰€éœ€çš„è®¡æ•°å€¼</span></span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;              <span class="comment">//è®¡ç®—å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    tmp = tmp+trim;                 <span class="comment">//å¾®è°ƒè®¡æ•°å€¼ä½¿å…¶å®šæ—¶æ›´ç²¾ç¡®åˆ°æˆ‘ä»¬æƒ³è¦çš„å®šæ—¶æ—¶é—´</span></span><br><span class="line">    T0RH = (<span class="type">unsigned</span> <span class="type">char</span>)(tmp&gt;&gt;<span class="number">8</span>); <span class="comment">//å®šæ—¶å™¨é‡è½½å€¼æ‹†åˆ†ä¸ºé«˜ä½å­—èŠ‚  </span></span><br><span class="line">    T0RL = (<span class="type">unsigned</span> <span class="type">char</span>)tmp;</span><br><span class="line">    TMOD &amp;= <span class="number">0xF0</span>; <span class="comment">//æ¸…0ä½å››ä½ </span></span><br><span class="line">    TMOD |= <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1   </span></span><br><span class="line">    TH0 = T0RH;   <span class="comment">//åŠ è½½T0é‡è½½å€¼   </span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    ET0 = <span class="number">1</span>;      <span class="comment">//é—­åˆå®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³        </span></span><br><span class="line">    TR0 = <span class="number">1</span>;      <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0         </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¦æƒ³å®šæ—¶2msï¼Œä¼ å…¥çš„å‚æ•°å°±æ˜¯2000ï¼Œæˆ‘ä»¬çš„å‚æ•°æ˜¯usæ•°ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯2000ï¼Œç¬¬äºŒæ¡è¯­å¥å°±æ˜¯â€œ(tmp*2)/1000â€ï¼Œä¸å®‹è€å¸ˆçš„ä»£ç åŸç†ä¸€æ ·ã€‚ä¸è¿‡éœ€è¦è®°ä½çš„æ˜¯æ”¹ä»£ç <code>ä¸èƒ½å®šæ—¶å°äº100usçš„æ—¶é—´ï¼Œæœ€ä½å•ä½åªèƒ½æ˜¯100us</code>ã€‚</p>
<h4 id="1-9-11-å¾®è°ƒå®šæ—¶ç²¾ç¡®æ—¶é—´"><a href="#1-9-11-å¾®è°ƒå®šæ—¶ç²¾ç¡®æ—¶é—´" class="headerlink" title="1.9.11 å¾®è°ƒå®šæ—¶ç²¾ç¡®æ—¶é—´"></a>1.9.11 å¾®è°ƒå®šæ—¶ç²¾ç¡®æ—¶é—´</h4><p>ä¸€èˆ¬å®šæ—¶å™¨ä¸­æ–­å‡½æ•°é‡Œçš„å†…å®¹æœ€å¥½æ˜¯èƒ½å¤Ÿå¿«é€Ÿåœ°å»æ‰§è¡Œå®Œï¼Œæ¯”å¦‚åªæ‰§è¡Œå‡ æ¡ç®€å•çš„è¯­å¥ï¼Œè¿™æ ·ä¸ä¸»å‡½æ•°é…åˆæ‰ä¼šä½¿ç¨‹åºæ›´åŠ é«˜æ•ˆã€‚å‰é¢ï¼Œåªä½¿ç”¨å®šæ—¶å™¨ä¸­æ–­è´Ÿè´£æŸä¸ªIOå¼•è„šé—´éš”è·³å˜æˆ–è€…ä½¿ä¸€ä¸ªå˜é‡é—´éš”è‡ªåŠ 1çš„ç®€å•è¯­å¥ã€‚</p>
<p>ç°åœ¨è¦å®ç°é—´éš”50mså·¦å³çš„æ—¶é—´è®©æµæ°´ç¯å·¦å³å¾ªç¯ç§»åŠ¨çš„åŒæ—¶ï¼Œè¿˜éœ€è¦æ— æºèœ‚é¸£å™¨ä¸€ç›´å“ï¼Œè¿™æ ·çš„åŠŸèƒ½ï¼Œæ€è·¯è¯¥æ€ä¹ˆå»å®ç°ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“æ— æºèœ‚é¸£å™¨è¦æƒ³é¸£å«çš„æ¯”è¾ƒå°–é”ï¼Œé‚£P1.6éœ€è¦ä¸€ä¸ªåˆé€‚çš„è„‰å†²ä¿¡å·ï¼Œè¿™ä¸ªä¿¡å·æ‰“ç®—ä½¿P1.6é«˜ä½ç”µå¹³ä¿æŒçš„æ—¶é—´ä¸º<code>300å¾®ç§’</code>ä¸æ–­å¾ªç¯ã€‚æ‰€ä»¥æˆ‘ä»¬ç”¨å®šæ—¶å™¨ä¸­æ–­å®ç°P1.6çš„ç”µå¹³é—´éš”è·³å˜ï¼Œä¸»å‡½æ•°é‡Œè´Ÿè´£å®Œæˆæµæ°´ç¯çš„ä»»åŠ¡å³å¯ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/6455f8750d2dde5777a48cbc.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">u8 T0RH, T0RL;</span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span><span class="comment">//trim:å¾®è°ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">    u32 tmp;                       <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">     </span><br><span class="line">    tmp = <span class="number">11059200</span> / <span class="number">12</span>;           <span class="comment">//å®šæ—¶å™¨è®¡æ•°é¢‘ç‡</span></span><br><span class="line">    tmp = ( tmp * (us/<span class="number">100</span>) )/<span class="number">10000</span>;<span class="comment">//è®¡ç®—æ‰€éœ€çš„è®¡æ•°å€¼</span></span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;             <span class="comment">//è®¡ç®—å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    tmp = tmp+trim;                <span class="comment">//è¡¥å¿ä¸­æ–­å“åº”å»¶æ—¶é€ æˆçš„è¯¯å·®</span></span><br><span class="line">    T0RH = (<span class="type">unsigned</span> <span class="type">char</span>)(tmp&gt;&gt;<span class="number">8</span>);<span class="comment">//å®šæ—¶å™¨é‡è½½å€¼æ‹†åˆ†ä¸ºé«˜ä½å­—èŠ‚  </span></span><br><span class="line">    T0RL = (<span class="type">unsigned</span> <span class="type">char</span>)tmp;</span><br><span class="line">    TMOD &amp;= <span class="number">0xF0</span>; <span class="comment">//æ¸…0ä½å››ä½ </span></span><br><span class="line">    TMOD |= <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1   </span></span><br><span class="line">    TH0 = T0RH;   <span class="comment">//åŠ è½½T0é‡è½½å€¼   </span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    ET0 = <span class="number">1</span>;      <span class="comment">//é—­åˆå®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³        </span></span><br><span class="line">    TR0 = <span class="number">1</span>;      <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0         </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u8 i,dir;</span><br><span class="line">    LED_Init();       <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>;           <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TIM0_Init(<span class="number">300</span>,<span class="number">0</span>); <span class="comment">//ç”¨å®šæ—¶å™¨0å®šæ—¶300us,ä¸å¾®è°ƒ</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;<span class="number">8</span>)dir=<span class="number">0</span>;<span class="comment">//å‘å·¦ç§»</span></span><br><span class="line">        <span class="keyword">if</span>(dir==<span class="number">0</span>)P0=~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)dir=<span class="number">1</span>;<span class="comment">//å‘å³ç§» </span></span><br><span class="line">        <span class="keyword">if</span>(dir==<span class="number">1</span>)P0=~( <span class="number">0x80</span>&gt;&gt;(i<span class="number">-7</span>) );<span class="comment">//å½“iå¤§äºç­‰äº8ä¹‹åï¼Œ(i-7)å…¶å®ä¹Ÿè¿˜æ˜¯åœ¨1~7ä¹‹é—´å˜åŒ–</span></span><br><span class="line"> </span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">15</span>)i=<span class="number">1</span>;<span class="comment">//è®©iä¸€ç›´åœ¨1~14ä¹‹é—´å˜åŒ–</span></span><br><span class="line">        delay_ms(<span class="number">50</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123;</span><br><span class="line">    TH0 = T0RH;   <span class="comment">//é‡æ–°åŠ è½½é‡è½½å€¼</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    BEEP=!BEEP;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-9-12-å°è£…å‡½æ•°"><a href="#1-9-12-å°è£…å‡½æ•°" class="headerlink" title="1.9.12 å°è£…å‡½æ•°"></a>1.9.12 å°è£…å‡½æ•°</h4><p>å°è£…<code>timer.h</code>å’Œ<code>time.c</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//time.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span> <span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line">   </span><br><span class="line">u8 T0RH,T0RL,T1RH,T1RL;</span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span><span class="comment">//trim:å¾®è°ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">    u32 tmp;  <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">     </span><br><span class="line">    tmp = <span class="number">11059200</span> / <span class="number">12</span>;            <span class="comment">//å®šæ—¶å™¨è®¡æ•°é¢‘ç‡</span></span><br><span class="line">    tmp = ( tmp * (us/<span class="number">100</span>) )/<span class="number">10000</span>; <span class="comment">//è®¡ç®—æ‰€éœ€çš„è®¡æ•°å€¼</span></span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;              <span class="comment">//è®¡ç®—å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    tmp = tmp+trim;                 <span class="comment">//å¾®è°ƒè®¡æ•°å€¼ä½¿å…¶å®šæ—¶æ›´ç²¾ç¡®åˆ°æˆ‘ä»¬æƒ³è¦çš„å®šæ—¶æ—¶é—´</span></span><br><span class="line">    T0RH = (<span class="type">unsigned</span> <span class="type">char</span>)(tmp&gt;&gt;<span class="number">8</span>); <span class="comment">//å®šæ—¶å™¨é‡è½½å€¼æ‹†åˆ†ä¸ºé«˜ä½å­—èŠ‚  </span></span><br><span class="line">    T0RL = (<span class="type">unsigned</span> <span class="type">char</span>)tmp;</span><br><span class="line">    TMOD &amp;= <span class="number">0xF0</span>; <span class="comment">//æ¸…0ä½å››ä½ </span></span><br><span class="line">    TMOD |= <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1   </span></span><br><span class="line">    TH0 = T0RH;   <span class="comment">//åŠ è½½T0é‡è½½å€¼   </span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    ET0 = <span class="number">1</span>;      <span class="comment">//é—­åˆå®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³        </span></span><br><span class="line">    TR0 = <span class="number">1</span>;      <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0         </span></span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM1_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span><span class="comment">//trim:å¾®è°ƒ</span></span><br><span class="line">&#123;</span><br><span class="line">    u32 tmp;  <span class="comment">//ä¸´æ—¶å˜é‡</span></span><br><span class="line">     </span><br><span class="line">    tmp = <span class="number">11059200</span> / <span class="number">12</span>;            <span class="comment">//å®šæ—¶å™¨è®¡æ•°é¢‘ç‡</span></span><br><span class="line">    tmp = ( tmp * (us/<span class="number">100</span>) )/<span class="number">10000</span>; <span class="comment">//è®¡ç®—æ‰€éœ€çš„è®¡æ•°å€¼</span></span><br><span class="line">    tmp = <span class="number">65536</span> - tmp;              <span class="comment">//è®¡ç®—å®šæ—¶å™¨é‡è½½å€¼</span></span><br><span class="line">    tmp = tmp+trim;                 <span class="comment">//å¾®è°ƒè®¡æ•°å€¼ä½¿å…¶å®šæ—¶æ›´ç²¾ç¡®åˆ°æˆ‘ä»¬æƒ³è¦çš„å®šæ—¶æ—¶é—´</span></span><br><span class="line">    T1RH = (<span class="type">unsigned</span> <span class="type">char</span>)(tmp&gt;&gt;<span class="number">8</span>); <span class="comment">//å®šæ—¶å™¨é‡è½½å€¼æ‹†åˆ†ä¸ºé«˜ä½å­—èŠ‚    </span></span><br><span class="line">    T1RL = (<span class="type">unsigned</span> <span class="type">char</span>)tmp;</span><br><span class="line">    TMOD&amp;=<span class="number">0x0F</span>;<span class="comment">//æ¸…0é«˜å››ä½</span></span><br><span class="line">    TMOD|=<span class="number">0x10</span>;<span class="comment">//è®¾ç½®å®šæ—¶å™¨1ä¸ºå·¥ä½œæ¨¡å¼1 </span></span><br><span class="line">    TH1 = T1RH;<span class="comment">//åŠ è½½T1é‡è½½å€¼     </span></span><br><span class="line">    TL1 = T1RL;</span><br><span class="line">    ET1 = <span class="number">1</span>;   <span class="comment">//é—­åˆå®šæ—¶å™¨1ä¸­æ–­çš„å¼€å…³        </span></span><br><span class="line">    TR1 = <span class="number">1</span>;   <span class="comment">//å¯åŠ¨å®šæ—¶å™¨1         </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//timer.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __TIMER_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __TIMER_H__</span></span><br><span class="line">   </span><br><span class="line"><span class="keyword">extern</span> u8 T0RH,T0RL,T1RH,T1RL;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span>;<span class="comment">//trim:å¾®è°ƒ </span></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM1_Init</span><span class="params">(u32 us,<span class="type">int</span> trim)</span>;<span class="comment">//trim:å¾®è°ƒ </span></span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h4 id="1-9-13-å‘¼å¸ç¯"><a href="#1-9-13-å‘¼å¸ç¯" class="headerlink" title="1.9.13 å‘¼å¸ç¯"></a>1.9.13 å‘¼å¸ç¯</h4><p>å‘¼å¸ç¯çš„å®ç°åŸç†å°±æ˜¯è®©å°ç¯çš„IOç«¯å£åœ¨ä¸€æ®µæ—¶é—´é‡ŒPWMç”±å¤§åˆ°å°å˜åŒ–çš„å ç©ºæ¯”è¾“å‡ºï¼Œæ¥ç€åˆç”±å°åˆ°å¤§çš„å ç©ºæ¯”è¾“å‡ºï¼Œå°ç¯æ˜¾ç¤ºæ•ˆæœå°±æ˜¯æ—¶äº®æ—¶æš—åœ°äº¤æ›¿é—ªçƒã€‚é¦–å…ˆæˆ‘ä»¬ç”¨å®šæ—¶å™¨0å®šæ—¶0.1msï¼Œå…¨å±€å˜é‡pwmåœ¨å…¶ä¸­æ–­å‡½æ•°é‡Œæ‰§è¡Œç®€å•çš„ä»0åˆ°99çš„å¾ªç¯è‡ªåŠ ï¼Œè¿™æ ·å‘¨æœŸå°±æ˜¯10msã€‚å‡å¦‚ä¸»å‡½æ•°é‡Œæˆ‘ä»¬è¿™æ ·æ‰§è¡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(pwm&lt;<span class="number">90</span>)P0=<span class="number">0xFF</span>;</span><br><span class="line"><span class="keyword">else</span> P0=<span class="number">0x00</span>;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆIOç«¯å£è¾“å‡ºçš„ä¸€ç›´æ˜¯<code>å‘¨æœŸä¸º10ms</code>å ç©ºæ¯”ä¸º90%çš„æ³¢å½¢ï¼Œè¿™æ ·8ç›å°ç¯ä¸€ç›´æ˜¯å¤„äºè¾ƒæš—çš„æ˜¾ç¤ºçŠ¶æ€ä¸å˜ï¼Œè¦æƒ³å®ç°å‘¼å¸ç¯ï¼Œå°±è¦ä¸åœæ”¹å˜PWMæ³¢å½¢çš„å ç©ºæ¯”ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å®šæ—¶å™¨1æ¥åšé—´éš”10msåœ°æ”¹å˜å ç©ºæ¯”ï¼Œæˆ‘ä»¬å†å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡highvalï¼Œè¿™ä¸ªå˜é‡æ¯éš”10mså°±ä¼šåœ¨å®šæ—¶å™¨1ä¸­æ–­å‡½æ•°ä¸­å®ç°åŠ 1æˆ–è€…å‡1ï¼ŒåŠ åˆ°99æ—¶åˆä»99å‡å›åˆ°0ï¼Œå‡å›åˆ°0åˆä»0å¼€å§‹åŠ åˆ°99çš„è¿™æ ·å¾ªç¯è¿‡ç¨‹ï¼Œå¤§å®¶å›å»ç ”ç©¶å·¦å³å¾€å¤å¾ªç¯æµæ°´ç¯çš„ä»£ç å°±ä¼šæ˜ç™½éƒ½æ˜¯ä¸€æ ·çš„æ€è·¯ã€‚ç„¶åä¸»å‡½æ•°è¿™æ ·æ‰§è¡Œ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(pwm&lt;highval)P0=<span class="number">0xFF</span>;<span class="comment">//highvalæ¯éš”10mså°±ä¼šå˜åŒ–åŠ 1æˆ–è€…å‡1</span></span><br><span class="line"><span class="keyword">else</span> P0=<span class="number">0x00</span>;</span><br></pre></td></tr></table></figure>
<p>æ•ˆæœå›¾å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645602160d2dde5777af389f.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">u8 pwm = <span class="number">0</span>; highval = <span class="number">99</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//é—­åˆä¸­æ–­æ€»å¼€å…³</span></span><br><span class="line">    TIM0_Init(<span class="number">100</span>, <span class="number">9</span>); <span class="comment">//å®šæ—¶0.1ms, 9æ˜¯å¾®è°ƒæ˜¯å®šæ—¶æ—¶é—´æ›´ç²¾ç¡®</span></span><br><span class="line">    TIM1_Init(<span class="number">10000</span>, <span class="number">10</span>); <span class="comment">//å®šæ—¶10msï¼Œ10æ˜¯å¾®è°ƒä½¿å®šæ—¶æ—¶é—´æ›´ç²¾ç¡®</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(pwm &lt; highval) P0 = <span class="number">0xFF</span>; <span class="comment">//highvalæ¯éš”10mså°±ä¼šå˜åŒ–åŠ ä¸€æˆ–è€…å‡ä¸€</span></span><br><span class="line">        <span class="keyword">else</span> P0 = <span class="number">0x00</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    TH0 = T0RH; <span class="comment">//é‡æ–°åˆå§‹åŒ–</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    pwm++;</span><br><span class="line">    <span class="keyword">if</span>(pwm &gt;= <span class="number">100</span>) pwm = <span class="number">0</span>; <span class="comment">//pwmåœ¨0-99ä¹‹é—´é—´éš”æ¯éš”0.1mså˜åŒ–ï¼Œå‘¨æœŸå°±ä¸º10ms</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM1_IRQHandler</span><span class="params">()</span> interrupt 3 &#123;</span><br><span class="line">    <span class="type">static</span> u8 dir;</span><br><span class="line">    TH1 = T1RH; <span class="comment">//é‡æ–°åˆå§‹åŒ–</span></span><br><span class="line">    TL1 = T1RL;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(dir == <span class="number">1</span>) highval--; <span class="comment">//å ç©ºæ¯”é€æ¸å‡å°ï¼Œå°ç¯é€æ¸å˜äº®</span></span><br><span class="line">    <span class="keyword">if</span>(highval == <span class="number">0</span>) dir = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(dir == <span class="number">0</span>) highval++; <span class="comment">//å ç©ºæ¯”é€æ¸å¢å¤§ï¼Œå°ç¯é€æ¸å˜æš—</span></span><br><span class="line">    <span class="keyword">if</span>(highval &gt;= <span class="number">99</span>) dir = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-10-èˆµæœº"><a href="#1-10-èˆµæœº" class="headerlink" title="1.10 èˆµæœº"></a>1.10 èˆµæœº</h3><h4 id="1-10-1-è®¤è¯†èˆµæœº"><a href="#1-10-1-è®¤è¯†èˆµæœº" class="headerlink" title="1.10.1 è®¤è¯†èˆµæœº"></a>1.10.1 è®¤è¯†èˆµæœº</h4><p>èˆµæœºæ˜¯å•ç‰‡æœºæœºæ¢°æ§åˆ¶å…¥é—¨å¿…å­¦çš„æ¨¡å—ï¼Œåœ¨ä¸€äº›æœºå™¨äººå…³èŠ‚ä¸­ä¹Ÿæ˜¯é‡‡ç”¨èˆµæœºä½œä¸ºæ§åˆ¶ï¼Œå­¦ä¹ å¹¶ç†Ÿç»ƒæŒæ¡ä½¿ç”¨èˆµæœºæ˜¯æˆ‘ä»¬å¯¹å•ç‰‡æœºçš„è¿›ä¸€æ­¥è®¤è¯†ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ä¸€ç›´å±€é™åœ°ä½¿ç”¨å¼€å‘æ¿è¿›è¡Œå­¦ä¹ ï¼Œè€Œæ˜¯æ‰©å±•ä¸€äº›ç”µå­æ¨¡å—æ¥è¾…åŠ©æˆ‘ä»¬æ›´åŠ æ·±å…¥äº†è§£å•ç‰‡æœºï¼Œè¯·è‡ªä¿¡è´­ä¹°èˆµæœºã€‚</p>
<p>å°å‹çš„èˆµæœºä¸å¤§å‹çš„èˆµæœºæ§åˆ¶åŸç†å‡ ä¹å¤§åŒå°å¼‚ï¼Œè€ƒè™‘åˆ°æˆ‘æ²¡é’±ï¼Œæˆ‘è‚¯å®šé€‰æ‹©å°å‹èˆµæœºä½œä¸ºå…¥é—¨å­¦ä¹ å’Œç®€å•å®ç”¨ã€‚å¸¸è§çš„å°å‹èˆµæœºå‹å·ä¸º<code>9gèˆµæœº</code>ï¼Œå¤–è§‚å¦‚ä¸‹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645612c60d2dde5777c5c075.png" alt=""></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645612eb0d2dde5777c60de0.png" alt=""></p>
<h4 id="1-10-2-èˆµæœºæ§åˆ¶åŸç†"><a href="#1-10-2-èˆµæœºæ§åˆ¶åŸç†" class="headerlink" title="1.10.2 èˆµæœºæ§åˆ¶åŸç†"></a>1.10.2 èˆµæœºæ§åˆ¶åŸç†</h4><p>æˆ‘ä»¬ä½¿ç”¨çš„èˆµæœºä¸º9gå°ºå¯¸ï¼Œä¿¡å·ä¸º<code>MG90S</code>ã€‚è¿™ç§èˆµæœºçš„ä½œç”¨è§’åº¦ä¸º<code>0Â°~180Â°</code>ï¼Œä¹Ÿå°±æ˜¯èˆµæœºæ¡¨å¯ä»¥ä»»æ„åœ¨æŸä¸ªè§’åº¦å¡æ­»ä¸åŠ¨ï¼Œç”±äºä¾›ç”µåŸå› æˆ‘ä»¬ä½¿ç”¨è›®åŠ›æ˜¯å¾ˆéš¾æ°åŠ¨èˆµæœºæ¡¨çš„ï¼Œåªæœ‰èˆµæœºæ‰ç”µä¹‹åèˆµæœºæ¡¨æ‰ä¼šä»»æ„åœ°ä¸ºæˆ‘ä»¬æ‰€æ‰­åŠ¨ã€‚</p>
<p>èˆµæœºæœ‰ä¸‰æ ¹çº¿ï¼Œé™¤äº†ä¾›ç”µçš„ä¸¤æ ¹ç”µæºçº¿è¿˜æœ‰ä¸€æ ¹ä¿¡å·çº¿ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯5vç”µå‹åŠŸç‡çš„èˆµæœºï¼Œæ‰€ä»¥å…¶ä»–ç”µæºçº¿å¯ä»¥ç›´æ¥æ¥åˆ°å•ç‰‡æœºçš„<code>+5v</code>å’Œ<code>GND</code>ä¸Šï¼Œä¿¡å·çº¿çš„è¯å°±æ¥åˆ°å•ç‰‡æœºçš„ä¸€ä¸ªIOç«¯å£ä¸Šï¼Œè¿™ä¸ªIOç«¯å£é€šè¿‡è¾“å‡ºPWMæ§åˆ¶èˆµæœºæ¡¨çš„è§’åº¦åœ¨ä»»æ„ä½ç½®ä¸Šå›ºå®šåœç•™ã€‚</p>
<p>è¿™ä¸ªPWMçš„å‘¨æœŸä¸º<code>20ms</code>ï¼Œé«˜ç”µå¹³çš„æ—¶é—´åœ¨<code>0.5ms~2.5ms</code>ä¹‹é—´å¯ä»¥æ§åˆ¶èˆµæœºæ¡¨è§’åº¦çš„åœç•™ä½ç½®ã€‚</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">0.5ms</th>
<th style="text-align:center">1.0ms</th>
<th style="text-align:center">1.5ms</th>
<th style="text-align:center">2.0ms</th>
<th style="text-align:center">2.5ms</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0åº¦</td>
<td style="text-align:center">45åº¦</td>
<td style="text-align:center">90åº¦</td>
<td style="text-align:center">135åº¦</td>
<td style="text-align:center">180åº¦</td>
</tr>
</tbody>
</table>
</div>
<p>æˆ‘ä»¬æŠŠèˆµæœºçš„ç”µæºçº¿æ¥å¥½ï¼Œç„¶åä¿¡å·çº¿è¿æ¥P1.7ï¼ŒæŠŠä»£ç ä¸‹è½½è¿›å»ï¼Œèˆµæœºæ¡¨åœ¨ä¸Šç”µåå°±ä¼šæ—‹è½¬åˆ°ä¸€ä¸ªå›ºå®šè§’åº¦çš„ä½ç½®ä¸Šåœç•™åœ¨é‚£ä¸åŠ¨ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;timer.h&gt;</span>   <span class="comment">//è¯¦è§ç¬¬å…«ç« ç¬¬11è®²</span></span></span><br><span class="line">sbit PWMOUT = P1^<span class="number">7</span>;  <span class="comment">//èˆµæœºä¿¡å·çº¿å¼•è„š</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>;    <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TIM0_Init(<span class="number">100</span>,<span class="number">9</span>);<span class="comment">//å®šæ—¶0.1ms,9æ˜¯å¾®è°ƒä½¿å®šæ—¶ç²¾åº¦æ›´é«˜</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>); </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123; </span><br><span class="line">    <span class="type">static</span> u8 pwm=<span class="number">0</span>;</span><br><span class="line">    TH0 = T0RH;  <span class="comment">//é‡æ–°åŠ è½½é‡è½½å€¼</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    </span><br><span class="line">    pwm++;</span><br><span class="line">    <span class="keyword">if</span>(pwm&gt;=<span class="number">200</span>)pwm=<span class="number">0</span>; <span class="comment">//pwmåœ¨0~199ä¹‹é—´é—´éš”0.1mså˜åŒ–ï¼Œå‘¨æœŸä¸º20ms</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span>(pwm&lt;<span class="number">10</span>)PWMOUT=<span class="number">1</span>;<span class="comment">//é«˜ç”µå¹³åœ¨å‘¨æœŸä¸º20msçš„PWMä¸­æŒç»­çš„æ—¶é—´ä¸º1msï¼Œä½ç”µå¹³æŒç»­çš„æ—¶é—´å°±æ˜¯19msï¼Œèˆµæœºæ¡¨åœ¨45åº¦å¤„çš„ä½ç½®åœç•™ä¸åŠ¨</span></span><br><span class="line">    <span class="keyword">else</span> PWMOUT=<span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645618c70d2dde5777ccc4a3.png" alt=""></p>
<h4 id="1-10-3-æŒ‰é”®æ§åˆ¶èˆµæœº"><a href="#1-10-3-æŒ‰é”®æ§åˆ¶èˆµæœº" class="headerlink" title="1.10.3 æŒ‰é”®æ§åˆ¶èˆµæœº"></a>1.10.3 æŒ‰é”®æ§åˆ¶èˆµæœº</h4><p>ä½¿ç”¨æŒ‰é”®æ§åˆ¶èˆµæœºæ¡¨åœ¨æˆ‘ä»¬æƒ³è¦çš„ä½ç½®ä¸Šåœç•™ã€‚K8è´Ÿè´£æ§åˆ¶èˆµæœºæ¡¨å¾€ä¸€ä¸ªæ–¹å‘ä¸åœæ—‹è½¬ï¼ŒK16åˆ™æ§åˆ¶ç›¸åæ–¹å‘æ—‹è½¬ã€‚æŒ‰é”®æ¨¡å¼ä¸ºæ”¯æŒè¿æŒ‰ã€‚ç„¶åæ•°ç ç®¡æ˜¾ç¤ºé«˜ç”µå¹³æŒç»­çš„æ—¶é—´ï¼Œå¦‚æœæ•°ç ç®¡æ˜¾ç¤º5ï¼Œåˆ™é«˜ç”µå¹³åœ¨20mså‘¨æœŸé‡ŒæŒç»­çš„æ—¶é—´ä¸º0.5msï¼Œå¦‚æœæ˜¾ç¤ºçš„æ˜¯20ï¼Œé‚£å°±æ˜¯æŒç»­2msçš„é«˜ç”µå¹³æ—¶é—´ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line">sbit PWMOUT = P1^<span class="number">7</span>;  <span class="comment">//èˆµæœºä¿¡å·çº¿å¼•è„š</span></span><br><span class="line">  </span><br><span class="line">u16 highval=<span class="number">15</span>; </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    u8 key;</span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>;    <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TIM0_Init(<span class="number">100</span>,<span class="number">9</span>); <span class="comment">//å®šæ—¶0.1ms,9æ˜¯å¾®è°ƒä½¿å®šæ—¶ç²¾åº¦æ›´é«˜</span></span><br><span class="line">    TIM1_Init(<span class="number">1000</span>,<span class="number">0</span>);<span class="comment">//å®šæ—¶1msï¼Œç”¨æ¥åˆ·æ–°æ•°ç ç®¡æ˜¾ç¤º,å®šæ—¶ç²¾åº¦è¦æ±‚ä¸é«˜å¯ä¸å¾®è°ƒ</span></span><br><span class="line">  </span><br><span class="line">    ShowNumber(highval);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;      </span><br><span class="line">        key=KEY_Scan(<span class="number">1</span>,<span class="number">500</span>);<span class="comment">//æ”¯æŒè¿æŒ‰ </span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            highval++;</span><br><span class="line">            <span class="keyword">if</span>(highval&gt;<span class="number">25</span>)highval=<span class="number">25</span>;<span class="comment">//é«˜ç”µå¹³æŒç»­æ—¶é—´ä¸èƒ½è¶…è¿‡2.5ms</span></span><br><span class="line">            ShowNumber(highval);</span><br><span class="line">        &#125;</span><br><span class="line">  </span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">16</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            highval--;</span><br><span class="line">            <span class="keyword">if</span>(highval&lt;<span class="number">5</span>)highval=<span class="number">5</span>;<span class="comment">//é«˜ç”µå¹³æŒç»­æ—¶é—´ä¸èƒ½ä½äº0.5ms</span></span><br><span class="line">            ShowNumber(highval);</span><br><span class="line">        &#125;     </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1</span><br><span class="line">&#123; </span><br><span class="line">    <span class="type">static</span> u8 pwm=<span class="number">0</span>;</span><br><span class="line">    TH0 = T0RH;  <span class="comment">//é‡æ–°åŠ è½½é‡è½½å€¼</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">     </span><br><span class="line">    pwm++;</span><br><span class="line">    <span class="keyword">if</span>(pwm&gt;=<span class="number">200</span>)pwm=<span class="number">0</span>;<span class="comment">//pwmåœ¨0~199ä¹‹é—´é—´éš”0.1mså˜åŒ–ï¼Œå‘¨æœŸä¸º20ms</span></span><br><span class="line">  </span><br><span class="line">    <span class="keyword">if</span>(pwm&lt;highval)PWMOUT=<span class="number">1</span>;<span class="comment">//highvalçš„å€¼å†³å®šèˆµæœºæ¡¨çš„åœç•™ä½ç½®</span></span><br><span class="line">    <span class="keyword">else</span> PWMOUT=<span class="number">0</span>; </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM1_IRQHandler</span><span class="params">()</span> interrupt 3</span><br><span class="line">&#123; </span><br><span class="line">    TH1 = T1RH;  <span class="comment">//é‡æ–°åŠ è½½é‡è½½å€¼</span></span><br><span class="line">    TL1 = T1RL;</span><br><span class="line">    SEG_Scan();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="1-10-4-å‘¼å¸ç¯ä¸èˆµæœº"><a href="#1-10-4-å‘¼å¸ç¯ä¸èˆµæœº" class="headerlink" title="1.10.4 å‘¼å¸ç¯ä¸èˆµæœº"></a>1.10.4 å‘¼å¸ç¯ä¸èˆµæœº</h4><p>å‘¼å¸ç¯çš„ç¨‹åºæ€æƒ³å¦‚æœç”¨åœ¨èˆµæœºæ§åˆ¶ä¸Šï¼Œé‚£ä¹ˆèˆµæœºæ¡¨å°±æ˜¯ä»0åº¦çš„ä½ç½®è½¬åˆ°180åº¦çš„ä½ç½®åˆä»180åº¦å¤„è½¬å›0åº¦å¤„å¦‚æ­¤å¾ªç¯å¾€å¤ï¼Œç°åœ¨æˆ‘ä»¬åŠ¨æ‰‹æ”¹å†™ä¸€ä¸‹å‘¼å¸ç¯çš„ç¨‹åºä½¿å…¶èƒ½èå…¥èˆµæœºçš„æ§åˆ¶ä¸­ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">sbit PWMOUT = P1^<span class="number">7</span>; <span class="comment">//èˆµæœºä¿¡å·çº¿å¼•è„š</span></span><br><span class="line"></span><br><span class="line">u16 highval = <span class="number">5</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	u8 key;</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">	KEY_Init(); <span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">	EA = <span class="number">1</span>; <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">	TIM0_Init(<span class="number">100</span>, <span class="number">9</span>); <span class="comment">//å®šæ—¶0.1ms, 9æ˜¯å¾®è°ƒä½¿å®šæ—¶ç²¾åº¦æ›´é«˜</span></span><br><span class="line">	TIM1_Init(<span class="number">50000</span>, <span class="number">0</span>); <span class="comment">//å®šæ—¶50msï¼Œå®šæ—¶ç²¾åº¦è¦æ±‚ä¸é«˜å¯ä»¥ä¸å¾®è°ƒ</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">	<span class="type">static</span> u8 pwm = <span class="number">0</span>;</span><br><span class="line">	TH0 = T0RH; <span class="comment">//é‡è£…åˆå§‹å€¼</span></span><br><span class="line">	TL0 = T0RL; </span><br><span class="line">	</span><br><span class="line">	pwm++;</span><br><span class="line">	<span class="keyword">if</span>(pwm &gt;= <span class="number">200</span>) pwm = <span class="number">0</span>; <span class="comment">//pwmåœ¨0-199ä¹‹é—´é—´éš”0.1mså˜åŒ–ï¼Œå‘¨æœŸä¸º20ms</span></span><br><span class="line">	<span class="keyword">if</span>(pwm &lt; highval) PWMOUT = <span class="number">1</span>; <span class="comment">//highvalçš„å€¼å†³å®šèˆµæœºæ¡¨çš„åœç•™ä½ç½®</span></span><br><span class="line">	<span class="keyword">else</span> PWMOUT = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM1_IRQHandler</span><span class="params">()</span> interrupt 3 &#123;</span><br><span class="line">	<span class="type">static</span> u8 dir;</span><br><span class="line">	TH1 = T1RH; <span class="comment">//é‡è£…åˆå§‹å€¼</span></span><br><span class="line">	TL1 = T1RL;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//æ§åˆ¶highvalåªèƒ½åœ¨5~24ä¹‹é—´å˜åŒ–</span></span><br><span class="line">	<span class="keyword">if</span>(dir == <span class="number">1</span>) highval--; <span class="comment">//å ç©ºæ¯”é€æ¸å‡å°‘ï¼Œèˆµæœºæ¡¨å¾€0åº¦çš„ä½ç½®èµ°åŠ¨</span></span><br><span class="line">	<span class="keyword">if</span>(highval &lt; <span class="number">5</span>) dir = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(dir == <span class="number">0</span>) highval++; <span class="comment">//å ç©ºæ¯”é€æ¸å¢åŠ ï¼Œèˆµæœºæ¡¨å¾€180åº¦çš„ä½ç½®èµ°åŠ¨</span></span><br><span class="line">	<span class="keyword">if</span>(highval&gt;=<span class="number">24</span>)dir = <span class="number">1</span>; <span class="comment">//æµ‹è¯•å‘ç°ï¼Œ24å·²ç»æ˜¯èˆµæœºæ¡¨çš„å°½å¤´ï¼Œæ— éœ€å†™25</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="1-11-ä¸²å£é€šä¿¡"><a href="#1-11-ä¸²å£é€šä¿¡" class="headerlink" title="1.11 ä¸²å£é€šä¿¡"></a>1.11 ä¸²å£é€šä¿¡</h3><h4 id="1-11-1-ä¸²å£é€šä¿¡å…¥é—¨"><a href="#1-11-1-ä¸²å£é€šä¿¡å…¥é—¨" class="headerlink" title="1.11.1 ä¸²å£é€šä¿¡å…¥é—¨"></a>1.11.1 ä¸²å£é€šä¿¡å…¥é—¨</h4><p>å¯¹äºå•ç‰‡æœºæ¥è¯´ï¼Œé€šä¿¡åˆ™ä¸ä¼ æ„Ÿå™¨ã€å­˜å‚¨èŠ¯ç‰‡ã€å¤–å›´æ§åˆ¶èŠ¯ç‰‡ç­‰æŠ€æœ¯ç´§å¯†ç»“åˆï¼Œæˆä¸ºæ•´ä¸ªå•ç‰‡æœºç³»ç»Ÿçš„<code>ç¥ç»ä¸­æ¢</code>ã€‚</p>
<p><code>UART</code>ï¼ˆUniversal Asynchronous Receiver/Transmitterï¼Œå³<code>é€šç”¨å¼‚æ­¥æ”¶å‘å™¨</code>ï¼‰ä¸²è¡Œé€šä¿¡æ˜¯å•ç‰‡æœºæœ€å¸¸ç”¨çš„ä¸€ç§é€šä¿¡æŠ€æœ¯ï¼Œé€šå¸¸ç”¨äºå•ç‰‡æœºå’Œç”µè„‘ä¹‹é—´ä»¥åŠå•ç‰‡æœºå’Œå•ç‰‡æœºä¹‹é—´çš„é€šä¿¡ã€‚ </p>
<p>é€šä¿¡æŒ‰ç…§åŸºæœ¬ç±»å‹å¯ä»¥åˆ†ä¸º<code>å¹¶è¡Œé€šä¿¡</code>å’Œ<code>ä¸²è¡Œé€šä¿¡</code>ã€‚å¹¶è¡Œé€šä¿¡æ—¶æ•°æ®çš„å„ä¸ªä½åŒæ—¶ä¼ é€ï¼Œå¯ä»¥å®ç°å­—èŠ‚ä¸ºå•ä½é€šä¿¡ï¼Œä½†æ˜¯é€šä¿¡çº¿å¤šå ç”¨èµ„æºå¤šï¼Œæˆæœ¬é«˜ã€‚æ¯”å¦‚æˆ‘ä»¬å‰è¾¹ç”¨åˆ°çš„P0 = 0xFE;ä¸€æ¬¡ç»™ P0 çš„ 8 ä¸ª IO å£åˆ†åˆ«èµ‹å€¼ï¼ŒåŒæ—¶è¿›è¡Œä¿¡å·è¾“å‡ºï¼Œç±»ä¼¼äºæœ‰ 8 ä¸ªè½¦é“åŒæ—¶å¯ä»¥è¿‡å» 8 è¾†<br>è½¦ä¸€æ ·ï¼Œè¿™ç§å½¢å¼å°±æ˜¯å¹¶è¡Œçš„ï¼Œæˆ‘ä»¬ä¹ æƒ¯ä¸Šè¿˜ç§° P0ã€P1ã€P2 å’Œ P3 ä¸º 51 å•ç‰‡æœºçš„ 4 ç»„å¹¶è¡Œæ€»çº¿ã€‚ è€Œä¸²è¡Œé€šä¿¡ï¼Œå°±å¦‚åŒä¸€æ¡è½¦é“ï¼Œä¸€æ¬¡åªèƒ½ä¸€è¾†è½¦è¿‡å»ï¼Œå¦‚æœä¸€ä¸ª 0xFE è¿™æ ·ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®è¦ä¼ è¾“è¿‡å»çš„è¯ï¼Œå‡å¦‚ä½ä½åœ¨å‰é«˜ä½åœ¨åçš„è¯ï¼Œé‚£å‘é€æ–¹å¼å°±æ˜¯ 0-1-1-1-1-1-1-1-1ï¼Œä¸€ä½ä¸€ä½çš„å‘é€å‡ºå»çš„ï¼Œè¦å‘é€ 8 æ¬¡æ‰èƒ½å‘é€å®Œä¸€ä¸ªå­—èŠ‚ã€‚</p>
<p>STC89C52 æœ‰ä¸¤ä¸ªå¼•è„šæ˜¯ä¸“é—¨ç”¨æ¥åš UART ä¸²è¡Œé€šä¿¡çš„ï¼Œä¸€ä¸ªæ˜¯<code>P3.0</code>ä¸€ä¸ªæ˜¯<code>P3.1</code>ï¼Œå®ƒä»¬è¿˜åˆ†åˆ«æœ‰å¦å¤–çš„åå­—å«åš<code>RXD</code>å’Œ<code>TXD</code>ï¼Œç”±å®ƒä»¬ç»„æˆçš„é€šä¿¡æ¥å£å°±å«åš<code>ä¸²è¡Œæ¥å£</code>ï¼Œç®€ç§°<code>ä¸²å£</code>ã€‚ç”¨ä¸¤ä¸ªå•ç‰‡æœºè¿›è¡Œ UART ä¸²å£é€šä¿¡ï¼ŒåŸºæœ¬çš„æ¼”ç¤ºå›¾å¦‚å›¾æ‰€ç¤ºã€‚ </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645ce2300d2dde57772f7ab8.png" alt=""></p>
<p>å›¾ä¸­ï¼ŒGND è¡¨ç¤ºå•ç‰‡æœºç³»ç»Ÿç”µæºçš„å‚è€ƒåœ°ï¼ŒTXD æ˜¯ä¸²è¡Œå‘é€å¼•è„šï¼ŒRXD æ˜¯ä¸²è¡Œæ¥æ”¶å¼•è„šã€‚ä¸¤ä¸ªå•ç‰‡æœºä¹‹é—´è¦é€šä¿¡ï¼Œé¦–å…ˆ<code>ç”µæºåŸºå‡†</code>å¾—ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠä¸¤ä¸ªå•ç‰‡æœºçš„ GND ç›¸äº’è¿æ¥èµ·æ¥ï¼Œç„¶åå•ç‰‡æœº 1 çš„ TXD å¼•è„šæ¥åˆ°å•ç‰‡æœº 2 çš„ RXD å¼•è„šä¸Šï¼Œå³æ­¤è·¯ä¸ºå•ç‰‡æœº 1 å‘é€<br>è€Œå•ç‰‡æœº 2 æ¥æ”¶çš„é€šé“ï¼Œå•ç‰‡æœº 1 çš„ RXD å¼•è„šæ¥åˆ°å•ç‰‡æœº 2 çš„ TXD å¼•è„šä¸Šï¼Œå³æ­¤è·¯ä¸ºå•ç‰‡æœº 2 å‘é€è€Œå•ç‰‡æœº 1 æ¥æ”¶çš„é€šé“ã€‚</p>
<p>å½“å•ç‰‡æœº 1 æƒ³ç»™å•ç‰‡æœº 2 å‘é€æ•°æ®æ—¶ï¼Œæ¯”å¦‚å‘é€ä¸€ä¸ª 0xE4 è¿™ä¸ªæ•°æ®ï¼Œç”¨äºŒè¿›åˆ¶å½¢å¼è¡¨ç¤ºå°±æ˜¯ 0b11100100ï¼Œåœ¨ UART é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œæ˜¯ä½ä½å…ˆå‘ï¼Œé«˜ä½åå‘çš„åŸåˆ™ï¼Œé‚£ä¹ˆå°±è®© TXDé¦–å…ˆæ‹‰ä½ç”µå¹³ï¼ŒæŒç»­ä¸€æ®µæ—¶é—´ï¼Œå‘é€ä¸€ä½ 0ï¼Œç„¶åç»§ç»­æ‹‰ä½ï¼Œå†æŒç»­ä¸€æ®µæ—¶é—´ï¼Œåˆå‘é€äº†ä¸€ä½ 0ï¼Œç„¶åæ‹‰é«˜ç”µå¹³ï¼ŒæŒç»­ä¸€æ®µæ—¶é—´ï¼Œå‘äº†ä¸€ä½ 1â€¦â€¦ä¸€ç›´åˆ°æŠŠ 8 ä½äºŒè¿›åˆ¶æ•°å­— 0b11100100å…¨éƒ¨å‘é€å®Œæ¯•ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æåŠæŒç»­ä¸€æ®µæ—¶é—´ï¼Œé‚£ä¹ˆè¦æŒç»­å¤šä¹…å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å­¦ç›¸å…³æ¦‚å¿µã€‚</p>
<ul>
<li>æ³¢ç‰¹ç‡ï¼šæ³¢ç‰¹ç‡å°±æ˜¯å‘é€äºŒè¿›åˆ¶æ•°æ®ä½çš„<code>é€Ÿç‡</code>ï¼Œä¹ æƒ¯ä¸Šç”¨<code>baud</code>è¡¨ç¤ºï¼Œå³æˆ‘ä»¬å‘é€<code>ä¸€ä½äºŒè¿›åˆ¶æ•°æ®</code>çš„æŒç»­æ—¶é—´=<code>1/baud</code>ã€‚åœ¨é€šä¿¡ä¹‹å‰ï¼Œå•ç‰‡æœº 1 å’Œå•ç‰‡æœº 2 é¦–å…ˆéƒ½è¦æ˜ç¡®çš„çº¦å®šå¥½å®ƒä»¬ä¹‹é—´çš„é€šä¿¡æ³¢ç‰¹ç‡ï¼Œå¿…é¡»ä¿æŒä¸€è‡´ï¼Œæ”¶å‘åŒæ–¹æ‰èƒ½æ­£å¸¸å®ç°é€šä¿¡ã€‚å¸¸ç”¨çš„æ³¢ç‰¹ç‡ä¸º<code>9600</code>ï¼Œæ‰€è°“9600æŒ‡çš„æ˜¯ä¸€ç§’é’Ÿå•ç‰‡æœºå¯ä»¥å‘é€9600ä¸ªæ•°æ®ä½ï¼Œä¹Ÿå°±æ˜¯1ç§’é’Ÿçš„æ—¶é—´é‡Œå•ç‰‡æœºå¯ä»¥å‘é€(9600/8)=1200å­—èŠ‚ï¼Œä¸€ä¸ªå­—èŠ‚ç­‰äºå…«ä¸ªä½ï¼Œä¸€å­—èŠ‚ç­‰äºå…«æ¯”ç‰¹ï¼Œå› æ­¤<code>ä¸€ä¸ªå­—èŠ‚ç­‰äºå…«ä¸ªäºŒè¿›åˆ¶ä½</code>ã€‚</li>
</ul>
<p>æˆ‘ä»¬çŸ¥é“äº†æ¥å—ï¼ˆå‘é€ï¼‰æŒç»­çš„æ—¶é—´ï¼Œé‚£ä¹ˆå¦‚ä½•ç¡®å®šèµ·å§‹æˆ–åœæ­¢å‘é€çš„å‘¢ï¼Ÿ</p>
<ul>
<li>è§„å®šå½“<code>æ²¡æœ‰</code>é€šä¿¡ä¿¡å·å‘ç”Ÿæ—¶ï¼Œ<code>é€šä¿¡çº¿è·¯ä¿æŒé«˜ç”µå¹³</code>ï¼Œå½“è¦å‘é€æ•°æ®ä¹‹å‰ï¼Œ<code>å…ˆå‘ä¸€ä½ 0 è¡¨ç¤ºèµ·å§‹ä½</code>ï¼Œç„¶åå‘é€ 8 ä½æ•°æ®ä½ï¼Œæ•°æ®ä½æ˜¯<code>å…ˆä½åé«˜</code>çš„é¡ºåºï¼Œæ•°æ®ä½å‘å®Œå<code>å†å‘ä¸€ä½ 1 è¡¨ç¤ºåœæ­¢ä½</code>ã€‚è¿™æ ·æœ¬æ¥è¦å‘é€ä¸€ä¸ªå­—èŠ‚çš„ <code>8</code> ä½æ•°æ®ï¼Œè€Œå®é™…ä¸Šæˆ‘ä»¬ä¸€å…±å‘é€äº† <code>10</code>ä½ï¼Œå¤šå‡ºæ¥çš„ä¸¤ä½å…¶ä¸­ä¸€ä½èµ·å§‹ä½ï¼Œä¸€ä½åœæ­¢ä½ã€‚è€Œæ¥æ”¶æ–¹å‘¢ï¼ŒåŸæœ¬ä¸€ç›´ä¿æŒçš„é«˜ç”µå¹³ï¼Œä¸€æ—¦æ£€æµ‹åˆ°äº†ä¸€ä½ä½ç”µå¹³ï¼Œé‚£å°±çŸ¥é“äº†è¦å¼€å§‹å‡†å¤‡æ¥æ”¶æ•°æ®äº†ï¼Œæ¥æ”¶åˆ° 8 ä½æ•°æ®ä½åï¼Œç„¶åæ£€æµ‹åˆ°åœæ­¢ä½ï¼Œå†å‡†å¤‡ä¸‹ä¸€ä¸ªæ•°æ®çš„æ¥æ”¶ã€‚</li>
</ul>
<p>æˆ‘ä»¬ä»¥ä¸€ä¸ªå…·ä½“çš„ä¾‹å­æ„Ÿå—ä¸€ä¸‹ï¼Œå•ç‰‡æœºçš„<code>P3.1</code>ï¼ˆTXDï¼‰æ˜¯å‘é€å¼•è„šï¼Œä¹Ÿå°±æ˜¯è¯´è¦å‘é€å­—ç¬¦â€œAâ€ï¼Œè¿™ä¸ªå¼•è„šçš„å˜åŒ–å¦‚ä¸‹å›¾æ‰€ç¤º</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645ce5bc0d2dde577733dfa2.png" alt=""></p>
<p>å•ç‰‡æœºè¦å‘é€ä¸€ä¸ªå­—èŠ‚ç»™ç”µè„‘ç«¯ï¼Œé¦–å…ˆå‘é€å¼•è„šéœ€è¦å…ˆæ‹‰é«˜ï¼Œç„¶åæ‹‰ä½æŒç»­(1/9600)ç§’ï¼Œç”µè„‘ç«¯æ£€æµ‹åˆ°è¿™ä¸ªä½ç”µå¹³ä¿¡å·å°±ä¼šå‡†å¤‡æ¥æ”¶æ•°æ®å­—èŠ‚ã€‚ç„¶åæˆ‘ä»¬è¦å‘é€çš„äºŒè¿›åˆ¶ä½æ˜¯01000001ï¼Œä½†æ˜¯ä¸²å£é€šä¿¡å‘é€çš„å­—èŠ‚æ˜¯ä½ä½åœ¨å‰ï¼Œé«˜ä½åœ¨åï¼Œæ‰€ä»¥ä¸Šå›¾çš„å‘é€é¡ºåºå°±æ˜¯01000001åè¿‡æ¥ä¸º10000010ã€‚ä¸€ä¸ªå­—èŠ‚å‘é€å®Œæˆä¹‹åè¿˜è¦å‘é€ä¸€ä¸ªåœæ­¢ä½1ï¼Œç”µè„‘ç«¯æ¥æ”¶åˆ°è¿™ä¸ªåœæ­¢ä½å°±è®¤ä¸ºä¸€ä¸ªå­—èŠ‚å‘é€å®Œæˆäº†ã€‚</p>
<p>æˆ‘ä»¬ç”¨å®šæ—¶å™¨æ¥å®ç°å¼•è„šçš„æŒç»­æ—¶é—´ï¼Œæ€ä¹ˆå®šæ—¶(1/9600)ç§’æ€ä¹ˆè®¾ç½®ï¼Œè®¡ç®—ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<script type="math/tex; mode=display">
\frac{1}{9600} = X * (12 / 11059200)</script><p>è§£å¾—ï¼š$X = 96$ï¼Œå› ä¸ºå®šæ—¶æ—¶é—´é—´éš”æ¯”è¾ƒçŸ­ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å®šæ—¶å™¨0çš„å·¥ä½œæ¨¡å¼2å°±å¯ä»¥äº†ã€‚å¡«å……TH0çš„åˆå§‹å€¼å°±æ˜¯$256-96=160 \rightarrow 0xA0$ã€‚å› ä¸ºP3^1åœ¨<code>#include &lt;reg52.h&gt;</code>å·²æœ‰å®šä¹‰ä¸ºTXDï¼Œ æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚é€šè¿‡æŒ‰K4æ¥å¯åŠ¨å‘é€å­—èŠ‚æ•°æ®ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function,h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_Mode2_Init</span><span class="params">()</span> &#123;</span><br><span class="line">    TMOD &amp;= <span class="number">0xF0</span>; <span class="comment">//æ¸…é›¶ä½å››ä½</span></span><br><span class="line">    TMOD |= <span class="number">0x02</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼2</span></span><br><span class="line">    TH0 = <span class="number">0xA0</span>; <span class="comment">//è®¡ç®—å‡ºæ³¢ç‰¹ç‡9600</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    ET0 = <span class="number">1</span>; <span class="comment">//é—­åˆå®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³</span></span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    u8 key;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    KEY_Init(); <span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TIM0_Mode2_Init(); <span class="comment">//å®šæ—¶ï¼ˆ1 / 9600ï¼‰ç§’</span></span><br><span class="line">    TR0 = <span class="number">0</span>; <span class="comment">//å…³é—­å®šæ—¶å™¨</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        key = KEY_Scan(<span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">if</span>(key == <span class="number">4</span>) TR0 = <span class="number">1</span>; <span class="comment">//å¼€å¯å®šæ—¶å™¨ï¼Œå¯åŠ¨ä¸€ä¸ªå­—èŠ‚ä¼ è¾“ï¼ŒæŒ‰ä¸€æ¬¡ä¸€æ¬¡å‘é€</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    <span class="type">static</span> u8 cnt = <span class="number">0</span>, i, TXDBUF = <span class="number">65</span>; <span class="comment">//å­—ç¬¦`A`çš„ASCIIå€¼ä¸º65</span></span><br><span class="line">    cnt++; <span class="comment">//cntä¸€ç›´åœ¨1-10ä¹‹é—´å˜åŒ–</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(cnt == <span class="number">1</span>) TXD = <span class="number">0</span>; <span class="comment">//cntå˜ä¸º1ï¼Œå‘é€èµ·å§‹ä½ï¼Œè¿™æ¬¡çš„ä¸­æ–­å‡½æ•°å°±æ‰§è¡Œå®Œäº†ï¼ŒæŒç»­å¤Ÿ(1/9600)ç§’ä¹‹åï¼Œå†æ¬¡è¿›å…¥ä¸­æ–­å‡½æ•°ï¼Œç„¶åå°±æ˜¯å‘é€æ•°æ®å­—èŠ‚çš„8ä½çš„ä»»åŠ¡</span></span><br><span class="line">    <span class="keyword">if</span>(cnt &gt;= <span class="number">2</span> &amp;&amp; cnt &lt;= <span class="number">9</span>) &#123; <span class="comment">//å‘é€8ä½æ•°æ®ä½ï¼Œä»ä½ä½å¼€å§‹å¼•è„šçš„å˜åŒ–ä¸º 1 0 0 0 0 0 1 0</span></span><br><span class="line">        TXD = TXDBUF &amp; <span class="number">0x01</span>; <span class="comment">//è¦ä¹ˆç­‰äº1è¦ä¹ˆç­‰äº0ï¼Œè¿™æ ·P3.1çš„å¼•è„šè¦ä¹ˆä¿æŒé«˜ç”µå¹³ï¼Œè¦ä¹ˆä¿æŒä½ç”µå¹³</span></span><br><span class="line">        TXDBUF &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cnt == <span class="number">10</span>) &#123;</span><br><span class="line">        TXD = <span class="number">1</span>; <span class="comment">//å‘é€åœæ­¢ä½</span></span><br><span class="line">        TR0 = <span class="number">0</span>; <span class="comment">//å…³é—­å®šæ—¶å™¨ï¼Œç»“æŸä¸€æ¬¡å­—èŠ‚ä¼ è¾“</span></span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        i++;</span><br><span class="line">        TXDBUF = <span class="number">65</span>+i; <span class="comment">//ä¸‹æ¬¡æŒ‰ä¸‹æŒ‰é”®å‘é€çš„æ˜¯B C D E...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œç®€å•è¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ä»¬æŒ‰ä¸‹K4å¯åŠ¨äº†å®šæ—¶å™¨ï¼Œç„¶åç¬¬ä¸€æ¬¡è¿›å…¥ä¸­æ–­å‡½æ•°æ—¶ï¼Œåšçš„ä»»åŠ¡å°±æ˜¯æ‹‰ä½P3.1ï¼Œç„¶åè¿™æ¬¡çš„ä¸­æ–­å‡½æ•°çš„ä»»åŠ¡å°±ç»“æŸäº†ï¼Œç­‰è¿‡äº†(1/9600)ç§’ä¹‹åï¼Œå†æ¬¡è¿›å…¥ä¸­æ–­å‡½æ•°ï¼Œä¸Šä¸€æ¬¡æ‹‰ä½P3.1çš„æ—¶é—´å·²ç»æŒç»­å¤Ÿ(1/9600)ç§’äº†ï¼Œè¿™ç¬¬äºŒæ¬¡çš„ä¸­æ–­å‡½æ•°ä»»åŠ¡å°±æ˜¯æ‹‰é«˜P3.1ï¼Œå› ä¸ºå‘é€å­—ç¬¦Aè¿™ä¸ªå­—èŠ‚çš„æœ€ä½ä½ä¸º1ï¼ŒæŒç»­å¤Ÿ(1/9600)ç§’è¿›å…¥ç¬¬ä¸‰æ¬¡æ‰§è¡Œä¸­æ–­å‡½æ•°ï¼Œæ‹‰ä½P3.1ï¼Œç¬¬å››ï¼Œç¬¬äº”ï¼Œç¬¬å…­ï¼Œç¬¬ä¸ƒéƒ½æ˜¯æ‹‰ä½P3.1å‘é€0ï¼Œä»¥æ­¤ç±»æ¨ï¼Œåˆ°ç¬¬10æ¬¡ä¸­æ–­å‡½æ•°æ‰§è¡Œå°±æ˜¯æ‹‰é«˜P3.1å‘é€åœæ­¢ä½ï¼Œå…³é—­å®šæ—¶å™¨ç»“æŸä¸€æ¬¡å­—èŠ‚çš„ä¼ è¾“ï¼Œè¦æƒ³å†æ¬¡å‘é€éœ€è¦æŒ‰K4å¯åŠ¨å®šæ—¶å™¨ï¼Œ<code>TXDBUF=65+i;</code>è¡¨ç¤ºä¸‹æ¬¡å‘é€çš„æ˜¯66è¿™ä¸ªæ•°æ®ï¼Œå†ä¸‹æ¬¡å°±æ˜¯å‘é€67ï¼Œ68ä»¥æ­¤ç±»æ¨ã€‚</p>
<h4 id="1-11-2-è½¯ä»¶è®¾ç½®"><a href="#1-11-2-è½¯ä»¶è®¾ç½®" class="headerlink" title="1.11.2 è½¯ä»¶è®¾ç½®"></a>1.11.2 è½¯ä»¶è®¾ç½®</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645cf95e0d2dde57774de5bd.png" alt=""></p>
<p>ä¸‹è½½ä»¥ä¸Šä»£ç ï¼Œä¸æ–­æŒ‰ä¸‹Key4å¯ä»¥çœ‹è§æŒ‰è¾“å‡ºA B C D Cç­‰â€¦</p>
<h4 id="1-11-3-ä¸²å£é…ç½®å‡½æ•°"><a href="#1-11-3-ä¸²å£é…ç½®å‡½æ•°" class="headerlink" title="1.11.3 ä¸²å£é…ç½®å‡½æ•°"></a>1.11.3 ä¸²å£é…ç½®å‡½æ•°</h4><p>è¿™é‡Œè®²è§£ä¸€ä¸¤å¤„é…ç½®çš„çŸ¥è¯†ï¼Œé¦–å…ˆ<code>SCON=0x50;</code>æ˜¯è®©SCONå¯„å­˜å™¨çš„ç¬¬4ä½å’Œç¬¬6ä½çš„ç½®1ï¼Œå…¶ä»–ä½ç½®0ã€‚<code>TH1=256-(11059200/12/32/buad);</code>æ˜¯æ³¢ç‰¹ç‡è®¾ç½®çš„è®¡ç®—å…¬å¼ï¼Œç”±äºä¸²å£çš„ä½¿ç”¨æ˜¯è¦å ç”¨å®šæ—¶å™¨1ï¼Œé‚£ä¹ˆå®šæ—¶å™¨1çš„å®šæ—¶ä¸­æ–­å°†ä¸èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥å¿…é¡»ä½¿<code>ET1=0;</code>ç¦æ­¢å…¶äº§ç”Ÿå®šæ—¶ä¸­æ–­ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨äº†ä¸²å£ï¼Œé‚£ä¹ˆ<code>void TIM1_IRQHandler() interrupt 3</code>å°†ä¸èƒ½å†å‡ºç°åœ¨ç¨‹åºä¹¦å†™ä¸­ã€‚ä¸è¿‡ï¼Œä¸²å£ä¹Ÿæœ‰ç›¸åº”çš„ä¸­æ–­å‡½æ•°ï¼Œåƒ<code>ET0,ET1</code>ä¸€æ ·ï¼Œè¿™äº›éƒ½æ˜¯å­å¼€å…³ï¼Œä¸²å£ä¸­æ–­çš„å­å¼€å…³ä¸º<code>ES</code>ï¼Œ<code>ES=1;</code>å’Œ<code>EA=1;</code>å°±å¼€å¯äº†ä¸²å£çš„ä¸­æ–­å‡½æ•°ã€‚æˆ‘ä»¬ä¸²å£å‘é€æ•°æ®çš„æ—¶å€™ä¼šäº§ç”Ÿä¸­æ–­ï¼Œæ¥æ”¶åˆ°æ•°æ®çš„æ—¶å€™ä¹Ÿä¼šäº§ç”Ÿä¸­æ–­ï¼Œè¿™ä¸¤ä¸ªç¬é—´æˆ‘ä»¬åœ¨ä¸­æ–­å‡½æ•°é‡Œéœ€è¦æ‰§è¡Œç›¸å…³ä»»åŠ¡ã€‚è¦çŸ¥é“ä¸²å£æœ‰åŠ¨ä½œçš„æ—¶å€™ï¼Œæ€»ä¼šæœ‰<code>RI</code>æˆ–è€…<code>TI</code>è¢«ç½®1ï¼Œå‰è€…æ„ä¸º<code>æ¥æ”¶åˆ°å®Œæ•´çš„8ä½çš„æ•°æ®</code>ï¼Œä¹Ÿå°±ä½¿æ¥æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚ç„¶å<code>RI</code>å°±è¢«ç½®1.åè€…æ„ä¸º<code>å•ç‰‡æœºå‘é€å®Œä¸€ä¸ªå®Œæ•´çš„å­—èŠ‚äº†</code>ï¼Œ<code>TI</code>å°±è¢«ç½®1.è¿™äº›ç¬é—´éƒ½éœ€è¦æˆ‘ä»¬åœ¨ä¸²å£ä¸­æ–­å‡½æ•°ä¸­è®©å…¶æ¸…é›¶ï¼ˆè½¯ä»¶æ¸…é›¶ï¼‰ï¼Œä»¥å¤‡ä¸‹æ¬¡å®ƒä»¬èƒ½å†æ¬¡è¢«ç½®1ã€‚</p>
<p>ä¸‹é¢å®ç°çš„åŠŸèƒ½æ˜¯ç”µè„‘ç«¯é€šè¿‡ä¸²å£å‘é€ä¸€ä¸ªæ•°æ®ç»™å•ç‰‡æœºï¼Œè¿™ä¸ªæ•°æ®è¢«å•ç‰‡æœºæ¥æ”¶åˆ°ä¹‹åï¼Œè®©è¿™ä¸ªæ•°æ®å†åŠ 1ï¼Œç„¶åå•ç‰‡æœºå†é€šè¿‡ä¸²å£æŠŠåŠ 1åçš„æ•°æ®å‘é€å›å»ç»™ç”µè„‘ç«¯è®©å®ƒåœ¨çª—å£ä¸Šæ˜¾ç¤ºã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">u8 RXDBUF; <span class="comment">//ç¼“å­˜æ¥æ”¶åˆ°çš„æ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(u16 baud)</span> &#123;</span><br><span class="line">    SCON = <span class="number">0x50</span>; <span class="comment">//é…ç½®ä¸²å£ä¸ºæ¨¡å¼1</span></span><br><span class="line">    TMOD &amp;= <span class="number">0x0F</span>; <span class="comment">//æ¸…é›¶T1çš„æ§åˆ¶ä½</span></span><br><span class="line">    TMOD |= <span class="number">0x20</span>; <span class="comment">//é…ç½®T1ä¸ºæ¨¡å¼2</span></span><br><span class="line">    </span><br><span class="line">    TH1 = <span class="number">256</span> - (<span class="number">11059200</span>/<span class="number">12</span>/<span class="number">32</span>)/baud; <span class="comment">//è®¡ç®—T1çš„é‡è½½å€¼</span></span><br><span class="line">    TL1 = TH1; <span class="comment">//åˆå€¼ä¸ºé‡è½½å€¼</span></span><br><span class="line">    </span><br><span class="line">    ET1 = <span class="number">0</span>; <span class="comment">//ç¦æ­¢T1ä¸­æ–­</span></span><br><span class="line">    ES = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸²å£ä¸­æ–­</span></span><br><span class="line">    TR1 = <span class="number">1</span>; <span class="comment">//å¼€å¯å®šæ—¶å™¨1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    ConfigUART(<span class="number">9600</span>); <span class="comment">//ä¸²å£æ³¢ç‰¹ç‡è®¾ç½®ä¸º9600</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">InterruptUART</span><span class="params">()</span> interrupt 4 &#123;</span><br><span class="line">    <span class="keyword">if</span> (RI) &#123; <span class="comment">//RIç­‰äº1å°±æ»¡è¶³ifæ¡ä»¶è¯­å¥ï¼Œæ„ä¸ºæ¥æ”¶åˆ°ä¸€ä¸ªå­—èŠ‚</span></span><br><span class="line">        RI = <span class="number">0</span>; <span class="comment">//è½¯ä»¶æ¸…é›¶æ¥å—ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">        RXDBUF = SBUF; <span class="comment">//æ¥æ”¶åˆ°çš„æ•°æ®ä¿å­˜åˆ°æ¥æ”¶ç¼“å­˜å˜é‡ä¸­</span></span><br><span class="line">        SBUF = RXDBUF + <span class="number">1</span>; <span class="comment">//å‘é€å›å»ç»™ç”µè„‘ç«¯çš„æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (TI) &#123;</span><br><span class="line">        TI = <span class="number">0</span>; <span class="comment">//è½¯ä»¶æ¸…é›¶å‘é€ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e507f0d2dde577702a131.png" alt=""></p>
<p>è¿™é‡Œçš„ä¸²å£ä¸­æ–­å‡½æ•°ï¼Œåƒ<code>if(RI)TR=0;</code>å’Œ<code>if(TI)TI=0;</code>è¿™äº›éƒ½æ˜¯åœ¨ä¸²å£ä¸­æ–­å‡½æ•°ä¸­å¿…é¡»è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå½“ç„¶å¦‚æœåœ¨å…¶ä»–å‡½æ•°é‡Œæœ‰æ¸…é›¶è¿™ä¸¤ä¸ªä½ï¼Œå¯ä»¥ä¸ç”¨åœ¨ä¸²å£ä¸­æ–­å‡½æ•°ä¸­ä¹¦å†™ï¼Œä½†æ˜¯ä¸€å®šè¦<code>ä¿è¯æ¯æ¬¡éƒ½è¦æ¸…0</code>ã€‚</p>
<p><code>SBUF</code>æ˜¯åå­—ç›¸åŒä½†ä½œç”¨ä¸åŒçš„ç¼“å†²åŒºï¼Œ<code>SBUF=RXDBUF+1;</code>SBUFåœ¨ç­‰äºå·<code>å‰é¢</code>æ„ä¸ºè¿™ä¸ªæ˜¯å•ç‰‡æœºå‘é€ç»™ç”µè„‘ç«¯æ•°æ®çš„ç¼“å†²åŒºï¼Œä¸€æ—¦å‡ºç°<code>SBUF=xxxx;</code>è¿™æ ·çš„è¯­å¥ï¼Œé‚£å°±æ˜¯å•ç‰‡æœºå¼€å§‹é€šè¿‡ä¸²å£å‘é€æ•°æ®å‡ºå»ã€‚ä¸Šå›¾å¯ä»¥çœ‹è§ç°è±¡ã€‚</p>
<h4 id="1-11-4-ASCIIç ä¸é€šä¿¡æ•°æ®"><a href="#1-11-4-ASCIIç ä¸é€šä¿¡æ•°æ®" class="headerlink" title="1.11.4 ASCIIç ä¸é€šä¿¡æ•°æ®"></a>1.11.4 ASCIIç ä¸é€šä¿¡æ•°æ®</h4><p>é€šè¿‡å®éªŒæ“ä½œæ¥ç†Ÿæ‚‰ASCIIç ä¸é€šä¿¡æ•°æ®ä¹‹é—´çš„å…³ç³»ã€‚</p>
<p>ç°åœ¨å®ç°è¿™æ ·çš„åŠŸèƒ½ï¼š<code>åœ¨ç”µè„‘ç«¯ä¸Šå‘é€â€œåå…­è¿›åˆ¶â€æ¨¡å¼æˆ–â€œå­—ç¬¦æ ¼å¼â€æ¨¡å¼çš„å­—èŠ‚ç»™å•ç‰‡æœºï¼Œæ•°ç ç®¡åˆ™æ˜¾ç¤ºå‡ºè¿™äº›æ•°æ®çš„åè¿›åˆ¶å€¼ï¼Œç„¶åè§‚å¯Ÿæ•°ç ç®¡ä¸Šæ˜¾ç¤ºçš„æ•°å€¼ä¸å‘é€æ•°æ®çš„å…³ç³»</code>ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;timer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">u8 RXDBUF; <span class="comment">//ç¼“å­˜æ¥æ”¶åˆ°çš„æ•°æ®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(u16 baud)</span> &#123;</span><br><span class="line">    SCON = <span class="number">0x50</span>; <span class="comment">//é…ç½®ä¸²å£ä¸ºæ¨¡å¼1</span></span><br><span class="line">    TMOD &amp;= <span class="number">0X0F</span>; <span class="comment">//æ¸…é›¶T1çš„æ§åˆ¶ä½</span></span><br><span class="line">    TMOD |= <span class="number">0x20</span>; <span class="comment">//é…ç½®T1ä¸ºæ¨¡å¼2</span></span><br><span class="line">    </span><br><span class="line">    TH1 = <span class="number">256</span> - (<span class="number">11059200</span>/<span class="number">12</span>/<span class="number">32</span>)/baud; <span class="comment">//è®¡ç®—é‡è½½å€¼</span></span><br><span class="line">    TL1 = TH1; <span class="comment">//åˆå§‹å€¼ä¸ºé‡è½½å€¼</span></span><br><span class="line">    </span><br><span class="line">    ET1 = <span class="number">0</span>; <span class="comment">//ç¦æ­¢T1ä¸­æ–­</span></span><br><span class="line">    ES = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸²å£ä¸­æ–­</span></span><br><span class="line">    TR1 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//é—­åˆä¸­æ–­æ€»å¼€å…³</span></span><br><span class="line">    ConfigUART(<span class="number">9600</span>); <span class="comment">//é…ç½®æ³¢ç‰¹ç‡ä¸º9600</span></span><br><span class="line">    TIM0_Init(<span class="number">1000</span>, <span class="number">0</span>); <span class="comment">//å®šæ—¶1msï¼Œç”¨æ¥åˆ·æ–°æ•°ç ç®¡æ˜¾ç¤ºï¼Œå®šæ—¶ç²¾åº¦è¦æ±‚ä¸é«˜å¯ä»¥ä¸ä½¿ç”¨å¾®è°ƒ</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        ShowNumber(RXDBUF);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    TH0 = T0RH; <span class="comment">//é‡æ–°åŠ è½½åˆå§‹å€¼</span></span><br><span class="line">    TL0 = T0RL;</span><br><span class="line">    SEG_Scan();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">InterruptUART</span><span class="params">()</span> interrupt 4 &#123;</span><br><span class="line">    <span class="keyword">if</span>(RI) &#123;</span><br><span class="line">        RI = <span class="number">0</span>; <span class="comment">//æ‰‹åŠ¨æ¸…é›¶æ¥æ”¶ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">        RXDBUF = SBUF; <span class="comment">//æ¥æ”¶åˆ°çš„æ•°æ®ä¿å­˜åˆ°æ¥æ”¶ç¼“å­˜å˜é‡ä¸­</span></span><br><span class="line">        SBUF = RXDBUF; <span class="comment">//æ¥æ”¶åˆ°çš„æ•°æ®åˆç›´æ¥å‘å›ï¼Œå«åš-&quot;echo&quot;,ç”¨ä»¥æç¤ºç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ˜¯å¦ä»¥æ­£ç¡®æ¥æ”¶</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(TI) &#123;</span><br><span class="line">        TI = <span class="number">0</span>; <span class="comment">//è½¯ä»¶æ¸…é›¶å‘é€ä¸­æ–­æ ‡å¿—ä½</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å‘é€çª—å£å’Œæ¥æ”¶çª—å£éƒ½é€‰â€œåå…­è¿›åˆ¶â€æ¨¡å¼ï¼Œç”µè„‘ç«¯å‘é€ä¸€ä¸ª8çš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯0x08ï¼‰çš„å­—èŠ‚ç»™å•ç‰‡æœºï¼Œç„¶åå•ç‰‡æœºä¼šå‘é€å›æ¥è¿™ä¸ªæ•°æ®ç»™ç”µè„‘ç«¯æ˜¾ç¤ºåœ¨çª—å£ä¸­ã€‚æ­¤æ—¶å¼€å‘æ¿ä¸Šçš„æ•°ç ç®¡æ˜¾ç¤ºçš„æ˜¯8ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e5c2d0d2dde577715cea5.png" alt="image-20230512233102479"></p>
<p>æ¥ç€æˆ‘ä»¬åœ¨ç”µè„‘ç«¯å‘é€çš„æ˜¯10ï¼Œè¿™æ˜¯0x10,ä¸è¦ä¸åè¿›åˆ¶çš„10æ··æ·†ã€‚æ•°ç ç®¡æ˜¾ç¤ºçš„æ˜¯16ï¼Œæ‰€ä»¥å‘é€çš„æ•°æ®ç”¨åè¿›åˆ¶æ˜¾ç¤ºåœ¨æ•°ç ç®¡ä¸Šæ˜¯æ­£ç¡®çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e5d4e0d2dde577717dec0.png" alt=""></p>
<p>æˆ‘ä»¬åˆ‡æ¢åˆ°<code>å­—ç¬¦æ ¼å¼</code>æ¨¡å¼ä¸‹å‘é€å­—ç¬¦<code>A</code>ã€‚æ•°ç ç®¡æ˜¾ç¤ºçš„æ˜¯65ï¼Œç”µè„‘ç«¯æ¥æ”¶åˆ°å•ç‰‡æœºå‘é€å›æ¥çš„æ•°æ®æ˜¯0x41ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶ä¸‹çš„65ã€‚</p>
<p>æ‰¾åˆ°ASCIIè¡¨ï¼Œå­—ç¬¦â€œAâ€å¯¹åº”çš„æ•°åˆšå¥½æ˜¯65ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e5de80d2dde577718d866.png" alt=""></p>
<p>å¦‚æœæŠŠç”µè„‘ç«¯æ¥æ”¶çª—å£æ”¹ä¸ºâ€œå­—ç¬¦æ ¼å¼â€æ˜¾ç¤ºï¼Œé‚£ä¹ˆæ˜¾ç¤ºçš„å†…å®¹å°±è·Ÿå‘é€çª—å£çš„å­—ç¬¦ä¸€æ ·äº†ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e5e580d2dde57771977bd.png" alt=""></p>
<p>å¦‚æœæˆ‘ä»¬åœ¨ç”µè„‘ç«¯å‘é€çª—å£è¾“å…¥ä¸€ä¸²å­—ç¬¦æ¯”å¦‚â€œABCD123â€ç‚¹å‡»å‘é€ç»™å•ç‰‡æœºï¼Œå¦‚æœæˆ‘ä»¬çœ‹åˆ°çš„æ˜¯ä¸‹é¢è¿™ä¸ªç°è±¡</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/645e5edd0d2dde57771a9e19.png" alt=""></p>
<p>é‚£ä¹ˆç»“åˆä»¥ä¸‹çš„ç¨‹åºä»£ç åˆ†æ<code>RXDBUF = SBUF;SBUF = RXDBUF;</code>ä¹Ÿå°±æ˜¯ç”µè„‘ç«¯å…ˆå‘é€å­—ç¬¦<code>A</code>ç»™å•ç‰‡æœºï¼Œå•ç‰‡æœºé©¬ä¸Šå‘é€å›å­—ç¬¦<code>A</code>ç»™ç”µè„‘ç«¯ï¼Œæ¥ç€ç”µè„‘ç«¯åˆå‘é€å­—ç¬¦<code>B</code>ï¼Œå¦‚æ­¤æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°å‘é€å®Œæœ€åä¸€ä¸ªå­—ç¬¦<code>4</code>ã€‚</p>
<p>è¿™äº›å‘é€å’Œæ¥æ”¶è¿‡ç¨‹æ˜¯éå¸¸å¿«çš„ï¼Œå› ä¸ºå•ç‰‡æœºæ¥æ”¶ç¼“å­˜åŒºSBUFæ¯æ¬¡åªèƒ½æš‚å­˜ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å‰é¢8ä¸ªå­—èŠ‚éƒ½ä¼šå¾ˆå¿«è¢«æ›¿æ¢ï¼Œå¯¼è‡´æ•°ç ç®¡åœ¨ä¸€ç¬é—´é‡Œåªæ˜¾ç¤ºå­—ç¬¦<code>4</code>çš„ASCIIç å€¼52ã€‚</p>
<h4 id="1-11-5-printfç³»åˆ—çš„å‡½æ•°å®ç°"><a href="#1-11-5-printfç³»åˆ—çš„å‡½æ•°å®ç°" class="headerlink" title="1.11.5 printfç³»åˆ—çš„å‡½æ•°å®ç°"></a>1.11.5 printfç³»åˆ—çš„å‡½æ•°å®ç°</h4><p>æ‡‚å¾—äº†å•ç‰‡æœºé€šè¿‡ä¸²å£ä¼ è¾“æ•°æ®ç»™ç”µè„‘ç«¯å£çª—å£æŸ¥çœ‹ï¼Œé‚£ä¹ˆï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å‘é€å­—ç¬¦ä¸²ï¼Œæœ‰æ—¶éœ€è¦å‘é€ä¸€ä¸ªå˜é‡çš„æ•°å€¼æ˜¯å¤šå°‘ï¼Œä»¥åŠè¿˜è¦å‘é€å›è½¦æ¢è¡Œè¿™ä¸‰ç§æƒ…å†µï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ä¸‰ä¸ªåŠŸèƒ½å‡½æ•°å°è£…èµ·æ¥ï¼Œæ–¹ä¾¿åç»­çš„ä¸²å£ä½¿ç”¨ã€‚</p>
<ol>
<li><code>void printf_str(u8 *str)</code>å‡½æ•°å°±æ˜¯ä¸“é—¨ç”¨æ¥å‘é€å­—ç¬¦ä¸²ç»™ç”µè„‘ç«¯çš„ã€‚</li>
<li><code>void printf_num(u32 num)</code>å‡½æ•°å‘é€çš„å˜é‡æ•°å€¼åªæ”¯æŒæ˜¾ç¤ºåè¿›åˆ¶æ•°<code>0-4294967295</code>,ä¹Ÿå°±æ˜¯å‚æ•°u32ç±»å‹ã€‚</li>
<li><code>void printf_rn()</code>å°±æ˜¯å‘é€å›è½¦æ¢è¡Œç¬¦ã€‚</li>
</ol>
<p>è¿™é‡Œçš„ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦æ…¢æ…¢å¼„æ‡‚ï¼Œç°åœ¨ä¸æ‡‚ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œåé¢æ…¢æ…¢æ¶ˆåŒ–ã€‚æˆ‘ä»¬å¸Œæœ›ä¸²å£è¿™éƒ¨åˆ†åŠŸèƒ½æ¨¡å—ä¹Ÿèƒ½åƒå®šæ—¶å™¨é‚£æ ·å°è£…ä¸€ä¸ªå•ç‹¬æ–‡ä»¶ä½¿ç”¨ï¼Œæ‰€ä»¥åˆ›å»ºå·<code>uart.c</code>å’Œ<code>uart.h</code>æ–‡ä»¶ï¼Œå¤åˆ¶ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uart.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(u16 baud)</span></span><br><span class="line">&#123;</span><br><span class="line">    SCON  = <span class="number">0x50</span>;  <span class="comment">//é…ç½®ä¸²å£ä¸ºæ¨¡å¼1</span></span><br><span class="line">    TMOD &amp;= <span class="number">0x0F</span>;  <span class="comment">//æ¸…é›¶T1çš„æ§åˆ¶ä½</span></span><br><span class="line">    TMOD |= <span class="number">0x20</span>;  <span class="comment">//é…ç½®T1ä¸ºæ¨¡å¼2</span></span><br><span class="line">    TH1 = <span class="number">256</span> - (<span class="number">11059200</span>/<span class="number">12</span>/<span class="number">32</span>)/baud;<span class="comment">//è®¡ç®—T1é‡è½½å€¼</span></span><br><span class="line">    TL1 = TH1;     <span class="comment">//åˆå€¼ç­‰äºé‡è½½å€¼</span></span><br><span class="line">    ET1 = <span class="number">0</span>;       <span class="comment">//ç¦æ­¢T1ä¸­æ–­</span></span><br><span class="line">    ES  = <span class="number">1</span>;       <span class="comment">//ä½¿èƒ½ä¸²å£ä¸­æ–­</span></span><br><span class="line">    TR1 = <span class="number">1</span>;       <span class="comment">//å¯åŠ¨T1</span></span><br><span class="line">&#125; </span><br><span class="line">    </span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_str</span><span class="params">(u8 *str)</span></span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">while</span>(*str != <span class="string">&#x27;\0&#x27;</span>)<span class="comment">//è¿ç»­å‘é€å­—ç¬¦ä¸²æ•°æ®ï¼Œç›´åˆ°æ£€æµ‹åˆ°ç»“æŸç¬¦</span></span><br><span class="line">    &#123;</span><br><span class="line">        SBUF=*str++;</span><br><span class="line">        <span class="keyword">while</span>(!TI);    <span class="comment">//ç­‰å¾…å­—èŠ‚å‘é€å®ŒæˆTIè¢«ç½®1å°±é€€å‡ºè¿™ä¸ªwhileå¾ªç¯</span></span><br><span class="line">        TI = <span class="number">0</span>;        <span class="comment">//æ¸…0æ ‡å¿—ä½</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_num</span><span class="params">(u32 num)</span></span><br><span class="line">&#123;</span><br><span class="line">    u8 buf[<span class="number">10</span>];</span><br><span class="line">    <span class="type">char</span> i;<span class="comment">//å–å€¼èŒƒå›´ä¸º-128~127</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)       <span class="comment">//æŠŠé•¿æ•´å‹æ•°è½¬æ¢ä¸º10ä½åè¿›åˆ¶çš„æ•°ç»„</span></span><br><span class="line">    &#123;</span><br><span class="line">        buf[i] = num % <span class="number">10</span>;</span><br><span class="line">        num = num / <span class="number">10</span>;        <span class="comment">//èˆæ‰ä¸ªä½æ•°ï¼Œé‡æ–°è£…è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">9</span>; i&gt;=<span class="number">1</span>; i--)  </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (buf[i] != <span class="number">0</span>)<span class="keyword">break</span>; <span class="comment">//ä»æœ€é«˜ä½èµ·ï¼Œé‡åˆ°0ä¸ç†ä¼šï¼Œé‡åˆ°é0åˆ™é€€å‡ºå¾ªç¯</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(i&gt;=<span class="number">0</span>)          <span class="comment">//å‰©ä½™ä½ä½éƒ½å¦‚å®å‘é€å‡ºå»</span></span><br><span class="line">    &#123;   </span><br><span class="line">        SBUF=<span class="string">&#x27;0&#x27;</span>+buf[i]; <span class="comment">//å¦‚æœæ­¤æ—¶çš„buf[i]çš„å€¼æ˜¯1ï¼Œé‚£ä¹ˆç”µè„‘ç«¯çª—å£åœ¨â€œå­—ç¬¦æ ¼å¼â€æ¨¡å¼ä¸‹è¦æƒ³æ˜¾ç¤ºå­—ç¬¦â€œ1â€ï¼Œåªéœ€&#x27;0&#x27;+1ï¼Œå› ä¸ºâ€˜0â€™å°±æ˜¯ASCIIç å€¼48</span></span><br><span class="line">        <span class="keyword">while</span>(!TI);      <span class="comment">//ç­‰å¾…å­—èŠ‚å‘é€å®ŒæˆTIè¢«ç½®1å°±é€€å‡ºè¿™ä¸ªwhileå¾ªç¯</span></span><br><span class="line">        TI = <span class="number">0</span>;          <span class="comment">//æ¸…0æ ‡å¿—ä½</span></span><br><span class="line">        i--;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_rn</span><span class="params">()</span> <span class="comment">//å‘é€å›è½¦æ¢è¡Œç¬¦</span></span><br><span class="line">&#123;</span><br><span class="line">    SBUF=<span class="string">&#x27;\r&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(!TI);  <span class="comment">//ç­‰å¾…å­—èŠ‚å‘é€å®ŒæˆTIè¢«ç½®1å°±é€€å‡ºè¿™ä¸ªwhileå¾ªç¯</span></span><br><span class="line">    TI = <span class="number">0</span>;      <span class="comment">//æ¸…0æ ‡å¿—ä½</span></span><br><span class="line">    </span><br><span class="line">    SBUF=<span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span>(!TI);  <span class="comment">//ç­‰å¾…å­—èŠ‚å‘é€å®ŒæˆTIè¢«ç½®1å°±é€€å‡ºè¿™ä¸ªwhileå¾ªç¯</span></span><br><span class="line">    TI = <span class="number">0</span>;      <span class="comment">//æ¸…0æ ‡å¿—ä½</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// uart.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __UART_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __UART_H__</span></span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(u16 baud)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_str</span><span class="params">(u8 *str)</span>;<span class="comment">//å‘é€å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_num</span><span class="params">(u32 num)</span>;<span class="comment">//å‘é€å‚æ•°çš„æ•°å€¼</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">printf_rn</span><span class="params">()</span>;        <span class="comment">//å‘é€å›è½¦æ¢è¡Œç¬¦</span></span><br><span class="line">   </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;uart.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u8 key;</span><br><span class="line">    u32 value=<span class="number">65535</span>;</span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>;    <span class="comment">//é—­åˆæ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    ConfigUART(<span class="number">9600</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;  </span><br><span class="line">        key=KEY_Scan(<span class="number">0</span>,<span class="number">1000</span>);</span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            printf_str(<span class="string">&quot;value=&quot;</span>);<span class="comment">//å‘é€å­—ç¬¦ä¸²</span></span><br><span class="line">            printf_num(value);   <span class="comment">//å‘é€å˜é‡çš„æ•°å€¼</span></span><br><span class="line">            printf_rn();         <span class="comment">//å‘é€å›è½¦æ¢è¡Œç¬¦</span></span><br><span class="line">            value++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">InterruptUART</span><span class="params">()</span> interrupt 4</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (RI)    <span class="comment">//æ¥æ”¶åˆ°å­—èŠ‚</span></span><br><span class="line">    &#123;</span><br><span class="line">        RI = <span class="number">0</span>;<span class="comment">//æ‰‹åŠ¨æ¸…é›¶æ¥æ”¶ä¸­æ–­æ ‡å¿—ä½                     </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸²å£ä¸­æ–­å‡½æ•°ä¸­æˆ‘ä»¬æ²¡æœ‰å†å†™â€œif(TI){ TI = 0; }â€,é‚£æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨æ‰€æœ‰çš„å‘é€å‡½æ•°ä¸­éƒ½åšäº†TIçš„æ¸…0å¤„ç†ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸²å£ä¸­æ–­å‡½æ•°ä¸­ä¸ç”¨å†ä¹¦å†™TIã€‚</p>
<p>ä¸æ–­æŒ‰ä¸‹Key4æŒ‰é”®ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°ä¸²å£åŠ©æ‰‹å‡ºç°å­—ç¬¦ä¸²ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/646094a20d2dde5777b7bd58.png" alt=""></p>
<h3 id="1-12-1602æ¶²æ™¶å±"><a href="#1-12-1602æ¶²æ™¶å±" class="headerlink" title="1.12 1602æ¶²æ™¶å±"></a>1.12 1602æ¶²æ™¶å±</h3><h2 id="äºŒã€å®æˆ˜æ•™å­¦ä»¥åŠä½œå“å±•ç¤º"><a href="#äºŒã€å®æˆ˜æ•™å­¦ä»¥åŠä½œå“å±•ç¤º" class="headerlink" title="äºŒã€å®æˆ˜æ•™å­¦ä»¥åŠä½œå“å±•ç¤º"></a>äºŒã€å®æˆ˜æ•™å­¦ä»¥åŠä½œå“å±•ç¤º</h2><h3 id="2-1-LED"><a href="#2-1-LED" class="headerlink" title="2.1 LED"></a>2.1 LED</h3><h4 id="2-1-1-ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯"><a href="#2-1-1-ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯" class="headerlink" title="2.1.1 ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯"></a>2.1.1 ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯</h4><h5 id="2-1-1-1-æºç "><a href="#2-1-1-1-æºç " class="headerlink" title="2.1.1.1 æºç "></a>2.1.1.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit LED= P2^<span class="number">0</span>; <span class="comment">// ç›´æ¥ä½¿ç”¨sbit æ§åˆ¶P0^0ä¸€ä¸ªä½</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	LED = <span class="number">0</span>; <span class="comment">// ä½ç”µå¹³ç‚¹ç¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>); <span class="comment">// æ­»å¾ªç¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-1-2-ä»¿çœŸ"><a href="#2-1-1-2-ä»¿çœŸ" class="headerlink" title="2.1.1.2 ä»¿çœŸ"></a>2.1.1.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bb98b6ea21b9a9e23ed62.gif" alt=""></p>
<h5 id="2-1-1-3-å®ç‰©"><a href="#2-1-1-3-å®ç‰©" class="headerlink" title="2.1.1.3 å®ç‰©"></a>2.1.1.3 å®ç‰©</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">   </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>; <span class="comment">//</span></span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">// ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">// **************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">// è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">// ***************************</span></span><br><span class="line">	</span><br><span class="line">	LED = <span class="number">0</span>; <span class="comment">//ç‚¹äº®æœ€å³è¾¹çš„ç¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bbc7c6ea21b9a9e3cf947.png" alt=""></p>
<h4 id="2-1-2-é—ªçƒçš„LEDç¯"><a href="#2-1-2-é—ªçƒçš„LEDç¯" class="headerlink" title="2.1.2 é—ªçƒçš„LEDç¯"></a>2.1.2 é—ªçƒçš„LEDç¯</h4><div class="tip warning faa-horizontal animated"><p>å»¶æ—¶æ˜¯å•ç‰‡æœºå…¥é—¨å¿…å­¦çš„åº”ç”¨ï¼</p>
</div>
<h5 id="2-1-2-1-æºç "><a href="#2-1-2-1-æºç " class="headerlink" title="2.1.2.1 æºç "></a>2.1.2.1 æºç </h5><p>æœ‰äº†å‰é¢çš„åŸºç¡€ï¼Œç‚¹ç¯è‚¯å®šä¸æ˜¯é—®é¢˜ï¼Œè¿™é‡Œå®ç°è®©LEDä»ç‚¹äº®ä¸€æ®µæ—¶é—´åˆ°ç†„ç­ä¸€æ®µæ—¶é—´å†ç‚¹äº®ä¸€æ®µæ—¶é—´å¦‚æ­¤å¾ªç¯ä¸‹å»ï¼Œå®ç°<code>é—ªçƒ</code>LEDçš„åŠŸèƒ½ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„æˆ‘ä»¬éœ€è¦å®ç°å»¶è¿Ÿå‡½æ•°<code>for(i=0;i&lt;30000;i++);</code>æ˜¯æœ€ç®€å•çš„å»¶æ—¶è¯­å¥ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED = P2^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		LED = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">3000</span>; i++);</span><br><span class="line">		LED = <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">3000</span>; i++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-2-2-ä»¿çœŸ"><a href="#2-1-2-2-ä»¿çœŸ" class="headerlink" title="2.1.2.2 ä»¿çœŸ"></a>2.1.2.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bc0326ea21b9a9e5ef73c.gif" alt=""></p>
<h5 id="2-1-2-3-å®ç‰©"><a href="#2-1-2-3-å®ç‰©" class="headerlink" title="2.1.2.3 å®ç‰©"></a>2.1.2.3 å®ç‰©</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">		ENLED = <span class="number">0</span>; <span class="comment">//å®šä¹‰ä¸€ä¸ª16ä½æ— ç¬¦å·æ•´å½¢å˜é‡</span></span><br><span class="line">		ADDR3 = <span class="number">1</span>; <span class="comment">// ä¸‰å…«è¯‘ç å™¨ä½¿èƒ½</span></span><br><span class="line">		</span><br><span class="line">		ADDR2 = <span class="number">1</span>; <span class="comment">//******************************</span></span><br><span class="line">		ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">		ADDR0 = <span class="number">0</span>; <span class="comment">//******************************</span></span><br><span class="line">	</span><br><span class="line">		<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">			LED = <span class="number">0</span>; <span class="comment">//ç‚¹äº®æœ€å³è¾¹çš„å°ç¯</span></span><br><span class="line">			<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">3000</span>; i++); <span class="comment">//å»¶è¿Ÿä¸€æ®µæ—¶é—´</span></span><br><span class="line">			LED = <span class="number">1</span>; <span class="comment">//ç†„ç­æœ€å³è¾¹çš„å°ç¯</span></span><br><span class="line">			<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">3000</span>; i++); <span class="comment">//å»¶è¿Ÿä¸€æ®µæ—¶é—´</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="tip warning faa-horizontal animated"><p>å…³äºå•ç‰‡æœºè®¾è®¡ç²¾ç¡®çš„å»¶è¿Ÿï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« çš„ç¬¬ä¸‰ç« çš„Delay()å‡½æ•°</p>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…ï¼Œå»¶è¿Ÿä¸€ç§’</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;<span class="comment">//å®šä¹‰ä¸¤ä¸ª16ä½çš„å˜é‡  </span></span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line"> </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED2=<span class="number">0</span>;<span class="comment">//ç‚¹äº®æœ€å³ç«¯çš„ç¯</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">        LED2=<span class="number">1</span>;<span class="comment">//ç†„ç­æœ€å³ç«¯çš„ç¯</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-3-ä¸‰ä¸ªå°ç¯åŒæ—¶é—ªçƒ"><a href="#2-1-3-ä¸‰ä¸ªå°ç¯åŒæ—¶é—ªçƒ" class="headerlink" title="2.1.3 ä¸‰ä¸ªå°ç¯åŒæ—¶é—ªçƒ"></a>2.1.3 ä¸‰ä¸ªå°ç¯åŒæ—¶é—ªçƒ</h4><h5 id="2-1-3-1-æºç "><a href="#2-1-3-1-æºç " class="headerlink" title="2.1.3.1 æºç "></a>2.1.3.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="comment">// åŸç†å¾ˆç®€å•æ§åˆ¶P2^0,P2^1,P2^2å£çš„é«˜ä½ç”µå¹³å³å¯</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;reg52.h&quot;</span> <span class="comment">// å¼•å…¥8051å•ç‰‡æœºå¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line">sbit LED1 = P2^<span class="number">0</span>; <span class="comment">// å®šä¹‰LED1å¼•è„šä¸ºP1.0</span></span><br><span class="line">sbit LED2 = P2^<span class="number">1</span>; <span class="comment">// å®šä¹‰LED2å¼•è„šä¸ºP1.1</span></span><br><span class="line">sbit LED3 = P2^<span class="number">2</span>; <span class="comment">// å®šä¹‰LED3å¼•è„šä¸ºP1.2</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">		<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) <span class="comment">// æ— é™å¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        LED1 = <span class="number">0</span>;</span><br><span class="line">        LED2 = <span class="number">0</span>;</span><br><span class="line">        LED3 = <span class="number">0</span>;</span><br><span class="line">			</span><br><span class="line">				<span class="comment">// å»¶æ—¶ä¸€æ®µæ—¶é—´ï¼Œä½¿LEDä¿æŒç†„ç­çŠ¶æ€</span></span><br><span class="line">        <span class="comment">// å¯æ ¹æ®éœ€è¦è°ƒæ•´å»¶æ—¶æ—¶é—´</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; <span class="number">500</span>;i++);</span><br><span class="line">        </span><br><span class="line">        LED1 = <span class="number">1</span>;<span class="comment">// å°†LED1å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED1</span></span><br><span class="line">        LED2 = <span class="number">1</span>;<span class="comment">// å°†LED2å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED2</span></span><br><span class="line">        LED3 = <span class="number">1</span>;<span class="comment">// å°†LED3å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED3</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å»¶æ—¶ä¸€æ®µæ—¶é—´ï¼Œä½¿LEDä¿æŒç†„ç­çŠ¶æ€</span></span><br><span class="line">        <span class="comment">// å¯æ ¹æ®éœ€è¦è°ƒæ•´å»¶æ—¶æ—¶é—´</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">500</span>;i++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-3-2-ä»¿çœŸ"><a href="#2-1-3-2-ä»¿çœŸ" class="headerlink" title="2.1.3.2 ä»¿çœŸ"></a>2.1.3.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64206b97a682492fcc53043f.gif" alt=""></p>
<h5 id="2-1-3-3-å®ç‰©"><a href="#2-1-3-3-å®ç‰©" class="headerlink" title="2.1.3.3 å®ç‰©"></a>2.1.3.3 å®ç‰©</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;reg52.h&quot;</span> <span class="comment">// å¼•å…¥8051å•ç‰‡æœºå¤´æ–‡ä»¶</span></span></span><br><span class="line"></span><br><span class="line">sbit LED1 = P0^<span class="number">0</span>; <span class="comment">// å®šä¹‰LED1å¼•è„šä¸ºP1.0</span></span><br><span class="line">sbit LED2 = P0^<span class="number">1</span>; <span class="comment">// å®šä¹‰LED2å¼•è„šä¸ºP1.1</span></span><br><span class="line">sbit LED3 = P0^<span class="number">2</span>; <span class="comment">// å®šä¹‰LED3å¼•è„šä¸ºP1.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å¯æ€»å¼€å…³</span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">		<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">		ENLED = <span class="number">0</span>;</span><br><span class="line">		ADDR3 = <span class="number">1</span>;</span><br><span class="line">		ADDR2 = <span class="number">1</span>;</span><br><span class="line">		ADDR1 = <span class="number">1</span>;</span><br><span class="line">		ADDR0 = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) <span class="comment">// æ— é™å¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        LED1 = <span class="number">0</span>;</span><br><span class="line">        LED2 = <span class="number">0</span>;</span><br><span class="line">        LED3 = <span class="number">0</span>;</span><br><span class="line">			</span><br><span class="line">				<span class="comment">// å»¶æ—¶ä¸€æ®µæ—¶é—´ï¼Œä½¿LEDä¿æŒç†„ç­çŠ¶æ€</span></span><br><span class="line">        <span class="comment">// å¯æ ¹æ®éœ€è¦è°ƒæ•´å»¶æ—¶æ—¶é—´</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; <span class="number">5000</span>;i++);</span><br><span class="line">        </span><br><span class="line">        LED1 = <span class="number">1</span>;<span class="comment">// å°†LED1å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED1</span></span><br><span class="line">        LED2 = <span class="number">1</span>;<span class="comment">// å°†LED2å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED2</span></span><br><span class="line">        LED3 = <span class="number">1</span>;<span class="comment">// å°†LED3å¼•è„šç½®ä¸ºé«˜ç”µå¹³ï¼Œç†„ç­LED3</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å»¶æ—¶ä¸€æ®µæ—¶é—´ï¼Œä½¿LEDä¿æŒç†„ç­çŠ¶æ€</span></span><br><span class="line">        <span class="comment">// å¯æ ¹æ®éœ€è¦è°ƒæ•´å»¶æ—¶æ—¶é—´</span></span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">5000</span>;i++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div align=center class="aspect-ratio">
    <iframe src="https://player.bilibili.com/player.html?aid=439229886&bvid=BV1sL411X7Vy&cid=1072639348&page=1&autoplay=0&autoplay=0" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>

<h5 id="2-1-3-4-ä¼˜åŒ–"><a href="#2-1-3-4-ä¼˜åŒ–" class="headerlink" title="2.1.3.4 ä¼˜åŒ–"></a>2.1.3.4 ä¼˜åŒ–</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®ºï¼Œé€šè¿‡æ§åˆ¶P0</span></span><br><span class="line"><span class="comment">// é€šè¿‡P0</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>;j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	P2 = <span class="number">0xF8</span>; <span class="comment">// 1111 1000 -&gt; 0xF8</span></span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">	P2 = <span class="number">0xFF</span>;</span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>;j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>;</span><br><span class="line">	ADDR1 = <span class="number">1</span>;</span><br><span class="line">	ADDR0 = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	P0 = <span class="number">0xF8</span>; <span class="comment">// 1111 1000 -&gt; 0xF8</span></span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">	P0 = <span class="number">0xFF</span>;</span><br><span class="line">	delay(<span class="number">500</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-4-æµæ°´ç¯"><a href="#2-1-4-æµæ°´ç¯" class="headerlink" title="2.1.4 æµæ°´ç¯"></a>2.1.4 æµæ°´ç¯</h4><p>å®ç°æµæ°´ç¯çš„ä»£ç æˆ‘ä»¬åœ¨ç¬¬ä¸€ç« çš„æ•™å­¦ä¸­å°±å·²ç»ç»™å‡ºäº†ï¼Œè¿™é‡Œç»™å‡ºä½¿ç”¨<code>P0</code>å£å®ç°çš„æ–¹å¼ï¼Œæˆ‘ä»¬çŸ¥é“åˆ°<code>P0</code>æ§åˆ¶çš„æ˜¯8ä¸ªIOç«¯å£ï¼Œæˆ‘ä»¬ä½¿ç”¨<code>0xFF</code>ç­‰æ§åˆ¶è¯­å¥èƒ½å®ç°æ§åˆ¶å…«ä¸ªç«¯å£è¾“å‡ºä¸åŒçš„é«˜ä½ç”µå¹³ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä½¿ç”¨<code>P0</code>æ¥å®ç°ä¸€ä¸‹ã€‚</p>
<h5 id="2-1-4-1-æºç "><a href="#2-1-4-1-æºç " class="headerlink" title="2.1.4.1 æºç "></a>2.1.4.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> &#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;t;i++)</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">120</span>;j++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		P2 = <span class="number">0xFE</span>; <span class="comment">// 0xFE -&gt; 1111 1110 -&gt; åªæœ‰æœ€å³è¾¹äº®</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xFD</span>; <span class="comment">// 0xFD -&gt; 1111 1101 *********************</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xFB</span>; <span class="comment">// 0xFB -&gt; 1111 1011</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xF7</span>; <span class="comment">// 0xF7 -&gt; 1111 0111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xEF</span>; <span class="comment">// 0xEF -&gt; 1110 1111 ä½ç”µå¹³ä¾æ¬¡å‘å³ç§»åŠ¨ï¼Œæ§åˆ¶ä¸åŒçš„ç¯äº®</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xDF</span>; <span class="comment">// 0xDF -&gt; 1101 1111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0xBF</span>; <span class="comment">// 0xBF -&gt; 1011 1111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P2 = <span class="number">0x7F</span>; <span class="comment">// 0x7F -&gt; 0111 1111 **********************</span></span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-4-2-ä»¿çœŸ"><a href="#2-1-4-2-ä»¿çœŸ" class="headerlink" title="2.1.4.2 ä»¿çœŸ"></a>2.1.4.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642bcb4a6ea21b9a9ec27827.gif" alt=""></p>
<h5 id="2-1-4-3-å®ç‰©"><a href="#2-1-4-3-å®ç‰©" class="headerlink" title="2.1.4.3 å®ç‰©"></a>2.1.4.3 å®ç‰©</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">// ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">// ***************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">// ä½¿ä¸‰å…«è¯‘ç å™¨IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">// ***************************</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		P0 = <span class="number">0xFE</span>; <span class="comment">// 0xFE -&gt; 1111 1110 -&gt; åªæœ‰æœ€å³è¾¹äº®</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xFD</span>; <span class="comment">// 0xFD -&gt; 1111 1101 *********************</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xFB</span>; <span class="comment">// 0xFB -&gt; 1111 1011</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xF7</span>; <span class="comment">// 0xF7 -&gt; 1111 0111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xEF</span>; <span class="comment">// 0xEF -&gt; 1110 1111 ä½ç”µå¹³ä¾æ¬¡å‘å³ç§»åŠ¨ï¼Œæ§åˆ¶ä¸åŒçš„ç¯äº®</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xDF</span>; <span class="comment">// 0xDF -&gt; 1101 1111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0xBF</span>; <span class="comment">// 0xBF -&gt; 1011 1111</span></span><br><span class="line">		delay(<span class="number">500</span>); <span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line">		P0 = <span class="number">0x7F</span>; <span class="comment">// 0x7F -&gt; 0111 1111 **********************</span></span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-4-4-ä¼˜åŒ–"><a href="#2-1-4-4-ä¼˜åŒ–" class="headerlink" title="2.1.4.4 ä¼˜åŒ–"></a>2.1.4.4 ä¼˜åŒ–</h5><p>â‘  <code>Switch case</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®ºï¼Œä½¿ç”¨switch caseè¯­å¥ä½¿ç¨‹åºæ›´åŠ å…¬æ­£</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">1</span>; <span class="comment">//å®šä¹‰æ–°çš„å˜é‡ç”¨æ¥è½®æµè°ƒç”¨ä¸åŒçš„caseè¯­å¥</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>: P2 = <span class="number">0xFE</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>: P2 = <span class="number">0xFD</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>: P2 = <span class="number">0xFB</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>: P2 = <span class="number">0xF7</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>: P2 = <span class="number">0xEF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>: P2 = <span class="number">0xDF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>: P2 = <span class="number">0xBF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>: P2 = <span class="number">0x7F</span>; i=<span class="number">0</span>; <span class="keyword">break</span>; <span class="comment">//å°ç»†èŠ‚</span></span><br><span class="line">		&#125;</span><br><span class="line">		i++;</span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">// ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//*****************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">//*****************************	</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>: P0 = <span class="number">0xFE</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>: P0 = <span class="number">0xFD</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>: P0 = <span class="number">0xFB</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>: P0 = <span class="number">0xF7</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>: P0 = <span class="number">0xEF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>: P0 = <span class="number">0xDF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>: P0 = <span class="number">0xBF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>: P0 = <span class="number">0x7F</span>; <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		i++;</span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¡ æ•°ç»„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> LEDSET[<span class="number">8</span>]=&#123;<span class="number">0xFE</span>,<span class="number">0xFD</span>,<span class="number">0xFB</span>,<span class="number">0xF7</span>,<span class="number">0xEF</span>,<span class="number">0xDF</span>,<span class="number">0xBF</span>,<span class="number">0x7F</span>&#125;;</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        P0=LEDSET[i];</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;<span class="comment">//iéœ€å½’0ä½¿P0åªèƒ½ä½¿ç”¨æ•°ç»„ä¸­çš„8ä¸ªå…ƒç´ ï¼Œé˜²æ­¢ä½¿ç”¨åˆ°è¶…å‡ºæ•°ç»„å…ƒç´ ä»¥å¤–çš„å€¼ï¼Œå…¶å®å°±æ˜¯è®©iåœ¨0~7ä¹‹é—´å˜åŒ–</span></span><br><span class="line">        delay_ms(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> LEDSET[<span class="number">8</span>]=&#123;<span class="number">0xFE</span>,<span class="number">0xFD</span>,<span class="number">0xFB</span>,<span class="number">0xF7</span>,<span class="number">0xEF</span>,<span class="number">0xDF</span>,<span class="number">0xBF</span>,<span class="number">0x7F</span>&#125;;</span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        P0=LEDSET[i];</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;<span class="comment">//iéœ€å½’0ä½¿P0åªèƒ½ä½¿ç”¨æ•°ç»„ä¸­çš„8ä¸ªå…ƒç´ ï¼Œé˜²æ­¢ä½¿ç”¨åˆ°è¶…å‡ºæ•°ç»„å…ƒç´ ä»¥å¤–çš„å€¼ï¼Œå…¶å®å°±æ˜¯è®©iåœ¨0~7ä¹‹é—´å˜åŒ–</span></span><br><span class="line">        delay_ms(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>â‘¢ ç§»ä½</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;  </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        P0=~(<span class="number">0x01</span>&lt;&lt;i);<span class="comment">//ç¬¬ä¸€æ¬¡è¿è¡Œè¿™æ¡è¯­å¥iæ˜¯ç­‰äº0çš„ï¼Œå…ˆç®—å‡ºæ‹¬å·ä¸­çš„å€¼ï¼š0x01å·¦ç§»0ä½è¿˜æ˜¯0x01ï¼Œç®—å‡ºäº†æ‹¬å·ä¸­çš„å€¼å†å»å–åå°±å¾—0xFE,                         </span></span><br><span class="line">                      <span class="comment">//æ‰€ä»¥ç¬¬ä¸€æ¬¡è¿è¡Œè¿™æ¡è¯­å¥æ—¶å°±ç›¸å½“äºâ€œP0=0xFE;â€ï¼Œç¬¬äºŒæ¬¡å¾ªç¯è¿è¡Œæ—¶iå·²ç»ç­‰äº1ï¼Œ0x01å·¦ç§»1ä½å°±ä¸º0x02ï¼Œå–åå¾—0xFD,æ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œè¿™æ¡è¯­å¥æ˜¯â€œP0=0xFD;â€</span></span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">        delay_ms(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;  </span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line"> </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        P0=~(<span class="number">0x01</span>&lt;&lt;i);<span class="comment">//ç¬¬ä¸€æ¬¡è¿è¡Œè¿™æ¡è¯­å¥iæ˜¯ç­‰äº0çš„ï¼Œå…ˆç®—å‡ºæ‹¬å·ä¸­çš„å€¼ï¼š0x01å·¦ç§»0ä½è¿˜æ˜¯0x01ï¼Œç®—å‡ºäº†æ‹¬å·ä¸­çš„å€¼å†å»å–åå°±å¾—0xFE,                         </span></span><br><span class="line">                      <span class="comment">//æ‰€ä»¥ç¬¬ä¸€æ¬¡è¿è¡Œè¿™æ¡è¯­å¥æ—¶å°±ç›¸å½“äºâ€œP0=0xFE;â€ï¼Œç¬¬äºŒæ¬¡å¾ªç¯è¿è¡Œæ—¶iå·²ç»ç­‰äº1ï¼Œ0x01å·¦ç§»1ä½å°±ä¸º0x02ï¼Œå–åå¾—0xFD,æ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œè¿™æ¡è¯­å¥æ˜¯â€œP0=0xFD;â€</span></span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">        delay_ms(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-1-4-äº¤é€šç¯çš„å®ç°"><a href="#2-1-4-äº¤é€šç¯çš„å®ç°" class="headerlink" title="2.1.4 äº¤é€šç¯çš„å®ç°"></a>2.1.4 äº¤é€šç¯çš„å®ç°</h4><h5 id="2-1-4-1-æºç -1"><a href="#2-1-4-1-æºç -1" class="headerlink" title="2.1.4.1 æºç "></a>2.1.4.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit RED1 = P2^<span class="number">0</span>; <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯</span></span><br><span class="line">sbit YELLOW1 = P2^<span class="number">1</span>; <span class="comment">//ç¬¬ä¸€ç»„é»„ç¯</span></span><br><span class="line">sbit GREEN1 = P2^<span class="number">2</span>; <span class="comment">//ç¬¬ä¸€ç»„ç»¿ç¯</span></span><br><span class="line">sbit RED2 = P2^<span class="number">3</span>; <span class="comment">//ç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">sbit YELLOW2 = P2^<span class="number">4</span>; <span class="comment">//ç¬¬äºŒç»„é»„ç¯</span></span><br><span class="line">sbit GREEN2 = P2^<span class="number">5</span>; <span class="comment">//ç¬¬äºŒç»„ç»¿ç¯</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> <span class="comment">//ç®€å•çš„å»¶æ—¶å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; t; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">120</span>; j++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„ç»¿ç¯ï¼Œç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">        GREEN1 = <span class="number">0</span>;</span><br><span class="line">        YELLOW1 = <span class="number">1</span>;</span><br><span class="line">        RED1 = <span class="number">1</span>;</span><br><span class="line">        GREEN2 = <span class="number">1</span>;</span><br><span class="line">        YELLOW2 = <span class="number">1</span>;</span><br><span class="line">        RED2 = <span class="number">0</span>; </span><br><span class="line">        delay(<span class="number">5000</span>); <span class="comment">//ç»¿ç¯æŒç»­5ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„é»„ç¯ï¼Œç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">        YELLOW1 = <span class="number">0</span>;</span><br><span class="line">        GREEN1 = <span class="number">1</span>;</span><br><span class="line">        delay(<span class="number">1000</span>); <span class="comment">//é»„ç¯æŒç»­1ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯ï¼Œç¬¬äºŒç»„ç»¿ç¯</span></span><br><span class="line">        RED1 = <span class="number">0</span>;</span><br><span class="line">        YELLOW1 = <span class="number">1</span>;</span><br><span class="line">        GREEN1 = <span class="number">1</span>;</span><br><span class="line">        RED2 = <span class="number">1</span>;</span><br><span class="line">        YELLOW2 = <span class="number">1</span>;</span><br><span class="line">        GREEN2 = <span class="number">0</span>; </span><br><span class="line">        delay(<span class="number">5000</span>); <span class="comment">//ç»¿ç¯æŒç»­5ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯ï¼Œç¬¬äºŒç»„é»„ç¯</span></span><br><span class="line">        YELLOW2 = <span class="number">0</span>;</span><br><span class="line">        GREEN2 = <span class="number">1</span>;</span><br><span class="line">        delay(<span class="number">1000</span>); <span class="comment">//é»„ç¯æŒç»­1ç§’é’Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note primary simple"><p>é™ˆåŒå­¦ç‰ˆæœ¬ï¼Œä¸»æ‰“å°±æ˜¯ä¸€ä¸ªä½ç§»ï¼Œå¤§å®¶å¯ä»¥ä½“ä¼šä¸€ä¸‹ä»–çš„é€»è¾‘ï¼Œæ³¨æ„<code>|</code>æ˜¯<code>æŒ‰ä½å–æˆ–</code></p>
</div>
<div class="note primary simple"><p>æ³¨æ„<code>|</code>æ˜¯<code>æŒ‰ä½å–æˆ–</code>,å°±æ˜¯è¯´æœ‰<code>1</code>å–<code>1</code>ï¼Œå…¨<code>0</code>å–<code>0</code></p>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a,b;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	a = <span class="number">0xfe</span>;</span><br><span class="line">	b = <span class="number">0xfe</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		P0 = a;</span><br><span class="line">		P1 = b;</span><br><span class="line">		delay(<span class="number">5000</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(a == <span class="number">0xfe</span>)&#123;</span><br><span class="line">			a = <span class="number">1</span>|(a &lt;&lt; <span class="number">1</span>);</span><br><span class="line">			P0 = a;</span><br><span class="line">			delay(<span class="number">3000</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(a == <span class="number">0xfd</span>)&#123;</span><br><span class="line">			a = <span class="number">1</span>|(a &lt;&lt; <span class="number">1</span>); <span class="comment">// yellow  -&gt; red</span></span><br><span class="line">			b = <span class="number">1</span>|(b &lt;&lt; <span class="number">1</span>); <span class="comment">// red -&gt; green</span></span><br><span class="line">			P0 = a;</span><br><span class="line">			P1 = b;</span><br><span class="line">			delay(<span class="number">5000</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(b == <span class="number">0xfd</span>)&#123;</span><br><span class="line">			b = <span class="number">1</span>|(b &lt;&lt; <span class="number">1</span>); <span class="comment">// green -&gt; yellow</span></span><br><span class="line">			P1 = b;</span><br><span class="line">			delay(<span class="number">3000</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(b == <span class="number">0xfb</span>)&#123;</span><br><span class="line">			a = <span class="number">0xfe</span>;</span><br><span class="line">			b = <span class="number">0xfe</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-4-2-ä»¿çœŸ-1"><a href="#2-1-4-2-ä»¿çœŸ-1" class="headerlink" title="2.1.4.2 ä»¿çœŸ"></a>2.1.4.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6424292ba682492fccad052b.gif" alt=""></p>
<h4 id="2-1-5-èŠ±å¼æµæ°´ç¯"><a href="#2-1-5-èŠ±å¼æµæ°´ç¯" class="headerlink" title="2.1.5 èŠ±å¼æµæ°´ç¯"></a>2.1.5 èŠ±å¼æµæ°´ç¯</h4><p>å½“æˆ‘ä»¬æƒ³å®ç°èŠ±å¼æµæ°´ç¯æ—¶è¿˜æ˜¯éœ€è¦è¿ç”¨åˆ°æ•°ç»„çš„ï¼Œæ¯•ç«Ÿæ•°ç»„å¯ä»¥ä¿®æ”¹LEDçš„çŠ¶æ€å€¼ã€‚</p>
<h5 id="2-1-5-1-å³ç§»æµæ°´ç¯æºç "><a href="#2-1-5-1-å³ç§»æµæ°´ç¯æºç " class="headerlink" title="2.1.5.1 å³ç§»æµæ°´ç¯æºç "></a>2.1.5.1 å³ç§»æµæ°´ç¯æºç </h5><div class="note primary simple"><p>æˆ‘å°†å„ç§å®ç°æ–¹æ³•å†™åœ¨äº†ä¸€èµ·ï¼Œå¤§å®¶æ ¹æ®è‡ªå·±çš„éœ€è¦é€‰å–</p>
</div>
<div class="note primary simple"><p>æ„Ÿè°¢é™ˆå…´é¾™åŒå­¦æä¾›çš„ä»£ç (<em>^_^</em>)</p>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="comment">// P0å£ï¼Œswitch case</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>: P2 = <span class="number">0x7F</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>: P2 = <span class="number">0xBF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>: P2 = <span class="number">0xDF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>: P2 = <span class="number">0xEF</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>: P2 = <span class="number">0xF7</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">6</span>: P2 = <span class="number">0xFB</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">7</span>: P2 = <span class="number">0xFD</span>; <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">8</span>: P2 = <span class="number">0xFE</span>; i=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		i++;</span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç»„</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> j[<span class="number">8</span>] = &#123;<span class="number">0x7F</span>, <span class="number">0xBF</span>, <span class="number">0xDF</span>, <span class="number">0xEF</span>, <span class="number">0xF7</span>, <span class="number">0xFB</span>,<span class="number">0xFD</span>, <span class="number">0xFE</span>&#125;;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		P2 = j[i];</span><br><span class="line">		delay(<span class="number">500</span>);</span><br><span class="line">		i++;</span><br><span class="line">		<span class="keyword">if</span>(i==<span class="number">8</span>)&#123;</span><br><span class="line">			i=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§»ä½</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a, b=<span class="number">10000000</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		a = <span class="number">0x7F</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">8</span>; i++)&#123;</span><br><span class="line">			P2 = a;</span><br><span class="line">			a = b|(a&gt;&gt;<span class="number">1</span>);</span><br><span class="line">			delay(<span class="number">500</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-1-5-2-å¾ªç¯æµæ°´ç¯"><a href="#2-1-5-2-å¾ªç¯æµæ°´ç¯" class="headerlink" title="2.1.5.2 å¾ªç¯æµæ°´ç¯"></a>2.1.5.2 å¾ªç¯æµæ°´ç¯</h5><h5 id="2-1-5-3-å¥‡å¶æµæ°´ç¯"><a href="#2-1-5-3-å¥‡å¶æµæ°´ç¯" class="headerlink" title="2.1.5.3 å¥‡å¶æµæ°´ç¯"></a>2.1.5.3 å¥‡å¶æµæ°´ç¯</h5><div class="note primary simple"><p>æ„Ÿè°¢é™ˆå…´é¾™åŒå­¦æä¾›çš„æ•°ç»„ä»£ç (<em>^_^</em>)</p>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="comment">// ç§»ä½æ–¹æ³•</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> uint unsigned int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(uint x)</span></span><br><span class="line">&#123;</span><br><span class="line">    uint i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=x;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">120</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¶æ•°ç¯é€ä¸ªç‚¹äº®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">even_light</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">8</span>;i+=<span class="number">2</span>) <span class="comment">//å¾ªç¯æ§åˆ¶ç‚¹äº®å¶æ•°ç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        P2 = ~(<span class="number">1</span>&lt;&lt;i); <span class="comment">//ç‚¹äº®ç¬¬iä¸ªLEDç¯, å¶æ•°</span></span><br><span class="line">        delay(<span class="number">500</span>); <span class="comment">//å»¶æ—¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¥‡æ•°ç¯é€ä¸ªç‚¹äº®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">odd_light</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">8</span>;i+=<span class="number">2</span>) <span class="comment">//å¾ªç¯æ§åˆ¶ç‚¹äº®å¥‡æ•°ç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        P2 = ~(<span class="number">1</span>&lt;&lt;i); <span class="comment">//ç‚¹äº®ç¬¬iä¸ªLEDç¯ï¼Œå¥‡æ•°</span></span><br><span class="line">        delay(<span class="number">500</span>); <span class="comment">//å»¶æ—¶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¨éƒ¨ç‚¹äº®ç„¶åç†„ç­</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">all_light</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++) &#123; </span><br><span class="line">			P2 = <span class="number">0x00</span>;</span><br><span class="line">			delay(<span class="number">500</span>); <span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">			P2 = <span class="number">0xFF</span>; <span class="comment">//å…¨ç­</span></span><br><span class="line">			delay(<span class="number">500</span>); <span class="comment">//å»¶æ—¶</span></span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¥‡å¶é€ä¸ªç‚¹äº®åå…¨ç­</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">even_odd_light_out</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">8</span>; i++)&#123;</span><br><span class="line">			P2 = ~(<span class="number">1</span>&lt;&lt;i);</span><br><span class="line">			delay(<span class="number">500</span>);</span><br><span class="line">		&#125;</span><br><span class="line">    P2 = <span class="number">0xFF</span>; <span class="comment">//å…¨ç­</span></span><br><span class="line">    delay(<span class="number">1000</span>); <span class="comment">//å»¶æ—¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) <span class="comment">//å¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        even_light(); <span class="comment">// å¶æ•°ç¯é€æ¸ç‚¹äº®</span></span><br><span class="line">        odd_light(); <span class="comment">// å¥‡æ•°ç¯é€æ¸ç‚¹äº®</span></span><br><span class="line">        all_light(); <span class="comment">// æ‰€æœ‰ç¯å…¨äº®</span></span><br><span class="line">        even_odd_light_out(); <span class="comment">//æ…¢æ…¢æ¥</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç»„</span></span><br><span class="line"><span class="meta"># <span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">()</span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">500</span>;i&gt;<span class="number">0</span>;i--)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">120</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	 <span class="type">unsigned</span> <span class="type">char</span> code ledj[<span class="number">4</span>]=&#123;<span class="number">0xfe</span>,<span class="number">0xfb</span>,<span class="number">0xef</span>,<span class="number">0xbf</span>&#125;;<span class="comment">//å¥‡æ•°ç¯</span></span><br><span class="line">	 <span class="type">unsigned</span> <span class="type">char</span> code ledo[<span class="number">4</span>]=&#123;<span class="number">0xfd</span>,<span class="number">0xf7</span>,<span class="number">0xdf</span>,<span class="number">0x7f</span>&#125;;<span class="comment">//å¶æ•°ç¯</span></span><br><span class="line">	 <span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line">	 <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		 <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">			 P0=ledo[i];</span><br><span class="line">			 delay();</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">			 P0=ledj[i];</span><br><span class="line">			 delay();</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">			 P0=<span class="number">0x00</span>;</span><br><span class="line">			 delay();</span><br><span class="line">		   P0=<span class="number">0xff</span>;</span><br><span class="line">			 delay();</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">4</span>;i++)&#123;</span><br><span class="line">			 P0=ledj[i];</span><br><span class="line">			 delay();</span><br><span class="line">			 P0=ledo[i];</span><br><span class="line">			 delay();</span><br><span class="line">		 &#125;</span><br><span class="line">		 P0=<span class="number">0xff</span>;</span><br><span class="line">		 delay();</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642fdca5a682492fcc726e5d.gif" alt=""></p>
<h5 id="2-1-5-4-æŒ‰é”®æ§åˆ¶æµæ°´ç¯"><a href="#2-1-5-4-æŒ‰é”®æ§åˆ¶æµæ°´ç¯" class="headerlink" title="2.1.5.4 æŒ‰é”®æ§åˆ¶æµæ°´ç¯"></a>2.1.5.4 æŒ‰é”®æ§åˆ¶æµæ°´ç¯</h5><div class="note primary simple"><p>æ„Ÿè°¢æè‚–å¤åŒå­¦æä¾›äº†è¯¥éƒ¨åˆ†çš„ä»£ç ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ä¸èƒ½ç›´æ¥å†™è¯­å¥P3^0==0çš„åˆ¤æ–­</p>
</div>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… æ™®ä¸­å¼€å‘æ¿</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line">sbit KEY2 = P3^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">()</span>		<span class="comment">//@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line"></span><br><span class="line">	i = <span class="number">39</span>;</span><br><span class="line">	j = <span class="number">230</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(KEY2 == <span class="number">0</span>)		  <span class="comment">// æŒ‰ä¸‹ç»™0ï¼Œ æ¾å¼€ç»™1</span></span><br><span class="line">	&#123;</span><br><span class="line">	  delay();	 <span class="comment">// é˜²æŠ–20ms</span></span><br><span class="line"></span><br><span class="line">	  <span class="keyword">if</span>(KEY2 == <span class="number">0</span>) &#123;</span><br><span class="line">	  	<span class="keyword">while</span>(KEY2 == <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">if</span>(KEY2 == <span class="number">1</span>) &#123;</span><br><span class="line">				P2 = ~(<span class="number">0x01</span>&lt;&lt;r); <span class="comment">//ç§»ä½</span></span><br><span class="line">				r++;</span><br><span class="line">				<span class="keyword">if</span>(r==<span class="number">9</span>)r=<span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… æ™®ä¸­å¼€å‘æ¿ æŒ‰é”®æ§åˆ¶å·¦å³å¾ªç¯æµæ°´ç¯</span></span><br><span class="line"> <span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> r=<span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> n=<span class="number">6</span>;</span><br><span class="line">sbit KEY2 = P3^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">()</span>		<span class="comment">//@12.000MHz</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line"></span><br><span class="line">	i = <span class="number">39</span>;</span><br><span class="line">	j = <span class="number">230</span>;</span><br><span class="line">	<span class="keyword">do</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">while</span> (--j);</span><br><span class="line">	&#125; <span class="keyword">while</span> (--i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(KEY2 == <span class="number">0</span>)		  <span class="comment">// æŒ‰ä¸‹ç»™0ï¼Œ æ¾å¼€ç»™1</span></span><br><span class="line">	&#123;</span><br><span class="line">	  delay();	 <span class="comment">// é˜²æŠ–20ms</span></span><br><span class="line"></span><br><span class="line">	  <span class="keyword">if</span>(KEY2 == <span class="number">0</span>) &#123;</span><br><span class="line">	  	<span class="keyword">while</span>(KEY2 == <span class="number">0</span>);</span><br><span class="line">			<span class="keyword">if</span>(KEY2 == <span class="number">1</span>) &#123;</span><br><span class="line">			   <span class="keyword">if</span>(r&lt;<span class="number">8</span>)&#123;</span><br><span class="line">				P2 = ~(<span class="number">0x01</span>&lt;&lt;r); <span class="comment">//ç§»ä½</span></span><br><span class="line">				r++;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">				&#123;</span><br><span class="line">				   P2 = ~(<span class="number">0x01</span>&lt;&lt;n);</span><br><span class="line">				   n--;</span><br><span class="line">				   <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">				      &#123;r=<span class="number">0</span>;</span><br><span class="line">					   n=<span class="number">6</span>;&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				&#125;</span><br><span class="line">	  &#125;</span><br><span class="line">	&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-2-èœ‚é¸£å™¨"><a href="#2-2-èœ‚é¸£å™¨" class="headerlink" title="2.2 èœ‚é¸£å™¨"></a>2.2 èœ‚é¸£å™¨</h3><h4 id="2-2-1-èœ‚é¸£å™¨é©±åŠ¨ä»£ç "><a href="#2-2-1-èœ‚é¸£å™¨é©±åŠ¨ä»£ç " class="headerlink" title="2.2.1 èœ‚é¸£å™¨é©±åŠ¨ä»£ç "></a>2.2.1 èœ‚é¸£å™¨é©±åŠ¨ä»£ç </h4><p>æ— æºèœ‚é¸£å™¨çš„ç¡¬ä»¶è¿æ¥å› ä¸ºä¸åƒLEDé‚£æ ·éƒ½æ¥äº†å¾ˆå¤šå…¶ä»–å™¨ä»¶æ¥åˆå§‹åŒ–ï¼Œæ‰€ä»¥é©±åŠ¨ä»£ç æ¯”è¾ƒç®€å•</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit BEEP = P1^<span class="number">6</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i; </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        BEEP=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">14</span>;i++);<span class="comment">//å»¶æ—¶æ¥è¿‘0.125ms,ç»™P1.6ä¿æŒäº†0.125msé«˜ç”µå¹³æ—¶é—´</span></span><br><span class="line">        BEEP=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">14</span>;i++);<span class="comment">//ä½ç”µå¹³æ—¶é—´ä¿æŒäº†0.125msï¼Œ æˆ‘ä»¬å¯ä»¥å°è¯•æŠŠä¸¤ä¸ªforè¯­å¥é‡Œçš„14æ”¹å¤§ä¸€ç‚¹å°±ä¼šå‘ç°é¸£å«çš„éŸ³è°ƒå˜å¾—ä½æ²‰ä¸€äº›äº†</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-2-èœ‚é¸£å™¨é¸£å«"><a href="#2-2-2-èœ‚é¸£å™¨é¸£å«" class="headerlink" title="2.2.2 èœ‚é¸£å™¨é¸£å«"></a>2.2.2 èœ‚é¸£å™¨é¸£å«</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… ç®€åŒ–</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit BEEP = P1^<span class="number">6</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i; </span><br><span class="line">     <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">     &#123;</span><br><span class="line">         BEEP=!BEEP; <span class="comment">// èœ‚é¸£å™¨é¸£å«ï¼Œé€šè¿‡P1.6å°±è¦ä»¥ä¸€å®šçš„æ—¶é—´é—´éš”ï¼ˆä¹Ÿå¯å«ä¸€å®šé¢‘ç‡ï¼‰ä¸åœçš„é«˜ä½ç”µå¹³åˆ‡æ¢ã€‚è¿™é‡Œå°ç»†èŠ‚ï¼Œå–éç¬¦å·</span></span><br><span class="line">         <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">14</span>;i++);<span class="comment">//åªéœ€æ”¹å˜ä¸€æ¬¡forè¯­å¥ä¸­çš„14å°±å¯ä»¥å®ç°ä¸åŒéŸ³è°ƒçš„é¸£å«äº†</span></span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note info simple"><p>è¿™é‡Œå¯å‘æˆ‘ä»¬ä½¿ç”¨LED=!LED å¯ä»¥å®ç°LEDç¯é—ªçƒ</p>
</div>
<h4 id="2-2-3-æ§åˆ¶èœ‚é¸£å™¨"><a href="#2-2-3-æ§åˆ¶èœ‚é¸£å™¨" class="headerlink" title="2.2.3 æ§åˆ¶èœ‚é¸£å™¨"></a>2.2.3 æ§åˆ¶èœ‚é¸£å™¨</h4><p>æˆ‘ä»¬å…ˆæ¼”ç¤ºä¸€ä¸ª<code>é”™è¯¯ä»£ç </code>ï¼Œå€ŸåŠ©äºæ§åˆ¶LEDå°ç¯äº®ç­çš„å¯å‘ï¼Œæˆ‘ä»¬å¯èƒ½å†™å‡ºå¦‚ä¸‹çš„ä¸»è¦ç¨‹åºæ§åˆ¶èœ‚é¸£å™¨çš„é«˜ä½ç”µå¹³</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">    BEEP = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">14</span>;i++); <span class="comment">//å»¶è¿Ÿ0.125ms</span></span><br><span class="line">    BEEP = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">14</span>;i++); <span class="comment">//å»¶è¿Ÿ0.125ms</span></span><br><span class="line">    </span><br><span class="line">    delay(<span class="number">5000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç®€å•åˆ†æä»¥ä¸Šä»£ç ï¼Œä¸‹é¢çš„å›¾è§£å¯ä»¥çœ‹å‡ºæ¥ä»¥ä¸Šä»£ç å’Œä¸Šé¢çš„é©±åŠ¨ä»£ç çš„åŒºåˆ«</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.staticaly.com/gh/Gan1Ser/img-url@main/2022/12image-20230405002829461.png" alt="image-20230405002829461"></p>
<p>å¾ˆæ˜æ˜¾ä½¿ç”¨å»¶è¿Ÿå‡½æ•°Delay()å‡½æ•°å»¶è¿Ÿæ§åˆ¶ä¸æ»¡è¶³èœ‚é¸£å™¨çš„é©±åŠ¨æ¡ä»¶ï¼šç”¨æ—¶é—´è¡¨ç¤ºå°±æ˜¯è¦è¾“å‡ºå‘¨æœŸä¸º<code>0.22ms~2msï¼ˆï¼ˆ1/4500sï¼‰~ï¼ˆ1/500sï¼‰ï¼‰</code>èŒƒå›´çš„æ–¹æ³¢,è¿™ä¸ªå‘¨æœŸå†…é«˜ç”µå¹³æ—¶é—´å’Œä½ç”µå¹³æ—¶é—´å„å ä¸€åŠã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è¦æ§åˆ¶èœ‚é¸£å™¨çš„å“ä¸ä¸å“è¯¥å¦‚ä½•åšï¼Ÿ</p>
<p>é©±åŠ¨ä»£ç ä¹‹æ‰€ä»¥èƒ½ä¸€ç›´å“ï¼Œæ˜¯å› ä¸ºåœ¨<code>æ­»å¾ªç¯é‡Œè¿™äº›æ–¹æ³¢æŒç»­çš„æ—¶é—´æ— é™é•¿</code>ã€‚é‚£ä¹ˆæˆ‘ä»¬è¦è®©å®ƒå“ä¸€æ®µæ—¶é—´ï¼Œå°±è®©è¿™ä¸ªæ–¹æ³¢æŒç»­ç€è¿™æ®µæ—¶é—´ï¼›ç„¶åæŠŠIOç«¯å£ç”µå¹³å›ºå®šä½ä¸å‘ç”Ÿæ”¹å˜ï¼Œæ— æºèœ‚é¸£å™¨æ²¡æœ‰è„‰å†²ä¿¡å·æ‰€ä»¥å°±ä¸å“äº†ã€‚è¿™æ—¶æˆ‘ä»¬å†å»¶æ—¶1ç§’ï¼Œåœ¨è¿™ä¸€ç§’é‡Œæ— æºèœ‚é¸£å™¨ä¸ä¼šå“ï¼Œè¿‡äº†è¿™ä¸€ç§’ä¹‹åå†è®©IOç«¯å£æŒç»­è¾“å‡ºä¸€æ®µæ–¹æ³¢æ—¶é—´ï¼Œè¿™æ—¶å°±å¯ä»¥å†æ¬¡å¼„å“æ— æºèœ‚é¸£å™¨ï¼Œå°±è¿™æ ·æ­»å¾ªç¯ä¸‹å»ä¹Ÿå°±è¾¾åˆ°è‡ªå·±æƒ³çš„ç›®çš„ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/642c515ca682492fccdfb9e7.png" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit BEEP = P1^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶è¿Ÿ</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨å¾ªç¯åµŒå¥—ï¼Œå†…å±‚å¾ªç¯æ§åˆ¶èœ‚é¸£å™¨ä¸€ç›´é¸£å«ï¼Œå†…å±‚å¾ªç¯å®Œæˆåï¼Œç”µå¹³ä¸åœ¨å‘ç”Ÿå˜æ¢ï¼Œèœ‚é¸£å™¨ä¸åœ¨é¸£å«ï¼Œå»¶è¿Ÿ1sé’Ÿåç»§ç»­è¿›å…¥å†…å±‚å¾ªç¯è¿›è¡Œé¸£å«</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,time;</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(time=<span class="number">0</span>;time&lt;<span class="number">800</span>;time++)<span class="comment">//800å†³å®šé¸£å«çš„æ—¶é•¿</span></span><br><span class="line">        &#123;  </span><br><span class="line">            BEEP=!BEEP;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">30</span>;i++);<span class="comment">//è¿™é‡Œæ”¹ä¸º30å»¶æ—¶é•¿ä¸€ç‚¹æŠŠé¸£å«éŸ³è°ƒè°ƒä½ä¸€äº›</span></span><br><span class="line">        &#125;</span><br><span class="line">        delay_ms(<span class="number">1000</span>);<span class="comment">//å»¶æ—¶1s </span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-2-4-èœ‚é¸£å™¨-LEDå®é™…æ¡ˆä¾‹"><a href="#2-2-4-èœ‚é¸£å™¨-LEDå®é™…æ¡ˆä¾‹" class="headerlink" title="2.2.4 èœ‚é¸£å™¨+LEDå®é™…æ¡ˆä¾‹"></a>2.2.4 èœ‚é¸£å™¨+LEDå®é™…æ¡ˆä¾‹</h4><p>æœºå™¨æŠ¥è­¦æ—¶ï¼Œç¯äº®çš„æ—¶å€™èœ‚é¸£å™¨å°±å“ï¼Œç¯ç­çš„æ—¶å€™å°±ä¸å“ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit BEEP  = P1^<span class="number">6</span>; <span class="comment">// æ§åˆ¶èœ‚é¸£å™¨çš„é«˜ä½ç”µå¹³</span></span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å»¶è¿Ÿå‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,time;</span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        LED2=<span class="number">0</span>; <span class="comment">//ç¯äº®ï¼ŒåŒæ—¶èœ‚é¸£å™¨é¸£å«</span></span><br><span class="line">        <span class="keyword">for</span>(time=<span class="number">0</span>;time&lt;<span class="number">3700</span>;time++)<span class="comment">//è½¯ä»¶è°ƒè¯•å‡ºæ­¤å¤„forå¾ªç¯ç”¨äº†1ç§’</span></span><br><span class="line">        &#123;  </span><br><span class="line">            BEEP=!BEEP;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">30</span>;i++);</span><br><span class="line">        &#125;</span><br><span class="line">        BEEP=<span class="number">0</span>;<span class="comment">//å›ºå®šä½èœ‚é¸£å™¨çš„ç”µå¹³ä½¿å…¶ä¸å“ï¼Œå…¶å®è¿™æ¡è¯­å¥ä¹Ÿå¯ä¸å†™ï¼Œå› ä¸ºä¸Šé¢çš„forè¯­å¥æ‰§è¡Œå®Œå°±æ²¡æœ‰æ–¹æ³¢äº§ç”Ÿäº†ä¹Ÿå°±ä¸å“äº†ï¼Œå¤§å®¶å¯ä»¥æ³¨é‡Šæ‰è¿™ä¸ªè¯­å¥çœ‹çœ‹ç°è±¡æ˜¯ä¸æ˜¯ä¸€æ ·çš„</span></span><br><span class="line">        LED2=<span class="number">1</span>; <span class="comment">//èœ‚é¸£å™¨ä¸å“ï¼Œç¯ç­</span></span><br><span class="line">        delay_ms(<span class="number">1000</span>);<span class="comment">//å»¶æ—¶1s </span></span><br><span class="line">      &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-3-æ•°ç ç®¡"><a href="#2-3-æ•°ç ç®¡" class="headerlink" title="2.3 æ•°ç ç®¡"></a>2.3 æ•°ç ç®¡</h3><h4 id="2-3-1-æ•°ç ç®¡åŸç†"><a href="#2-3-1-æ•°ç ç®¡åŸç†" class="headerlink" title="2.3.1 æ•°ç ç®¡åŸç†"></a>2.3.1 æ•°ç ç®¡åŸç†</h4><p>pass</p>
<h4 id="2-3-2-é™æ€æ•°ç ç®¡æ˜¾ç¤º"><a href="#2-3-2-é™æ€æ•°ç ç®¡æ˜¾ç¤º" class="headerlink" title="2.3.2 é™æ€æ•°ç ç®¡æ˜¾ç¤º"></a>2.3.2 é™æ€æ•°ç ç®¡æ˜¾ç¤º</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¾ç¤ºå•ä¸ªæ•°å­— 0</span></span><br><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">seg</span><span class="params">()</span> &#123;</span><br><span class="line">	P2 = <span class="number">0x3F</span>; <span class="comment">//0011 1111 -&gt; 0x3F</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	seg();</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6413f387a682492fccd1d02c.gif" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ˜¾ç¤ºé›¶åˆ°ä¹çš„å¾ªç¯</span></span><br><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> s[] = &#123;<span class="number">0x3F</span>, <span class="number">0x06</span>, <span class="number">0x5B</span>, <span class="number">0x4F</span>, <span class="number">0x66</span>, <span class="number">0x6D</span>, <span class="number">0x7D</span>, <span class="number">0x07</span>, <span class="number">0x7F</span>, <span class="number">0x6F</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> n)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>,j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">seg</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">10</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		P2 = s[i];</span><br><span class="line">		delay(<span class="number">800</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		seg();</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6413f793a682492fccdaf4e2.gif" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="comment">// 0~Fæ˜¾ç¤º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[] = &#123;<span class="number">0xC0</span>, <span class="number">0xF9</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>, <span class="number">0x99</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x83</span>, <span class="number">0xC6</span>, <span class="number">0xA1</span>, <span class="number">0x86</span>, <span class="number">0x8E</span>&#125;; <span class="comment">// 0~Fçš„çœŸå€¼è¡¨ï¼Œä½¿ç”¨codeå…³é”®å­—ä½¿charç±»å‹LedCharæ”¾å…¥Flashè€Œä¸æ”¾å…¥RAMï¼Œä¹‹æ‰€ä»¥æ”¾å…¥Flashæ˜¯å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦æ”¹å˜è¯¥çœŸå€¼è¡¨çš„å€¼</span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> cnt = <span class="number">0</span>; <span class="comment">// è®°å½•T0ä¸­æ–­æ¬¡æ•°</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> sec = <span class="number">0</span>; <span class="comment">// è®°å½•ç»è¿‡çš„ç§’æ•°</span></span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;	<span class="comment">//ä½¿èƒ½ U3ï¼Œé€‰æ‹©æ•°ç ç®¡ DS1</span></span><br><span class="line">	ADDR3 = <span class="number">1</span>;	<span class="comment">//ä¸º T0 èµ‹åˆå€¼ 0xB800 </span></span><br><span class="line">	ADDR2 = <span class="number">0</span>;</span><br><span class="line">	ADDR1 = <span class="number">0</span>;</span><br><span class="line">	ADDR0 = <span class="number">0</span>;	<span class="comment">//å¯åŠ¨ T0</span></span><br><span class="line">	</span><br><span class="line">	TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½® T0 ä¸ºæ¨¡å¼ 1 </span></span><br><span class="line">	TH0 = <span class="number">0xB8</span>;</span><br><span class="line">	TL0 = <span class="number">0x00</span>;</span><br><span class="line">	TR0 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (TF0 == <span class="number">1</span>) &#123; <span class="comment">//åˆ¤æ–­ T0 æ˜¯å¦æº¢å‡º</span></span><br><span class="line">			TF0 = <span class="number">0</span>;	<span class="comment">//T0 æº¢å‡ºåï¼Œæ¸…é›¶ä¸­æ–­æ ‡å¿— </span></span><br><span class="line">			TH0 = <span class="number">0XB8</span>;	<span class="comment">//å¹¶é‡æ–°èµ‹åˆå€¼</span></span><br><span class="line">			TL0 = <span class="number">0x00</span>;</span><br><span class="line">			cnt++;	<span class="comment">//è®¡æ•°å€¼è‡ªåŠ  1 </span></span><br><span class="line">			<span class="keyword">if</span> (cnt &gt;= <span class="number">50</span>)&#123;	<span class="comment">//åˆ¤æ–­ T0 æº¢å‡ºæ˜¯å¦è¾¾åˆ° 50 æ¬¡</span></span><br><span class="line">				cnt = <span class="number">0</span>;	<span class="comment">//è¾¾åˆ° 50 æ¬¡åè®¡æ•°å€¼æ¸…é›¶</span></span><br><span class="line">				P0 = LedChar[sec];	<span class="comment">//å½“å‰ç§’æ•°å¯¹åº”çš„çœŸå€¼è¡¨ä¸­çš„å€¼é€åˆ° P0 å£ </span></span><br><span class="line">				sec++;	<span class="comment">//ç§’æ•°è®°å½•è‡ªåŠ  1</span></span><br><span class="line">				<span class="keyword">if</span> (sec &gt;= <span class="number">16</span>)&#123;	<span class="comment">//å½“ç§’æ•°è¶…è¿‡ 0x0F(15)åï¼Œé‡æ–°ä» 0 å¼€å§‹</span></span><br><span class="line">					sec = <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div align=center class="aspect-ratio">
    <iframe src="https://player.bilibili.com/player.html?aid=441060182&&page=1&as_wide=1&high_quality=1&danmaku=0&autoplay=0" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>

<h4 id="2-3-3-åŠ¨æ€æ•°ç ç®¡æ˜¾ç¤º"><a href="#2-3-3-åŠ¨æ€æ•°ç ç®¡æ˜¾ç¤º" class="headerlink" title="2.3.3 åŠ¨æ€æ•°ç ç®¡æ˜¾ç¤º"></a>2.3.3 åŠ¨æ€æ•°ç ç®¡æ˜¾ç¤º</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> str[] = &#123;<span class="number">0x76</span>, <span class="number">0x79</span>, <span class="number">0x38</span>, <span class="number">0x38</span>, <span class="number">0x3F</span>&#125;; <span class="comment">//HELLO çš„æ®µé€‰</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> wei[] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>&#125;; <span class="comment">//å…±é˜´æçš„çº¿é€‰</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> n)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>,j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;n; i++)</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">seg</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++) <span class="comment">// çº¿é€‰ä¸º5</span></span><br><span class="line">	&#123;</span><br><span class="line">		P3 = ~wei[i];</span><br><span class="line">		P2 = str[i];</span><br><span class="line">		delay(<span class="number">5</span>); <span class="comment">// è°ƒå°ç‚¹æ˜¯ä¸ºäº†è§†è§‰æ®‹ç•™çš„æ•ˆæœ</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		seg();</span><br><span class="line">	&#125;</span><br><span class="line">		</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6413fc94a682492fcce7fc08.gif" alt=""></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[] = &#123;<span class="number">0xC0</span>, <span class="number">0xF9</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>, <span class="number">0x99</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x83</span>, <span class="number">0xC6</span>, <span class="number">0xA1</span>, <span class="number">0x86</span>, <span class="number">0x8E</span>&#125;; <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºå­—ç¬¦è½¬æ¢è¡¨è¡¨</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>] = &#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºç¼“å†²åŒºï¼Œåˆå€¼0xFFç¡®ä¿å¯åŠ¨æ—¶éƒ½ä¸äº®</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;	<span class="comment">//åŠ¨æ€æ‰«æç´¢å¼•</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> cnt = <span class="number">0</span>;	<span class="comment">// è®°å½•T0ä¸­æ–­æ¬¡æ•°</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">long</span> sec = <span class="number">0</span>; <span class="comment">//è®°å½•ç»è¿‡çš„ç§’æ•°</span></span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	TMOD = <span class="number">0x01</span>; <span class="comment">// è®¾ç½®T0æ¨¡å¼ä¸º1 -&gt; 0x01</span></span><br><span class="line">	TH0 = <span class="number">0xFC</span>; <span class="comment">//ä¸ºT0è®¾ç½®åˆå€¼ä¸º0xFC67ï¼Œå®šæ—¶ä¸º1msï¼ŒTHé«˜</span></span><br><span class="line">	TL0 = <span class="number">0x67</span>; <span class="comment">// TLä½</span></span><br><span class="line">	TR0 = <span class="number">1</span>; <span class="comment">// å¯åŠ¨T0</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (TF0 == <span class="number">1</span>) &#123; <span class="comment">// åˆ¤æ–­T0æ˜¯å¦æº¢å‡º</span></span><br><span class="line">			TF0 = <span class="number">0</span>;</span><br><span class="line">			TH0 = <span class="number">0xFC</span>; <span class="comment">//ä¸ºT0é‡æ–°èµ‹å€¼0xFC67</span></span><br><span class="line">			TL0 = <span class="number">0x67</span>;</span><br><span class="line">			cnt++; <span class="comment">//è®¡æ•°å™¨è‡ªåŠ 1</span></span><br><span class="line">			<span class="keyword">if</span> (cnt &gt;= <span class="number">1000</span>) &#123; <span class="comment">// åˆ¤æ–­T0æº¢å‡ºæ˜¯å¦è¾¾åˆ°1000æ¬¡</span></span><br><span class="line">				cnt = <span class="number">0</span>; <span class="comment">// è¾¾åˆ°1000æ¬¡åè®¡æ•°å€¼æ¸…é›¶</span></span><br><span class="line">				sec++; <span class="comment">// ç§’è®¡æ•°åŠ 1</span></span><br><span class="line">				<span class="comment">// ä»¥ä¸‹ä»£ç å°†secæŒ‰åè¿›åˆ¶ä½ä»ä½åˆ°é«˜ä¾æ¬¡æå–å¹¶è½¬ä¸ºæ•°ç ç®¡æ˜¾ç¤ºå­—ç¬¦</span></span><br><span class="line">				LedBuff[<span class="number">0</span>] = LedChar[sec%<span class="number">10</span>];</span><br><span class="line">				LedBuff[<span class="number">1</span>] = LedChar[sec/<span class="number">10</span>%<span class="number">10</span>];</span><br><span class="line">				LedBuff[<span class="number">2</span>] = LedChar[sec/<span class="number">100</span>%<span class="number">10</span>];</span><br><span class="line">				LedBuff[<span class="number">3</span>] = LedChar[sec/<span class="number">1000</span>%<span class="number">10</span>];</span><br><span class="line">				LedBuff[<span class="number">4</span>] = LedChar[sec/<span class="number">10000</span>%<span class="number">10</span>];</span><br><span class="line">				LedBuff[<span class="number">5</span>] = LedChar[sec/<span class="number">100000</span>%<span class="number">10</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// ä»¥ä¸‹ä»£ç å®Œæˆæ•°ç ç®¡åŠ¨æ€æ‰«æåˆ·æ–°</span></span><br><span class="line">			<span class="keyword">if</span> (i == <span class="number">0</span>)&#123;</span><br><span class="line">				ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; i++; P0 = LedBuff[<span class="number">0</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">1</span>) &#123;</span><br><span class="line">				ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; i++; P0 = LedBuff[<span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">2</span>) &#123;</span><br><span class="line">				ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">0</span>; i++; P0 = LedBuff[<span class="number">2</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">				ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">1</span>; i++; P0 = LedBuff[<span class="number">3</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">4</span>) &#123;</span><br><span class="line">				ADDR2 = <span class="number">1</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; i++; P0 = LedBuff[<span class="number">4</span>];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (i == <span class="number">5</span>) &#123;</span><br><span class="line">				ADDR2 = <span class="number">1</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; i = <span class="number">0</span>; P0 = LedBuff[<span class="number">5</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div align=center class="aspect-ratio">
    <iframe src="https://player.bilibili.com/player.html?aid=781144915&&page=1&as_wide=1&high_quality=1&danmaku=0&autoplay=0" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>

<h4 id="2-3-4-4åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º0-3"><a href="#2-3-4-4åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º0-3" class="headerlink" title="2.3.4 4åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º0~3"></a>2.3.4 4åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º0~3</h4><h5 id="2-3-4-1-æºç "><a href="#2-3-4-1-æºç " class="headerlink" title="2.3.4.1 æºç "></a>2.3.4.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç ç®¡æ®µé€‰ä¿¡å·æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code digit[<span class="number">4</span>] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>&#125;;</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºæ•°å­—æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code num[<span class="number">4</span>] = &#123;<span class="number">0x3F</span>, <span class="number">0x06</span>, <span class="number">0x5B</span>, <span class="number">0x4F</span>&#125;;</span><br><span class="line"><span class="comment">// å®šä¹‰è®¡æ•°å™¨</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = xms; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">110</span>; j &gt; <span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">		<span class="comment">// å®šä¹‰è®¡æ•°å™¨å¾ªç¯æ§åˆ¶å˜é‡i</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æ§åˆ¶å˜é‡j</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡ä½é€‰ä¿¡å·P2å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P3 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡æ®µé€‰ä¿¡å·P0å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P2 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœjç­‰äº4ï¼Œåˆ™å°†jèµ‹å€¼ä¸º0ï¼Œç»§ç»­ä»0å¼€å§‹</span></span><br><span class="line">        <span class="keyword">if</span> (j == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†æ•°ç ç®¡ä½é€‰ä¿¡å·è®¾ç½®ä¸ºç¬¬jä½</span></span><br><span class="line">        P3 = ~digit[j];</span><br><span class="line">        <span class="comment">// å°†æ•°ç ç®¡æ®µé€‰ä¿¡å·è®¾ç½®ä¸ºå¯¹åº”æ•°å­—</span></span><br><span class="line">        P2 = num[count % <span class="number">4</span>];</span><br><span class="line">        <span class="comment">// å»¶æ—¶200ms</span></span><br><span class="line">        delay(<span class="number">200</span>);</span><br><span class="line">        <span class="comment">// è®¡æ•°å™¨åŠ 1</span></span><br><span class="line">        count++;</span><br><span class="line">				<span class="comment">// å¾ªç¯æ§åˆ¶å˜é‡jæ¯æ¬¡åŠ 1</span></span><br><span class="line">				j++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-3-4-2-ä»¿çœŸ"><a href="#2-3-4-2-ä»¿çœŸ" class="headerlink" title="2.3.4.2 ä»¿çœŸ"></a>2.3.4.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6422f37ea682492fcc0f0189.gif" alt=""></p>
<h4 id="2-3-5-8åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º8-F"><a href="#2-3-5-8åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º8-F" class="headerlink" title="2.3.5 8åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º8~F"></a>2.3.5 8åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º8~F</h4><h5 id="2-3-5-1-æºç "><a href="#2-3-5-1-æºç " class="headerlink" title="2.3.5.1 æºç "></a>2.3.5.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç ç®¡æ®µé€‰ä¿¡å·æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code digit[<span class="number">8</span>] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>&#125;;</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºæ•°å­—æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code num[<span class="number">8</span>] = &#123;<span class="number">0x7F</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x7C</span>, <span class="number">0x39</span>, <span class="number">0x5E</span>, <span class="number">0x79</span>, <span class="number">0x71</span>&#125;;</span><br><span class="line"><span class="comment">// å®šä¹‰è®¡æ•°å™¨</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = xms; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">110</span>; j &gt; <span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰è®¡æ•°å™¨å¾ªç¯æ§åˆ¶å˜é‡i</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å¾ªç¯æ§åˆ¶å˜é‡j</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡ä½é€‰ä¿¡å·P2å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P3 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡æ®µé€‰ä¿¡å·P0å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P2 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœjç­‰äº4ï¼Œåˆ™å°†jèµ‹å€¼ä¸º0ï¼Œç»§ç»­ä»0å¼€å§‹,countä¹Ÿè´Ÿå€¼ä¸º0ï¼›</span></span><br><span class="line">        <span class="keyword">if</span> (j == <span class="number">8</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="number">0</span>;</span><br><span class="line">			count = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°†æ•°ç ç®¡ä½é€‰ä¿¡å·è®¾ç½®ä¸ºç¬¬jä½</span></span><br><span class="line">        P3 = ~digit[j];</span><br><span class="line">        <span class="comment">// å°†æ•°ç ç®¡æ®µé€‰ä¿¡å·è®¾ç½®ä¸ºå¯¹åº”æ•°å­—</span></span><br><span class="line">        P2 = num[count];</span><br><span class="line">        <span class="comment">// å»¶æ—¶200ms</span></span><br><span class="line">        delay(<span class="number">200</span>);</span><br><span class="line">        <span class="comment">// è®¡æ•°å™¨åŠ 1</span></span><br><span class="line">        count++;</span><br><span class="line">				<span class="comment">// å¾ªç¯æ§åˆ¶å˜é‡jæ¯æ¬¡åŠ 1</span></span><br><span class="line">				j++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-3-5-2-ä»¿çœŸ"><a href="#2-3-5-2-ä»¿çœŸ" class="headerlink" title="2.3.5.2 ä»¿çœŸ"></a>2.3.5.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64230880a682492fcc366767.gif" alt=""></p>
<h4 id="2-3-6-8åªæ•°ç ç®¡æ˜¾ç¤ºä¸åŒå­—ç¬¦"><a href="#2-3-6-8åªæ•°ç ç®¡æ˜¾ç¤ºä¸åŒå­—ç¬¦" class="headerlink" title="2.3.6 8åªæ•°ç ç®¡æ˜¾ç¤ºä¸åŒå­—ç¬¦"></a>2.3.6 8åªæ•°ç ç®¡æ˜¾ç¤ºä¸åŒå­—ç¬¦</h4><h5 id="2-3-6-1-æºç "><a href="#2-3-6-1-æºç " class="headerlink" title="2.3.6.1 æºç "></a>2.3.6.1 æºç </h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç†è®º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç ç®¡æ®µé€‰ä¿¡å·æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code digit[<span class="number">8</span>] = &#123;<span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>&#125;;</span><br><span class="line"><span class="comment">// æ˜¾ç¤ºæ•°å­—æ•°ç»„</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code num[<span class="number">8</span>] = &#123;<span class="number">0x7F</span>, <span class="number">0x6F</span>, <span class="number">0x77</span>, <span class="number">0x7C</span>, <span class="number">0x39</span>, <span class="number">0x5E</span>, <span class="number">0x79</span>, <span class="number">0x71</span>&#125;;</span><br><span class="line"><span class="comment">// å®šä¹‰è®¡æ•°å™¨</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> xms)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = xms; i &gt; <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">110</span>; j &gt; <span class="number">0</span>; j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// å®šä¹‰è®¡æ•°å™¨å¾ªç¯æ§åˆ¶å˜é‡i</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡ä½é€‰ä¿¡å·P2å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P3 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="comment">// å®šä¹‰æ•°ç ç®¡æ®µé€‰ä¿¡å·P0å£ä¸ºè¾“å‡º</span></span><br><span class="line">    P2 = <span class="number">0xff</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">8</span>; i++)&#123;</span><br><span class="line">					<span class="comment">// å°†æ•°ç ç®¡ä½é€‰ä¿¡å·è®¾ç½®ä¸ºç¬¬jä½</span></span><br><span class="line">					P3 = ~digit[i];</span><br><span class="line">					<span class="comment">// å°†æ•°ç ç®¡æ®µé€‰ä¿¡å·è®¾ç½®ä¸ºå¯¹åº”æ•°å­—</span></span><br><span class="line">					P2 = num[i];</span><br><span class="line">					<span class="comment">// å»¶æ—¶5ms</span></span><br><span class="line">					delay(<span class="number">5</span>); <span class="comment">// å»¶æ—¶å¤ŸçŸ­ï¼Œäººçœ¼åˆ†è¾¨ä¸å‡ºæ¥å°±è¡Œ</span></span><br><span class="line">				&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-3-6-2-ä»¿çœŸ"><a href="#2-3-6-2-ä»¿çœŸ" class="headerlink" title="2.3.6.2 ä»¿çœŸ"></a>2.3.6.2 ä»¿çœŸ</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6423c4dca682492fcc194167.gif" alt=""></p>
<h3 id="2-4-ç‹¬ç«‹æŒ‰é”®"><a href="#2-4-ç‹¬ç«‹æŒ‰é”®" class="headerlink" title="2.4 ç‹¬ç«‹æŒ‰é”®"></a>2.4 ç‹¬ç«‹æŒ‰é”®</h3><h4 id="2-4-1-æŒ‰ä¸‹æŒ‰é”®LEDå°ç¯äº®"><a href="#2-4-1-æŒ‰ä¸‹æŒ‰é”®LEDå°ç¯äº®" class="headerlink" title="2.4.1 æŒ‰ä¸‹æŒ‰é”®LEDå°ç¯äº®"></a>2.4.1 æŒ‰ä¸‹æŒ‰é”®LEDå°ç¯äº®</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line">sbit GND = P2^<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">// ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>;<span class="comment">//*****************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>;<span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>;<span class="comment">//*****************************</span></span><br><span class="line">	</span><br><span class="line">	GND = <span class="number">0</span>; <span class="comment">//ä½¿P2.7èƒ½å…·å¤‡è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		P0 = KEY4*<span class="number">0xFF</span>; <span class="comment">//å¾ˆæœ‰æ„æ€ï¼Œè¿™é‡Œç‹¬ç«‹æŒ‰é”®å°±å¥½åƒè¾“å‡º0(æŒ‰ä¸‹æŒ‰é”®)å’Œ1(æ¾å¼€æŒ‰é”®)ä¸€æ ·</span></span><br><span class="line">		<span class="comment">// 0æ—¶8ä¸ªå°ç¯å…¨äº®(0x00)ï¼Œ1æ—¶å…¨ç­(0xff)</span></span><br><span class="line">		<span class="comment">//P0 = ~(KEY4*0xFF)</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div align=center class="aspect-ratio">
    <iframe src="https://player.bilibili.com/player.html?bvid=BV1b84y1T7Ap&page=1&autoplay=0" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>

<h4 id="2-4-2-æŒ‰é”®æŒ‰ä¸‹èœ‚é¸£å™¨é¸£å“"><a href="#2-4-2-æŒ‰é”®æŒ‰ä¸‹èœ‚é¸£å™¨é¸£å“" class="headerlink" title="2.4.2 æŒ‰é”®æŒ‰ä¸‹èœ‚é¸£å™¨é¸£å“"></a>2.4.2 æŒ‰é”®æŒ‰ä¸‹èœ‚é¸£å™¨é¸£å“</h4><p>ä½¿ç”¨æ— æºèœ‚é¸£å™¨ï¼ŒæŒ‰é”®æŒ‰ä¸‹æ—¶ï¼Œèœ‚é¸£å™¨å°±å“ï¼Œæ¾å¼€ä¸æŒ‰æ—¶å°±ä¸å“ã€‚æˆ‘ä»¬çŸ¥é“<code>åœ¨P2^3è¾“å‡ºä½ç”µå¹³çš„æƒ…å†µä¸‹ï¼ŒK4æŒ‰ä¸‹çš„æ—¶å€™ç¨‹åºé’ŸKEY4ç­‰äº0ï¼Œæ¾å¼€ä¸æŒ‰æ—¶KEY4ç­‰äº1</code>ã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³è¦å®ç°ç›®çš„ï¼Œå¯ä»¥åœ¨ä¸»å‡½æ•°ä¸­çš„æ­»å¾ªç¯ä¸­ç”¨<code>if(KEY4==0)</code>æ¥ä¸€ç›´ç­‰å¾…<code>K4</code>è¢«æŒ‰ä¸‹ï¼Œäºæ˜¯KEY4çš„å€¼ç­‰äº0æ‰èƒ½è¿›å…¥ifè¯­å¥é’Ÿæ‰§è¡Œç¨‹åºã€‚ä¸æŒ‰ä¸‹æ—¶<code>KEY4ç­‰äº1</code>å°±ä¸èƒ½è¿›å…¥æ‰§è¡Œç¨‹åºï¼ŒCPUä¹‹åªèƒ½æ‰§è¡Œç©ºå¾ªç¯ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit BEEP = P1^<span class="number">6</span>;</span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//è®©K4å…·å¤‡æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶ -&gt;1111 0111 -&gt; P2^3è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">			BEEP = !BEEP;</span><br><span class="line">			<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">25</span>; i++); <span class="comment">//ä¸åŒæ—¶é—´çš„å»¶æ—¶é¸£å«çš„éŸ³è°ƒä¸åŒ</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div align=center class="aspect-ratio">
    <iframe src="https://player.bilibili.com/player.html?aid=867173357&bvid=BV1BV4y1f76n&cid=1087827885&page=1&autoplay=0" 
    scrolling="no" 
    border="0" 
    frameborder="no" 
    framespacing="0" 
    high_quality=1
    danmaku=1 
    allowfullscreen="true"> 
    </iframe>
</div>

<h4 id="2-4-3-æµ‹è¯•â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2-7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿"><a href="#2-4-3-æµ‹è¯•â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2-7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿" class="headerlink" title="2.4.3 æµ‹è¯•â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2.7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿"></a>2.4.3 æµ‹è¯•â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2.7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿</h4><p>â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2.7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿ï¼Œç”¨æµæ°´ç¯çš„æ–¹å¼æ¥æŸ¥çœ‹æŒ‰ä¸‹ä¹‹åè¿…é€Ÿæ¾å¼€ï¼Œå°ç¯ä¼šè·³åˆ°å“ªé‡Œæ˜¾ç¤ºã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">1</span>;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>;<span class="comment">//*****************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>;<span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>;<span class="comment">//*****************************</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>;<span class="comment">//ä½¿P2^7å…·å¤‡è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	P0 = <span class="number">0xFE</span>;<span class="comment">//å…ˆç‚¹äº®æœ€å³ç«¯çš„å°ç¯</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">			delay(<span class="number">10</span>);</span><br><span class="line">			P0 = ~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">			i++;</span><br><span class="line">			<span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®dotcppç½‘ç«™çš„æµ‹è¯•å¾—å‡ºä¸€ä¸‹ç»“è®ºï¼š<code>å³ä½¿æ‰‹é€Ÿå†æ€ä¹ˆå¿«åœ°æŒ‰ä¸‹K4é©¬ä¸Šæ¾å¼€ï¼Œå¯åœ¨è¿™æ®µæ—¶é—´é‡Œç‚¹äº®çš„LED2è·³åˆ°äº†LED5ç‚¹äº®ï¼Œä¹Ÿå°±æ˜¯è¯´æŒ‰é”®åœ¨ç‰©ç†ä¸Šçš„å¯¼é€šæ—¶é—´è¶…è¿‡äº†30ms</code>åé¢iç»å¯¹å¤§äº3ï¼Œå› ä¸ºLED5äº®ï¼Œæ‰€ä»¥æœ‰â€œP0=0xF7;â€æ¨å‡ºâ€œ ~(0x01&lt;&lt;3)â€ï¼Œç„¶åå†æœ‰â€œi++;â€ï¼Œiç»å¯¹å¤§äº3ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643142c60d2dde577786f63d.png" alt=""></p>
<p><code>P2.7åœ¨æŒ‰é”®åŠ¨ä½œä¸­è¢«æ‹‰ä½çš„æŒç»­æ—¶é—´å°±æœ‰60~90ms</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643143610d2dde577788b149.png" alt=""></p>
<h4 id="2-4-4-æŒ‰é”®æ§åˆ¶ç¯äº®ç¯ç­"><a href="#2-4-4-æŒ‰é”®æ§åˆ¶ç¯äº®ç¯ç­" class="headerlink" title="2.4.4 æŒ‰é”®æ§åˆ¶ç¯äº®ç¯ç­"></a>2.4.4 æŒ‰é”®æ§åˆ¶ç¯äº®ç¯ç­</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… å¤§å®¶ä¼šå‘ç°è¿™ç§æ–¹æ³•æ˜¯å­˜åœ¨ç¼ºé™·çš„</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//*************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">//*************************</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿KEY4å…·å¤‡è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">			delay(<span class="number">50</span>); <span class="comment">//å»¶è¿Ÿ50ms</span></span><br><span class="line">			<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123; <span class="comment">//åœ¨æ­¤åˆ¤æ–­ï¼Œå¦‚æœä»ä¸º0å°±è¯´æ˜æ˜¯ç¨³å®šæ€çš„æŒ‰ä¸‹0</span></span><br><span class="line">				<span class="comment">// æ‰§è¡Œä»£ç </span></span><br><span class="line">				LED = !LED; <span class="comment">// æ¯è¿›å…¥ä¸€æ¬¡éƒ½å°†æ”¹å˜ä¸€æ¬¡LEDçš„çŠ¶æ€ï¼Œè€Œè¿›å…¥éœ€è¦åˆ¤æ–­KEY4çš„çŠ¶æ€ï¼Œå®ç°æŒ‰é”®æ§åˆ¶LEDã€‚</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯æ˜¯æ¯ä¸ªäººçš„æŒ‰é”®æ‰‹é€Ÿä¸åŒï¼Œæˆ‘ä»¬å‘ç°å¦‚æœæŒ‰ä¸‹çš„æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ï¼ˆæ²¡æ¾æ‰‹ï¼‰ï¼Œé‚£ä¹ˆLED2å°±ä¼šé—ªçƒï¼Œä¹Ÿå°±æ˜¯â€œLED2=!LED2;â€è¢«å¤šæ¬¡æ‰§è¡Œï¼Œè¦æ˜¯åˆ»æ„å¿«é€ŸæŒ‰ä¸‹å°±æ¾æ‰‹ï¼ŒLED2æ²¡ååº”ï¼Œæ‰€ä»¥è¿™æ ·çš„ä»£ç æ˜¯åšä¸åˆ°æ™®éé€šç”¨çš„ã€‚è¿˜æœ‰æˆ‘ä»¬ç”¨50msåšå»¶æ—¶å¤ªå½±å“CPUçš„è¿è¡Œæ•ˆç‡äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¼•å…¥<code>æ”¯æŒè¿æŒ‰</code>å’Œ<code>ä¸æ”¯æŒè¿æŒ‰</code>çš„æŒ‰é”®æ¦‚å¿µã€‚</p>
<h4 id="2-4-5-ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼"><a href="#2-4-5-ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼" class="headerlink" title="2.4.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼"></a>2.4.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼</h4><p>åŸºäº1.7.5èŠ‚çš„åˆ†æï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç å®ç°ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼ã€‚å¯ä»¥å‘ç°æ— è®ºæˆ‘ä»¬çš„æŒ‰ä¸‹æ‰‹é€Ÿæœ‰å¤šå¿«æˆ–å¤šæ…¢ï¼Œâ€œ LED2=!LED2;â€åªèƒ½è¢«æ‰§è¡Œä¸€æ¬¡è€Œå·²ã€‚è¿™æ ·å°±åƒæŒ‰ç”µç£ç‚‰ä¸Šçš„æŒ‰é”®ä¸€æ ·ï¼Œä¸€æ¬¡åªèƒ½åˆ‡æ¢ä¸€å›ç¯çš„äº®ç­ï¼Œå³ä½¿ä¸æ¾æ‰‹ä¹Ÿä¸ä¼šå‡ºç°ç¯çš„é—ªçƒï¼Œè¿™å°±æ˜¯ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç ä¹¦å†™æ–¹å¼ï¼Œä¸è¿‡è¿™æ ·çš„ä»£ç è¿˜æ˜¯å­˜åœ¨ç¼ºé™·</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™…</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    ENLED = <span class="number">0</span>;</span><br><span class="line">    ADDR3 = <span class="number">1</span>; <span class="comment">// ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    </span><br><span class="line">    ADDR2 = <span class="number">1</span>; <span class="comment">//************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>; <span class="comment">//************************</span></span><br><span class="line">    </span><br><span class="line">    P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿P2^7å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">            delay_ms(<span class="number">10</span>); <span class="comment">//ç­‰å¾…æŠ–åŠ¨è¿‡å»</span></span><br><span class="line">            <span class="keyword">if</span> (KEY4 == <span class="number">0</span>) &#123; <span class="comment">//äºŒæ¬¡åˆ¤æ–­</span></span><br><span class="line">                LED = !LED;</span><br><span class="line">                <span class="keyword">while</span>(KEY4 == <span class="number">0</span>); <span class="comment">//å¦‚æœIOç«¯å£è¿˜æ˜¯ä¿æŒä½ç”µå¹³ï¼Œæ­¤æ—¶ä¹Ÿå°±æ˜¯æ²¡æœ‰æ¾æ‰‹ï¼Œé‚£</span></span><br><span class="line">				<span class="comment">//æ‹¬å·é‡Œçš„æ¡ä»¶æ»¡è¶³ï¼Œç¨‹åºä¸€ç›´åœ¨å¾ªç¯è¿™æ¡è¯­å¥ï¼Œæ‰€ä»¥ç¨‹åºåœæ­¢ä¸å¾€ä¸‹æ‰§è¡Œäº†ï¼Œ</span></span><br><span class="line">				<span class="comment">//ç›´åˆ°KEY4ç­‰äº1ï¼Œä¹Ÿå°±æ˜¯æŒ‰é”®æ¾æ‰‹äº†ï¼Œwhileé‡Œé¢çš„æ¡ä»¶ä¸æˆç«‹æ‰é€€å‡ºå¾ªç¯ï¼Œæ”¾è¡Œç¨‹åº</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ”¹å–„æˆ‘ä»¬çš„ä»£ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å·¥ä½œå®¤å¼€å‘æ¿ æŒ‰ä¸‹æ¾å¼€åå°ç¯å·¦ç§»</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">1</span>; <span class="comment">//å®šä¹‰è®°å½•æŒ‰é”®çŠ¶æ€å€¼çš„å˜é‡ï¼Œåˆå§‹å€¼ä¸º1æ˜¯ä¸ºäº†</span></span><br><span class="line">	<span class="comment">// é¿å…ç¨‹åºä¸€å¼€å§‹å°±è¿›å…¥if(key_up==0)</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//***************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨IO6å£è¾“å‡ºä½ç”µå¹³ </span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">//***************************</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿P2^7å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	P0 = <span class="number">0xFE</span>; <span class="comment">//å…ˆç‚¹äº®LEDç¯</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(KEY4 == <span class="number">1</span>) &#123; <span class="comment">// åªè¦ä¸æ¾æ‰‹ï¼ŒKEY4å°±ä¼šç­‰äºé›¶, åªè¦åœ¨æŒ‰é”®æŠ¬èµ·ä¹‹åæ‰æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">				P0 = ~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">				i++;</span><br><span class="line">				<span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125;</span><br><span class="line">		key_up = KEY4; <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0 </span></span><br><span class="line">		delay_ms(<span class="number">2</span>); <span class="comment">//å‡è®¾è¿™éƒ¨åˆ†æ˜¯è¦æ‰§è¡Œçš„å…¶ä»–ç¨‹åº</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å·¥ä½œå®¤å•ç‰‡æœº æŒ‰ä¸‹å°ç¯å·¦ç§» æ¾å¼€ä¸å˜</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶æ—¶å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">0</span>; <span class="comment">//å®šä¹‰è®°å½•æŒ‰é”®çŠ¶æ€å€¼çš„å˜é‡ï¼Œåˆå§‹å€¼ä¸º0æ˜¯ä¸ºäº†</span></span><br><span class="line">	<span class="comment">// é¿å…ç¨‹åºä¸€å¼€å§‹å°±è¿›å…¥if(key_up==0)</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//***************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨IO6å£è¾“å‡ºä½ç”µå¹³ </span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">//***************************</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿P2^7å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	P0 = <span class="number">0xFE</span>; <span class="comment">//å…ˆç‚¹äº®LEDç¯</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(key_up == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123; <span class="comment">// åªè¦ä¸æ¾æ‰‹ï¼ŒKEY4å°±ä¼šç­‰äºé›¶, åªè¦åœ¨æŒ‰é”®æŠ¬èµ·ä¹‹åæ‰æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">				P0 = ~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">				i++;</span><br><span class="line">				<span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">			&#125;	</span><br><span class="line">		&#125;</span><br><span class="line">		key_up = KEY4; <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0 </span></span><br><span class="line">		delay_ms(<span class="number">2</span>); <span class="comment">//å‡è®¾è¿™éƒ¨åˆ†æ˜¯è¦æ‰§è¡Œçš„å…¶ä»–ç¨‹åº</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å·¥ä½œå®¤ æŒ‰é”®æ§åˆ¶å·¦å³ç§»æµæ°´ç¯</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit LED = P0^<span class="number">0</span>;</span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»¶è¿Ÿå‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key_up = <span class="number">0</span>; <span class="comment">//key_upç”¨äºç›‘æ§KEY4çš„çŠ¶æ€ï¼Œåˆå€¼0æ˜¯ä¸ºäº†é¿å…ç›´æ¥è¿›å…¥if(key_up==1)</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">1</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> mask = <span class="number">10000000</span>; <span class="comment">//æ©ç </span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a = <span class="number">0x7F</span>;</span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//*****************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿æ˜¯ä¸‰å…«è¯‘ç å™¨IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">// ****************************</span></span><br><span class="line">	</span><br><span class="line">	LED = <span class="number">0</span>; <span class="comment">//äº‹å…ˆç‚¹äº®ä¸€ä¸ªLED</span></span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿P2^7å…·æœ‰èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(key_up == <span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">if</span>(i == <span class="number">15</span>)&#123;</span><br><span class="line">					i = <span class="number">1</span>;</span><br><span class="line">					a = <span class="number">0x7F</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			<span class="keyword">if</span>(KEY4 == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span>(i &lt; <span class="number">8</span>)&#123;</span><br><span class="line">					P0 = ~(<span class="number">0x01</span> &lt;&lt; i);</span><br><span class="line">					i++;</span><br><span class="line">				&#125; <span class="comment">// å·¦ç§»</span></span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					a = mask|(a &gt;&gt; <span class="number">1</span>);</span><br><span class="line">					P0 = a;</span><br><span class="line">					i++;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		key_up = KEY4;</span><br><span class="line">		delay(<span class="number">50</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-6-å›å½’æŒ‰é”®"><a href="#2-4-6-å›å½’æŒ‰é”®" class="headerlink" title="2.4.6 å›å½’æŒ‰é”®"></a>2.4.6 å›å½’æŒ‰é”®</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… å›å½’æŒ‰é”® ä½¿ç”¨staticé™æ€å˜é‡å…³é”®å­—</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line">sbit LED2 = P0^<span class="number">0</span>;</span><br><span class="line"><span class="comment">// å»¶è¿Ÿå‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> i, j;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;x; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>; j&lt;<span class="number">120</span>; j++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_task</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(key_up==<span class="number">0</span>)</span><br><span class="line">    &#123;      </span><br><span class="line">        <span class="keyword">if</span>(KEY4==<span class="number">1</span>)<span class="comment">//ä¸æ”¯æŒè¿æŒ‰</span></span><br><span class="line">        &#123;</span><br><span class="line">            LED2 = !LED2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    key_up=KEY4;   <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0 </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	ADDR2 = <span class="number">1</span>; <span class="comment">//*****************************</span></span><br><span class="line">	ADDR1 = <span class="number">1</span>; <span class="comment">//ä½¿ä¸‰å…«è¯‘ç å™¨çš„IO6å£è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">	ADDR0 = <span class="number">0</span>; <span class="comment">//*****************************</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿P2^7å…·å¤‡è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		KEY_task(); <span class="comment">// æŒ‰é”®åŠŸèƒ½ä»»åŠ¡</span></span><br><span class="line">		delay_ms(<span class="number">2</span>); <span class="comment">// è¿™é‡Œå¯ä»¥æ”¾å…¶ä»–ç¨‹åº</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-7-æ”¯æŒè¿æŒ‰"><a href="#2-4-7-æ”¯æŒè¿æŒ‰" class="headerlink" title="2.4.7 æ”¯æŒè¿æŒ‰"></a>2.4.7 æ”¯æŒè¿æŒ‰</h4><p>è¿™æ¬¡æˆ‘ä»¬æŠŠæ•°ç ç®¡æ˜¾ç¤ºçš„å†…å®¹ä»£ç å°è£…æˆå‡½æ•°ï¼Œå®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡cntï¼Œcntåœ¨ä¸»å‡½æ•°ä¸­é€šè¿‡æŒ‰é”®åŠ¨ä½œæ¥æ”¹å˜è¿™ä¸ªå€¼ï¼Œç„¶åæ•°ç ç®¡è´Ÿè´£æ˜¾ç¤ºè¿™ä¸ªæ•°ï¼›å®éªŒç°è±¡å°±æ˜¯æŒ‰ç€K4ä¸æ”¾ï¼Œæ•°ç ç®¡æ˜¾ç¤ºcntçš„å€¼ä¸€ç›´ç´¯åŠ ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>] = &#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;; <span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>] = &#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cnt = <span class="number">0</span>; <span class="comment">//å¯ä»¥åœ¨SEG_task()å’Œmainä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span> <span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line">	LedBuff[<span class="number">0</span>] = LedChar[cnt%<span class="number">10</span>];</span><br><span class="line">	<span class="keyword">if</span>(cnt&gt;=<span class="number">10</span>)LedBuff[<span class="number">1</span>] = LedChar[(cnt/<span class="number">10</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡æœ‰è¾¾åˆ°10ä¹‹å‰ä¸æ›´æ–°LedBuff[1]çš„åˆå§‹å€¼</span></span><br><span class="line">	<span class="keyword">if</span>(cnt&gt;=<span class="number">100</span>)LedBuff[<span class="number">2</span>] = LedChar[(cnt/<span class="number">100</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡æœ‰è¾¾åˆ°100ä¹‹å‰ä¸æ›´æ–°LedBuff[2]çš„åˆå§‹å€¼</span></span><br><span class="line">	<span class="keyword">if</span>(cnt==<span class="number">0</span>)&#123; </span><br><span class="line">		LedBuff[<span class="number">1</span>] = <span class="number">0xFF</span>; </span><br><span class="line">		LedBuff[<span class="number">2</span>] = <span class="number">0xFF</span>;</span><br><span class="line">	&#125; <span class="comment">//cntåˆ°è¾¾255ä¹‹åå†åŠ 1å°±æº¢å‡ºå˜ä¸º0äº†ï¼Œè¿™æ—¶å€™è¦å†æ¬¡ç†„ç­è¿™ä¸¤ä¸ªæ•°ç ç®¡</span></span><br><span class="line">	</span><br><span class="line">	P0 = <span class="number">0xFF</span>; <span class="comment">// ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡é‡Œçš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">	<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">0</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; P0= LedBuff[<span class="number">1</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">2</span>]; i=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">1</span>;<span class="comment">//å®šä¹‰è®°å½•æŒ‰é”®çŠ¶æ€å€¼çš„å˜é‡,åˆå§‹å€¼ä¸º1é¿å…ç¨‹åºä¸€å¼€å§‹å°±è¿›å…¥äº†â€œif(key_up==0)â€</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>  times=<span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">    P2 = <span class="number">0xF7</span>;<span class="comment">//è®©K4èƒ½å…·å¤‡æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶å…ˆ</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        SEG_task();<span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºä»»åŠ¡</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">//æŒ‰é”®åŠŸèƒ½éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">if</span>(key_up==<span class="number">0</span>)</span><br><span class="line">        &#123;      </span><br><span class="line">            <span class="keyword">if</span>(KEY4==<span class="number">0</span>)         <span class="comment">//ä¹‹å‰â€œKEY4==1â€æ˜¯ä¸æ”¯æŒè¿æŒ‰ï¼Œç°åœ¨æ”¹ä¸ºâ€œKEY4==0â€å°±æˆä¸ºæ”¯æŒè¿æŒ‰äº†</span></span><br><span class="line">            &#123;</span><br><span class="line">                times++;</span><br><span class="line">                <span class="keyword">if</span>(times&gt;=<span class="number">1000</span>) <span class="comment">//æŒ‰é”®IOç«¯å£ä¸€ç›´æ˜¯ä½ç”µå¹³timeså°±ä¸€ç›´ç´¯åŠ ï¼Œç´¯åŠ åˆ°1000æ„å‘³ä½ç”µå¹³æŒç»­äº†ä¸€æ®µæ—¶é—´äº†ï¼Œè¯¥æ‰§è¡ŒåŠŸèƒ½ä»£ç äº†,ä¿®æ”¹1000è¿™ä¸ªæ•°çš„è¯é‚£ä¹ˆcntè‡ªåŠ çš„é€Ÿåº¦å°±ä¼šæ”¹å˜</span></span><br><span class="line">                &#123;</span><br><span class="line">                    times=<span class="number">0</span>;</span><br><span class="line">                    cnt++;      <span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        key_up=KEY4;            <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0  </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-8-ä¼˜åŒ–ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç "><a href="#2-4-8-ä¼˜åŒ–ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç " class="headerlink" title="2.4.8 ä¼˜åŒ–ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç "></a>2.4.8 ä¼˜åŒ–ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç </h4><p>åœ¨<code>æŒ‰é”®ä¸æ”¯æŒè¿æŒ‰</code>å³<code>2.4.5</code>èŠ‚çš„ä»£ç ä¸­ï¼Œæ­»å¾ªç¯éƒ½æœ‰<code>delay_ms(2);\delay(2)</code>,å› ä¸ºå¤§å¤šæ•°æ—¶å€™ä¸»å¾ªç¯éƒ½è¦åšå¾ˆå¤šäº‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºè¿™2msçš„å»¶æ—¶æ˜¯å¾ˆå¤šå¤æ‚ç¨‹åºè¦æ‰§è¡Œæ‰€æ¶ˆè€—çš„æ—¶é—´ï¼Œè€Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªå»¶æ—¶å‡½æ•°çš„å­˜åœ¨æŠŠæŒ‰é”®çš„ç‰©ç†æŠ–åŠ¨ç»™æ»¤æ‰äº†ï¼Œè¯¯å¯¼äº†æˆ‘ä»¬ä»¥ä¸ºè¿™æ ·çš„ä¸æ”¯æŒè¿æŒ‰ä»£ç æ˜¯åˆæ ¼çš„ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ˜¯ç”¨è¿™ç§å†™æ³•å»å®ç°ä¸æ”¯æŒè¿æŒ‰åŠŸèƒ½ï¼Œé‚£ä¹ˆè¯·æŠŠä¸‹é¢çš„ä»£ç ä¸‹è½½è¿›å¼€å‘æ¿é€šè¿‡<code>å¿«æŒ‰</code>å’Œ<code>æ…¢æŒ‰</code>K4ï¼Œè§‚å¯Ÿæ•°ç ç®¡çš„æ˜¾ç¤ºã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">  </span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit KEY4  = P2^<span class="number">7</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>]=&#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;;<span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>]=&#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">// æ•°ç ç®¡ç¼“å†²</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cnt=<span class="number">0</span>;<span class="comment">//å¯ä»¥åœ¨SEG_task()å’Œmain()ä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span><span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line">    LedBuff[<span class="number">0</span>]= LedChar[cnt%<span class="number">10</span>];   </span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">10</span>) LedBuff[<span class="number">1</span>]= LedChar[(cnt/<span class="number">10</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡åˆ°è¾¾10ä¹‹å‰ä¸æ›´æ–°LedBuff[1]çš„åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">100</span>)LedBuff[<span class="number">2</span>]= LedChar[(cnt/<span class="number">100</span>)%<span class="number">10</span>];<span class="comment">//cntæ²¡åˆ°è¾¾100ä¹‹å‰ä¸æ›´æ–°LedBuff[2]çš„åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">0</span>)&#123; LedBuff[<span class="number">1</span>]=<span class="number">0xFF</span>;LedBuff[<span class="number">2</span>]=<span class="number">0XFF</span>; &#125;<span class="comment">//cntåˆ°è¾¾255ä¹‹åå†åŠ 1å°±æº¢å‡ºå˜ä¸º0äº†ï¼Œè¿™æ—¶å€™è¦å†æ¬¡ç†„ç­è¿™ä¸¤ä¸ªæ•°ç ç®¡</span></span><br><span class="line">   </span><br><span class="line">    P0=<span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">switch</span>(i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">0</span>];i++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">1</span>;P0=LedBuff[<span class="number">1</span>];i++;<span class="keyword">break</span>;     </span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">1</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">2</span>];i=<span class="number">0</span>;<span class="keyword">break</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">1</span>;<span class="comment">//å®šä¹‰è®°å½•æŒ‰é”®çŠ¶æ€å€¼çš„å˜é‡,åˆå§‹å€¼ä¸º1é¿å…ç¨‹åºä¸€å¼€å§‹å°±è¿›å…¥äº†â€œif(key_up==0)â€</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>  times=<span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">    P2 = <span class="number">0xF7</span>;<span class="comment">//è®©K4èƒ½å…·å¤‡æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶å…ˆ</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        SEG_task();<span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºä»»åŠ¡</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment">//æŒ‰é”®åŠŸèƒ½éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">if</span>(key_up==<span class="number">0</span>)</span><br><span class="line">        &#123;      </span><br><span class="line">            <span class="keyword">if</span>(KEY4==<span class="number">1</span>)<span class="comment">//æŒ‰é”®å·²å¼¹èµ·</span></span><br><span class="line">            &#123;</span><br><span class="line">                cnt++; <span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        key_up=KEY4;   <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0    </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¤šæŒ‰å‡ æ¬¡ï¼Œä¼šå‘ç°æœ‰æ—¶æŠ¬èµ·ä¹‹åcntå°±è¢«åŠ 2äº†æˆ–è€…æ›´å¤šï¼Œä¹Ÿå°±æ˜¯åœ¨ä¸€æ¬¡æŒ‰é”®çš„åŠ¨ä½œé‡Œ<code>cnt++;</code>è¢«æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œè¿™æ˜¯å› ä¸º<code>SEG_task();</code>çš„æ‰§è¡Œæ—¶é—´å¤ªçŸ­<code>æ²¡æœ‰æ»¤æ‰æŒ‰é”®çš„æŠ–åŠ¨</code>ï¼Œå¤§å®¶å†æ¬¡å¯¹ç…§ä¸‹å›¾è‡ªå·±åˆ†æ</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643523e00d2dde57777f75e1.png" alt=""></p>
<p>æœ‰äº†<code>æ”¯æŒè¿æŒ‰</code>çš„ä»£ç æ€è·¯ï¼Œå®ç°æ¶ˆæŠ–è¿˜æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œæˆ‘ä»¬åŒæ ·ç”¨ä¸Štimesè®°å½•æŒ‰é”®IOç«¯å£è¿›å…¥ä½ç”µå¹³çš„æ—¶é—´ï¼Œ<code>åªè¦timeså¤§äº500</code>è¯æ˜æŠ–åŠ¨çš„æ—¶é—´å·²ç»è¿‡å»ï¼Œæ­¤æ—¶å†åˆ¤æ–­æŒ‰é”®æ˜¯å¦æŠ¬èµ·å°±å¯ä»¥å†³å®šè¯¥ä¸è¯¥æ‰§è¡ŒåŠŸèƒ½ä»£ç äº†ã€‚å¾ˆæœ‰æ„æ€</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">  </span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit KEY4  = P2^<span class="number">7</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>]=&#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;;<span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>]=&#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">// æ•°ç ç®¡ç¼“å†²</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cnt=<span class="number">0</span>;<span class="comment">//å¯ä»¥åœ¨SEG_task()å’Œmain()ä¸­ä½¿ç”¨çš„å…¨å±€å˜é‡</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span><span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line">    LedBuff[<span class="number">0</span>]= LedChar[cnt%<span class="number">10</span>];   </span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">10</span>) LedBuff[<span class="number">1</span>]= LedChar[(cnt/<span class="number">10</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡åˆ°è¾¾10ä¹‹å‰ä¸æ›´æ–°LedBuff[1]çš„åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(cnt&gt;=<span class="number">100</span>)LedBuff[<span class="number">2</span>]= LedChar[(cnt/<span class="number">100</span>)%<span class="number">10</span>];<span class="comment">//cntæ²¡åˆ°è¾¾100ä¹‹å‰ä¸æ›´æ–°LedBuff[2]çš„åˆå§‹å€¼</span></span><br><span class="line">    <span class="keyword">if</span>(cnt==<span class="number">0</span>)&#123; LedBuff[<span class="number">1</span>]=<span class="number">0xFF</span>;LedBuff[<span class="number">2</span>]=<span class="number">0XFF</span>; &#125;<span class="comment">//cntåˆ°è¾¾255ä¹‹åå†åŠ 1å°±æº¢å‡ºå˜ä¸º0äº†ï¼Œè¿™æ—¶å€™è¦å†æ¬¡ç†„ç­è¿™ä¸¤ä¸ªæ•°ç ç®¡</span></span><br><span class="line">   </span><br><span class="line">    P0=<span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">switch</span>(i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">0</span>];i++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">1</span>;P0=LedBuff[<span class="number">1</span>];i++;<span class="keyword">break</span>;     </span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">1</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">2</span>];i=<span class="number">0</span>;<span class="keyword">break</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> key_up=<span class="number">1</span>;<span class="comment">//å®šä¹‰è®°å½•æŒ‰é”®çŠ¶æ€å€¼çš„å˜é‡,åˆå§‹å€¼ä¸º1é¿å…ç¨‹åºä¸€å¼€å§‹å°±è¿›å…¥äº†â€œif(key_up==0)â€</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span>  times=<span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">    P2 = <span class="number">0xF7</span>;<span class="comment">//è®©K4èƒ½å…·å¤‡æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶å…ˆ</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        SEG_task();<span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºä»»åŠ¡</span></span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span>  times=<span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//æŒ‰é”®åŠŸèƒ½éƒ¨åˆ†</span></span><br><span class="line">        <span class="keyword">if</span>(key_up==<span class="number">0</span>)</span><br><span class="line">        &#123;      </span><br><span class="line">            times++;     </span><br><span class="line">            <span class="keyword">if</span>(times&gt;=<span class="number">500</span>&amp;&amp;KEY4==<span class="number">1</span>)<span class="comment">//ä½ç”µå¹³æŒç»­å¤Ÿä¸€å®šçš„æ—¶é—´äº†ï¼Œè¯æ˜æŠ–åŠ¨æ—¶é—´å·²ç»è¿‡å»äº†ï¼Œå¦‚æœç°åœ¨æŒ‰é”®å·²ç»æŠ¬èµ·å°±æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">            &#123;</span><br><span class="line">                times=<span class="number">0</span>;</span><br><span class="line">                cnt++;<span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç   </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        key_up=KEY4; <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0 </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-9-åŒæ¨¡å¼å‡½æ•°å°è£…"><a href="#2-4-9-åŒæ¨¡å¼å‡½æ•°å°è£…" class="headerlink" title="2.4.9 åŒæ¨¡å¼å‡½æ•°å°è£…"></a>2.4.9 åŒæ¨¡å¼å‡½æ•°å°è£…</h4><hr>
<ul>
<li><p>é¢˜ç›®</p>
<p>æˆ‘ä»¬ç”¨æœ€å·¦ç«¯çš„æ•°ç ç®¡æ¥æç¤ºæ­¤æ—¶çš„K4æ˜¯<code>æ”¯æŒè¿æŒ‰</code>è¿˜æ˜¯<code>ä¸æ”¯æŒè¿æŒ‰</code>ï¼Œè¿™ä¸ªæ•°ç ç®¡æ˜¾ç¤º0çš„æ—¶å€™ä¸æ”¯æŒè¿æŒ‰ï¼Œæ˜¾ç¤º1çš„æ—¶å€™æ”¯æŒè¿æŒ‰ã€‚</p>
<p>ç”¨K3æ¥åˆ‡æ¢æŒ‰é”®æ¨¡å¼ï¼ŒK3çš„æŒ‰é”®æ¨¡å¼æ˜¯ä¸æ”¯æŒè¿æŒ‰çš„ï¼ŒæŒ‰ä¸‹æ¾å¼€å°±æ˜¯æŠŠK4åˆ‡æ¢ä¸ºå¦ä¸€ç§æŒ‰é”®æ¨¡å¼ã€‚</p>
<p>ç„¶åæˆ‘ä»¬é€šè¿‡æŒ‰K4ï¼ŒåŒæ ·<code>å³è¾¹çš„3ä¸ªæ•°ç ç®¡æ˜¾ç¤ºcnt</code>çš„å€¼ï¼Œæ”¯æŒè¿æŒ‰æ—¶ï¼ŒæŒ‰ä¸‹ä¸æ”¾å°±ä¸€ç›´è‡ªåŠ¨ç´¯åŠ ï¼Œä¸æ”¯æŒè¿æŒ‰æ—¶ï¼ŒæŒ‰ä¸‹æ¾å¼€æ‰ç´¯åŠ 1ã€‚</p>
</li>
</ul>
<hr>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit LED2 = P0^<span class="number">0</span>;</span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line">sbit KEY3 = P2^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>] = &#123;<span class="number">0xC0</span>, <span class="number">0xF9</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>, <span class="number">0x99</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x83</span>, <span class="number">0xC6</span>, <span class="number">0xA1</span>, <span class="number">0x86</span>, <span class="number">0x8E</span>&#125;; <span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>] = &#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº,å…¨å±€å˜é‡</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cnt; <span class="comment">//åœ¨KEY_task()å’ŒSEG_task()é‡Œç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span> &#123; <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// è°ƒæ•´æ•°ç ç®¡çš„æ•°å­—</span></span><br><span class="line">	LedBuff[<span class="number">0</span>] = LedChar[cnt%<span class="number">10</span>]; <span class="comment">// ä¸ªä½</span></span><br><span class="line">	<span class="keyword">if</span>(cnt&gt;=<span class="number">10</span>) LedBuff[<span class="number">1</span>] = LedChar[(cnt/<span class="number">10</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡åˆ°è¾¾10ä¹‹å‰ä¸æ›´æ–°LedBuff[1]çš„åˆå§‹å€¼ åä½</span></span><br><span class="line">	<span class="keyword">if</span>(cnt&gt;=<span class="number">100</span>) LedBuff[<span class="number">2</span>] = LedChar[(cnt/<span class="number">100</span>)%<span class="number">10</span>]; <span class="comment">//cntæ²¡åˆ°è¾¾100ä¹‹å‰ä¸æ›´æ–°LedBuff[2]çš„åˆå§‹å€¼ ç™¾ä½</span></span><br><span class="line">	<span class="keyword">if</span>(cnt==<span class="number">0</span>)&#123; LedBuff[<span class="number">1</span>] = <span class="number">0xFF</span>; LedBuff[<span class="number">2</span>] = <span class="number">0xFF</span>;&#125; <span class="comment">//cntè¾¾åˆ°255ä¹‹ååœ¨åŠ 1å°±æº¢å‡ºå˜ä¸º0äº†ï¼Œè¿™æ—¶å€™å†æ¬¡ç†„ç­è¿™ä¸¤ä¸ªæ•°ç ç®¡</span></span><br><span class="line">	</span><br><span class="line">	P0 = <span class="number">0xFF</span>; <span class="comment">//ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡é‡Œçš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">	<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">0</span>]; i++; <span class="keyword">break</span>; <span class="comment">//çº¿é€‰æ•°ç ç®¡0ï¼Œå¹¶æ˜¾ç¤ºæ•°å­—</span></span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; P0 = LedBuff[<span class="number">1</span>]; i++; <span class="keyword">break</span>; <span class="comment">//çº¿é€‰æ•°ç ç®¡1ï¼Œå¹¶æ˜¾ç¤ºæ•°å­—</span></span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">2</span>]; i++; <span class="keyword">break</span>; <span class="comment">//çº¿é€‰æ•°ç ç®¡2ï¼Œå¹¶æ˜¾ç¤ºæ•°å­—</span></span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>: ADDR2 = <span class="number">1</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; P0 = LedBuff[<span class="number">5</span>]; i=<span class="number">0</span>; <span class="keyword">break</span>; <span class="comment">//çº¿é€‰æ•°ç ç®¡5ï¼Œå¹¶æ˜¾ç¤ºæŒ‰é”®æ¨¡å¼å¯¹åº”çš„æ•°å­—</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_task</span><span class="params">()</span> &#123; <span class="comment">//æŒ‰é”®æŒ‰ä¸‹æ‰€éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡</span></span><br><span class="line">	cnt++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_mode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> mode)</span> &#123;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> key_up = <span class="number">1</span>;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°ï¼Œå¯ä»¥æ‹¿æ¥é˜²æŠ–</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">		times++;</span><br><span class="line">		<span class="keyword">if</span>(mode == <span class="number">1</span> &amp;&amp; times &gt;= <span class="number">1000</span>) <span class="comment">//modeç­‰äº1ï¼Œè¯¥éƒ¨åˆ†ä»£ç æ˜¯ç”¨æ¥å®ç°æ”¯æŒè¿æŒ‰çš„ï¼Œ1000æ˜¯ä¸ºäº†è®©è¿æŒ‰é€Ÿåº¦æ²¡é‚£ä¹ˆå¿«ï¼Œå¦‚æœæ”¹ä¸º500ï¼Œ é‚£ä¹ˆè¿æŒ‰é€Ÿåº¦å°†åŠ å¿«</span></span><br><span class="line">		&#123;</span><br><span class="line">			times = <span class="number">0</span>;</span><br><span class="line">			KEY_task();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(mode == <span class="number">0</span> &amp;&amp; times &gt;=<span class="number">500</span>) <span class="comment">// modeç­‰äº0ï¼Œè¯¥éƒ¨åˆ†ä»£ç æ˜¯ç”¨æ¥å®ç°ä¸æ”¯æŒè¿æŒ‰çš„ï¼Œè¿™é‡Œçš„timesèµ·åˆ°æ¶ˆæŠ–çš„ä½œç”¨</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span>(KEY4 == <span class="number">1</span>) &#123; <span class="comment">// æŒ‰é”®å·²æŠ¬èµ·</span></span><br><span class="line">				times = <span class="number">0</span>;</span><br><span class="line">				KEY_task();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	key_up = KEY4; <span class="comment">//å¦‚æœä¸æ¾æ‰‹ï¼Œkey_upå°±ä¼šç­‰äº0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> mode = <span class="number">0</span>; <span class="comment">//åˆå§‹æ—¶æ˜¯ä¸æ”¯æŒè¿æŒ‰</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key_up = <span class="number">1</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">			</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xF7</span>; <span class="comment">//ä½¿K3, K4å…·æœ‰èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	LedBuff[<span class="number">5</span>] = LedChar[mode]; <span class="comment">//å¡«å……å¥½æ•°ç ç®¡5è¦æ˜¾ç¤ºçš„æŒ‰é”®æ¨¡å¼å‚æ•°</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		SEG_task(); <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">		KEY_mode(mode); <span class="comment">// K4çš„æ‰§è¡Œå‡½æ•°ï¼Œè®¡æ•°å™¨cntçš„åŠ æ³•</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// ä»¥ä¸‹æ˜¯K3æŒ‰é”®çš„åŠŸèƒ½ä»£ç </span></span><br><span class="line">		<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">			times++;</span><br><span class="line">			<span class="keyword">if</span>(KEY3 == <span class="number">1</span> &amp;&amp; times &gt;= <span class="number">500</span>) &#123;</span><br><span class="line">				times = <span class="number">0</span>;</span><br><span class="line">				mode = !mode; <span class="comment">//é0åŠ1</span></span><br><span class="line">				LedBuff[<span class="number">5</span>] = LedChar[mode]; <span class="comment">// ç”¨æ¥æ˜¾ç¤ºæ­¤æ—¶çš„K4æ˜¯å¦æ”¯æŒè¿æŒ‰ï¼Œæ˜¾ç¤º0è¡¨ç¤ºä¸æ”¯æŒï¼Œæ˜¾ç¤º1è¡¨ç¤ºæ”¯æŒ</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		key_up = KEY3;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-4-10-ç»¼åˆæ¡ˆä¾‹"><a href="#2-4-10-ç»¼åˆæ¡ˆä¾‹" class="headerlink" title="2.4.10 ç»¼åˆæ¡ˆä¾‹"></a>2.4.10 ç»¼åˆæ¡ˆä¾‹</h4><p>ç»¼åˆæ¡ˆä¾‹ç»“åˆä»¥ä¸Šæ‰€å­¦çš„çŸ¥è¯†ï¼Œé’ˆå¯¹<code>æ•°ç ç®¡\LED</code>ã€<code>èœ‚é¸£å™¨</code>ã€<code>æŒ‰é”®</code>çš„çŸ¥è¯†ï¼Œæ¨¡æ‹Ÿå¾—åˆ†çš„è¿‡ç¨‹ã€‚</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">é¢˜ç›®ï¼š</span><br><span class="line"><span class="code">	å‡è®¾ä¸¤ä¸ªäººå®Œæ·ç¡¬å¸æ¸¸æˆï¼Œæ¸¸æˆè§„åˆ™å¦‚ä¸‹</span></span><br><span class="line"><span class="code">	Aå’ŒBå„æŒä¸€æšç¡¬å¸</span></span><br><span class="line"><span class="code">	ä¸¤äººéƒ½å‡ºæ­£é¢æ—¶ï¼šAå¾—3å—é’±</span></span><br><span class="line"><span class="code">	ä¸¤äººéƒ½å‡ºåé¢æ—¶ï¼šAå¾—1å—é’±</span></span><br><span class="line"><span class="code">	ä¸¤äººå‡ºä¸€æ­£ä¸€åæ—¶ï¼šBå¾—2å—é’±</span></span><br><span class="line"><span class="code">æ€è·¯ï¼š</span></span><br><span class="line"><span class="code">	è¿™æ ·åšæ¨¡æ‹Ÿï¼Œç¨‹åºçš„å¼€å§‹å®šä¹‰ä¸¤ä¸ªå…¨å±€å˜é‡Aå’ŒBåˆå§‹åŒ–ä¸º30ï¼Œæ„ä¸ºæ¯äººå„æŒ30å—é’±ç”¨æ¥æ˜¾ç¤ºåœ¨å·¦å³ç«¯çš„ä¸¤ä¸ªæ•°ç ç®¡ä¸Š(3/3)ï¼ŒAçš„é’±æ˜¾ç¤ºåœ¨å·¦è¾¹çš„æ•°ç ç®¡ï¼ŒBçš„é’±æ˜¾ç¤ºåœ¨å³è¾¹çš„æ•°ç ç®¡ã€‚æˆ‘ä»¬ç”¨K13ä½œä¸ºç»™AåŠ 3å—é’±çš„åŒæ—¶ä¹Ÿç»™Bå‡3å—çš„åŠŸèƒ½ã€‚ç”¨K14ä½œä¸ºç»™AåŠ 1å—é’±çš„åŒæ—¶ä¹Ÿç»™Bå‡1å—çš„åŠŸèƒ½ã€‚ç”¨K15ä½œä¸ºç»™Aå‡2å—é’±çš„åŒæ—¶ç»™BåŠ 2å—çš„åŠŸèƒ½ã€‚ä¸‰ä¸ªæŒ‰é”®éƒ½æ˜¯ä¸æ”¯æŒè¿æŒ‰ï¼(ä½ ä¹Ÿå¯ä»¥è‡ªç”±å‘æŒ¥æä¸€ä¸ªå°è£…ç©ç©)</span></span><br><span class="line"><span class="code">	è§„å®šè°å…ˆèµ¢å¾—45å…ƒæ—¶å°±ç®—èƒœåˆ©ï¼Œæ¸¸æˆç»“æŸã€‚æ¯”å¦‚Açš„é’±åˆ°è¾¾æˆ–è¶…è¿‡45å—é’±æ—¶ï¼ŒBçš„é’±å°±ä¸æ˜¾ç¤ºäº†ï¼Œè¿™ä¸¤ä¸ªæ•°ç ç®¡ç†„ç­ï¼Œå¦‚æœæ˜¯Bçš„é’±åˆ°è¾¾æˆ–è¶…è¿‡45å—æ—¶ï¼ŒAçš„é’±å°±ä¸æ˜¾ç¤ºäº†ã€‚æ¸¸æˆç»“æŸèœ‚é¸£å™¨é¸£å“ã€‚èœ‚é¸£å™¨å°±é—´éš”é¸£å«ï¼Œé¸£å«çš„æ—¶å€™æ‰€æœ‰æ•°ç ç®¡ç†„ç­ï¼Œä¸é¸£å«çš„æ—¶å€™å°±åªæœ‰4ä¸ªæ•°ç ç®¡äº®ç€ï¼Œæ•°ç ç®¡å‘ˆç°é—´éš”æ˜¾ç¤ºï¼Œèœ‚é¸£å™¨é—´éš”é¸£å«ã€‚è¦æƒ³é‡æ–°å¼€å§‹æ¸¸æˆå¿…é¡»å¤ä½å¼€å‘æ¿é‡å¯ï¼</span></span><br><span class="line"><span class="code">å¼€å‘æ¿ç»†èŠ‚ï¼š</span></span><br><span class="line"><span class="code">	1. åˆå§‹åŒ–LedBuff[]æ•°ç»„çš„æ—¶å€™ç¬¬2å’Œç¬¬3å·å…ƒç´ ä¸º0xBFï¼Œè®©æ•°ç ç®¡2å’Œæ•°ç ç®¡3æ˜¾ç¤ºä¸­é—´é‚£ä¸€æ ã€‚</span></span><br><span class="line"><span class="code">	2. æ­»å¾ªç¯æ‰§è¡Œå®Œä¸€æ¬¡å¾ªç¯çš„æ—¶é—´æ¯”ä»¥å¾€çš„ä¾‹ç¨‹è¦å¤šï¼Œæ‰€ä»¥timesçš„åˆ¤æ–­æˆ‘ä»¬åªéœ€è¦å®ƒè¶…è¿‡300å³å¯ã€‚</span></span><br><span class="line"><span class="code">	3. å› ä¸ºç”¨ä¸Šäº†3ä¸ªæŒ‰é”®ï¼Œæ¯ä¸ªæŒ‰é”®åŠŸèƒ½è¢«å°è£…ä¸ºä¸€ä¸ªå‡½æ•°äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå®â€œ#define  TIMES  300â€ï¼Œ3ä¸ªæŒ‰é”®çš„å‡½æ•°åˆ¤æ–­timesæ—¶ï¼Œåªéœ€ä¹¦å†™â€œif(times&gt;=TIMES&amp;&amp;KEYxx==1)â€å³å¯ï¼Œä»¥åæˆ‘ä»¬å†™çš„ä»£ç æ­»å¾ªç¯é‡Œæ¯”è¿™æ¬¡çš„ä¾‹ç¨‹æ‰§è¡Œä¸€éå¾ªç¯çš„æ—¶é—´è¿˜é•¿çš„è¯ï¼ŒæŠŠå®æ”¹ä¸ºæ¯”300è¿˜å°çš„æ•°å°±å¯ä»¥äº†ã€‚</span></span><br><span class="line"><span class="code">	4. æ¨¡æ‹Ÿæ·éª°å­ï¼Œä½¿ç”¨pythonå§ï¼Œæ¯”è¾ƒç®€å•</span></span><br><span class="line"><span class="code">	5. ä¸è¦æ”¾å¼ƒã€‚</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å¼€å‘æ¿</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TIMES 300 <span class="comment">// è¯¥ç¨‹åºä¸»å‡½æ•°å¾ªç¯ä¸€æ¬¡æ‰€è¦èŠ±è´¹çš„æ—¶é—´æ¯”ä»¥å¾€çš„é•¿ï¼Œæ‰€ä»¥timesè®¾ç½®ä¸º300</span></span></span><br><span class="line"></span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">sbit BEEP = P1^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">sbit KEY13 = P2^<span class="number">4</span>;</span><br><span class="line">sbit KEY14 = P2^<span class="number">5</span>;</span><br><span class="line">sbit KEY15 = P2^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°ç ç®¡çŠ¶æ€åˆå§‹åŒ–</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>] = &#123;<span class="number">0xC0</span>, <span class="number">0xF9</span>, <span class="number">0xA4</span>, <span class="number">0xB0</span>,<span class="number">0x99</span>, <span class="number">0x92</span>, <span class="number">0x82</span>, <span class="number">0xF8</span>, <span class="number">0x80</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x83</span>, <span class="number">0xC6</span>, <span class="number">0xA1</span>, <span class="number">0x86</span>, <span class="number">0x8E</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> LedBuff[<span class="number">6</span>] = &#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xBF</span>, <span class="number">0xBF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;; <span class="comment">//æ•°ç ç®¡ç¼“å†²åŒº</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> A = <span class="number">30</span>; <span class="comment">//åˆå§‹åŒ–Aå’ŒBçš„é’±</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> C = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">UPDATE_LED</span><span class="params">()</span> &#123; <span class="comment">//æ›´æ–°æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº</span></span><br><span class="line">	LedBuff[<span class="number">5</span>] = LedChar[A/<span class="number">10</span>];</span><br><span class="line">	LedBuff[<span class="number">4</span>] = LedChar[A%<span class="number">10</span>];</span><br><span class="line">	LedBuff[<span class="number">1</span>] = LedChar[C/<span class="number">10</span>];</span><br><span class="line">	LedBuff[<span class="number">0</span>] = LedChar[C%<span class="number">10</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span> &#123; <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">	P0 = <span class="number">0xFF</span>;</span><br><span class="line">	<span class="keyword">switch</span>(i) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">0</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">0</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">1</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; P0 = LedBuff[<span class="number">1</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">2</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>: ADDR2 = <span class="number">0</span>; ADDR1 = <span class="number">1</span>; ADDR0 = <span class="number">1</span>; P0 = LedBuff[<span class="number">3</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>: ADDR2 = <span class="number">1</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">0</span>; P0 = LedBuff[<span class="number">4</span>]; i++; <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>: ADDR2 = <span class="number">1</span>; ADDR1 = <span class="number">0</span>; ADDR0 = <span class="number">1</span>; P0 = LedBuff[<span class="number">5</span>]; i=<span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY13_task</span><span class="params">()</span> &#123; <span class="comment">// K13æŒ‰é”®ä½œç”¨</span></span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> key_up = <span class="number">1</span>;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">		times++;</span><br><span class="line">		<span class="keyword">if</span>(KEY13 == <span class="number">1</span> &amp;&amp; times &gt;= TIMES) &#123;</span><br><span class="line">			times = <span class="number">0</span>;</span><br><span class="line">			A += <span class="number">3</span>; <span class="comment">// Açš„é’±åŠ 3å…ƒ</span></span><br><span class="line">			C -= <span class="number">3</span>; <span class="comment">// Bçš„é’±å‡3å…ƒ</span></span><br><span class="line">			UPDATE_LED(); <span class="comment">//æ›´æ–°æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	key_up = KEY13;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY14_task</span><span class="params">()</span> &#123; <span class="comment">//KEY13æŒ‰é”®ä»»åŠ¡</span></span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> key_up = <span class="number">1</span>;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­è¯­å¥çš„æ¬¡æ•°</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">		times++;</span><br><span class="line">		<span class="keyword">if</span>(KEY14 == <span class="number">1</span> &amp;&amp; times &gt;= TIMES) &#123;</span><br><span class="line">			times = <span class="number">0</span>;</span><br><span class="line">			A += <span class="number">1</span>; <span class="comment">//Açš„é’±åŠ 1</span></span><br><span class="line">			C -= <span class="number">1</span>; <span class="comment">//Bçš„é’±å‡1</span></span><br><span class="line">			UPDATE_LED(); <span class="comment">// æ›´æ–°æ•°ç ç®¡ç¼“å­˜åŒº</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	key_up = KEY14;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY15_task</span><span class="params">()</span> &#123; <span class="comment">// æŒ‰é”®15çš„ä»»åŠ¡</span></span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> key_up = <span class="number">1</span>;</span><br><span class="line">	<span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> times = <span class="number">0</span>; <span class="comment">//ç”¨æ¥è®°å½•è¿›å…¥è¿‡æŒ‰é”®åˆ¤æ–­çš„æ¬¡æ•°</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">		times++;</span><br><span class="line">		<span class="keyword">if</span>(KEY15 == <span class="number">1</span> &amp;&amp; times &gt;= TIMES) &#123;</span><br><span class="line">			times = <span class="number">0</span>;</span><br><span class="line">			A -= <span class="number">2</span>; <span class="comment">//Açš„é’±å‡2</span></span><br><span class="line">			C += <span class="number">2</span>; <span class="comment">//Bçš„é’±åŠ 2</span></span><br><span class="line">			UPDATE_LED(); <span class="comment">//æ›´æ–°æ•°ç ç®¡ç¼“å­˜åŒº</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	key_up = KEY15;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">BEEP_ON</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> x)</span> &#123; <span class="comment">//æ¸¸æˆç»“æŸèœ‚é¸£å™¨é¸£å«</span></span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, time;</span><br><span class="line">	<span class="keyword">for</span>(time = <span class="number">0</span>; time &lt; <span class="number">2000</span>; time++) &#123; <span class="comment">//time&lt;2000å†³å®šé¸£å«çš„æ—¶é—´</span></span><br><span class="line">		<span class="keyword">if</span>(x == <span class="number">1</span>)BEEP = !BEEP; <span class="comment">//x=1è¡¨æ˜æ¸¸æˆç»“æŸ</span></span><br><span class="line">		<span class="keyword">else</span> BEEP = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">30</span>; i++);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, x; <span class="comment">//åšå¾ªç¯å’Œå»¶æ—¶ç”¨</span></span><br><span class="line">	</span><br><span class="line">	ENLED = <span class="number">0</span>;</span><br><span class="line">	ADDR3 = <span class="number">1</span>; <span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">	</span><br><span class="line">	P2 = <span class="number">0xFE</span>; <span class="comment">//ä½¿KEY13,KEY14, KEY15å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">	UPDATE_LED(); <span class="comment">//åˆå§‹åŒ–æ•°ç ç®¡ç¼“å­˜åŒº</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		SEG_task(); <span class="comment">// æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">		KEY13_task(); <span class="comment">//KEY13æŒ‰é”®çš„ä»»åŠ¡</span></span><br><span class="line">		KEY14_task(); <span class="comment">// KEY14æŒ‰é”®çš„ä»»åŠ¡</span></span><br><span class="line">		KEY15_task(); <span class="comment">//KEY15æŒ‰é”®çš„ä»»åŠ¡</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">//æ¸¸æˆç»“æŸè¦å®Œæˆçš„ä»»åŠ¡</span></span><br><span class="line">		<span class="keyword">if</span>(A&gt;=<span class="number">45</span> || C &gt;= <span class="number">45</span>) &#123; <span class="comment">// åªè¦å…¶ä¸­ä¸€æ–¹çš„é’±è¾¾åˆ°45å—ä»¥ä¸Šå°±ç»“æŸæ¸¸æˆï¼Œç¨‹åºè¿›å…¥æ­»å¾ªç¯</span></span><br><span class="line">			<span class="keyword">if</span>(A&gt;=<span class="number">45</span>) &#123;</span><br><span class="line">				LedBuff[<span class="number">1</span>] = <span class="number">0xFF</span>;</span><br><span class="line">				LedBuff[<span class="number">0</span>] = <span class="number">0xFF</span>; <span class="comment">// Aèµ¢å¾—æ¯”èµ›ï¼ŒBçš„é’±ä¸å†æ˜¾ç¤º</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				LedBuff[<span class="number">5</span>] = <span class="number">0xFF</span>;</span><br><span class="line">				LedBuff[<span class="number">4</span>] = <span class="number">0xFF</span>; <span class="comment">//Bèµ¢å¾—æ¯”èµ›ï¼ŒAçš„é’±ä¸å†æ˜¾ç¤º</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">				P0 = <span class="number">0xFF</span>; <span class="comment">//ç†„ç­æ‰€æœ‰æ•°ç ç®¡</span></span><br><span class="line">				BEEP_ON(<span class="number">1</span>); <span class="comment">// èœ‚é¸£å™¨é¸£å«ä¸€æ®µæ—¶é—´</span></span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">300</span>; i++) &#123; <span class="comment">//è®©æ•°ç ç®¡æ˜¾ç¤ºä¸€æ®µæ—¶é—´</span></span><br><span class="line">					SEG_task(); <span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">					<span class="keyword">for</span>(x = <span class="number">0</span>; x &lt; <span class="number">200</span>; x++); <span class="comment">//åŠ æ­¤å»¶æ—¶æ˜¯ä¸ºäº†è®©æ•°ç ç®¡æ˜¾ç¤ºäº®äº¿ç‚¹ç‚¹ï¼Œä¸ç„¶åªå¾ªç¯æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°ï¼Œæ˜¾ç¤ºå°±ä¼šæš—ä¸€äº›</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¨¡æ‹Ÿæ·ç¡¬å¸</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">coin_toss_simulation</span>(<span class="params">num_trials</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_trials):</span><br><span class="line">        player_1_coin = random.randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        player_2_coin = random.randint(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[%d %d] &#x27;</span>%(player_1_coin, player_2_coin), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ‹è¯•ä»£ç ï¼Œæ¨¡æ‹Ÿ10æ¬¡ç¡¬å¸æ­£åé¢</span></span><br><span class="line">coin_toss_simulation(<span class="number">50</span>)</span><br></pre></td></tr></table></figure>
<h3 id="2-5-å¤šæ¨¡å—ç¼–ç¨‹"><a href="#2-5-å¤šæ¨¡å—ç¼–ç¨‹" class="headerlink" title="2.5 å¤šæ¨¡å—ç¼–ç¨‹"></a>2.5 å¤šæ¨¡å—ç¼–ç¨‹</h3><p>å¤šæ¨¡å—ç¼–ç¨‹éå¸¸æ–¹ä¾¿ï¼Œåšä¸»çœ‹å¾ˆå¤šæ•™ç¨‹éƒ½å†™<code>#include &lt;function.h&gt;</code>ï¼Œä½†æ˜¯æˆ‘è¿™è¾¹å»ºè®®ï¼Œæˆ‘ä»¬è‡ªå·±å†™çš„å¤´æ–‡ä»¶æœ€å¥½æ˜¯ç”¨<code>&quot;&quot;</code>è¡¨ç¤ºï¼Œç”±ä¸‹é¢çš„ä»£ç æˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºç”±<code>function.h</code>å»ºç«‹äº†main.cæ–‡ä»¶ä¸function.cçš„è”ç³»ã€‚é’ˆå¯¹é‡Œé¢ä¸€äº›æ–°çš„å®šä¹‰å’Œç®€æ´å‡½æ•°è¯¦æƒ…è§ç¬¬ç¬¬ä¸‰ç« ç¬¬3.5èŠ‚</p>
<p>æ–‡ä»¶åªéœ€è¦å°†<code>function.c</code>å’Œ<code>main.c</code>åŠ å…¥å³å¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ main.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u16 i,x,NUM=<span class="number">12345</span>;</span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">     </span><br><span class="line">    LED2=<span class="number">0</span>;LED9=<span class="number">0</span>;</span><br><span class="line">    delay_ms(<span class="number">100</span>);</span><br><span class="line">    LED3=<span class="number">0</span>;LED8=<span class="number">0</span>;</span><br><span class="line">    delay_ms(<span class="number">100</span>);</span><br><span class="line">    LED4=<span class="number">0</span>;LED7=<span class="number">0</span>;</span><br><span class="line">    delay_ms(<span class="number">100</span>);</span><br><span class="line">    LED5=<span class="number">0</span>;LED6=<span class="number">0</span>;</span><br><span class="line">    delay_ms(<span class="number">100</span>);</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">5000</span>;i++)<span class="comment">//èœ‚é¸£å™¨å“ä¸€ä¸‹</span></span><br><span class="line">    &#123;</span><br><span class="line">        BEEP=!BEEP;</span><br><span class="line">        <span class="keyword">for</span>(x=<span class="number">0</span>;x&lt;<span class="number">30</span>;x++);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ShowNumber(NUM);<span class="comment">//æ›´æ–°ç¼“å­˜åŒºçš„å†…å®¹ï¼Œé¦–æ¬¡æ˜¾ç¤º12345åœ¨æ•°ç ç®¡ä¸Š</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;     </span><br><span class="line">        SEG_Scan();</span><br><span class="line">        i++;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8000</span>)<span class="comment">//éš”ä¸€æ®µæ—¶é—´æ›´æ–°æ•°ç ç®¡æ˜¾ç¤ºçš„å†…å®¹</span></span><br><span class="line">        &#123;</span><br><span class="line">            i=<span class="number">0</span>;</span><br><span class="line">            ShowNumber(NUM++);</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ function.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line">  </span><br><span class="line">u8 code LedChar[<span class="number">16</span>]=&#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;;<span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line">u8 LedBuff[<span class="number">6</span>]=&#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;;<span class="comment">//åˆå§‹åŒ–æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(u16 x)</span></span><br><span class="line">&#123;</span><br><span class="line">    u16 i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    P1|=<span class="number">0x0E</span>;<span class="comment">//è®©P1.1ï¼ŒP1.2ï¼ŒP1.3å¼ºåˆ¶è¾“å‡º1</span></span><br><span class="line">    P1&amp;=<span class="number">0xEE</span>;<span class="comment">//è®©P1.0å’ŒP1.4å¼ºåˆ¶è¾“å‡º0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_Scan</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> u8 i = <span class="number">0</span>;     </span><br><span class="line">    P0 = <span class="number">0xFF</span>;            <span class="comment">//ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡é‡Œçš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">    P1 = (P1 &amp; <span class="number">0xF8</span>) | i; <span class="comment">//iç­‰äº0æ—¶ï¼Œå°±æ˜¯â€œADDR2=0; ADDR1=0; ADDR0=0;â€ï¼Œiç­‰äº1æ—¶ï¼Œå°±æ˜¯â€œADDR2=0; ADDR1=0; ADDR0=1;â€ï¼Œä»¥æ­¤ç±»æ¨</span></span><br><span class="line">    P0 = LedBuff[i];      <span class="comment">//6ä¸ªç¼“å†²åŒºçš„å€¼è½®æµèµ‹ç»™P0</span></span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=<span class="number">6</span>)i=<span class="number">0</span>;          <span class="comment">//è®©iåœ¨0~5ä¹‹é—´å¾ªç¯å˜åŒ–</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> i;<span class="comment">//å–å€¼èŒƒå›´-128~127</span></span><br><span class="line">    u8 buf[<span class="number">6</span>];    </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)    <span class="comment">//æŠŠé•¿æ•´å‹æ•°è½¬æ¢ä¸º6ä½åè¿›åˆ¶çš„æ•°ç»„</span></span><br><span class="line">    &#123;</span><br><span class="line">        buf[i] = num % <span class="number">10</span>;</span><br><span class="line">        num = num / <span class="number">10</span>;    <span class="comment">//èˆæ‰ä¸ªä½æ•°ï¼Œé‡æ–°è£…è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">5</span>; i&gt;=<span class="number">1</span>; i--)   <span class="comment">//ä»æœ€é«˜ä½èµ·ï¼Œé‡åˆ°0å¡«å……ä¸æ˜¾ç¤ºçš„ä»£ç ï¼Œé‡åˆ°é0åˆ™é€€å‡ºå¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (buf[i] == <span class="number">0</span>)</span><br><span class="line">            LedBuff[i] = <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ; i&gt;=<span class="number">0</span>; i--)     <span class="comment">//å‰©ä½™ä½ä½éƒ½å¦‚å®è½¬æ¢ä¸ºæ•°ç ç®¡æ˜¾ç¤ºå­—ç¬¦</span></span><br><span class="line">    &#123;</span><br><span class="line">        LedBuff[i] = LedChar[buf[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ function.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> _function_h_</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _function_h_</span></span><br><span class="line">  </span><br><span class="line">sbit BEEP  = P1^<span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit LED3  = P0^<span class="number">1</span>;</span><br><span class="line">sbit LED4  = P0^<span class="number">2</span>;</span><br><span class="line">sbit LED5  = P0^<span class="number">3</span>;</span><br><span class="line">sbit LED6  = P0^<span class="number">4</span>;</span><br><span class="line">sbit LED7  = P0^<span class="number">5</span>;</span><br><span class="line">sbit LED8  = P0^<span class="number">6</span>;</span><br><span class="line">sbit LED9  = P0^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span>  u8;   <span class="comment">//å¯¹æ•°æ®ç±»å‹è¿›è¡Œå£°æ˜å®šä¹‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>  u16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> u32;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span>  u8 LedBuff[<span class="number">6</span>];       <span class="comment">//å¯¹æ•°ç ç®¡ç¼“å­˜åŒºè¿›è¡Œå¤–éƒ¨å£°æ˜</span></span><br><span class="line"><span class="keyword">extern</span>  u8 code LedChar[<span class="number">16</span>]; <span class="comment">//å¯¹æ•°ç ç®¡çœŸå€¼è¡¨è¿›è¡Œå¤–éƒ¨å£°æ˜</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//åªè¦åœ¨â€œfunction.câ€æ–‡ä»¶ä¸­å°è£…æœ‰çš„å‡½æ•°éƒ½éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜ä¸€ä¸‹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(u16 x)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_Scan</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6438062c0d2dde5777a3bbf1.png" alt=""></p>
<h4 id="2-5-1-å¸¦è¿”å›å€¼çš„å‡½æ•°ï¼ˆä¸æ”¯æŒè¿æŒ‰çš„æŒ‰é”®ï¼‰"><a href="#2-5-1-å¸¦è¿”å›å€¼çš„å‡½æ•°ï¼ˆä¸æ”¯æŒè¿æŒ‰çš„æŒ‰é”®ï¼‰" class="headerlink" title="2.5.1 å¸¦è¿”å›å€¼çš„å‡½æ•°ï¼ˆä¸æ”¯æŒè¿æŒ‰çš„æŒ‰é”®ï¼‰"></a>2.5.1 å¸¦è¿”å›å€¼çš„å‡½æ•°ï¼ˆä¸æ”¯æŒè¿æŒ‰çš„æŒ‰é”®ï¼‰</h4><p>ä¹‹å‰å°è£…çš„å‡½æ•°éƒ½æ˜¯voidç±»å‹æ— è¿”å›å€¼çš„å‡½æ•°ã€‚éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠCè¯­è¨€çš„ç²¾é«“å­¦åˆ°å®¶ã€‚</p>
<p>å‰é¢è®²çš„<code>function.c</code>ä¸­æ²¡æœ‰æåŠè¿‡æŒ‰é”®çš„å‡½æ•°å°è£…ã€‚æŒ‰é”®åŠŸèƒ½å‡½æ•°éƒ½éœ€è¦å®šä¹‰å…¨å±€å˜é‡ï¼Œè¿™ç§è¿‡å¤šçš„ä½¿ç”¨å…¨å±€å˜é‡æ˜¯ç¼–ç¨‹çš„å¤§å¿Œã€‚éšç€æˆ‘ä»¬ä½¿ç”¨æŒ‰é”®è¶Šæ¥è¶Šçµæ´»ï¼Œå°±ä¸æ˜¯ç®€å•çš„è®©ä¸€ä¸¤ä¸ªå˜é‡åŠ åŠ å‡å‡è€Œå·²äº†ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦æ›´åŠ çš„å»è´´åˆåµŒå…¥å¼ç¼–ç¨‹çš„æ–¹å¼ï¼Œé‚£ä¹ˆæŒ‰é”®çš„ä½¿ç”¨å¦‚æœç”¨å‡½æ•°å°è£…çš„è¯ï¼Œéœ€è¦ç”¨åˆ°å‡½æ•°è¿”å›å€¼çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> TIMES 1000 <span class="comment">//æ­»å¾ªç¯é‡Œçš„ä»£ç é‡å°‘ï¼Œæ‰€ä»¥æŠŠé˜ˆå€¼è°ƒå¤§äº›</span></span></span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">static</span> u8 key_up = <span class="number">1</span>;</span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">        times++;</span><br><span class="line">        <span class="keyword">if</span>(KEY4 == <span class="number">1</span> &amp;&amp; times &gt;= TIMES) &#123;</span><br><span class="line">            times = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    key_up = KEY4;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main() &#123;</span><br><span class="line">    u8 key; <span class="comment">//ç”¨æ¥è¯»å–æŒ‰é”®åŠ¨ä½œçš„è¿”å›å€¼</span></span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    P2 = <span class="number">0xF7</span>; <span class="comment">//è®©K4å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        key=KEY4_Scan();</span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">1</span>)LED2=!LED2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-5-2-æ”¯æŒè¿æŒ‰çš„æŒ‰é”®"><a href="#2-5-2-æ”¯æŒè¿æŒ‰çš„æŒ‰é”®" class="headerlink" title="2.5.2 æ”¯æŒè¿æŒ‰çš„æŒ‰é”®"></a>2.5.2 æ”¯æŒè¿æŒ‰çš„æŒ‰é”®</h4><p>å®éªŒç°è±¡å°±æ˜¯æŒ‰ç€æŒ‰é”®ä¸æ”¾ï¼Œé‚£ä¹ˆâ€œkey=1;â€å‡ºç°çš„é¢‘ç‡å°±ä¼šæ¯”ä¸æ”¯æŒè¿æŒ‰ä»£ç çš„æ—¶å€™å¤šï¼Œæ‰€ä»¥å°±ä¼šæœ‰å·¦å³ä¸æ–­æµæ°´çš„ç°è±¡</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> TIMES 2000 <span class="comment">//è®©æµé€Ÿæ…¢ä¸€ç‚¹</span></span></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"> </span><br><span class="line">u8 <span class="title function_">KEY4_Scan</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> u8 key_up=<span class="number">1</span>;</span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(key_up==<span class="number">0</span>)</span><br><span class="line">    &#123;      </span><br><span class="line">        times++;   </span><br><span class="line">        <span class="keyword">if</span>(times&gt;=TIMES)</span><br><span class="line">        &#123;</span><br><span class="line">            times=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    key_up=KEY4;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u8 key;     <span class="comment">//ç”¨æ¥è¯»å–æŒ‰é”®åŠ¨ä½œçš„è¿”å›å€¼</span></span><br><span class="line">    u8 i=<span class="number">0</span>,dir; <span class="comment">//diræ˜¯ä½œä¸ºåˆ‡æ¢æµæ°´æ–¹å‘</span></span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    P2=<span class="number">0xF7</span>;    <span class="comment">//è®©K4èƒ½å…·å¤‡æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶å…ˆ</span></span><br><span class="line">    P0=<span class="number">0xFE</span>;    <span class="comment">//å…ˆç‚¹äº®LED2</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;      </span><br><span class="line">        key=KEY4_Scan();</span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">1</span>)<span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">        &#123;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=<span class="number">15</span>)i=<span class="number">1</span>;<span class="comment">//è®©iä¸€ç›´åœ¨1~14ä¹‹é—´å˜åŒ–</span></span><br><span class="line">       </span><br><span class="line">            <span class="keyword">if</span>(i&lt;<span class="number">8</span>)dir=<span class="number">0</span>;<span class="comment">//å‘å·¦ç§»</span></span><br><span class="line">            <span class="keyword">if</span>(dir==<span class="number">0</span>)P0=~(<span class="number">0x01</span>&lt;&lt;i);</span><br><span class="line">       </span><br><span class="line">            <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)dir=<span class="number">1</span>;<span class="comment">//å‘å³ç§» </span></span><br><span class="line">            <span class="keyword">if</span>(dir==<span class="number">1</span>)P0=~( <span class="number">0x80</span>&gt;&gt;(i<span class="number">-7</span>) );<span class="comment">//å½“iå¤§äºç­‰äº8ä¹‹åï¼Œ(i-7)å…¶å®ä¹Ÿè¿˜æ˜¯åœ¨1~7ä¹‹é—´å˜åŒ–    </span></span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘åˆ°æˆ‘ä»¬æœ€å¸¸ç”¨çš„æŒ‰é”®æ˜¯<code>K4ã€K8ã€K12ã€K16</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/643821610d2dde5777cc6c74.png" alt=""></p>
<p>æ‰€ä»¥åªæœ‰<code>P2^7</code>è¾“å‡ºä½ç”µå¹³ä¹‹åï¼Œå¯¹åº”çš„4ä¸ªæŒ‰é”®çš„IOç«¯å£æ‰æœ‰è¢«æ‹‰ä½çš„æ¡ä»¶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">KEY_Init</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    P2=<span class="number">0X7F</span>;<span class="comment">//è®©P2.7è¾“å‡ºä½ç”µå¹³ï¼Œå…¶ä»–IOç«¯å£è¾“å‡ºé«˜ç”µå¹³ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿èƒ½4ä¸ªæŒ‰é”®äº†</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-5-3-æœ€ç»ˆæŒ‰é”®ç¨‹åº"><a href="#2-5-3-æœ€ç»ˆæŒ‰é”®ç¨‹åº" class="headerlink" title="2.5.3 æœ€ç»ˆæŒ‰é”®ç¨‹åº"></a>2.5.3 æœ€ç»ˆæŒ‰é”®ç¨‹åº</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">(u8 mode,u16 TIMES)</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">static</span> u8 key_up=<span class="number">1</span>; <span class="comment">//æŒ‰é”®æ¾å¼€æ ‡å¿—</span></span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(mode)key_up=<span class="number">1</span>;   <span class="comment">//å¦‚æœmodeç­‰äº1ï¼Œæ”¯æŒè¿æŒ‰    </span></span><br><span class="line">    <span class="keyword">if</span>(key_up&amp;&amp;(KEY4==<span class="number">0</span>||KEY8==<span class="number">0</span>||KEY12==<span class="number">0</span>||KEY16==<span class="number">0</span>))<span class="comment">//åªè¦åœ¨key_upç­‰äº1æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹å°±å¯ä»¥è¿›å…¥æ‰§è¡Œä»£ç </span></span><br><span class="line">    &#123;</span><br><span class="line">        times++;        <span class="comment">//è®°å½•è¿›å…¥ä½ç”µå¹³çš„æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span>(times&gt;=TIMES)<span class="comment">//æŠ–åŠ¨çš„æ—¶é—´å·²ç»è¿‡å»</span></span><br><span class="line">        &#123; </span><br><span class="line">            times=<span class="number">0</span>;</span><br><span class="line">            key_up=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(KEY4==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY8==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY12==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">12</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY16==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(KEY4==<span class="number">1</span>&amp;&amp;KEY8==<span class="number">1</span>&amp;&amp;KEY12==<span class="number">1</span>&amp;&amp;KEY16==<span class="number">1</span>)key_up=<span class="number">1</span>;      </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">// æ— æŒ‰é”®æŒ‰ä¸‹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>å‡è®¾æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°modeä¸º0ï¼Œè¿›å…¥å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶key_upä¸º1ï¼Œç„¶åæ²¡æœ‰å»æ‰§è¡Œâ€œif(mode)key_up=1;â€ï¼Œæ­¤æ—¶è‹¥æ²¡æœ‰æŒ‰é”®æŒ‰ä¸‹ï¼Œåˆ™æ»¡è¶³â€œelse if(KEY4==1&amp;&amp;KEY8==1&amp;&amp;KEY12==1&amp;&amp;KEY16==1)key_up=1;â€ï¼Œæ‰€ä»¥key_upè¿˜æ˜¯ç­‰äº1ï¼Œè¿”å›å€¼ä¸º0ã€‚</li>
</ol>
<ol>
<li>å‡è®¾æœ‰æŒ‰é”®æŒ‰ä¸‹ï¼ŒæŒç»­å¤Ÿä¸€å®šçš„ä½ç”µå¹³æ—¶é—´äº†ï¼ˆæŠ–åŠ¨æ—¶é—´è¿‡å»äº†ï¼‰ï¼Œæ¸…é›¶timesï¼Œè®©key_upç­‰äº0ï¼Œç„¶ååˆ¤æ–­æ­¤æ—¶æ˜¯å“ªä¸ªæŒ‰é”®æŒ‰ä¸‹å°±è¿”å›å¯¹åº”çš„å€¼ã€‚</li>
</ol>
<ol>
<li><p>è¿”å›å¯¹åº”çš„å€¼ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬ä¸€ç›´æŒ‰ç€ä¸æ”¾ï¼Œç¬¬äºŒæ¬¡æ‰§è¡Œè¿™ä¸ªå‡½æ•°å°±ä¼šå› ä¸ºkey_upåœ¨å‰ä¸€æ¬¡å‡½æ•°æ‰§è¡Œä¸­å·²ç»ç­‰äº0ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±ç®—æŒ‰ç€æŒ‰é”®ä¸æ”¾ä¹Ÿè¿›å…¥ä¸äº†â€œif(key_up&amp;&amp;(KEY4==0||KEY8==0||KEY12==0||KEY16==0))â€ï¼Œé‚£ä¹ˆä¸€æ¬¡æŒ‰é”®åŠ¨ä½œåªèƒ½æœ‰ä¸€æ¬¡è¿”å›å€¼ä¸º4ã€8ã€12æˆ–16çš„æœºä¼šï¼Œå…¶ä»–æ—¶å€™éƒ½æ˜¯è¿”å›0ã€‚å¦‚æœæˆ‘ä»¬æŒ‰é”®æ¾æ‰‹äº†ï¼Œé‚£å°±æ»¡è¶³â€œelse if(KEY4==1&amp;&amp;KEY8==1&amp;&amp;KEY12==1&amp;&amp;KEY16==1)key_up=1;â€ï¼Œè¿™æ ·key_upæ¢å¤ä¸º1äº†ï¼Œä¸‹æ¬¡æŒ‰é”®åŠ¨ä½œåˆèƒ½å¤Ÿè¿›å…¥â€œif(key_up&amp;&amp;(KEY4==0||KEY8==0||KEY12==0||KEY16==0))â€ä»è€Œå¯ä»¥è¿”å›å¯¹åº”çš„æŒ‰é”®å€¼ã€‚ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼å°±è®²è§£å®Œäº†ã€‚</p>
</li>
<li><p>å‚æ•°modeä¸º1æ—¶ï¼Œæ€»ä¼šæ‰§è¡Œâ€œif(mode)key_up=1;â€ï¼Œæ‰€ä»¥æŒ‰é”®æŒ‰ç€ä¸æ”¾å‡½æ•°çš„æ‰§è¡Œéƒ½ä¼šè¿›å…¥â€œif(key_up&amp;&amp;(KEY4==0||KEY8==0||KEY12==0||KEY16==0))â€ï¼Œè¿™æ ·è¿”å›çš„æŒ‰é”®å€¼çš„æœºä¼šæ¯”ä¸æ”¯æŒè¿æŒ‰æ—¶å€™è¿˜è¦å¤šï¼Œè¿™å°±æ˜¯modeç­‰äº1æ—¶å‘ˆç°çš„æ”¯æŒè¿æŒ‰åŠŸèƒ½ã€‚</p>
</li>
<li>æˆ‘ä»¬ä¸å†ä½¿ç”¨â€œ#define TIMES 1000â€ï¼Œå› ä¸ºæœ‰æ—¶â€œKEY_Scan()â€åœ¨å„ç§ä¸åŒçš„å¾ªç¯ä½“é‡Œæ‰«æè¿”å›å€¼ï¼Œæœ‰äº›å¾ªç¯ä¸€æ¬¡æ‰§è¡Œæ—¶é—´å¾ˆå¿«ï¼Œæœ‰äº›å´å¾ˆæ…¢ï¼Œæˆ‘ä»¬åœ¨ç¬¬äº”ç« å·²ç»åˆ†æè¿‡è¿™äº›æƒ…å†µäº†ï¼Œæ‰€ä»¥TIMESçš„å€¼éœ€è¦éšæœºåº”å˜ã€‚æˆ‘ä»¬å†³å®šè®©TIMESä½œä¸ºæŒ‰é”®ç¨‹åºçš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™æ ·åœ¨æŸäº›å¾ªç¯ä½“é‡Œå¦‚æœå¾ªç¯ä¸€æ¬¡çš„æ—¶é—´å¾ˆå¿«ï¼Œæˆ‘ä»¬è°ƒä¸ºâ€œKEY_Scan(0,1000);â€ï¼Œå¾ªç¯ä¸€æ¬¡çš„æ—¶é—´å¾ˆæ…¢å°±æ”¹ä¸ºâ€œKEY_Scan(0,300);â€</li>
</ol>
<p>åŸç†è§£æå°±è®²è§£å®Œäº†ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¯¥ä»£ç åœ¨ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼ä¸‹æ˜¯æŒ‰ä¸‹ä¹‹åå°±æ‰§è¡Œè¿”å›å€¼äº†çš„ï¼Œè€Œä¸æ˜¯åƒä»¥å‰ä¸€æ ·è¦æŠ¬èµ·æŒ‰é”®ä¹‹åæ‰ä¼šæ‰§è¡Œè¿”å›å€¼çš„è¯­å¥ï¼Œæ‰€ä»¥ä¸ç®¡æˆ‘ä»¬çš„æŒ‰é”®æ‰‹é€Ÿæ˜¯å¿«æ˜¯æ…¢ï¼Œç¨‹åºéƒ½ä¼šåœ¨æœ€å¿«æ—¶é—´å†…å»æ‰§è¡Œè¿”å›å€¼çš„è¯­å¥ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ æŠŠâ€œKEY_Scan(0,1000);â€æ”¹ä¸ºâ€œKEY_Scan(1,1000);â€å°±æ˜¯æ”¯æŒè¿æŒ‰äº†ã€‚</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span></span></span><br><span class="line">sbit KEY4  = P2^<span class="number">3</span>;</span><br><span class="line">sbit KEY8  = P2^<span class="number">2</span>;</span><br><span class="line">sbit KEY12 = P2^<span class="number">1</span>;</span><br><span class="line">sbit KEY16 = P2^<span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">(u8 mode,u16 TIMES)</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">static</span> u8 key_up=<span class="number">1</span>; <span class="comment">//æŒ‰é”®æ¾å¼€æ ‡å¿—</span></span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(mode)key_up=<span class="number">1</span>;   <span class="comment">//å¦‚æœmodeç­‰äº1ï¼Œæ”¯æŒè¿æŒ‰    </span></span><br><span class="line">    <span class="keyword">if</span>(key_up&amp;&amp;(KEY4==<span class="number">0</span>||KEY8==<span class="number">0</span>||KEY12==<span class="number">0</span>||KEY16==<span class="number">0</span>))<span class="comment">//åªè¦åœ¨key_upç­‰äº1æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹å°±å¯ä»¥è¿›å…¥æ‰§è¡Œä»£ç </span></span><br><span class="line">    &#123;</span><br><span class="line">        times++;        <span class="comment">//è®°å½•è¿›å…¥ä½ç”µå¹³çš„æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span>(times&gt;=TIMES)<span class="comment">//æŠ–åŠ¨çš„æ—¶é—´å·²ç»è¿‡å»</span></span><br><span class="line">        &#123; </span><br><span class="line">            times=<span class="number">0</span>;</span><br><span class="line">            key_up=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(KEY4==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY8==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY12==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">12</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY16==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(KEY4==<span class="number">1</span>&amp;&amp;KEY8==<span class="number">1</span>&amp;&amp;KEY12==<span class="number">1</span>&amp;&amp;KEY16==<span class="number">1</span>)key_up=<span class="number">1</span>;      </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">// æ— æŒ‰é”®æŒ‰ä¸‹</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_Init</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    P2=<span class="number">0X7F</span>;<span class="comment">//è®©P2.7è¾“å‡ºä½ç”µå¹³ï¼Œå…¶ä»–è¾“å‡ºé«˜ç”µå¹³ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿èƒ½4ä¸ªæŒ‰é”®äº†</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u8 key;    <span class="comment">//ç”¨æ¥è¯»å–æŒ‰é”®åŠ¨ä½œçš„è¿”å›å€¼</span></span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">    P0=<span class="number">0xFE</span>;   <span class="comment">//å…ˆç‚¹äº®LED2</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;      </span><br><span class="line">        key=KEY_Scan(<span class="number">0</span>,<span class="number">1000</span>); <span class="comment">//ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼ï¼Œåˆ¤æ–­é˜ˆå€¼ä¸º1000</span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">4</span>)LED2=!LED2; <span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">8</span>)LED4=!LED4; <span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">12</span>)LED6=!LED6;<span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">16</span>)LED8=!LED8;<span class="comment">//æ‰§è¡ŒåŠŸèƒ½ä»£ç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-5-4-æœ€ç»ˆçš„Functionæ–‡ä»¶"><a href="#2-5-4-æœ€ç»ˆçš„Functionæ–‡ä»¶" class="headerlink" title="2.5.4 æœ€ç»ˆçš„Functionæ–‡ä»¶"></a>2.5.4 æœ€ç»ˆçš„Functionæ–‡ä»¶</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ functin.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span> </span></span><br><span class="line">  </span><br><span class="line">u8 code LedChar[<span class="number">16</span>]=&#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;;<span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line">u8 LedBuff[<span class="number">6</span>]=&#123;<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>&#125;;<span class="comment">//åˆå§‹åŒ–æ•°ç ç®¡æ˜¾ç¤ºç¼“å­˜åŒº</span></span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(u16 x)</span></span><br><span class="line">&#123;</span><br><span class="line">    u16 i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    P1|=<span class="number">0x0E</span>;<span class="comment">//è®©P1.1ï¼ŒP1.2ï¼ŒP1.3å¼ºåˆ¶è¾“å‡º1</span></span><br><span class="line">    P1&amp;=<span class="number">0xEE</span>;<span class="comment">//è®©P1.0å’ŒP1.4å¼ºåˆ¶è¾“å‡º0</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_Init</span><span class="params">()</span></span><br><span class="line">&#123;    </span><br><span class="line">    P2=<span class="number">0X7F</span>;<span class="comment">//è®©P2.7è¾“å‡ºä½ç”µå¹³ï¼Œå…¶ä»–è¾“å‡ºé«˜ç”µå¹³ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿èƒ½4ä¸ªæŒ‰é”®äº†</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">(u8 mode,u16 TIMES)</span></span><br><span class="line">&#123;  </span><br><span class="line">    <span class="type">static</span> u8 key_up=<span class="number">1</span>; <span class="comment">//æŒ‰é”®æ¾å¼€æ ‡å¿—</span></span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(mode)key_up=<span class="number">1</span>;   <span class="comment">//å¦‚æœmodeç­‰äº1ï¼Œæ”¯æŒè¿æŒ‰      </span></span><br><span class="line">    <span class="keyword">if</span>(key_up&amp;&amp;(KEY4==<span class="number">0</span>||KEY8==<span class="number">0</span>||KEY12==<span class="number">0</span>||KEY16==<span class="number">0</span>))<span class="comment">//åªè¦åœ¨key_upç­‰äº1æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªæŒ‰é”®è¢«æŒ‰ä¸‹å°±å¯ä»¥è¿›å…¥æ‰§è¡Œä»£ç </span></span><br><span class="line">    &#123;</span><br><span class="line">        times++;        <span class="comment">//è®°å½•è¿›å…¥ä½ç”µå¹³çš„æ—¶é—´</span></span><br><span class="line">        <span class="keyword">if</span>(times&gt;=TIMES)<span class="comment">//æŠ–åŠ¨çš„æ—¶é—´å·²ç»è¿‡å»</span></span><br><span class="line">        &#123;  </span><br><span class="line">            times=<span class="number">0</span>;</span><br><span class="line">            key_up=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(KEY4==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY8==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">8</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY12==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">12</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(KEY16==<span class="number">0</span>)<span class="keyword">return</span> <span class="number">16</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(KEY4==<span class="number">1</span>&amp;&amp;KEY8==<span class="number">1</span>&amp;&amp;KEY12==<span class="number">1</span>&amp;&amp;KEY16==<span class="number">1</span>)key_up=<span class="number">1</span>;       </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">// æ— æŒ‰é”®æŒ‰ä¸‹</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_Scan</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> u8 i = <span class="number">0</span>;     </span><br><span class="line">    P0 = <span class="number">0xFF</span>;             <span class="comment">//ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡é‡Œçš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">    P1 = (P1 &amp; <span class="number">0xF8</span>) | i;  <span class="comment">//iç­‰äº0æ—¶ï¼Œå°±æ˜¯â€œADDR2=0; ADDR1=0; ADDR0=0;â€ï¼Œiç­‰äº1æ—¶ï¼Œå°±æ˜¯â€œADDR2=0; ADDR1=0; ADDR0=1;â€ï¼Œä»¥æ­¤ç±»æ¨</span></span><br><span class="line">    P0 = LedBuff[i];       <span class="comment">//6ä¸ªç¼“å†²åŒºçš„å€¼è½®æµèµ‹ç»™P0</span></span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=<span class="number">6</span>)i=<span class="number">0</span>;           <span class="comment">//è®©iåœ¨0~5ä¹‹é—´å¾ªç¯å˜åŒ–</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> i;<span class="comment">//å–å€¼èŒƒå›´-128~127</span></span><br><span class="line">    u8 buf[<span class="number">6</span>];    </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)    <span class="comment">//æŠŠé•¿æ•´å‹æ•°è½¬æ¢ä¸º6ä½åè¿›åˆ¶çš„æ•°ç»„</span></span><br><span class="line">    &#123;</span><br><span class="line">        buf[i] = num % <span class="number">10</span>;</span><br><span class="line">        num = num / <span class="number">10</span>;    <span class="comment">//èˆæ‰ä¸ªä½æ•°ï¼Œé‡æ–°è£…è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">5</span>; i&gt;=<span class="number">1</span>; i--)   <span class="comment">//ä»æœ€é«˜ä½èµ·ï¼Œé‡åˆ°0å¡«å……ä¸æ˜¾ç¤ºçš„ä»£ç ï¼Œé‡åˆ°é0åˆ™é€€å‡ºå¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (buf[i] == <span class="number">0</span>)</span><br><span class="line">            LedBuff[i] = <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ; i&gt;=<span class="number">0</span>; i--)     <span class="comment">//å‰©ä½™ä½ä½éƒ½å¦‚å®è½¬æ¢ä¸ºæ•°ç ç®¡æ˜¾ç¤ºå­—ç¬¦</span></span><br><span class="line">    &#123;</span><br><span class="line">        LedBuff[i] = LedChar[buf[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ function.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __FUNCTION_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __FUNCTION_H__</span></span><br><span class="line">  </span><br><span class="line">sbit BEEP  = P1^<span class="number">6</span>;</span><br><span class="line">sbit KEY4  = P2^<span class="number">3</span>;</span><br><span class="line">sbit KEY8  = P2^<span class="number">2</span>;</span><br><span class="line">sbit KEY12 = P2^<span class="number">1</span>;</span><br><span class="line">sbit KEY16 = P2^<span class="number">0</span>;</span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit LED3  = P0^<span class="number">1</span>;</span><br><span class="line">sbit LED4  = P0^<span class="number">2</span>;</span><br><span class="line">sbit LED5  = P0^<span class="number">3</span>;</span><br><span class="line">sbit LED6  = P0^<span class="number">4</span>;</span><br><span class="line">sbit LED7  = P0^<span class="number">5</span>;</span><br><span class="line">sbit LED8  = P0^<span class="number">6</span>;</span><br><span class="line">sbit LED9  = P0^<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span>  u8;  <span class="comment">//å¯¹æ•°æ®ç±»å‹è¿›è¡Œå£°æ˜å®šä¹‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>  u16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> u32;</span><br><span class="line"><span class="keyword">extern</span>  u8 LedBuff[<span class="number">6</span>];      <span class="comment">//å¯¹æ•°ç ç®¡ç¼“å­˜åŒºè¿›è¡Œå¤–éƒ¨å£°æ˜</span></span><br><span class="line"><span class="keyword">extern</span>  u8 code LedChar[<span class="number">16</span>];<span class="comment">//å¯¹æ•°ç ç®¡çœŸå€¼è¡¨è¿›è¡Œå¤–éƒ¨å£°æ˜</span></span><br><span class="line">  </span><br><span class="line"><span class="comment">//åªè¦åœ¨â€œfunction.câ€æ–‡ä»¶ä¸­å°è£…æœ‰çš„å‡½æ•°éƒ½éœ€è¦åœ¨å¤´æ–‡ä»¶ä¸­å£°æ˜ä¸€ä¸‹</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(u16 x)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">KEY_Init</span><span class="params">()</span>;</span><br><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">(u8 mode,u16 TIMES)</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG_Scan</span><span class="params">()</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span>;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®é™… é‡‘æ²™æ»©å¼€å‘æ¿ main.c</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    u8 key;<span class="comment">//ç”¨æ¥è¯»å–æŒ‰é”®åŠ¨ä½œçš„è¿”å›å€¼</span></span><br><span class="line">    u8 beep_ok=<span class="number">0</span>;<span class="comment">//å®šä¹‰æ ‡å¿—èœ‚é¸£å™¨å…è®¸é¸£å«çš„å˜é‡ï¼Œä¸º1æ—¶å¯ä»¥é¸£å«ï¼Œä¸º0æ—¶ä¸èƒ½é¸£å«</span></span><br><span class="line">    u8 x;</span><br><span class="line">    u32 NUM=<span class="number">10086</span>;</span><br><span class="line">    LED_Init();<span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    KEY_Init();<span class="comment">//åˆå§‹åŒ–æŒ‰é”®æ¨¡å—</span></span><br><span class="line">    ShowNumber(NUM);<span class="comment">//æ›´æ–°æ•°ç ç®¡ç¼“å­˜åŒºå†…å®¹</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;        </span><br><span class="line">        SEG_Scan();</span><br><span class="line">        key=KEY_Scan(<span class="number">0</span>,<span class="number">700</span>);                <span class="comment">//ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼ï¼Œåˆ¤æ–­é˜ˆå€¼ä¸º700</span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">4</span>)&#123;NUM++;ShowNumber(NUM);&#125;  <span class="comment">//K4ä½¿NUMè‡ªåŠ </span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">12</span>)&#123;NUM--;ShowNumber(NUM);&#125; <span class="comment">//K12ä½¿NUMè‡ªå‡</span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">8</span>)beep_ok=<span class="number">1</span>;                <span class="comment">//K8å¼€å¯èœ‚é¸£å™¨é¸£å«</span></span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">16</span>)beep_ok=<span class="number">0</span>;               <span class="comment">//K16å…³é—­èœ‚é¸£å™¨é¸£å«</span></span><br><span class="line">     </span><br><span class="line">        <span class="keyword">if</span>(beep_ok==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> x=<span class="number">0</span>;</span><br><span class="line">     </span><br><span class="line">        <span class="keyword">if</span>(x&gt;=<span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x=<span class="number">0</span>;</span><br><span class="line">            BEEP=!BEEP;   </span><br><span class="line">        &#125;      </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class="note success modern"><p>success è¿™æ ·æˆ‘ä»¬çš„functionæ–‡ä»¶å°±å›Šæ‹¬äº†ä¹‹å‰æ‰€å­¦çš„å•ç‰‡æœºå¤–è®¾çš„ä»£ç äº†ï¼Œå¤§å®¶è¦å¥½å¥½æ¶ˆåŒ–è¿™ä¸€æ–‡ä»¶</p>
</div>
<h3 id="2-6-å¤–éƒ¨ä¸­æ–­"><a href="#2-6-å¤–éƒ¨ä¸­æ–­" class="headerlink" title="2.6 å¤–éƒ¨ä¸­æ–­"></a>2.6 å¤–éƒ¨ä¸­æ–­</h3><h4 id="2-6-1-IE0çš„ä½œç”¨"><a href="#2-6-1-IE0çš„ä½œç”¨" class="headerlink" title="2.6.1 IE0çš„ä½œç”¨"></a>2.6.1 IE0çš„ä½œç”¨</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¯·æå‰å°†P3.2å’ŒGNDç›¸è¿</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span>(IE0 == <span class="number">0</span>) &#123;</span><br><span class="line">			LED2 = !LED2;</span><br><span class="line">			delay_ms(<span class="number">50</span>);</span><br><span class="line">			LED2 = <span class="number">1</span>; <span class="comment">//å¦‚æœIE0ä¸ç­‰äº0äº†ï¼Œè¦ä¿è¯ç†„ç­LED2;</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(IE0 == <span class="number">1</span>) &#123;</span><br><span class="line">			LED9 = !LED9;</span><br><span class="line">			delay_ms(<span class="number">50</span>);</span><br><span class="line">			LED9 = <span class="number">1</span>; <span class="comment">//å¦‚æœLED0ä¸ç­‰äº1äº†ï¼Œè¦ä¿è¯ç†„ç­LED9</span></span><br><span class="line">		&#125;</span><br><span class="line">		delay_ms(<span class="number">50</span>); <span class="comment">//æ€»è¦æ‰§è¡Œ`if(IE0 == 0)`æˆ–è€…`if(IE0 == 1)`ï¼Œè¿™ä¸ªå»¶æ—¶è¦ä¿è¯å…¶ä¸­ä¸€ç›ç¯ç­çš„æ—¶é—´ï¼Œä¿è¯æ€»æœ‰ç¯é—ªçƒçš„ç°è±¡</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-6-2-ä¸­æ–­å‡½æ•°"><a href="#2-6-2-ä¸­æ–­å‡½æ•°" class="headerlink" title="2.6.2 ä¸­æ–­å‡½æ•°"></a>2.6.2 ä¸­æ–­å‡½æ•°</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT0 = <span class="number">1</span>; <span class="comment">//ä¸‹é™æ²¿è§¦å‘</span></span><br><span class="line">	EX0 = <span class="number">1</span>;</span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>); <span class="comment">// ä¸»å‡½æ•°ä»€ä¹ˆäº‹éƒ½ä¸ç”¨åšï¼Œç©ºå¾ªç¯è¿™æ¡è¯­å¥</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI0_IRQHandler</span><span class="params">()</span> interrupt 0 &#123;</span><br><span class="line">	LED2 = !LED2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥ä¸»å‡½æ•°ä»€ä¹ˆå†…å®¹ä¹Ÿæ²¡æœ‰ï¼Œä½†æ˜¯åœ¨æ‹”æ’æœé‚¦çº¿çš„è¿‡ç¨‹ä¸­è§¦å‘äº†ä¸­æ–­å‡½æ•°ï¼Œæ‰€ä»¥LED2è¢«æ‰§è¡Œè·³å˜ï¼Œè¿™å°±æ˜¯ä¸­æ–­å‡½æ•°çš„ä½œç”¨ã€‚å³ä½¿ä¸»å‡½æ•°ä¸€ç›´æ‰§è¡Œ<code>while(1);</code>ï¼Œä¸­æ–­å‡½æ•°è¿˜æ˜¯èƒ½æ‰§è¡Œçš„äº†çš„ã€‚æŠŠ<code>EX0=1;</code>æ”¹ä¸º<code>EX0=0;</code>ï¼Œæˆ–è€…æŠŠ<code>EA=1;</code>æ”¹ä¸º<code>EA=0;</code>å†ç¼–è¯‘ä¸‹è½½è¿›å»æ‹”æ’æœé‚¦çº¿å‘ç°LED2æ²¡æœ‰ååº”ï¼Œå› ä¸ºè¿™æ ·åšå·²ç»ä¸æ»¡è¶³è§¦å‘ä¸­æ–­å‡½æ•°å“åº”äº†ã€‚</p>
<h4 id="2-6-3-å¤–éƒ¨ä¸­æ–­1"><a href="#2-6-3-å¤–éƒ¨ä¸­æ–­1" class="headerlink" title="2.6.3 å¤–éƒ¨ä¸­æ–­1"></a>2.6.3 å¤–éƒ¨ä¸­æ–­1</h4><p>æƒ³è¦ä½¿ç”¨å¤–éƒ¨ä¸­æ–­1ï¼Œä»£ç ä¸­éœ€è¦æŠŠ<code>EX0</code>æ”¹ä¸º<code>EX1</code>ï¼Œ<code>IT0</code>æ”¹ä¸º<code>IT1</code>ã€‚interruptåé¢çš„0è¦æ”¹ä¸º2ï¼Œå‡½æ•°åæˆ‘ä»¬æ”¹ä¸º<code>EXTI1_IRQHandler()</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT1 = <span class="number">1</span>; <span class="comment">//ä¸‹é™æ²¿è§¦å‘æ¨¡å¼</span></span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	EX1 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶ç”µè·¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXIT1_IRQHandler</span><span class="params">()</span> interrupt 2 &#123;</span><br><span class="line">	LED2 = !LED2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-6-4-æŒ‰é”®æ§åˆ¶ä¸­æ–­"><a href="#2-6-4-æŒ‰é”®æ§åˆ¶ä¸­æ–­" class="headerlink" title="2.6.4 æŒ‰é”®æ§åˆ¶ä¸­æ–­"></a>2.6.4 æŒ‰é”®æ§åˆ¶ä¸­æ–­</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT1 = <span class="number">1</span>; <span class="comment">//è®¾ç½®ä¸‹é™æ²¿è§¦å‘æ¨¡å¼</span></span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	EX1 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç”µè·¯</span></span><br><span class="line">	KEY_Init(); <span class="comment">//åˆå§‹åŒ–æŒ‰é”®ç”µè·¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXTI1_IRQHandler</span><span class="params">()</span> interrupt 2 &#123;</span><br><span class="line">	LED2 = !LED2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬éœ€è¦å¯¹æŒ‰é”®è¿›è¡Œæ¶ˆæŠ–ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°æŒ‰ä¸‹æ¾æ‰‹ä¸€æ¬¡ï¼ŒLED2çš„çŠ¶æ€åªèƒ½å–åä¸€æ¬¡çš„çµæ•æ•ˆæœã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡åœ¨ä¸­æ–­å‡½æ•°ä¸­æ·»åŠ å»¶æ—¶å‡½æ•°æ¶ˆæŠ–ï¼Œä¸€èˆ¬ä¸è¿™æ ·åšï¼Œä½†ç¼–ç¨‹æœ¬å°±æ˜¯é€†å¤©è€Œè¡Œ</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT1 = <span class="number">1</span>; <span class="comment">//è®¾ç½®ä¸‹é™æ²¿è§¦å‘</span></span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	EX1 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç”µè·¯</span></span><br><span class="line">	KEY_Init(); <span class="comment">//åˆå§‹åŒ–é”®ç›˜ç”µè·¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXIT1_IRQHandler</span><span class="params">()</span> interrupt 2 &#123;</span><br><span class="line">	delay_ms(<span class="number">50</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(INT1 == <span class="number">0</span>) &#123; <span class="comment">// æ¶ˆæŠ–</span></span><br><span class="line">		LED2 = !LED2; <span class="comment">// P3.3æ˜¯å¦è¿˜å¤„äºä½ç”µå¹³çš„ç¨³å®šæ¥è§¦çŠ¶æ€ï¼ŒINT1å·²åœ¨â€œ#include &lt;reg52.h&gt;â€ä¸­å®šä¹‰å¥½äº†</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥è¾¾åˆ°æŒ‰ä¸‹æ¾æ‰‹ä¸€æ¬¡ï¼ŒLED2çš„çŠ¶æ€åªèƒ½å–åä¸€æ¬¡çš„çµæ•æ•ˆæœã€‚å¦‚æœæˆ‘ä»¬ä¸€ç›´æŒ‰ç€ä¸æ”¾ï¼ŒLED2ä¹Ÿåªæ˜¯è·³å˜ä¸€æ¬¡è€Œå·²ï¼Œæœ‰ç‚¹åƒä¸æ”¯æŒè¿æŒ‰åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸º<code>IT1=1;</code>çš„åŸå› ã€‚è¦æ˜¯æ”¹ä¸º<code>IT1=0;</code>ï¼Œè¿™æ ·K4æŒ‰é”®å°±æœ‰ç§æ”¯æŒè¿æŒ‰çš„æ„Ÿè§‰ä»è€ŒLED2å°±ä¼šä¸åœé—ªçƒäº†ã€‚æŒ‰é”®æŒ‰ä¸‹ä¸€ç›´ä¸æ”¾å°±ä¼šä¸åœåœ°è¿›å…¥ä¸­æ–­å‡½æ•°ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡åœ¨ä¸­æ–­å‡½æ•°ä¸­æ·»åŠ å»¶æ—¶å‡½æ•°æ¶ˆæŠ–ï¼Œä¸€èˆ¬ä¸è¿™æ ·åšï¼Œä½†ç¼–ç¨‹æœ¬å°±æ˜¯é€†å¤©è€Œä¸º</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	IT1 = <span class="number">0</span>; <span class="comment">//ä½ç”µå¹³ä¸‹è§¦å‘ä¸­æ–­</span></span><br><span class="line">	EA = <span class="number">1</span>;</span><br><span class="line">	EX1 = <span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç”µè·¯</span></span><br><span class="line">	KEY_Init(); <span class="comment">//åˆå§‹KEYç”µè·¯</span></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">EXIT_IRQHandler</span><span class="params">()</span> interrupt 2 &#123;</span><br><span class="line">	delay_ms(<span class="number">50</span>);</span><br><span class="line">	<span class="keyword">if</span>(INT1 == <span class="number">0</span>) &#123;</span><br><span class="line">		LED2 = !LED2;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="2-7-å®šæ—¶å™¨"><a href="#2-7-å®šæ—¶å™¨" class="headerlink" title="2.7 å®šæ—¶å™¨"></a>2.7 å®šæ—¶å™¨</h3><h4 id="2-7-1-å·¥ä½œæ¨¡å¼ä¸€ä¹‹æµæ°´ç¯"><a href="#2-7-1-å·¥ä½œæ¨¡å¼ä¸€ä¹‹æµæ°´ç¯" class="headerlink" title="2.7.1 å·¥ä½œæ¨¡å¼ä¸€ä¹‹æµæ°´ç¯"></a>2.7.1 å·¥ä½œæ¨¡å¼ä¸€ä¹‹æµæ°´ç¯</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># å®šæ—¶å™¨<span class="number">0</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    u8 i = <span class="number">0</span>;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä½å·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH0 = <span class="number">0x4C</span>; <span class="comment">//è‰²æ¹–ä¹‹å®šæ—¶æ—¶é—´ä½50ms</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(TF0 == <span class="number">1</span>) &#123; <span class="comment">//åˆ¤æ–­å®šæ—¶å™¨0æ˜¯å¦æº¢å‡ºï¼Œæ¯éš”50mså°±å¯ä»¥è¿›å…¥ä¸€æ¬¡è¿™ä¸ªifè¯­å¥å†…éƒ¨</span></span><br><span class="line">            TF0 = <span class="number">0</span>; <span class="comment">//è½¯ä»¶æ¸…é›¶ï¼Œå®šæ—¶å™¨0æº¢å‡ºåï¼Œæ¸…0æº¢å‡ºæ ‡å¿—</span></span><br><span class="line">            TH0 = <span class="number">0x4C</span>; <span class="comment">//é‡æ–°èµ‹å€¼ï¼Œä¿è¯ä¸‹æ¬¡æº¢å‡ºæ—¶é—´é—´éš”è¿˜æ˜¯50ms</span></span><br><span class="line">            TL0 = <span class="number">0x00</span>;</span><br><span class="line">            P0 = ~(<span class="number">0x01</span> &lt;&lt; i); <span class="comment">//æ¯ç›ç¯çš„ç‚¹äº®æ—¶é—´éƒ½ä¿æŒè€…50ms</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"># å®šæ—¶å™¨<span class="number">1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;function.h&gt;</span><span class="comment">//è¯¦è§ç¬¬å…­ç« ç¬¬8è®²</span></span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;   </span><br><span class="line">    u8 i=<span class="number">0</span>;</span><br><span class="line">    LED_Init();   <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å— </span></span><br><span class="line">    TMOD = <span class="number">0x10</span>;  <span class="comment">//è®¾ç½®å®šæ—¶å™¨1ä¸ºå·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH1  = <span class="number">0x4C</span>;  <span class="comment">//è®¾ç½®å®šæ—¶æ—¶é—´ä¸º50ms</span></span><br><span class="line">    TL1  = <span class="number">0x00</span>;</span><br><span class="line">    TR1  = <span class="number">1</span>;     <span class="comment">//å¯åŠ¨å®šæ—¶å™¨1</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (TF1 == <span class="number">1</span>)     <span class="comment">//åˆ¤æ–­å®šæ—¶å™¨1æ˜¯å¦æº¢å‡ºï¼Œæ¯éš”50mså°±å¯ä»¥è¿›å…¥ä¸€æ¬¡è¿™ä¸ªifè¯­å¥</span></span><br><span class="line">        &#123;</span><br><span class="line">            TF1 = <span class="number">0</span>;      <span class="comment">//å®šæ—¶å™¨1æº¢å‡ºåï¼Œæ¸…0æº¢å‡ºæ ‡å¿—</span></span><br><span class="line">            TH1 = <span class="number">0x4C</span>;   <span class="comment">//é‡æ–°èµ‹åˆå€¼ï¼Œä¿è¯ä¸‹æ¬¡æº¢å‡ºé—´éš”æ—¶é—´è¿˜æ˜¯50ms</span></span><br><span class="line">            TL1 = <span class="number">0x00</span>;</span><br><span class="line">            P0=~(<span class="number">0x01</span>&lt;&lt;i);<span class="comment">//æ¯ç›ç¯çš„ç‚¹äº®æ—¶é—´éƒ½ä¿æŒç€50ms</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">8</span>)i=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-7-2-å®šæ—¶å™¨ä¸­æ–­"><a href="#2-7-2-å®šæ—¶å™¨ä¸­æ–­" class="headerlink" title="2.7.2 å®šæ—¶å™¨ä¸­æ–­"></a>2.7.2 å®šæ—¶å™¨ä¸­æ–­</h4><p>å³ç§»æµæ°´ç¯ï¼Œå®šæ—¶æ—¶é•¿ä¸º30ms</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    EA = <span class="number">1</span>; <span class="comment">//æ‰“å¼€æ€»ä¸­æ–­å¼€å…³</span></span><br><span class="line">    TMOD = <span class="number">0x01</span>; <span class="comment">//è®¾ç½®å®šæ—¶å™¨0ä¸ºå·¥ä½œæ¨¡å¼1</span></span><br><span class="line">    TH0 = <span class="number">0x94</span>; <span class="comment">// è®¾ç½®å®šæ—¶æ—¶é—´ä¸º30ms</span></span><br><span class="line">    ET0 = <span class="number">1</span>; <span class="comment">//æ‰“å¼€å®šæ—¶å™¨0ä¸­æ–­çš„å¼€å…³</span></span><br><span class="line">    TR0 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨å®šæ—¶å™¨0</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">TIM0_IRQHandler</span><span class="params">()</span> interrupt 1 &#123;</span><br><span class="line">    <span class="type">static</span> u8 i;</span><br><span class="line">    TH0 = <span class="number">0x94</span>; <span class="comment">//é‡æ–°è®¾å®šæ—¶é—´ä¸º30ms</span></span><br><span class="line">    TL0 = <span class="number">0x00</span>;</span><br><span class="line">    </span><br><span class="line">    P0 = ~(<span class="number">0x80</span> &gt;&gt; i); <span class="comment">//æµæ°´ç¯å‘å·¦ç§»åŠ¨</span></span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i &gt;= <span class="number">8</span>) i = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰ã€å•ç‰‡æœºCè¯­è¨€"><a href="#ä¸‰ã€å•ç‰‡æœºCè¯­è¨€" class="headerlink" title="ä¸‰ã€å•ç‰‡æœºCè¯­è¨€"></a>ä¸‰ã€å•ç‰‡æœºCè¯­è¨€</h2><p>è¯¥ç« åªè®°å½•åšä¸»ä¸ä¼šçš„å•ç‰‡æœºç›¸å…³Cè¯­è¨€çŸ¥è¯†ï¼Œä¸åšCè¯­è¨€çš„è¯¦ç»†è§£é‡Šï¼Œè°å«åšä¸»æ˜¯ä¸ªèœé¸¡å‘¢ã€‚å¯¹åˆšå…¥é—¨å•ç‰‡æœºç¼–ç¨‹çš„åˆå­¦è€…æ¥è¯´ï¼Œä»¥å‰æˆ‘ä»¬Cè¯­è¨€åŸºç¡€ä¸Šæœºæ“ä½œçš„æ—¶å€™éƒ½æ˜¯åªè§è¿‡åˆ«äººint,charçš„å»å®šä¹‰å˜é‡ï¼Œè€Œåœ¨å•ç‰‡æœºå…¥é—¨ç¼–ç¨‹ä¸­çœ‹åˆ°çš„éƒ½æ˜¯unsigned int,unsigned charè¿™æ ·å®šä¹‰ï¼ŒåŸå› æ˜¯<code>å•ç‰‡æœºåœ¨å…¥é—¨çš„æ—¶å€™ç”¨çš„å˜é‡çš„å–å€¼éƒ½æ˜¯0å’Œæ­£æ•´æ•°ï¼ˆæ­£æ•´æ•°ä¸åŒ…æ‹¬0ï¼‰ï¼Œæ‰€ä»¥æ‰ä¼šç”¨unsignedå»å®šä¹‰æ— ç¬¦å·æ•´å½¢å˜é‡</code>ã€‚</p>
<h3 id="3-1-ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å’Œä½å®šä¹‰"><a href="#3-1-ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å’Œä½å®šä¹‰" class="headerlink" title="3.1 ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å’Œä½å®šä¹‰"></a>3.1 ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å’Œä½å®šä¹‰</h3><h4 id="3-1-1-sfr-P0-0x80"><a href="#3-1-1-sfr-P0-0x80" class="headerlink" title="3.1.1 sfr P0=0x80"></a>3.1.1 sfr P0=0x80</h4><p>sfr è¿™ä¸ªå…³é”®å­—ï¼Œæ˜¯ 51 å•ç‰‡æœºç‰¹æœ‰çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯å®šä¹‰ä¸€ä¸ª<code>å•ç‰‡æœºç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨</code>(special function register)ã€‚</p>
<p>51 å•ç‰‡æœºå†…éƒ¨æœ‰å¾ˆå¤šä¸ªå°<code>æ¨¡å—</code>ï¼Œæ¯ä¸ªæ¨¡å—å±…ä½åœ¨æ‹¥æœ‰å”¯ä¸€æˆ¿é—´å·çš„æˆ¿é—´å†…ï¼ŒåŒæ—¶æ¯ä¸ªæ¨¡å—éƒ½æœ‰ 8 ä¸ªæ§åˆ¶å¼€å…³ã€‚<code>P0</code>å°±æ˜¯ä¸€ä¸ªåŠŸèƒ½æ¨¡å—ï¼Œå°±ä½åœ¨äº† <code>0x80</code> è¿™ä¸ªæˆ¿é—´é‡Œï¼Œæˆ‘ä»¬å°±æ˜¯é€šè¿‡è®¾ç½® P0 å†…éƒ¨è¿™ä¸ªæ¨¡å—çš„ 8 ä¸ªå¼€å…³ï¼Œæ¥è®©å•ç‰‡æœºçš„ P0 è¿™ 8 ä¸ª IO å£è¾“å‡ºé«˜ç”µå¹³æˆ–è€…ä½ç”µå¹³çš„ã€‚è€Œ 51 å•ç‰‡æœºå†…éƒ¨æœ‰å¾ˆå¤šå¯„å­˜å™¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨çš„è¯å¿…é¡»æå‰è¿›è¡Œ sfr å£°æ˜ã€‚ä¸è¿‡ Keil è½¯ä»¶å·²ç»æŠŠæ‰€æœ‰è¿™äº›å£°æ˜éƒ½é¢„å…ˆå†™å¥½å¹¶ä¿å­˜åˆ°ä¸€ä¸ªä¸“é—¨çš„æ–‡ä»¶ä¸­å»äº†ï¼Œæˆ‘ä»¬è¦ç”¨çš„è¯åªè¦æ–‡ä»¶å¼€å¤´æ·»åŠ ä¸€è¡Œ#include<reg52.h>å³å¯ã€‚</p>
<h4 id="3-1-2-sbit-LED-P0-0"><a href="#3-1-2-sbit-LED-P0-0" class="headerlink" title="3.1.2 sbit LED = P0^0"></a>3.1.2 sbit LED = P0^0</h4><p>è¿™ä¸ª <code>sbit</code>ï¼Œå°±æ˜¯å¯¹åˆšæ‰æ‰€è¯´çš„ SFR é‡Œè¾¹çš„ 8 ä¸ªå¼€å…³å…¶ä¸­çš„ä¸€ä¸ªè¿›è¡Œå®šä¹‰ã€‚ç»è¿‡ä¸Šè¾¹ç¬¬äºŒæ¡è¯­å¥åï¼Œä»¥ååªè¦åœ¨ç¨‹åºé‡Œå†™ LEDï¼Œå°±ä»£è¡¨äº† P0.0 å£ã€‚æ³¨æ„è¿™ä¸ª P å¿…é¡»å¤§å†™ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ç»™ P0.0 åˆå–äº†ä¸€ä¸ªæ›´å½¢è±¡çš„åå­—å«åš LEDã€‚</p>
<h4 id="3-1-3-å•ç‰‡æœºçš„ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨"><a href="#3-1-3-å•ç‰‡æœºçš„ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨" class="headerlink" title="3.1.3 å•ç‰‡æœºçš„ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨"></a>3.1.3 å•ç‰‡æœºçš„ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨</h4><p>è¯·æ³¨æ„ï¼Œæ¯ä¸ªå‹å·çš„å•ç‰‡æœºéƒ½ä¼šé…æœ‰ç”Ÿäº§å‚å•†æ‰€ç¼–å†™çš„æ•°æ®æ‰‹å†Œ(Datasheet)ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ STC89C52 çš„æ•°æ®æ‰‹å†Œï¼Œä» 21 é¡µåˆ° 24 é¡µï¼Œå…¨éƒ¨æ˜¯å¯¹ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨çš„ä»‹ç»ä»¥åŠåœ°å€æ˜ å°„åˆ—è¡¨ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.staticaly.com/gh/Gan1Ser/img-url@main/2022/12image-20230331165423783.png" alt="image-20230331165423783"></p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¡¨ï¼Œå…¶ä¸­ P4 å£ STC89C52 å¯¹æ ‡å‡† 51 çš„æ‰©å±•ï¼Œæˆ‘ä»¬å…ˆå¿½ç•¥å®ƒï¼Œåªçœ‹å‰è¾¹çš„ P0ã€P1ã€P2ã€P3 è¿™ 4 ä¸ªï¼Œæ¯ä¸ª P å£æœ¬èº«åˆæœ‰ 8 ä¸ªæ§åˆ¶ç«¯å£ã€‚è¿™æ ·å°±ç¡®å®šäº†æˆ‘ä»¬çš„å•ç‰‡æœºä¸€å…±æœ‰ 32 ä¸ª IO å£</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/64268bc2a682492fccb2fc91.png" alt=""></p>
<p>å…¶ä¸­P0 å£æ‰€åœ¨çš„åœ°å€æ˜¯0x80ï¼Œä¸€å…±æœ‰ä»7 åˆ°0 è¿™8 ä¸ªIO å£æ§åˆ¶ä½ï¼Œåè¾¹æœ‰ä¸ªReset Valueï¼ˆå¤ä½å€¼ï¼‰ï¼Œè¿™ä¸ªå¾ˆé‡è¦ï¼Œæ˜¯æˆ‘ä»¬çœ‹å¯„å­˜å™¨å¿…çœ‹çš„ä¸€ä¸ªå‚æ•°ï¼Œ8 ä¸ªæ§åˆ¶ä½å¤ä½å€¼å…¨éƒ¨éƒ½æ˜¯ 1ã€‚è¿™å°±æ˜¯å‘Šè¯‰æˆ‘ä»¬ï¼Œæ¯å½“å•ç‰‡æœºä¸Šç”µå¤ä½çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å¼•è„šçš„å€¼é»˜è®¤æ˜¯éƒ½æ˜¯ 1ï¼Œå³é«˜ç”µå¹³ï¼Œ<br>æˆ‘ä»¬åœ¨è®¾è®¡ç”µè·¯çš„æ—¶å€™ä¹Ÿè¦å……åˆ†çš„è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="3-2-Delay-å‡½æ•°"><a href="#3-2-Delay-å‡½æ•°" class="headerlink" title="3.2 Delay()å‡½æ•°"></a>3.2 Delay()å‡½æ•°</h3><p>å‰æœŸæˆ‘ä»¬åœ¨è®¾è®¡æ—¶é—´é—´éš”æ—¶ç»å¸¸ä½¿ç”¨$Delay()$å‡½æ•°ï¼Œæœ€è¿‘å‡ ä½åŒå­¦ä¸€ç›´åœ¨ç ”ç©¶è¿™ä¸ªå‡½æ•°ï¼Œç®€å•çš„ä¸¤å±‚<code>for</code>å¾ªç¯ï¼ŒçœŸçš„èƒ½å¾ˆå‡†ç¡®çš„è®¾ç½®å»¶è¿Ÿå—ï¼Ÿè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹è¿™ä¸ªç®€å•çš„å»¶è¿Ÿçš„å‡½æ•°ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> <span class="comment">//ç®€å•çš„å»¶æ—¶å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; t; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">120</span>; j++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">delay(<span class="number">5000</span>); <span class="comment">//ç»¿ç¯æŒç»­5ç§’é’Ÿ</span></span><br></pre></td></tr></table></figure>
<p>ç°åœ¨æ€è€ƒä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨å‡½æ•°$delay(5000)$å°±èƒ½å»¶è¿Ÿ5ç§’é’Ÿå‘¢ï¼Ÿ</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;-- è¿™é‡Œæ˜¯æ ¹æ®æˆ‘æŸ¥é˜…äº†ä¸€äº›èµ„æ–™å¾—åˆ°çš„ä¸€ç‚¹ç†è§£ï¼Œå¦‚æœ‰ä¸å¯¹è¯·æŒ‡æ­£ --&gt;</span><br><span class="line"></span><br><span class="line">æ ¹æ®ä»£ç å…¶å®å¾ˆæ˜æ˜¾ï¼Œè°ƒç”¨delayå‡½æ•°å»¶æ—¶çš„æ—¶é•¿æ˜¯é€šè¿‡å¾ªç¯æ‰§è¡Œç©ºæ“ä½œæ¥å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œdelayå‡½æ•°å¹¶æ²¡æœ‰çœŸæ­£çš„å³ä½¿åŠŸèƒ½ï¼Œè€Œæ˜¯é€šè¿‡ç¨‹åºæ‰§è¡Œçš„é€Ÿåº¦æ¥æ§åˆ¶å»¶æ—¶çš„æ—¶é•¿ã€‚å› æ­¤ï¼Œdelay(5000)å®é™…ä¸Šæ˜¯åœ¨å¾ªç¯æ‰§è¡Œä¸€å®šæ¬¡æ•°çš„ç©ºæ“ä½œåï¼Œæ‰è¿”å›å‡½æ•°ï¼Œè¾¾åˆ°å»¶æ—¶5sçš„æ•ˆæœã€‚</span><br><span class="line"></span><br><span class="line">å…·ä½“æ¥æ±‚è§£è¿™ä¸ª5så…¶å®æ˜¯è¦è€ƒè™‘å¾ˆå¤šå› ç´ çš„ï¼Œå»¶æ—¶æ—¶é•¿çš„è®¡ç®—ä¸å•ç‰‡æœºæ‰€ä½¿ç”¨çš„æ—¶é’Ÿé¢‘ç‡æœ‰å…³ã€‚ä»¥ä¸€ä¸ª8MHzçš„æ™¶æŒ¯ä¸ºä¾‹ï¼Œæ¯ä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ—¶é—´ä¸º1/(8MHz)=0.125usã€‚delayå‡½æ•°ä¸­çš„å¾ªç¯æ¬¡æ•°æ˜¯é€šè¿‡å°†æ‰€éœ€å»¶æ—¶æ—¶é—´è½¬æ¢ä¸ºå¾ªç¯æ¬¡æ•°æ¥å®ç°çš„ï¼Œè®¡ç®—å…¬å¼ä¸ºï¼šå¾ªç¯æ¬¡æ•° = å»¶æ—¶æ—¶é—´ / å•æ¬¡å¾ªç¯æ‰€éœ€æ—¶é—´ã€‚å¯¹äºdelay(5000)æ¥è¯´ï¼Œå»¶æ—¶ä¸º5s,å³5000ms=5000000usã€‚è€Œå•æ¬¡å¾ªç¯æ‰€éœ€æ—¶é—´æ˜¯æ ¹æ®æ—¶é’Ÿé¢‘ç‡è®¡ç®—å¾—åˆ°çš„ï¼Œå¯¹äº8MHzæ™¶æŒ¯ï¼Œå•æ¬¡å¾ªç¯æ‰€éœ€æ—¶é—´ä¸º1/(8MHz)Â·4 = 0.5us(å…¶ä¸­4æ˜¯ç©ºæ“ä½œçš„æŒ‡ä»¤æ‰§è¡Œæ•°)ã€‚å› æ­¤ï¼Œå»¶è¿Ÿ5séœ€è¦æ‰§è¡Œçš„å¾ªç¯æ¬¡æ•°ä¸ºï¼š5000000us/0.5us=10000000æ¬¡ï¼Œæ‰èƒ½å®ç°å»¶è¿Ÿ5ç§’çš„æ•ˆæœã€‚</span><br><span class="line"></span><br><span class="line">&lt;-- åšä¸»çš„å•ç‰‡æœºæ˜¯11.9....MHzçš„æ™¶æŒ¯ï¼Œprotuesæ˜¯12MHzçš„ï¼Œè®©æˆ‘è®¡ç®—ä¸€ä¸‹ï¼Œä»¥ä¸Šä»£ç æ˜¯å¦çœŸçš„æ˜¯5s --&gt;</span><br><span class="line">æŒ‰ç…§protuesä¸­çš„12MHzï¼Œæˆ‘ä»¬è®¡ç®—ä¸€ä¸‹5séœ€è¦å¾ªç¯å¤šå°‘æ¬¡ã€‚æ ¹æ®ä¸Šè¿°åŸç†ï¼Œæˆ‘ä»¬æ¯ä¸ªæ—¶é’Ÿå‘¨æœŸçš„æ—¶é—´ä¸º1/(12MHZ),å•æ¬¡å¾ªç¯æ‰€éœ€æ—¶é—´ä¸º1/(12MHz)Â·120 = 10us(è¿™é‡Œ120æ˜¯ç©ºæ“ä½œçš„æŒ‡ä»¤æ‰§è¡Œæ•°è§ä»£ç for(j = 0; j &lt; 120; j++))ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è¦å»¶è¿Ÿ5séœ€è¦æ‰§è¡Œçš„å¾ªç¯æ¬¡æ•°ä¸ºï¼š5000000us/10us = 500000æ¬¡ï¼Œä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨delay(5000)ä¸€å…±å¾ªç¯äº†5000Â·120=600000æ¬¡ï¼Œä¸ç®¡æ˜¯500000æ¬¡è¿˜æ˜¯600000æ¬¡æˆ‘ä»¬å‘ç°è¿™éƒ½å’Œæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°5000ä¸ç¬¦åˆå‘€ï¼Œéº»äº†ï¼Œè¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºä»¥ä¸Šè®¡ç®—å…¬å¼éƒ½æ˜¯åŸºäºå•ç‰‡æœºæ±‡ç¼–è¯­è¨€çš„ï¼Œæˆ‘ä»¬ä½¿ç”¨cè¯­è¨€ç»ä¸èƒ½è¿™æ ·è®¡ç®—ï¼Œå¾ˆæ˜æ˜¾ä¸€æ¡cè¯­å¥åº”è¯¥æ˜¯å¯¹åº”å¾ˆå¤šè°ƒæ±‡ç¼–è¯­å¥çš„ï¼Œä½ å¯ä»¥Dedugè¯•è¯•ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•æ˜¯è®¡ç®—ä¸å‡ºæ¥çš„ã€‚</span><br></pre></td></tr></table></figure>
<p>å¦‚ä½•è®¾è®¡æˆ‘ä»¬çš„å¾ªç¯è¾¾åˆ°æƒ³è¦çš„å»¶è¿Ÿæ•ˆæœï¼Ÿç»¼åˆä¸Šè¿°æ‰€è®²ï¼Œæˆ‘ä»¬çš„è¯¯åŒºå°±è½åœ¨Cè¯­è¨€è¯­å¥çš„æ‰§è¡Œæ—¶é—´ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥å®é™…è°ƒè¯•ä¸€ä¸‹çœ‹çœ‹æˆ‘ä»¬çš„ä»£ç åˆ°åº•è¿è¡Œå¤šä¹…ã€‚</p>
<h5 id="3-2-1-ç©ºæ“ä½œå¾ªç¯è¿è¡Œçš„æ—¶é—´"><a href="#3-2-1-ç©ºæ“ä½œå¾ªç¯è¿è¡Œçš„æ—¶é—´" class="headerlink" title="3.2.1 ç©ºæ“ä½œå¾ªç¯è¿è¡Œçš„æ—¶é—´"></a>3.2.1 ç©ºæ“ä½œå¾ªç¯è¿è¡Œçš„æ—¶é—´</h5><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">sbit RED1 = P2^<span class="number">0</span>; <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯</span></span><br><span class="line">sbit YELLOW1 = P2^<span class="number">1</span>; <span class="comment">//ç¬¬ä¸€ç»„é»„ç¯</span></span><br><span class="line">sbit GREEN1 = P2^<span class="number">2</span>; <span class="comment">//ç¬¬ä¸€ç»„ç»¿ç¯</span></span><br><span class="line">sbit RED2 = P2^<span class="number">3</span>; <span class="comment">//ç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">sbit YELLOW2 = P2^<span class="number">4</span>; <span class="comment">//ç¬¬äºŒç»„é»„ç¯</span></span><br><span class="line">sbit GREEN2 = P2^<span class="number">5</span>; <span class="comment">//ç¬¬äºŒç»„ç»¿ç¯</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">delay</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> t)</span> <span class="comment">//ç®€å•çš„å»¶æ—¶å‡½æ•°</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; t; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">120</span>; j++);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">		<span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„ç»¿ç¯ï¼Œç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">        GREEN1 = <span class="number">0</span>;</span><br><span class="line">        YELLOW1 = <span class="number">1</span>;</span><br><span class="line">        RED1 = <span class="number">1</span>;</span><br><span class="line">        GREEN2 = <span class="number">1</span>;</span><br><span class="line">        YELLOW2 = <span class="number">1</span>;</span><br><span class="line">        RED2 = <span class="number">0</span>; </span><br><span class="line">				<span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;<span class="number">120</span>; i++); <span class="comment">//éªŒè¯ç©ºæ“ä½œå¾ªç¯æ‰€éœ€æ—¶é—´</span></span><br><span class="line">        delay(<span class="number">5000</span>); <span class="comment">//ç»¿ç¯æŒç»­5ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„é»„ç¯ï¼Œç¬¬äºŒç»„çº¢ç¯</span></span><br><span class="line">        YELLOW1 = <span class="number">0</span>;</span><br><span class="line">        GREEN1 = <span class="number">1</span>;</span><br><span class="line">        delay(<span class="number">1000</span>); <span class="comment">//é»„ç¯æŒç»­1ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯ï¼Œç¬¬äºŒç»„ç»¿ç¯</span></span><br><span class="line">        RED1 = <span class="number">0</span>;</span><br><span class="line">        YELLOW1 = <span class="number">1</span>;</span><br><span class="line">        GREEN1 = <span class="number">1</span>;</span><br><span class="line">        RED2 = <span class="number">1</span>;</span><br><span class="line">        YELLOW2 = <span class="number">1</span>;</span><br><span class="line">        GREEN2 = <span class="number">0</span>; </span><br><span class="line">        delay(<span class="number">5000</span>); <span class="comment">//ç»¿ç¯æŒç»­5ç§’é’Ÿ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ç»„çº¢ç¯ï¼Œç¬¬äºŒç»„é»„ç¯</span></span><br><span class="line">        YELLOW2 = <span class="number">0</span>;</span><br><span class="line">        GREEN2 = <span class="number">1</span>;</span><br><span class="line">        delay(<span class="number">1000</span>); <span class="comment">//é»„ç¯æŒç»­1ç§’é’Ÿ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol>
<li>é¦–å…ˆå°†æˆ‘ä»¬çš„æ™¶æŒ¯é¢‘ç‡è®¾ç½®ä¸º12MHzï¼Œå› ä¸ºæ–°å»ºå·¥ç¨‹æ—¶é»˜è®¤æ˜¯24MHz</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e5f6a682492fccc4d8d7.png" alt="image-20230402090540447"></p>
<ol>
<li>å¼€å§‹è°ƒè¯•ï¼ˆä¸ºäº†éªŒè¯çš„ç®€å•ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨mainå‡½æ•°ä¸­æ·»åŠ ç©ºæ“ä½œå¾ªç¯ï¼‰</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e628a682492fccc51215.png" alt="image-20230402090813183"></p>
<ol>
<li>æ‰“æ–­ç‚¹</li>
</ol>
<p>æˆ‘ä»¬å°†æ–­ç‚¹æ‰“åˆ°ç¬¬30è¡Œå’Œç¬¬31è¡Œï¼Œç‚¹å‡»<code>RST</code>æŒ‰é’®ï¼Œç„¶åè¿”å›mainå‡½æ•°ï¼ŒæŒ‰ä¸‹<code>run</code>é”®ï¼Œé€šè¿‡å³ä¾§<code>sec</code>æ—¶é—´å¯ä»¥çœ‹åˆ°å½“å‰ç¨‹åºæ‰§è¡Œåˆ°ç¬¬30è¡Œæ‰€ç”¨çš„æ—¶é—´ã€‚å¯ä»¥çœ‹åˆ°ç¨‹åºè¿è¡Œåˆ°ç¬¬30è¡Œæ—¶èŠ±äº†0.00039400s</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e65da682492fccc546ca.png" alt="image-20230402092201907"></p>
<p>æˆ‘ä»¬ç»§ç»­æ‰§è¡Œç¬¬30æ¡è¯­å¥ï¼ŒæŸ¥çœ‹æ—¶é—´ä¸º0.00039500ï¼Œè¿™æ¡è¯­å¥èŠ±äº†0.00039500-0.00039400=0.00000100s,ä¹Ÿå°±æ˜¯1å¾®ç§’ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e694a682492fccc5861b.png" alt="image-20230402092421453"></p>
<p>ä¸‹é¢æˆ‘ä»¬æ‰§è¡Œç©ºæ“ä½œå¾ªç¯è¯­å¥ï¼Œæˆ‘ä»¬ç»§ç»­å°†æ–­ç‚¹æ‰“åœ¨32è¡Œï¼ˆä¸ºäº†è®¡ç®—æ—¶é—´ï¼Œå¦‚æœä¸æ‰“æ–­ç‚¹ç¨‹åºä¼šå°†31è¡Œè¯­å¥åé¢çš„ç¨‹åºå…¨éƒ¨æ‰§è¡Œå®Œï¼‰ã€‚å¯ä»¥çœ‹åˆ°æ—¶é—´å˜æˆ0.00135800sã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„ç©ºæ“ä½œè¯­å¥èŠ±äº†0.00135800s-0.00039500=0.000963sï¼Œä¹Ÿå°±æ˜¯0.963æ¯«ç§’æ¥è¿‘1msã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e6c5a682492fccc5b86e.png" alt="image-20230402092931979"></p>
<p>å¦‚æ­¤æˆ‘ä»¬å°±çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬è°ƒç”¨delay(5000)å°±èƒ½å¤Ÿå»¶è¿Ÿ5sç§’äº†ï¼Œè§†5000ä¸º5000æ¬¡1msï¼Œå°±å¾—åˆ°5säº†ã€‚</p>
<h5 id="3-2-2-å­˜åœ¨çš„é—®é¢˜"><a href="#3-2-2-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="3.2.2 å­˜åœ¨çš„é—®é¢˜"></a>3.2.2 å­˜åœ¨çš„é—®é¢˜</h5><p>å¦‚æœä½ è°ƒè¯•æ—¶å€™æˆ‘ä»¬çš„æ—¶é—´æ˜¯æœ‰å·®å¼‚çš„ï¼Œé‚£å°±è¯´æ˜æˆ‘ä»¬ä½¿ç”¨ç©ºæ“ä½œå¾ªç¯è¿›è¡Œå»¶æ—¶æ“ä½œæ˜¯ä¸å®Œå…¨çš„ã€‚è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬è®¾ç½®çš„æ—¶é—´å‚æ•°5000ï¼Œåˆ©ç”¨ç©ºå¾ªç¯ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œè€Œè¿™ä¸ªæ—¶é—´æ­£æ˜¯é€šè¿‡è®¡ç®—æœº(æ™¶æŒ¯)æ—¶é’Ÿå‘¨æœŸæ•°æ¥å®ç°çš„ï¼Œå®ƒçš„å…·ä½“æ—¶é—´å–å†³äºè®¡ç®—æœºçš„æ€§èƒ½å’Œç³»ç»Ÿè´Ÿè½½æƒ…å†µã€‚ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨è°ƒè¯•æ—¶ï¼Œè¿™æ ·çš„ç»“æœè¿˜å’Œæˆ‘ä»¬çš„å•ç‰‡æœº(è®¡ç®—æœº)ç¡¬ä»¶æœ‰å…³ï¼Œå› æ­¤å­˜åœ¨è¯¯å·®æ˜¯å¾ˆæ­£å¸¸ã€‚</span><br><span class="line"></span><br><span class="line">å…¶å®æˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬è°ƒè¯•å‡ºçš„for(i=0;i&lt;120;i++)å¹¶ä¸æ˜¯1msï¼Œè€Œæ˜¯0.963msã€‚æˆ‘ä»¬ç”¨æ­¤å¾ªç¯5000æ¬¡ï¼Œè¿™æ ·çš„è¯¯å·®ä¼šéšç€å¾ªç¯æ¬¡æ•°çš„å¢åŠ è¢«ä¸æ–­åœ°æ”¾å¤§ä¸º1535ms,wokï¼Œå·®äº†1sï¼Œè¿™å¤ªå¯æ€•äº†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªéªŒè¯çš„GIFï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®6sï¼ˆæˆ‘åç‚¹æŒ‰çš„å€’è®¡æ—¶ï¼‰</span><br></pre></td></tr></table></figure>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6428e1b8a682492fccc019c2.gif" alt=""></p>
<p>æ‰€ä»¥æˆ‘ä»¬å•çº¯çš„ä½¿ç”¨ç©ºæ“ä½œå¾ªç¯è¯­å¥è¿›è¡Œå»¶è¿Ÿå®é™…ä¸Šæ˜¯ä¸å‡†ç¡®çš„ï¼Œä½†æ˜¯å‹‰å¼ºèƒ½ç”¨ã€‚</p>
<h5 id="3-2-3-è®¾è®¡ç²¾ç¡®çš„5s"><a href="#3-2-3-è®¾è®¡ç²¾ç¡®çš„5s" class="headerlink" title="3.2.3 è®¾è®¡ç²¾ç¡®çš„5s"></a>3.2.3 è®¾è®¡ç²¾ç¡®çš„5s</h5><p>è¦è®¾è®¡ç²¾ç¡®çš„5sæˆ‘ä»¬å¯ä»¥å€ŸåŠ©äºçœ‹é—¨ç‹—(å®šæ—¶å™¨)æˆ–è€…å†æ¬¡è°ƒè¯•ï¼Œåé¢æ›´æ–°ï¼Œåšä¸»å›°äº†ï¼Œæ‹œæ‹œã€‚</p>
<h3 id="3-3-ç§»ä½"><a href="#3-3-ç§»ä½" class="headerlink" title="3.3 ç§»ä½"></a>3.3 ç§»ä½</h3><p>åœ¨æˆ‘ä»¬çš„ C è¯­è¨€å½“ä¸­ï¼Œæœ‰ä¸€ä¸ªç§»ä½æ“ä½œï¼Œå…¶ä¸­<code>&lt;&lt;</code>ä»£è¡¨çš„æ˜¯å·¦ç§»ï¼Œ<code>&gt;&gt;</code>ä»£è¡¨çš„æ˜¯å³ç§»ã€‚æ¯”å¦‚<code>a = 0x01&lt;&lt;1;</code>å°±æ˜¯ a çš„ç»“æœç­‰äº 0x01 å·¦ç§»ä¸€ä½ã€‚å¤§å®¶æ³¨æ„ï¼Œç§»ä½éƒ½æ˜¯æŒ‡äºŒè¿›åˆ¶ç§»ä½ï¼Œé‚£ä¹ˆç§»ä½å®Œäº†ï¼Œæœ¬æ¥åœ¨ç¬¬ 0 ä½çš„ 1 ç§»åŠ¨åˆ°äº†ç¬¬ä¸€ä½ä¸Šï¼Œç§»åŠ¨å®Œäº†ä½ä½æ˜¯è¡¥ 0 çš„ã€‚æ‰€ä»¥ a çš„å€¼æœ€ç»ˆæ˜¯ç­‰äº <code>0x02</code>ã€‚ è¿˜è¦å­¦ä¹ å¦å¤–ä¸€ä¸ªè¿ç®—ç¬¦~ï¼Œè¿™ä¸ªç¬¦å·æ˜¯æŒ‰ä½å–åçš„æ„æ€ï¼ŒåŒç†æŒ‰ä½å–åä¹Ÿæ˜¯é’ˆå¯¹äºŒè¿›åˆ¶è€Œè¨€ã€‚æ¯”å¦‚ a = ~(0x01); 0x01 çš„äºŒè¿›åˆ¶æ˜¯ 0b00000001ï¼ŒæŒ‰ä½å–ååå°±æ˜¯ 0b11111110ï¼Œé‚£ä¹ˆa çš„å€¼å°±æ˜¯ 0xFE äº†ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯<code>äºŒè¿›åˆ¶ç§»ä½</code></p>
<h3 id="3-4-é™æ€å˜é‡"><a href="#3-4-é™æ€å˜é‡" class="headerlink" title="3.4 é™æ€å˜é‡"></a>3.4 é™æ€å˜é‡</h3><p><strong>static</strong>ä¸€èˆ¬ä¸ç”¨åœ¨ä¸»å‡½æ•°ä¸­ï¼Œå¤§å¤šæ•°åœ¨ä¸­æ–­å‡½æ•°å’Œå°è£…å¥½çš„å­å‡½æ•°é‡Œè¿ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¿è¯åœ¨å­å‡½æ•°æˆ–ä¸­æ–­å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡æ¯æ¬¡è°ƒç”¨å®Œä¹‹åéƒ½å¯ä»¥ä¿æŒè°ƒç”¨å®Œæ—¶å€™çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ä¿è¯å˜é‡åœ¨ä¸¤ä¸ªå‡½æ•°ä¸­çš„å€¼ä½¿ç›¸åŒä¸”é€šç”¨çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¸¾ä¾‹ï¼Œå¯ä»¥ä¸‹è½½åˆ°å•ç‰‡æœºä¸­è§‚å¯Ÿç°è±¡ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span> </span></span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line">  </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> code LedChar[<span class="number">16</span>]=&#123;<span class="number">0xC0</span>,<span class="number">0xF9</span>,<span class="number">0xA4</span>,<span class="number">0xB0</span>,<span class="number">0x99</span>,<span class="number">0x92</span>,<span class="number">0x82</span>,<span class="number">0xF8</span>,<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x83</span>,<span class="number">0xC6</span>,<span class="number">0xA1</span>,<span class="number">0x86</span>,<span class="number">0x8E</span>&#125;;<span class="comment">//æ•°ç ç®¡çŠ¶æ€å€¼åˆå§‹åŒ–</span></span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">19601</span>;i++)<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">5</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">while</span>(x--)<span class="keyword">for</span>(j=<span class="number">115</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">SEG0_task</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>; <span class="comment">//é™æ€å˜é‡</span></span><br><span class="line">    P0=LedChar[i];</span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=<span class="number">16</span>)i=<span class="number">0</span>; <span class="comment">//è®©iåœ¨0~15ä¹‹é—´å˜åŒ–</span></span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;  </span><br><span class="line">    ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">    ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">   </span><br><span class="line">    ADDR2 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">    ADDR1 = <span class="number">0</span>;<span class="comment">//åªè®©æ•°ç ç®¡0æ˜¾ç¤º</span></span><br><span class="line">    ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br><span class="line">   </span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        SEG0_task();</span><br><span class="line">        delay_ms(<span class="number">1000</span>);<span class="comment">//å»¶æ—¶1s</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-5-å¤šæ–‡ä»¶ç¼–ç¨‹"><a href="#3-5-å¤šæ–‡ä»¶ç¼–ç¨‹" class="headerlink" title="3.5 å¤šæ–‡ä»¶ç¼–ç¨‹"></a>3.5 å¤šæ–‡ä»¶ç¼–ç¨‹</h3><p>è¿ç”¨å¤šæ–‡ä»¶ç¼–ç¨‹æ˜¯ä¸ºäº†ä½¿æˆ‘ä»¬æ•™ç¨‹æ— éœ€æ¯æ¬¡éƒ½è´´å‡ºç›¸åŒåŠŸèƒ½çš„ä»£ç ï¼Œç¼–ç¨‹çš„æ—¶å€™å·²ç»æœ‰å¾ˆå¤šä»£ç å®Œå…¨å¯ä»¥å‰å¾€ä»¥å‰çš„ä¾‹ç¨‹é‡Œå¤åˆ¶å³å¯ã€‚</p>
<p>åæœŸçš„ä¾‹ç¨‹é‡Œä»£ç é‡è¶Šæ¥è¶Šå¤§ï¼Œæ˜¾ç„¶å…¨éƒ¨ç»™å‡ºå°±ä¸åˆé€‚äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠç»å¸¸ä½¿ç”¨çš„åŠŸèƒ½æ¨¡å—ä»£ç å°è£…èµ·æ¥æ”¾åœ¨å¦ä¸€ä¸ªâ€œ.câ€æ–‡ä»¶é‡Œæä¾›ç»™æˆ‘ä»¬è°ƒç”¨ï¼Œè¿™ä¸ªâ€œ.câ€æ–‡ä»¶å‘½åä¸ºâ€œfunction.câ€ã€‚ä»¥åæˆ‘ä»¬æä¾›çš„ä»£ç å°±æ˜¯â€œmain.câ€çš„å†…å®¹ï¼Œè¿™æ ·æ•™ç¨‹ä¾›ç»™çš„ä»£ç æ•°é‡å°±ä¼šç²¾ç®€ä¸€äº›ã€‚</p>
<h4 id="3-5-1-å‰æœŸè®¾ç½®"><a href="#3-5-1-å‰æœŸè®¾ç½®" class="headerlink" title="3.5.1 å‰æœŸè®¾ç½®"></a>3.5.1 å‰æœŸè®¾ç½®</h4><p>æ–°å»º<code>function.c</code>å’Œ<code>function.h</code>ï¼Œå¹¶æ·»åŠ åˆ°<code>Source Group 1</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/6437b42c0d2dde57773c9f9b.png" alt=""></p>
<p>åœ¨<code>function.h</code>ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __FUNCTION_H__</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> __FUNCTION_H__</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">char</span>  u8;<span class="comment">//å¯¹æ•°æ®ç±»å‹è¿›è¡Œå£°æ˜å®šä¹‰</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">int</span>  u16;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> u32;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h4 id="3-5-2-ç¡¬ä»¶çš„åˆå§‹åŒ–"><a href="#3-5-2-ç¡¬ä»¶çš„åˆå§‹åŒ–" class="headerlink" title="3.5.2 ç¡¬ä»¶çš„åˆå§‹åŒ–"></a>3.5.2 ç¡¬ä»¶çš„åˆå§‹åŒ–</h4><p>å›é¡¾ä¸€ä¸‹è¦ç‚¹äº®å°ç¯éœ€è¦çš„æ¡ä»¶</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆ</span></span><br><span class="line">sbit LED2  = P0^<span class="number">0</span>;</span><br><span class="line">sbit ADDR2 = P1^<span class="number">2</span>;</span><br><span class="line">sbit ADDR1 = P1^<span class="number">1</span>;</span><br><span class="line">sbit ADDR0 = P1^<span class="number">0</span>;</span><br><span class="line">sbit ENLED = P1^<span class="number">4</span>;</span><br><span class="line">sbit ADDR3 = P1^<span class="number">3</span>;</span><br><span class="line"><span class="comment">// ç„¶å</span></span><br><span class="line">ADDR3 = <span class="number">1</span>;<span class="comment">//ä½¿èƒ½ä¸‰å…«è¯‘ç å™¨</span></span><br><span class="line">ENLED = <span class="number">0</span>;<span class="comment">// </span></span><br><span class="line">  </span><br><span class="line">ADDR2 = <span class="number">1</span>;<span class="comment">//**************************</span></span><br><span class="line">ADDR1 = <span class="number">1</span>;<span class="comment">//è®©ä¸‰å…«è¯‘ç å™¨çš„IO6è¾“å‡ºä½ç”µå¹³</span></span><br><span class="line">ADDR0 = <span class="number">0</span>;<span class="comment">//**************************</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™äº›æ¡ä»¶æ»¡è¶³äº†å°±å«<code>LEDçš„åˆå§‹åŒ–</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æƒ³ä½¿ç”¨ç¡¬ä»¶ä¸Šçš„æ¨¡å—ï¼Œæˆ‘ä»¬å¿…é¡»é…ç½®å¥½å®ƒçš„IOç«¯å£è¾“å‡ºæƒ…å†µæˆ–è€…è®¾ç½®å¥½å‡½æ•°çš„å‚æ•°ä½¿å…¶èƒ½å·¥ä½œã€‚åˆå§‹åŒ–ä¸æ˜¯æ”¾åœ¨while(1)å¾ªç¯ä¸­åå¤æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨ä¸»å‡½æ•°å¼€å¤´æŠŠç›¸åº”çš„IOç«¯å£è¯¥è¾“å‡ºä½ç”µå¹³çš„è¾“å‡ºä½ç”µå¹³ï¼Œè¯¥è¾“å‡ºé«˜ç”µå¹³çš„è¾“å‡ºé«˜ç”µå¹³ï¼Œé…ç½®å¥½è¿™äº›å™¨ä»¶ï¼Œå®ƒåªéœ€åœ¨ä¸»å‡½æ•°å¼€å¤´æ‰§è¡Œä¸€æ¬¡å³å¯ï¼Œåé¢å°±æ˜¯è¿›å…¥æ­»å¾ªç¯å»çœŸæ­£çš„å®ç°ç›¸åº”çš„åŠŸèƒ½äº†ã€‚</p>
<h4 id="3-5-3-å°ç¯çš„åˆå§‹åŒ–"><a href="#3-5-3-å°ç¯çš„åˆå§‹åŒ–" class="headerlink" title="3.5.3 å°ç¯çš„åˆå§‹åŒ–"></a>3.5.3 å°ç¯çš„åˆå§‹åŒ–</h4><p>å°ç¯è¦èƒ½æ­£å¸¸å·¥ä½œï¼Œå°±è¦æ»¡è¶³P1çš„5ä¸ªIOç«¯å£çš„æ¡ä»¶ï¼Œå¯ä»¥å°†LEDå°ç¯çš„åˆå§‹åŒ–å°±å°è£…ä¸º</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">LED_Init</span><span class="params">()</span> &#123;</span><br><span class="line">    P1 |= <span class="number">0X0E</span>; <span class="comment">//è®©P1.1, P1.2, P1.3å¼ºåˆ¶è¾“å‡º1</span></span><br><span class="line">    P1&amp;=<span class="number">0xEE</span>; <span class="comment">//è®©P1.0å’ŒP1.4å¼ºåˆ¶è¾“å‡º0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å½“æ•°ç ç®¡å·¥ä½œæ—¶ï¼Œå°ç¯æ˜¯æš‚æ—¶å‘æŒ¥ä¸äº†ä½œç”¨çš„ï¼Œå› ä¸ºä¸‰å…«è¯‘ç å™¨çš„IO6ç«¯å£çš„è¾“å‡ºå·²ç»åˆ‡æ¢äº†ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span> &#123; <span class="comment">//æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">    P0 = <span class="number">0xFF</span>; <span class="comment">// ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡ç†çš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">    <span class="keyword">switch</span>(i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">0</span>];i++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">1</span>;P0=LedBuff[<span class="number">1</span>];i++;<span class="keyword">break</span>;     </span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">1</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">2</span>];i++;<span class="keyword">break</span>;  </span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        ADDR2 = <span class="number">0</span>;ADDR1 = <span class="number">1</span>;ADDR0 = <span class="number">1</span>;P0=LedBuff[<span class="number">3</span>];i++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        ADDR2 = <span class="number">1</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">0</span>;P0=LedBuff[<span class="number">4</span>];i++;<span class="keyword">break</span>;     </span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">        ADDR2 = <span class="number">1</span>;ADDR1 = <span class="number">0</span>;ADDR0 = <span class="number">1</span>;P0=LedBuff[<span class="number">5</span>];i=<span class="number">0</span>;<span class="keyword">break</span>; </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç æˆ‘ä»¬å¯ä»¥ç®€åŒ–ä¸º</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">SEG_task</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">unsigned</span> <span class="type">char</span> i = <span class="number">0</span>;</span><br><span class="line">    P0 = <span class="number">0xFF</span>; <span class="comment">// ç«¯å£çŠ¶æ€å…¨éƒ¨ç†„ç­æ•°ç ç®¡é‡Œçš„LEDè¾¾åˆ°åˆ·æ–°ä½œç”¨</span></span><br><span class="line">    P1 = (p1 &amp; <span class="number">0xF8</span>) | i; <span class="comment">//iç­‰äº0æ—¶ï¼Œå°±æ˜¯ADDR2 = 0; ADDR1 = 0; ADDR0 = 0; iç­‰äº1æ—¶ï¼Œå°±æ˜¯ADDR2=0;ADDR1=0;ADDR2=1;ä¸€æ¬¡ç±»æ¨</span></span><br><span class="line">    P0 = LedBuff[i]; <span class="comment">//6ä¸ªç¼“å†²åŒºçš„å€¼è½®æµèµ‹ç»™P0</span></span><br><span class="line">    i++;</span><br><span class="line">    <span class="keyword">if</span>(i&gt;=<span class="number">6</span>)i=<span class="number">0</span>; <span class="comment">//è®©iåœ¨0-5ä¹‹é—´å¾ªç¯å˜åŒ–</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-5-4-function-hçš„å†…å®¹"><a href="#3-5-4-function-hçš„å†…å®¹" class="headerlink" title="3.5.4 function.hçš„å†…å®¹"></a>3.5.4 function.hçš„å†…å®¹</h4><p>åˆ†æä¸€ä¸‹<code>reg52.h</code>æ–‡ä»¶é‡Œå‘ç°æœ‰P3çš„8ä¸ªIOç«¯å£çš„å®šä¹‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sbit RD   = P3^<span class="number">7</span>;</span><br><span class="line">sbit WR   = P3^<span class="number">6</span>;</span><br><span class="line">sbit T1   = P3^<span class="number">5</span>;</span><br><span class="line">sbit T0   = P3^<span class="number">4</span>;</span><br><span class="line">sbit INT1 = P3^<span class="number">3</span>;</span><br><span class="line">sbit INT0 = P3^<span class="number">2</span>;</span><br><span class="line">sbit TXD  = P3^<span class="number">1</span>;</span><br><span class="line">sbit RXD  = P3^<span class="number">0</span>;</span><br></pre></td></tr></table></figure>
<p>é‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‡‚å¾—æŠŠä¹‹å‰çš„<code>sbit LED2 = P0^0;</code>ç­‰æ”¾åœ¨<code>function.h</code>ä¸­ï¼Œä»¥åŠåœ¨<code>function.c</code>å°è£…æœ‰çš„å‡½æ•°å’Œåˆå§‹åŒ–çš„æ•°ç»„éƒ½éœ€è¦åœ¨<code>function.h</code>ä¸­å£°æ˜ä¸€ä¸‹ã€‚æ¯”å¦‚åœ¨<code>function.c</code>ä¸­å®šä¹‰å¥½äº†<code>LED_Init()</code>ï¼Œåœ¨<code>function.h</code>å°±è¦<code>void LED_Init();</code>å£°æ˜ä¸€ä¸‹ã€‚</p>
<h4 id="3-5-5-æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°"><a href="#3-5-5-æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°" class="headerlink" title="3.5.5 æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°"></a>3.5.5 æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</h4><p>æœ‰æ—¶æˆ‘ä»¬éœ€è¦6ä¸ªæ•°ç ç®¡æ˜¾ç¤ºæˆ‘ä»¬æƒ³è¦çœ‹åˆ°çš„æ•°å­—ï¼Œæ¯”å¦‚è®¡ç®—ç»“æœå‘ˆç°åœ¨æ•°ç ç®¡ä¸Šï¼Œç„¶è€Œå½“è¦æ˜¾ç¤ºçš„æ•°ä¸ºâ€œ520â€æ—¶åˆä¸æƒ³å‰é¢çš„3ä¸ªæ•°ç ç®¡äº®ï¼ˆä¹Ÿå°±æ˜¯é«˜ä½ä¸º0ä¸æ˜¾ç¤ºï¼‰ï¼Œæˆ‘ä»¬æŠŠè¿™éƒ¨åˆ†åŠŸèƒ½ä»£ç å°è£…ä¸ºå¸¦å‚æ•°çš„å‡½æ•°ï¼Œä¼ å…¥çš„å‚æ•°å°±æ˜¯è¦æ˜¾ç¤ºçš„æ•°å€¼ã€‚å‚æ•°å®šä¹‰çš„æ˜¯unsigned longç±»å‹ï¼Œä¹Ÿå°±æ˜¯æ”¯æŒ0~4294967296çš„æ•°å€¼ï¼ˆ2çš„32æ¬¡æ–¹ç­‰äº4294967296ï¼‰ã€‚</p>
<p>ç¤ºä¾‹ä¸€</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span> &#123;</span><br><span class="line">    LedBuff[<span class="number">0</span>]=LedChar[num%<span class="number">10</span>];</span><br><span class="line">    LedBuff[<span class="number">1</span>]=LedChar[(num/<span class="number">10</span>)%<span class="number">10</span>];</span><br><span class="line">    LedBuff[<span class="number">2</span>]=LedChar[(num/<span class="number">100</span>)%<span class="number">10</span>];</span><br><span class="line">    LedBuff[<span class="number">3</span>]=LedChar[(num/<span class="number">1000</span>)%<span class="number">10</span>];</span><br><span class="line">    LedBuff[<span class="number">4</span>]=LedChar[(num/<span class="number">10000</span>)%<span class="number">10</span>];</span><br><span class="line">    LedBuff[<span class="number">5</span>]=LedChar[(num/<span class="number">100000</span>)%<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">100000</span>)LedBuff[<span class="number">5</span>] = <span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">10000</span>) LedBuff[<span class="number">4</span>] = <span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">1000</span>)  LedBuff[<span class="number">3</span>] = <span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">100</span>)   LedBuff[<span class="number">2</span>] = <span class="number">0xFF</span>;</span><br><span class="line">    <span class="keyword">if</span>(num&lt;<span class="number">10</span>)    LedBuff[<span class="number">1</span>] = <span class="number">0xFF</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¤ºä¾‹äºŒ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span></span><br><span class="line">&#123;</span><br><span class="line">    u32 i;</span><br><span class="line">    u8 x=<span class="number">5</span>;<span class="comment">//æ¯æ¬¡è¢«è°ƒç”¨éƒ½ä¼šä»5å¼€å§‹ </span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">100000</span>;i&gt;<span class="number">0</span>;i/=<span class="number">10</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span>(num&lt;i)LedBuff[x] = <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">else</span> LedBuff[x]=LedChar[(num/i)%<span class="number">10</span>];</span><br><span class="line">        x--;</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤æ®µä»£ç éƒ½èƒ½å®ç°æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ï¼Œç¤ºä¾‹1å¯è¯»æ€§å¼ºï¼Œè®©äººä¸€çœ‹å°±æ˜ç™½äº†ä»£ç çš„ä½œç”¨ã€‚è€Œç¤ºä¾‹2ä¹¦å†™é‡å°‘ï¼Œæ¯”è¾ƒç®€æ´ï¼Œä½†åœ¨é˜…è¯»ç†è§£ä¸Šéœ€è¦æˆ‘ä»¬è½¬ä¸€ä¸‹å¼¯ï¼Œç»è¿‡æµ‹è¯•è¿™ä¸¤æ®µä»£ç çš„æ‰§è¡Œæ—¶é—´ï¼Œå‘ç°ç¤ºä¾‹1æ¯”ç¤ºä¾‹2å¿«5mså·¦å³ï¼Œè¿™ç§æƒ…å†µä¸‹æ¯«æ— ç–‘é—®æˆ‘ä»¬è‚¯å®šæ˜¯é€‰æ‹©ç¤ºä¾‹1æš‚æ—¶ä½œä¸ºå®ç”¨ä»£ç ã€‚</p>
<p>å¯æ˜¯åœ¨åæœŸçš„æ•™ç¨‹ä¸­ç”¨åˆ°å®šæ—¶å™¨ä¸­æ–­æ¥æ‰«ææ•°ç ç®¡æ˜¾ç¤ºæ—¶ï¼Œç¤ºä¾‹1çš„ä»£ç æ•ˆæœä¸å°½äººæ„ï¼Œå…³äºæ¼æ´åœ¨å“ªå¤§å®¶åé¢å¯ä»¥å°è¯•è‡ªå·±å¯»æ‰¾ã€‚</p>
<p>åœ¨ä½¿ç”¨ç¤ºä¾‹2æ—¶è™½ç„¶æ˜¾ç¤ºæ•ˆæœæ¯”ç¤ºä¾‹1çš„å¥½ï¼Œä½†æ˜¯è´¹æ—¶é•¿ï¼Œæ‰€ä»¥è¿™ä¸¤æ®µä»£ç éƒ½ä¸æ˜¯å®ç”¨å‹ä»£ç ã€‚</p>
<p>ä»£ç å‚è€ƒ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">ShowNumber</span><span class="params">(u32 num)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> i;<span class="comment">//å–å€¼èŒƒå›´-128~127</span></span><br><span class="line">    u8 buf[<span class="number">6</span>];    </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">6</span>; i++)    <span class="comment">//æŠŠé•¿æ•´å‹æ•°è½¬æ¢ä¸º6ä½åè¿›åˆ¶çš„æ•°ç»„</span></span><br><span class="line">    &#123;</span><br><span class="line">        buf[i] = num % <span class="number">10</span>;</span><br><span class="line">        num = num / <span class="number">10</span>;    <span class="comment">//èˆæ‰ä¸ªä½æ•°ï¼Œé‡æ–°è£…è½½</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">5</span>; i&gt;=<span class="number">1</span>; i--)   <span class="comment">//ä»æœ€é«˜ä½èµ·ï¼Œé‡åˆ°0å¡«å……ä¸æ˜¾ç¤ºçš„ä»£ç ï¼Œé‡åˆ°é0åˆ™é€€å‡ºå¾ªç¯</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (buf[i] == <span class="number">0</span>)</span><br><span class="line">            LedBuff[i] = <span class="number">0xFF</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ; i&gt;=<span class="number">0</span>; i--)     <span class="comment">//å‰©ä½™ä½ä½éƒ½å¦‚å®è½¬æ¢ä¸ºæ•°ç ç®¡æ˜¾ç¤ºå­—ç¬¦</span></span><br><span class="line">    &#123;</span><br><span class="line">        LedBuff[i] = LedChar[buf[i]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™éƒ¨åˆ†ä»£ç æˆ‘ä»¬æ¥ä¸¾ä¸ªä¾‹å­ç†è§£ï¼Œå‡å¦‚ä¼ å…¥çš„å‚æ•°ä¸º125ï¼Œç¬¬ä¸€ä¸ªforå¾ªç¯å°±æ˜¯å®ç°ä»¥ä¸‹åŠŸèƒ½</p>
<p>buf[5]=0; buf[4]=0; buf[3]=0; buf[2]=1; buf[1]=2; buf[0]=5;</p>
<p>ç¬¬äºŒä¸ªforå¾ªç¯iç­‰äº2ä¹‹åå°±é€€å‡ºäº†å¾ªç¯ï¼Œç¬¬ä¸‰ä¸ªforå¾ªç¯iæ˜¯ç­‰äº2ï¼Œç„¶åå¡«å……å¥½è¦æ˜¾ç¤ºçš„1,2,5ç»™æ•°ç ç®¡ç¼“å­˜åŒºã€‚</p>
<h4 id="3-5-6-å¸¦è¿”å›å€¼çš„å‡½æ•°"><a href="#3-5-6-å¸¦è¿”å›å€¼çš„å‡½æ•°" class="headerlink" title="3.5.6 å¸¦è¿”å›å€¼çš„å‡½æ•°"></a>3.5.6 å¸¦è¿”å›å€¼çš„å‡½æ•°</h4><p>ä¹‹å‰å°è£…çš„å‡½æ•°éƒ½æ˜¯voidç±»å‹æ— è¿”å›å€¼çš„å‡½æ•°ã€‚éšç€å­¦ä¹ çš„æ·±å…¥ï¼Œæˆ‘ä»¬éœ€è¦æŠŠCè¯­è¨€çš„ç²¾é«“å­¦åˆ°å®¶ã€‚</p>
<p>å‰é¢è®²çš„<code>function.c</code>ä¸­æ²¡æœ‰æåŠè¿‡æŒ‰é”®çš„å‡½æ•°å°è£…ã€‚æŒ‰é”®åŠŸèƒ½å‡½æ•°éƒ½éœ€è¦å®šä¹‰å…¨å±€å˜é‡ï¼Œè¿™ç§è¿‡å¤šçš„ä½¿ç”¨å…¨å±€å˜é‡æ˜¯ç¼–ç¨‹çš„å¤§å¿Œã€‚éšç€æˆ‘ä»¬ä½¿ç”¨æŒ‰é”®è¶Šæ¥è¶Šçµæ´»ï¼Œå°±ä¸æ˜¯ç®€å•çš„è®©ä¸€ä¸¤ä¸ªå˜é‡åŠ åŠ å‡å‡è€Œå·²äº†ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦æ›´åŠ çš„å»è´´åˆåµŒå…¥å¼ç¼–ç¨‹çš„æ–¹å¼ï¼Œé‚£ä¹ˆæŒ‰é”®çš„ä½¿ç”¨å¦‚æœç”¨å‡½æ•°å°è£…çš„è¯ï¼Œéœ€è¦ç”¨åˆ°å‡½æ•°è¿”å›å€¼çš„ç›¸å…³çŸ¥è¯†ã€‚</p>
<ul>
<li>ä¸¾ä¾‹ï¼šé¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªä¸å¸¦å‚æ•°ä¸”è¿”å›å€¼ä¸ºunsigned charå‹çš„å‡½æ•°ï¼Œå‡½æ•°åä¸º<code>KEY4_Scan()</code>ï¼Œé‡Œé¢çš„å†…å®¹è·Ÿä»¥å‰çš„ä¸æ”¯æŒè¿æŒ‰å‡½æ•°éƒ½å·®ä¸å¤šï¼Œåªæ˜¯æˆ‘ä»¬æŠŠæ‰§è¡ŒåŠŸèƒ½ä»£ç éƒ¨åˆ†æ”¹ä¸º<code>return 1</code>ã€‚å½“æŒ‰é”®<code>æŒ‰ä¸‹æŠ¬èµ·</code>æ—¶æˆ‘ä»¬å‡½æ•°çš„è¿”å›å€¼ä¸º1ï¼Œå…¶ä»–æƒ…å†µè¿”å›å€¼ä¸º0ï¼Œè¿™æ ·æ­»å¾ªç¯é‡Œä¸æ–­æ›´æ–°keyçš„å€¼ï¼Œè€Œå¤§å¤šæ•°æ—¶å€™æ²¡æœ‰æŒ‰é”®åŠ¨ä½œï¼Œæ‰€ä»¥æ­»å¾ªç¯é‡Œçš„keyçš„å€¼éƒ½æ˜¯0ï¼Œæœ‰æŒ‰é”®åŠ¨ä½œäº†ï¼Œkeyç­‰äº1å°±æ‰§è¡ŒåŠŸèƒ½ä»£ç ï¼Œä¸‹ä¸€ä¸ªå¾ªç¯æ²¡æœ‰æŒ‰é”®åŠ¨ä½œäº†keyåˆç­‰äº0å°±ä¸æ‰§è¡ŒåŠŸèƒ½ä»£ç äº†ã€‚</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> TIMES 1000 <span class="comment">//æ­»å¾ªç¯é‡Œçš„ä»£ç é‡å°‘ï¼Œæ‰€ä»¥æŠŠé˜ˆå€¼è°ƒå¤§äº›</span></span></span><br><span class="line"></span><br><span class="line">sbit KEY4 = P2^<span class="number">7</span>;</span><br><span class="line"></span><br><span class="line">u8 <span class="title function_">KEY_Scan</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">static</span> u8 key_up = <span class="number">1</span>;</span><br><span class="line">    <span class="type">static</span> u16 times;</span><br><span class="line">    <span class="keyword">if</span>(key_up == <span class="number">0</span>) &#123;</span><br><span class="line">        times++;</span><br><span class="line">        <span class="keyword">if</span>(KEY4 == <span class="number">1</span> &amp;&amp; times &gt;= TIMES) &#123;</span><br><span class="line">            times = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    key_up = KEY4;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main() &#123;</span><br><span class="line">    u8 key; <span class="comment">//ç”¨æ¥è¯»å–æŒ‰é”®åŠ¨ä½œçš„è¿”å›å€¼</span></span><br><span class="line">    LED_Init(); <span class="comment">//åˆå§‹åŒ–LEDç¡¬ä»¶æ¨¡å—</span></span><br><span class="line">    P2 = <span class="number">0xF7</span>; <span class="comment">//è®©K4å…·å¤‡èƒ½è¢«æ‹‰ä½çš„æ¡ä»¶</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        key=KEY4_Scan();</span><br><span class="line">        <span class="keyword">if</span>(key==<span class="number">1</span>)LED2=!LED2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="3-6-typedefå…³é”®å­—"><a href="#3-6-typedefå…³é”®å­—" class="headerlink" title="3.6 typedefå…³é”®å­—"></a>3.6 typedefå…³é”®å­—</h3><p>ä½¿ç”¨typedefæˆ‘ä»¬å¯ä»¥å¯¹ä»£ç è¿›è¡Œç®€åŒ–ï¼Œæ¯”å¦‚<code>unsigned int</code>çš„å®šä¹‰ï¼Œæˆ‘ä»¬ç”¨<code>typedef unsigned int u16;</code>å£°æ˜ï¼Œu16å°±æ˜¯ç”¨ä¸€ä¸ªæ›´åŠ ç®€æ´çš„åå­—æ¥å–ä»£<code>unsigned int</code>åŒºå®šä¹‰16ä½çš„å˜é‡ã€‚</p>
<p>ç”¨<code>typedef unsigned char u8;</code>çš„è¯ï¼Œu8å°±æ˜¯ç”¨æ¥å®šä¹‰8ä½çš„å˜é‡ï¼Œæˆ–è€…åƒä¹‹å‰å®šä¹‰çš„æ•°ç»„ä¹Ÿå¯ä»¥åƒè¿™æ ·<code>u8 LEDSET[8]=&#123;0xFE,0xFD,0xFB,0xF7,0xEF,0xDF,0xBF,0x7F&#125;;</code>å»å®šä¹‰ã€‚</p>
<p>æœ‰æ—¶éœ€è¦å®šä¹‰32ä½çš„å˜é‡ï¼Œå°±ç”¨â€œtypedef unsigned long u32;â€å³å¯ã€‚è™½ç„¶<strong>#define</strong>ä¸<strong>typedef</strong>çš„ä½œç”¨æœ‰ç‚¹æ„æ€ç›¸è¿‘ï¼Œä½†â€œ#define u16 unsigned intâ€æ˜¯ä¸ä¸¥è°¨çš„ç¼–å†™ä¹ æƒ¯ï¼Œä¸å»ºè®®è¿™æ ·ä½¿ç”¨ï¼ŒåŸå› å¤§å®¶å¯ä¸Šç½‘äº†è§£ã€‚</p>
<h3 id="3-7-æŒ‡é’ˆ"><a href="#3-7-æŒ‡é’ˆ" class="headerlink" title="3.7 æŒ‡é’ˆ"></a>3.7 æŒ‡é’ˆ</h3><p>æŒ‡é’ˆæ˜¯Cè¯­è¨€çš„çµé­‚ï¼Œåˆ©ç”¨æŒ‡é’ˆå¯ä»¥ç›´æ¥è€Œå¿«é€Ÿçš„å¤„ç†å†…å­˜ä¸­çš„å„ç§æ•°æ®ç»“æ„ä¸­çš„æ•°æ®ï¼Œç‰¹åˆ«æ˜¯<code>æ•°ç»„ã€å­—ç¬¦ä¸²å’Œå†…å­˜çš„åŠ¨æ€åˆ†é…</code>ç­‰ï¼Œå®ƒä¸ºå‡½æ•°ä¹‹é—´å„ç±»æ•°æ®ä¼ é€’æä¾›äº†ç®€æ´ä¾¿åˆ©çš„æ–¹æ³•ã€‚</p>
<h4 id="3-7-1-æŒ‡é’ˆçš„æ¦‚å¿µä¸æŒ‡é’ˆå˜é‡çš„å£°æ˜"><a href="#3-7-1-æŒ‡é’ˆçš„æ¦‚å¿µä¸æŒ‡é’ˆå˜é‡çš„å£°æ˜" class="headerlink" title="3.7.1 æŒ‡é’ˆçš„æ¦‚å¿µä¸æŒ‡é’ˆå˜é‡çš„å£°æ˜"></a>3.7.1 æŒ‡é’ˆçš„æ¦‚å¿µä¸æŒ‡é’ˆå˜é‡çš„å£°æ˜</h4><h5 id="3-7-1-1-å˜é‡çš„åœ°å€"><a href="#3-7-1-1-å˜é‡çš„åœ°å€" class="headerlink" title="3.7.1.1 å˜é‡çš„åœ°å€"></a>3.7.1.1 å˜é‡çš„åœ°å€</h5><p>è¦ç ”ç©¶æŒ‡é’ˆï¼Œæˆ‘ä»¬å¾—å…ˆæ¥æ·±å…¥ç†è§£<code>å†…å­˜åœ°å€</code>è¿™ä¸ªæ¦‚å¿µã€‚æ‰“ä¸ªæ¯”æ–¹ï¼šæ•´ä¸ªå†…å­˜å°±ç›¸å½“äºä¸€ä¸ªæ‹¥æœ‰å¾ˆå¤šæˆ¿é—´çš„å¤§æ¥¼ï¼Œæ¯ä¸ªæˆ¿é—´éƒ½æœ‰æˆ¿é—´å·ï¼Œæ¯”å¦‚ä» 101ã€102ã€103 ä¸€ç›´åˆ° NNNï¼Œæˆ‘ä»¬å¯ä»¥è¯´è¿™äº›æˆ¿é—´å·å°±æ˜¯æˆ¿é—´çš„åœ°å€ã€‚ç›¸å¯¹åº”çš„å†…å­˜ä¸­çš„æ¯ä¸ªå•å…ƒä¹Ÿéƒ½æœ‰è‡ªå·±çš„ç¼–å·ï¼Œæ¯”å¦‚ä»0x00ã€0x01ã€0x02 ä¸€ç›´åˆ° 0xNNï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥è¯´è¿™äº›ç¼–å·å°±æ˜¯<code>å†…å­˜å•å…ƒ</code>çš„åœ°å€ã€‚æˆ¿é—´é‡Œå¯ä»¥ä½äººï¼Œå¯¹åº”çš„å†…å­˜å•å…ƒé‡Œå°±å¯ä»¥â€œä½è¿›â€å˜é‡äº†ï¼šå‡å¦‚ä¸€ä½åå­—å« A çš„äººä½åœ¨ 101 æˆ¿é—´ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ A çš„ä½å€å°±æ˜¯ 101ï¼Œæˆ–è€… 101 å°±æ˜¯ A çš„ä½å€ï¼›å¯¹åº”çš„ï¼Œå‡å¦‚ä¸€ä¸ªåä¸º x çš„å˜é‡ä½åœ¨ç¼–å·ä¸º 0x00 çš„è¿™ä¸ªå†…å­˜å•å…ƒä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¯´å˜é‡ x çš„å†…å­˜åœ°å€å°±æ˜¯ 0x00ï¼Œæˆ–è€… 0x00å°±æ˜¯å˜é‡ x çš„åœ°å€ã€‚ </p>
<p>åŸºæœ¬çš„å†…å­˜å•å…ƒæ˜¯<code>å­—èŠ‚</code>ï¼Œè‹±æ–‡å•è¯ä¸º Byteï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ STC89C52 å•ç‰‡æœºå…±æœ‰ <code>512</code>å­—èŠ‚çš„ RAMï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è°“çš„å†…å­˜ï¼Œä½†å®ƒåˆ†ä¸ºå†…éƒ¨ 256 å­—èŠ‚å’Œå¤–éƒ¨ 256 å­—èŠ‚ï¼Œæˆ‘ä»¬ä»…ä»¥å†…éƒ¨çš„ 256 å­—èŠ‚ä¸ºä¾‹ï¼Œå¾ˆæ˜æ˜¾å…¶åœ°å€çš„ç¼–å·ä» 0 å¼€å§‹å°±æ˜¯<code>0x00ï½0xFF</code>ã€‚æˆ‘ä»¬ç”¨ C è¯­è¨€å®šä¹‰çš„å„<br>ç§å˜é‡å°±å­˜åœ¨ 0x00ï½0xFF çš„åœ°å€èŒƒå›´å†…ï¼Œè€Œä¸åŒç±»å‹çš„å˜é‡ä¼šå ç”¨ä¸åŒæ•°é‡çš„å†…å­˜å•å…ƒï¼Œå³å­—èŠ‚ï¼Œå¯ä»¥ç»“åˆå‰é¢è®²è¿‡çš„ C è¯­è¨€å˜é‡ç±»å‹æ·±å…¥ç†è§£ã€‚å‡å¦‚ç°åœ¨å®šä¹‰äº† unsigned char a = 1; unsigned char b = 2; unsigned int c = 3; unsigned long d = 4; è¿™æ · 4 ä¸ªå˜é‡ï¼Œæˆ‘ä»¬æŠŠè¿™ 4 ä¸ªå˜é‡åˆ†åˆ«æ”¾åˆ°å†…å­˜ä¸­ï¼Œå°±ä¼šæ˜¯è¡¨ 12-1 ä¸­æ‰€åˆ—çš„æ ·å­ï¼Œæˆ‘ä»¬å…ˆæ¥å¤§æ¦‚äº†è§£ä¸€ä¸‹ä»–ä»¬çš„å­˜å‚¨æ–¹å¼ã€‚</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic2.imgdb.cn/item/646099320d2dde5777bf32f9.png" alt=""></p>
<p>å˜é‡ aã€b å’Œ c å’Œ d ä¹‹é—´çš„å˜é‡ç±»å‹ä¸åŒï¼Œå› æ­¤åœ¨å†…å­˜ä¸­æ‰€å çš„å­˜å‚¨å•å…ƒä¹Ÿä¸ä¸€æ ·ï¼Œa å’Œb éƒ½å ä¸€ä¸ªå­—èŠ‚ï¼Œc å äº† 2 ä¸ªå­—èŠ‚ï¼Œè€Œ d å äº† 4 ä¸ªå­—èŠ‚ã€‚é‚£ä¹ˆï¼Œa çš„åœ°å€å°±æ˜¯ 0x00ï¼Œb çš„åœ°å€å°±æ˜¯ 0x01ï¼Œc çš„åœ°å€å°±æ˜¯ 0x02ï¼Œd çš„åœ°å€å°±æ˜¯ 0x04ï¼Œå®ƒä»¬çš„åœ°å€çš„è¡¨è¾¾æ–¹å¼å¯ä»¥å†™æˆï¼š<code>&amp;aï¼Œ&amp;bï¼Œ&amp;cï¼Œ&amp;d</code>ã€‚è¿™æ ·å°±ä»£è¡¨äº†ç›¸åº”å˜é‡çš„åœ°å€ï¼ŒC è¯­è¨€ä¸­å˜é‡å‰åŠ ä¸€ä¸ª&amp;è¡¨ç¤ºå–è¿™ä¸ªå˜é‡çš„åœ°å€ï¼Œ&amp;åœ¨è¿™é‡Œå°±å«åš<code>å–å€ç¬¦</code>ã€‚</p>
<p>è®²åˆ°è¿™é‡Œï¼Œæœ‰ä¸€ç‚¹å»¶ä¼¸å†…å®¹ï¼Œå¤§å®¶å¯ä»¥äº†è§£ä¸‹ï¼šæ¯”å¦‚å˜é‡ c æ˜¯ unsigned int ç±»å‹çš„ï¼Œå äº†2 ä¸ªå­—èŠ‚ï¼Œå­˜å‚¨åœ¨äº†0x02 å’Œ0x03 è¿™ä¸¤ä¸ªå†…å­˜åœ°å€ä¸Šï¼Œé‚£ä¹ˆ0x02 æ˜¯å®ƒçš„<code>ä½å­—èŠ‚</code>è¿˜æ˜¯<code>é«˜å­—èŠ‚</code>å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜ç”±æ‰€ç”¨çš„ <code>C ç¼–è¯‘å™¨ä¸å•ç‰‡æœºæ¶æ„</code>å…±åŒå†³å®šï¼Œå•ç‰‡æœºç±»å‹ä¸åŒå°±æœ‰å¯èƒ½ä¸åŒï¼Œå¤§å®¶çŸ¥é“è¿™ä¹ˆå›äº‹å³å¯ã€‚æ¯”å¦‚ï¼šåœ¨æˆ‘ä»¬ä½¿ç”¨çš„ Keil+51 å•ç‰‡æœºçš„ç¯å¢ƒä¸‹ï¼Œ0x02 å­˜çš„æ˜¯é«˜å­—èŠ‚ï¼Œ0x03å­˜çš„æ˜¯ä½å­—èŠ‚ã€‚è¿™æ˜¯ç¼–è¯‘åº•å±‚å®ç°ä¸Šçš„ç»†èŠ‚é—®é¢˜ï¼Œå¹¶ä¸å½±å“ä¸Šå±‚çš„åº”ç”¨ï¼Œå¦‚ä¸‹è¿™ä¸¤ç§æƒ…å†µåœ¨åº”ç”¨ä¸Šä¸æ¯«ä¸å—è¿™ä¸ªç»†èŠ‚çš„å½±å“ï¼šå¼ºåˆ¶ç±»å‹è½¬æ¢â€”â€”b = (unsigned char) cï¼Œé‚£ä¹ˆ b çš„å€¼ä¸€å®šæ˜¯ c çš„ä½å­—èŠ‚ï¼›å–åœ°å€â€”â€”&amp;cï¼Œåˆ™å¾—åˆ°çš„ä¸€å®šæ˜¯ 0x02ï¼Œè¿™éƒ½æ˜¯ C è¯­è¨€æœ¬èº«æ‰€å†³å®šçš„è§„åˆ™ï¼Œä¸å› å•ç‰‡æœºç¼–è¯‘å™¨çš„ä¸åŒè€Œæœ‰æ‰€æ”¹å˜ã€‚</p>
<p>å®é™…ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬è¦å¯»æ‰¾ä¸€ä¸ªäººæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ–¹å¼æ˜¯é€šè¿‡å®ƒçš„åå­—æ¥æ‰¾äººï¼Œè¿˜æœ‰ç¬¬äºŒç§æ–¹å¼å°±æ˜¯é€šè¿‡å®ƒçš„ä½å®…åœ°å€æ¥æ‰¾äººã€‚æˆ‘ä»¬åœ¨æ´¾å‡ºæ‰€çš„æˆ·ç±ç®¡ç†ç³»ç»Ÿçš„ä¿¡æ¯è¾“å…¥æ–¹æ¡†å†…ï¼Œè¾“å…¥å°æ˜çš„å®¶åº­ä½å€ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŒ‡å‘å°æ˜çš„ç›¸å…³ä¿¡æ¯ï¼Œè¾“å…¥å°åˆšçš„å®¶åº­ä½å€ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æŒ‡å‘å°åˆšçš„ç›¸å…³ä¿¡æ¯ã€‚è¿™ä¸ªä¾›æˆ‘ä»¬è¾“å…¥åœ°å€çš„æ–¹æ¡†ï¼Œåœ¨æˆ·ç±ç®¡ç†ç³»ç»Ÿå«åš<code>åœ°å€è¾“å…¥æ¡†</code>ã€‚</p>
<p>é‚£ä¹ˆï¼Œåœ¨ C è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬è¦è®¿é—®ä¸€ä¸ªå˜é‡ï¼ŒåŒæ ·æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>ä¸€ç§æ˜¯é€šè¿‡<code>å˜é‡å</code>æ¥è®¿é—®ã€‚</li>
<li>å¦ä¸€ç§è‡ªç„¶æ˜¯é€šè¿‡å˜é‡çš„åœ°å€æ¥è®¿é—®ã€‚</li>
</ol>
<p>åœ¨ C è¯­è¨€ä¸­ï¼Œ<code>åœ°å€</code>å°±ç­‰åŒäº<code>æŒ‡é’ˆ</code>ï¼Œ<code>å˜é‡çš„åœ°å€</code>å°±æ˜¯<code>å˜é‡çš„æŒ‡é’ˆ</code>ã€‚æˆ‘ä»¬è¦æŠŠåœ°å€é€åˆ°ä¸Šè¾¹é‚£ä¸ªæ‰€è°“çš„<code>åœ°å€è¾“å…¥æ¡†</code>å†…ï¼Œè¿™ä¸ª<code>åœ°å€è¾“å…¥æ¡†</code>æ—¢å¯ä»¥è¾“å…¥ x çš„æŒ‡é’ˆï¼Œåˆå¯ä»¥è¾“å…¥ y çš„æŒ‡é’ˆï¼Œæ‰€ä»¥ç›¸å½“äºä¸€ä¸ªç‰¹æ®Šçš„å˜é‡â€”â€”<code>ä¿å­˜æŒ‡é’ˆ</code>çš„å˜é‡ï¼Œå› æ­¤ç§°ä¹‹ä¸ºæŒ‡é’ˆå˜é‡ï¼Œç®€ç§°ä¸ºæŒ‡é’ˆï¼Œè€Œé€šå¸¸æˆ‘ä»¬è¯´çš„æŒ‡é’ˆå°±æ˜¯æŒ‡æŒ‡é’ˆå˜é‡ã€‚ åœ°å€è¾“å…¥æ¡†è¾“å…¥è°çš„åœ°å€ï¼ŒæŒ‡å‘çš„å°±æ˜¯è¿™ä¸ªäººçš„ä¿¡æ¯ï¼Œè€Œç»™æŒ‡é’ˆå˜é‡è¾“å…¥å“ªä¸ªæ™®é€šå˜é‡çš„åœ°å€ï¼Œå®ƒè‡ªç„¶å°±æŒ‡å‘äº†è¿™ä¸ªå˜é‡çš„å†…å®¹ï¼Œé€šå¸¸çš„è¯´æ³•å°±æ˜¯æŒ‡é’ˆæŒ‡å‘äº†è¯¥å˜é‡ã€‚</p>
<h5 id="3-7-1-2-æŒ‡é’ˆå˜é‡çš„å£°æ˜"><a href="#3-7-1-2-æŒ‡é’ˆå˜é‡çš„å£°æ˜" class="headerlink" title="3.7.1.2 æŒ‡é’ˆå˜é‡çš„å£°æ˜"></a>3.7.1.2 æŒ‡é’ˆå˜é‡çš„å£°æ˜</h5><p>åœ¨ C è¯­è¨€ä¸­ï¼Œå˜é‡çš„åœ°å€å¾€å¾€éƒ½æ˜¯ç¼–è¯‘ç³»ç»Ÿ<code>è‡ªåŠ¨åˆ†é…</code>çš„ï¼Œå¯¹æˆ‘ä»¬ç”¨æˆ·æ¥è¯´ï¼Œæˆ‘ä»¬æ˜¯ä¸çŸ¥é“æŸä¸ªå˜é‡çš„å…·ä½“åœ°å€çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡ pï¼ŒæŠŠæ™®é€šå˜é‡ a çš„åœ°å€ç›´æ¥é€ç»™æŒ‡é’ˆå˜é‡ p å°±æ˜¯<code>p = &amp;a;</code>è¿™æ ·çš„å†™æ³•</p>
<p>å¯¹äºæŒ‡é’ˆå˜é‡ p çš„å®šä¹‰å’Œåˆå§‹åŒ–ï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼š</p>
<ol>
<li>å®šä¹‰æ—¶ç›´æ¥è¿›è¡Œåˆå§‹åŒ–èµ‹å€¼</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> a;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *p = &amp;a;</span><br></pre></td></tr></table></figure>
<ol>
<li>å®šä¹‰åå†è¿›è¡Œèµ‹å€¼</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> a;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *p;</span><br><span class="line">p = &amp;a;</span><br></pre></td></tr></table></figure>
<p>å¤§å®¶ä»”ç»†çœ‹ä¼šçœ‹å‡ºæ¥è¿™ä¸¤ç§å†™æ³•çš„åŒºåˆ«ï¼Œå®ƒä»¬éƒ½æ˜¯æ­£ç¡®çš„ã€‚æˆ‘ä»¬åœ¨å®šä¹‰çš„æŒ‡é’ˆå˜é‡å‰è¾¹åŠ äº†ä¸ª*ï¼Œè¿™ä¸ª*p å°±ä»£è¡¨äº†è¿™ä¸ªpæ˜¯ä¸ªæŒ‡é’ˆå˜é‡ï¼Œä¸æ˜¯ä¸ªæ™®é€šçš„å˜é‡ï¼Œå®ƒæ˜¯ä¸“é—¨ç”¨æ¥å­˜æ”¾å˜é‡åœ°å€çš„ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å®šä¹‰*p çš„æ—¶å€™ï¼Œç”¨äº†unsigned charæ¥å®šä¹‰ï¼Œè¿™é‡Œè¡¨ç¤ºçš„æ˜¯è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘çš„å˜é‡ç±»å‹æ˜¯ unsigned char å‹çš„</p>
<p>æŒ‡é’ˆå˜é‡ä¼¼ä¹æ¯”è¾ƒå¥½ç†è§£ï¼Œå¤§å®¶ä¹Ÿèƒ½å¾ˆå®¹æ˜“å°±å¬æ˜ç™½ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šäººå¼„ä¸æ˜ç™½æŒ‡é’ˆå‘¢ï¼Ÿå› ä¸ºåœ¨ C è¯­è¨€ä¸­ï¼Œæœ‰ä¸€äº›è¿ç®—å’Œå®šä¹‰ï¼Œä»–ä»¬æ˜¯æœ‰åŒºåˆ«çš„ï¼Œå¾ˆå¤šåŒå­¦å°±æ˜¯æ²¡å¼„æ˜ç™½å®ƒä»¬çš„åŒºåˆ«ï¼ŒæŒ‡é’ˆå°±å§‹ç»ˆå­¦ä¸å¥½ã€‚è¿™é‡Œæˆ‘è¦é‡ç‚¹å¼ºè°ƒä¸¤ä¸ªåŒºåˆ«ï¼Œåªè¦æŠŠè¿™ä¸¤ä¸ªåŒºåˆ«å¼„æ˜ç™½äº†ï¼Œèµ·ç æŒ‡é’ˆå˜é‡è¿™éƒ¨åˆ†å°±ä¸æ˜¯é—®é¢˜äº†ã€‚è¿™ä¸¤ä¸ªé‡ç‚¹ç°åœ¨å¤§å®¶æ­»è®°ç¡¬èƒŒï¼Œç›´æ¥è®°ä½å³å¯ï¼Œé ç†è§£æœ‰å¯èƒ½æ··æ·†æ¦‚å¿µã€‚</p>
<ol>
<li>æŒ‡é’ˆå˜é‡ p å’Œæ™®é€šå˜é‡ a çš„åŒºåˆ«ï¼šæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡ aï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç»™å˜é‡ a èµ‹å€¼ a = 1ï¼Œä¹Ÿå¯ä»¥èµ‹å€¼ a = 2ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡ pï¼Œå¦å¤–è¿˜å®šä¹‰äº†ä¸€ä¸ªæ™®é€šå˜é‡ a=1ï¼Œæ™®é€šå˜é‡ b=2ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡é’ˆå˜é‡å¯ä»¥æŒ‡å‘ a çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥æŒ‡å‘ b çš„åœ°å€ï¼Œå¯ä»¥å†™æˆ p = &amp;aï¼Œä¹Ÿå¯ä»¥å†™æˆ p = &amp;bï¼Œä½†å°±æ˜¯ä¸èƒ½å†™æˆ<code>p = 1 æˆ–è€… p = 2 æˆ–è€… p = a</code>ï¼Œè¿™ä¸‰ç§è¡¨è¾¾æ–¹å¼éƒ½æ˜¯é”™çš„ã€‚å› æ­¤è¿™ä¸ªåœ°æ–¹ï¼Œä¸è¦çœ‹åˆ°å®šä¹‰*p çš„æ—¶å€™å‰è¾¹æœ‰ä¸ª unsigned char å‹ï¼Œå°±é”™è¯¯çš„èµ‹å€¼ p=1ï¼Œè¿™ä¸ªåªæ˜¯è¯´æ˜ p æŒ‡å‘çš„å˜é‡æ˜¯è¿™ä¸ª unsigned char ç±»å‹çš„ï¼Œè€Œ p æœ¬èº«ï¼Œæ˜¯æŒ‡é’ˆå˜é‡ï¼Œä¸å¯ä»¥ç»™å®ƒèµ‹å€¼æ™®é€šçš„å€¼æˆ–è€…å˜é‡ï¼Œåè¾¹æˆ‘ä»¬ä¼šç›´æ¥æŠŠæŒ‡é’ˆå˜é‡ç§°ä¹‹ä¸ºæŒ‡é’ˆï¼Œå¤§å®¶è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªå°ç»†èŠ‚ã€‚</li>
<li><code>å®šä¹‰</code>æŒ‡é’ˆå˜é‡*p å’Œ<code>å–å€¼è¿ç®—</code>*p çš„åŒºåˆ«ï¼š <code>*</code>è¿™ä¸ªç¬¦å·ï¼Œåœ¨æˆ‘ä»¬çš„ C è¯­è¨€æœ‰ä¸‰ä¸ªç”¨æ³•ï¼Œç¬¬ä¸€ä¸ªç”¨æ³•å¾ˆç®€å•ï¼Œä¹˜æ³•æ“ä½œå°±æ˜¯ç”¨è¿™ä¸ªç¬¦å·ï¼›ç¬¬äºŒä¸ªç”¨æ³•ï¼Œæ˜¯å®šä¹‰æŒ‡é’ˆå˜é‡çš„æ—¶å€™ç”¨çš„ï¼Œæ¯”å¦‚ <code>unsigned char *p</code>ï¼Œè¿™ä¸ªåœ°æ–¹ä½¿ç”¨â€œ*â€ä»£è¡¨çš„æ„æ€æ˜¯ p æ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œè€Œéæ™®é€šçš„å˜é‡ã€‚è¿˜æœ‰ç¬¬ä¸‰ç§ç”¨æ³•ï¼Œå°±æ˜¯å–å€¼è¿ç®—ï¼Œå’Œå®šä¹‰æŒ‡é’ˆå˜é‡æ˜¯å®Œå…¨ä¸¤ç äº‹ï¼Œæ¯”å¦‚</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *p;</span><br><span class="line">p = &amp;a;</span><br><span class="line">b = *p;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·ä¸¤æ­¥è¿ç®—å®Œäº†ä¹‹åï¼Œb çš„å€¼å°±æˆäº† 1 äº†ã€‚åœ¨è¿™æ®µä»£ç ä¸­ï¼Œ&amp;a è¡¨ç¤ºå– a è¿™ä¸ªå˜é‡çš„åœ°å€ï¼ŒæŠŠè¿™ä¸ªåœ°å€é€ç»™ p ä¹‹åï¼Œå†ç”¨*pè¿ç®—è¡¨ç¤ºçš„æ˜¯å–æŒ‡é’ˆå˜é‡pæŒ‡å‘çš„åœ°å€çš„å˜é‡çš„å€¼ï¼ŒåˆæŠŠè¿™ä¸ªå€¼é€ç»™äº† bï¼Œæœ€ç»ˆçš„ç»“æœç›¸å½“äº b=aã€‚åŒæ ·æ˜¯*pï¼Œæ”¾åœ¨å®šä¹‰çš„ä½ç½®å°±æ˜¯å®šä¹‰æŒ‡é’ˆå˜é‡ï¼Œæ”¾åœ¨æ‰§è¡Œä»£ç ä¸­å°±æ˜¯å–å€¼è¿ç®—ã€‚</p>
<h5 id="3-7-1-3-ç®€å•ç¤ºä¾‹"><a href="#3-7-1-3-ç®€å•ç¤ºä¾‹" class="headerlink" title="3.7.1.3 ç®€å•ç¤ºä¾‹"></a>3.7.1.3 ç®€å•ç¤ºä¾‹</h5><p>ä½¿ç”¨æŒ‡é’ˆå®ç°æµæ°´ç¯</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;function.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">ShiftLeft</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *p)</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> buf = <span class="number">0x01</span>;</span><br><span class="line">	LED_Init();</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">		P0 = ~buf; <span class="comment">//ç¼“å†²å€¼å–åå‘é€åˆ°P0å£</span></span><br><span class="line">		delay_ms(<span class="number">2000</span>);</span><br><span class="line">		ShiftLeft(&amp;buf); <span class="comment">//ç¼“å†²å€¼å·¦ç§»ä¸€ä½</span></span><br><span class="line">		<span class="keyword">if</span> (buf == <span class="number">0</span>) &#123;</span><br><span class="line">			buf = <span class="number">0x01</span>; </span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*å°†æŒ‡é’ˆå˜é‡pæŒ‡å‘çš„å­—èŠ‚å·¦ç§»ä¸€ä½*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">ShiftLeft</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *p)</span> &#123;</span><br><span class="line">	*p = *p &lt;&lt; <span class="number">1</span>; <span class="comment">//åˆ©ç”¨æŒ‡é’ˆå˜é‡å¯ä»¥å‘å‡½æ•°å¤–è¾“å‡ºè¿ç®—ç»“æœ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹æ¯”ä¹‹å‰çš„å‡½æ•°è°ƒç”¨ï¼Œå¤§å®¶æ˜¯å¦çœ‹æ˜ç™½ï¼Œå¦‚æœæ˜¯æ™®é€šå˜é‡ä¼ é€’ï¼Œåªèƒ½å•å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸»å‡½æ•°ä¼ é€’ç»™å­å‡½æ•°çš„å€¼ï¼Œå­å‡½æ•°åªèƒ½ä½¿ç”¨å´ä¸èƒ½æ”¹å˜ã€‚è€Œç°åœ¨æˆ‘ä»¬ä¼ é€’çš„æ˜¯æŒ‡é’ˆï¼Œä¸ä»…ä»…å­å‡½æ•°å¯ä»¥ä½¿ç”¨ buf é‡Œè¾¹çš„å€¼ï¼Œè€Œä¸”è¿˜å¯ä»¥<code>å¯¹ buf é‡Œè¾¹çš„å€¼è¿›è¡Œä¿®æ”¹</code>ã€‚</p>
<p>åªè¦æ˜¯*p å‰è¾¹å¸¦äº†å˜é‡ç±»å‹å¦‚ unsigned charï¼Œå°±æ˜¯è¡¨ç¤ºå®šä¹‰äº†ä¸€ä¸ªæŒ‡é’ˆå˜é‡ pï¼Œè€Œæ‰§è¡Œä»£ç ä¸­çš„*pï¼Œæ˜¯æŒ‡ p æ‰€æŒ‡å‘çš„å†…å®¹ã€‚</p>
<h4 id="3-7-2-æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆ"><a href="#3-7-2-æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆ" class="headerlink" title="3.7.2 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆ"></a>3.7.2 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆ</h4><h5 id="3-7-2-1-æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œè¿ç®—æ³•åˆ™"><a href="#3-7-2-1-æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œè¿ç®—æ³•åˆ™" class="headerlink" title="3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œè¿ç®—æ³•åˆ™"></a>3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œè¿ç®—æ³•åˆ™</h5><p>æ‰€è°“æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆï¼Œå…¶æœ¬è´¨è¿˜æ˜¯å˜é‡çš„æŒ‡é’ˆã€‚å› ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå…¶å®éƒ½å¯ä»¥ç›´æ¥çœ‹æˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œæ‰€ä»¥æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯å˜é‡çš„æŒ‡é’ˆã€‚</p>
<p>æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆä¸éš¾ï¼Œä½†å¾ˆå¸¸ç”¨ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> number[<span class="number">10</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *p</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬å†™<code>p = &amp;number[0];</code>é‚£ä¹ˆæŒ‡é’ˆpå°±æŒ‡å‘äº†numberçš„ç¬¬0å·å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æŠŠnumber[0]çš„åœ°å€èµ‹å€¼ç»™äº†pï¼ŒåŒç†ï¼Œå¦‚æœå†™<code>p=&amp;number[1];</code>p å°±æŒ‡å‘äº†æ•°ç»„ number çš„ç¬¬ 1å·å…ƒç´ ã€‚<code>p = &amp;number[x];</code>å…¶ä¸­ x çš„å–å€¼èŒƒå›´æ˜¯0ï½9ï¼Œå°±è¡¨ç¤º<code>p</code>æŒ‡å‘äº†æ•°ç»„numberçš„ç¬¬ x å·å…ƒç´ ã€‚ </p>
<p>æŒ‡é’ˆæœ¬èº«ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œå‡ ç§ç®€å•çš„è¿ç®—ï¼Œè¿™å‡ ç§è¿ç®—å¯¹äºæ•°ç»„å…ƒç´ çš„æŒ‡é’ˆæ¥è¯´åº”ç”¨æœ€å¤šã€‚</p>
<ol>
<li>æ¯”è¾ƒè¿ç®—ã€‚æ¯”è¾ƒçš„å‰ææ˜¯<code>ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒç§ç±»å‹çš„å¯¹è±¡</code>ï¼Œæ¯”å¦‚ä¸¤ä¸ªæŒ‡é’ˆå˜é‡<code>p</code>å’Œ<code>q</code>å®ƒä»¬æŒ‡å‘äº†å…·æœ‰åŒç§æ•°æ®ç±»å‹çš„æ•°ç»„ï¼Œé‚£å®ƒä»¬å¯ä»¥è¿›è¡Œ&lt;ï¼Œ&gt;ï¼Œ&gt;=ï¼Œ&lt;=ï¼Œ==ç­‰å…³ç³»è¿ç®—ã€‚å¦‚æœ<code>p==q</code>ä¸ºçœŸçš„è¯ï¼Œè¡¨ç¤ºè¿™ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘çš„æ˜¯<code>åŒä¸€ä¸ªå…ƒç´ </code>ã€‚ </li>
<li><code>æŒ‡é’ˆ</code>å’Œ<code>æ•´æ•°</code>å¯ä»¥ç›´æ¥è¿›è¡ŒåŠ å‡è¿ç®—ã€‚æ¯”å¦‚è¿˜æ˜¯ä¸Šè¾¹æˆ‘ä»¬é‚£ä¸ªæŒ‡é’ˆpå’Œæ•°ç»„numberï¼Œå¦‚æœ<code>p = &amp;number[0]</code>ï¼Œé‚£ä¹ˆp+1å°±æŒ‡å‘äº†number[1]ï¼Œp+9å°±æŒ‡å‘äº†number[9]ã€‚å½“ç„¶äº†ï¼Œå¦‚æœp = &amp;number[9]ï¼Œp-9 ä¹Ÿå°±æŒ‡å‘äº†number[0]ã€‚ </li>
<li>ä¸¤ä¸ªæŒ‡é’ˆå˜é‡åœ¨<code>ä¸€å®šæ¡ä»¶ä¸‹</code>å¯ä»¥è¿›è¡Œå‡æ³•è¿ç®—ã€‚å¦‚<code>p = &amp;number[0]; q = &amp;number[9];</code>é‚£ä¹ˆ<code>q-p</code>çš„ç»“æœå°±æ˜¯ 9ã€‚ä½†æ˜¯è¿™ä¸ªåœ°æ–¹è¦ç‰¹åˆ«æ³¨æ„ï¼Œè¿™ä¸ª 9 ä»£è¡¨çš„æ˜¯<code>å…ƒç´ çš„ä¸ªæ•°</code>ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„åœ°å€å·®å€¼ã€‚<code>å¦‚æœæˆ‘ä»¬çš„ number çš„å˜é‡ç±»å‹æ˜¯ unsigned int å‹ï¼Œå  2 ä¸ªå­—èŠ‚ï¼Œq-p çš„ç»“æœä¾ç„¶æ˜¯ 9ï¼Œå› ä¸ºå®ƒä»£è¡¨çš„æ˜¯æ•°ç»„å…ƒç´ çš„ä¸ªæ•°</code>ã€‚</li>
</ol>
<p>åœ¨æ•°ç»„å…ƒç´ æŒ‡é’ˆè¿™é‡Œè¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯æ•°ç»„åå­—å…¶å®å°±ä»£è¡¨äº†æ•°ç»„å…ƒç´ çš„é¦–åœ°å€ï¼Œå³</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p = &amp;number[<span class="number">0</span>];</span><br><span class="line">p = number;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸¤ç§è¡¨è¾¾æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼Œå› æ­¤ä»¥ä¸‹å‡ ç§è¡¨è¾¾å½¢å¼å’Œå†…å®¹éœ€è¦æ³¨æ„ï¼š</p>
<p>æ ¹æ®æŒ‡é’ˆçš„è¿ç®—è§„åˆ™ï¼Œp+x ä»£è¡¨çš„æ˜¯ number[x]çš„<code>åœ°å€</code>ï¼Œé‚£ä¹ˆnumber+xä»£è¡¨çš„ä¹Ÿæ˜¯number[x]çš„<code>åœ°å€</code>ã€‚æˆ–è€…è¯´ï¼Œå®ƒä»¬æŒ‡å‘çš„éƒ½æ˜¯numberæ•°ç»„çš„ç¬¬ x å·å…ƒç´ ã€‚*(p+x)å’Œ*(number+x)éƒ½è¡¨ç¤º number[x]ã€‚</p>
<p>æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆä¹Ÿå¯ä»¥è¡¨ç¤ºæˆæ•°ç»„çš„å½¢å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…è®¸æŒ‡é’ˆå˜é‡å¸¦ä¸‹æ ‡ï¼Œå³ p[i]å’Œ*(p+i)æ˜¯ç­‰ä»·çš„ã€‚ä½†æ˜¯ä¸ºäº†é¿å…æ··æ·†ä¸è§„èŒƒèµ·è§ï¼Œè¿™é‡Œæˆ‘ä»¬å»ºè®®å¤§å®¶ä¸è¦å†™æˆå‰è€…ï¼Œè€Œä¸€å¾‹é‡‡ç”¨åè€…çš„å†™æ³•ã€‚ä½†å¦‚æœçœ‹åˆ°åˆ«äººé‚£ä¹ˆå†™ï¼Œä¹ŸçŸ¥é“æ˜¯æ€ä¹ˆå›äº‹å³å¯ã€‚</p>
<p>äºŒç»´æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œä¸€ç»´æ•°ç»„ç±»ä¼¼ï¼Œéœ€è¦ä»‹ç»çš„å†…å®¹ä¸å¤šã€‚å‡å¦‚ç°åœ¨ä¸€ä¸ªæŒ‡é’ˆå˜é‡på’Œä¸€ä¸ªäºŒç»´æ•°ç»„number[3][4]ï¼Œå®ƒçš„åœ°å€çš„è¡¨è¾¾æ–¹å¼ä¹Ÿå°±æ˜¯ p=&amp;number[0][0]ï¼Œæœ‰ä¸€ä¸ªåœ°æ–¹è¦æ³¨æ„ï¼Œæ—¢ç„¶æ•°ç»„åä»£è¡¨äº†æ•°ç»„å…ƒç´ çš„é¦–åœ°å€ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯è¯´på’Œ number éƒ½æ˜¯æŒ‡æ•°ç»„çš„é¦–åœ°å€ã€‚å¯¹äºŒç»´æ•°ç»„æ¥è¯´ï¼Œnumber[0]ï¼Œnumber[1]ï¼Œnumber[2]éƒ½å¯ä»¥çœ‹æˆæ˜¯ä¸€ç»´æ•°ç»„çš„æ•°ç»„åå­—ï¼Œæ‰€ä»¥number[0]ç­‰ä»·äº&amp;number[0[0]ï¼Œnumber[1]ç­‰ä»·äº&amp;number[1][0]ï¼Œnumber[2]ç­‰ä»·äº&amp;number[2][0]ã€‚åŠ å‡è¿ç®—å’Œä¸€ç»´æ•°ç»„æ˜¯ç±»ä¼¼çš„ï¼Œä¸å†è¯¦è¿°ã€‚ </p>
<h5 id="3-7-2-1-æŒ‡å‘æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å®ä¾‹"><a href="#3-7-2-1-æŒ‡å‘æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å®ä¾‹" class="headerlink" title="3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å®ä¾‹"></a>3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å®ä¾‹</h5><p>åœ¨ C è¯­è¨€é‡Œï¼Œ<code>sizeof()</code>å¯ä»¥ç”¨æ¥è·å–æ‹¬å·å†…çš„å¯¹è±¡æ‰€å ç”¨çš„<code>å†…å­˜å­—èŠ‚æ•°</code>ï¼Œè™½ç„¶å®ƒå†™ä½œå‡½æ•°çš„å½¢å¼ï¼Œä½†å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œæ˜¯ C è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ï¼Œ<code>sizeof()</code>æ•´ä½“åœ¨ç¨‹åºä»£ç ä¸­å°±ç›¸å½“äºä¸€ä¸ªå¸¸é‡ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè·å–æ“ä½œæ˜¯åœ¨<code>ç¨‹åºç¼–è¯‘</code>çš„æ—¶å€™è¿›è¡Œçš„ï¼Œè€Œä¸æ˜¯åœ¨ç¨‹åºè¿è¡Œçš„æ—¶å€™è¿›è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªå®é™…ç¼–ç¨‹ä¸­å¾ˆæœ‰ç”¨çš„å…³é”®å­—ï¼Œçµæ´»è¿ç”¨å®ƒå¯ä»¥ä¸ºç¨‹åºå¸¦æ¥æ›´å¥½çš„å¯è¯»æ€§ã€æ˜“ç»´æŠ¤æ€§å’Œå¯ç§»æ¤æ€§ï¼Œåœ¨åç»­çš„ä¾‹ç¨‹å­¦ä¹ ä¸­å°†ä¼šæ…¢æ…¢æœ‰æ‰€ä½“ä¼šçš„ã€‚</p>
<p><code>sizeof()</code>æ‹¬å·ä¸­å¯ä»¥æ˜¯<code>å˜é‡å</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯<code>å˜é‡ç±»å‹å</code>ï¼Œå…¶ç»“æœæ˜¯ç­‰æ•ˆçš„ã€‚è€Œå…¶æ›´å¤§çš„ç”¨å¤„æ˜¯ä¸<code>æ•°ç»„åæ­é…ä½¿ç”¨</code>ï¼Œè¿™æ ·å¯ä»¥<strong>è·å–æ•´ä¸ªæ•°ç»„å ç”¨çš„å­—èŠ‚æ•°</strong>ï¼Œå°±ä¸ç”¨è‡ªå·±åŠ¨æ‰‹è®¡ç®—äº†ï¼Œå¯ä»¥é¿å…é”™è¯¯ï¼Œè€Œå¦‚æœæ—¥åæ”¹å˜äº†æ•°ç»„çš„ç»´æ•°æ—¶ï¼Œä¹Ÿä¸éœ€è¦å†åˆ°æ‰§è¡Œä»£ç ä¸­é€ä¸ªä¿®æ”¹ï¼Œä¾¿äºç¨‹åºçš„ç»´æŠ¤å’Œç§»æ¤ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹ç¨‹</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;reg52.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">bit cmdArrived = <span class="number">0</span>; <span class="comment">//å‘½ä»¤åˆ°è¾¾æ ‡å¿—ï¼Œå³æ¥æ”¶åˆ°ä¸Šä½æœºä¸‹å‘çš„å‘½ä»¤</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cmdIndex = <span class="number">0</span>; <span class="comment">//å‘½ä»¤ç´¢å¼•ï¼Œå³ä¸ä¸Šä½æœºçº¦å®šå¥½çš„æ•°ç»„ç¼–å· </span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cntTxd = <span class="number">0</span>;   <span class="comment">//ä¸²å£å‘é€è®¡æ•°å™¨ </span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> *ptrTxd;      <span class="comment">//ä¸²å£å‘é€æŒ‡é’ˆ </span></span><br><span class="line"> </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> array1[<span class="number">1</span>] = &#123;<span class="number">1</span>&#125;; </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> array2[<span class="number">2</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>&#125;; </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> array3[<span class="number">4</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>&#125;; </span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> array4[<span class="number">8</span>] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>&#125;; </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> baud)</span>; </span><br><span class="line"> </span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span> </span><br><span class="line">&#123; </span><br><span class="line">    EA = <span class="number">1</span>;  <span class="comment">//å¼€æ€»ä¸­æ–­ </span></span><br><span class="line"> ConfigUART(<span class="number">9600</span>); <span class="comment">//é…ç½®æ³¢ç‰¹ç‡ä¸º 9600 </span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">if</span> (cmdArrived) </span><br><span class="line">        &#123; </span><br><span class="line">            cmdArrived = <span class="number">0</span>; </span><br><span class="line">            <span class="keyword">switch</span> (cmdIndex) </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">case</span> <span class="number">1</span>: </span><br><span class="line"> ptrTxd = array1; <span class="comment">//æ•°ç»„ 1 çš„é¦–åœ°å€èµ‹å€¼ç»™å‘é€æŒ‡é’ˆ </span></span><br><span class="line"> cntTxd = <span class="keyword">sizeof</span>(array1); <span class="comment">//æ•°ç»„ 1 çš„é•¿åº¦èµ‹å€¼ç»™å‘é€è®¡æ•°å™¨ </span></span><br><span class="line">                    TI = <span class="number">1</span>;   <span class="comment">//æ‰‹åŠ¨æ–¹å¼å¯åŠ¨å‘é€ä¸­æ–­ï¼Œå¤„ç†æ•°æ®å‘é€ </span></span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">                <span class="keyword">case</span> <span class="number">2</span>: </span><br><span class="line">                    ptrTxd = array2; </span><br><span class="line">                    cntTxd = <span class="keyword">sizeof</span>(array2); </span><br><span class="line">                    TI = <span class="number">1</span>; </span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">                <span class="keyword">case</span> <span class="number">3</span>: </span><br><span class="line">                    ptrTxd = array3; </span><br><span class="line">                    cntTxd = <span class="keyword">sizeof</span>(array3); </span><br><span class="line">                    TI = <span class="number">1</span>; </span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">                <span class="keyword">case</span> <span class="number">4</span>: </span><br><span class="line">                    ptrTxd = array4; </span><br><span class="line">                    cntTxd = <span class="keyword">sizeof</span>(array4); </span><br><span class="line">                    TI = <span class="number">1</span>; </span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">                <span class="keyword">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/* ä¸²å£é…ç½®å‡½æ•°ï¼Œbaud-é€šä¿¡æ³¢ç‰¹ç‡ */</span> </span><br><span class="line"><span class="type">void</span> <span class="title function_">ConfigUART</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> baud)</span> </span><br><span class="line">&#123; </span><br><span class="line"> SCON = <span class="number">0x50</span>; <span class="comment">//é…ç½®ä¸²å£ä¸ºæ¨¡å¼ 1 </span></span><br><span class="line"> TMOD &amp;= <span class="number">0x0F</span>; <span class="comment">//æ¸…é›¶ T1 çš„æ§åˆ¶ä½ </span></span><br><span class="line"> TMOD |= <span class="number">0x20</span>; <span class="comment">//é…ç½® T1 ä¸ºæ¨¡å¼ 2 </span></span><br><span class="line"> TH1 = <span class="number">256</span> - (<span class="number">11059200</span>/<span class="number">12</span>/<span class="number">32</span>)/baud; <span class="comment">//è®¡ç®— T1 é‡è½½å€¼ </span></span><br><span class="line">    TL1 = TH1;     <span class="comment">//åˆå€¼ç­‰äºé‡è½½å€¼ </span></span><br><span class="line"> ET1 = <span class="number">0</span>; <span class="comment">//ç¦æ­¢ T1 ä¸­æ–­ </span></span><br><span class="line">    ES  = <span class="number">1</span>;       <span class="comment">//ä½¿èƒ½ä¸²å£ä¸­æ–­ </span></span><br><span class="line"> TR1 = <span class="number">1</span>; <span class="comment">//å¯åŠ¨ T1 </span></span><br><span class="line">&#125; </span><br><span class="line"><span class="comment">/* UART ä¸­æ–­æœåŠ¡å‡½æ•° */</span> </span><br><span class="line"><span class="type">void</span> <span class="title function_">InterruptUART</span><span class="params">()</span> interrupt 4 </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">if</span> (RI)  <span class="comment">//æ¥æ”¶åˆ°å­—èŠ‚ </span></span><br><span class="line">    &#123; </span><br><span class="line">        RI = <span class="number">0</span>;  <span class="comment">//æ¸…é›¶æ¥æ”¶ä¸­æ–­æ ‡å¿—ä½ </span></span><br><span class="line">        cmdIndex = SBUF;  <span class="comment">//æ¥æ”¶åˆ°çš„æ•°æ®ä¿å­˜åˆ°å‘½ä»¤ç´¢å¼•ä¸­ </span></span><br><span class="line">        cmdArrived = <span class="number">1</span>;   <span class="comment">//è®¾ç½®å‘½ä»¤åˆ°è¾¾æ ‡å¿— </span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span> (TI)  <span class="comment">//å­—èŠ‚å‘é€å®Œæ¯• </span></span><br><span class="line">    &#123; </span><br><span class="line">        TI = <span class="number">0</span>;  <span class="comment">//æ¸…é›¶å‘é€ä¸­æ–­æ ‡å¿—ä½ </span></span><br><span class="line">        <span class="keyword">if</span> (cntTxd &gt; <span class="number">0</span>)  <span class="comment">//æœ‰å¾…å‘é€æ•°æ®æ—¶ï¼Œç»§ç»­å‘é€åç»­å­—èŠ‚ </span></span><br><span class="line">        &#123; </span><br><span class="line">            SBUF = *ptrTxd;  <span class="comment">//å‘å‡ºæŒ‡é’ˆæŒ‡å‘çš„æ•°æ® </span></span><br><span class="line">            cntTxd--;         <span class="comment">//å‘é€è®¡æ•°å™¨é€’å‡ </span></span><br><span class="line">            ptrTxd++;         <span class="comment">//å‘é€æŒ‡é’ˆé€’å¢ </span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="èµèµä½œè€…"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>æ‰“èµä½œè€…</div><div class="reward-main"><div class="reward-all"><span class="reward-title">æ„Ÿè°¢ä½ èµäºˆæˆ‘å‰è¿›çš„åŠ›é‡</span><ul class="reward-group"><li class="reward-item"><a href="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage%20(1).webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage%20(1).webp" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/eassy/imageonline-co-convertedwebpimage.webp" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">èµèµè€…åå•</div><div class="reward-dec">å› ä¸ºä½ ä»¬çš„æ”¯æŒè®©æˆ‘æ„è¯†åˆ°å†™æ–‡ç« çš„ä»·å€¼ğŸ™</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« "><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://www.gan1ser.top/post/dc68b377.html"></div><div class="reward-dec">ä½¿ç”¨æ‰‹æœºè®¿é—®è¿™ç¯‡æ–‡ç« </div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°&amp;url=https://www.gan1ser.top/post/dc68b377.html&amp;pic=https://pic.gan1ser.top/post/1.webp" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="å¤åˆ¶é“¾æ¥" onclick="rm.copyPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%F0%9F%93%95%E7%9F%A5%E8%AF%86/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ğŸ“•çŸ¥è¯†<span class="tagsPageCount">41</span></a><a class="post-meta__box__tags" href="/tags/%F0%9F%96%8A%E7%AC%94%E8%AE%B0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>ğŸ–Šç¬”è®°<span class="tagsPageCount">33</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://pic.gan1ser.top/post/119.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer="defer"></script></div></div></div><div class="post-copyright"><i class="anzhiyufont anzhiyu-icon-copyright"></i><div class="post-copyright__author"><a class="post-copyright__original" title="è¯¥æ–‡ç« ä¸ºåŸåˆ›æ–‡ç« ï¼Œæ³¨æ„ç‰ˆæƒåè®®" href="https://www.gan1ser.top/post/dc68b377.html">åŸåˆ›</a><a class="post-copyright-title"><span>ã€Šå•ç‰‡æœºåŸç†åŠè¿ç”¨ã€‹å­¦ä¹ ç¬”è®°</span></a></div><div class="post-copyright-info-box"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"></span><a class="link" href="https://www.gan1ser.top">GanSer</a></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a class="link" href="https://www.gan1ser.top/post/dc68b377.html">https://www.gan1ser.top/post/dc68b377.html</a></span><span class="copy-button" onclick="rm.copyPageUrl('https://www.gan1ser.top/post/dc68b377.html')"><i class="anzhiyufont anzhiyu-icon-copy"></i></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://www.gan1ser.top" target="_blank">GanSer</a>ï¼</span></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/38ff18f6.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/3.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ã€Šæ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡ã€‹å­¦ä¹ ç¬”è®°</div></div></a></div><div class="next-post pull-right"><a href="/post/17311.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/53.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">è§£å†³Auroraæ•°å­¦å…¬å¼æ¸²æŸ“é—®é¢˜</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/post/1b809c7b.html" title="å¸¸ç”¨å†…å»ºæ¨¡å—(ä¸€)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/68.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-07-30</div><div class="title">å¸¸ç”¨å†…å»ºæ¨¡å—(ä¸€)</div></div></a></div><div><a href="/post/ca1e50ee.html" title="Deformable ConvNets-å¯å˜å½¢å·ç§¯å­¦ä¹ "><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/95.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-14</div><div class="title">Deformable ConvNets-å¯å˜å½¢å·ç§¯å­¦ä¹ </div></div></a></div><div><a href="/post/8c94c2b9.html" title="Markdownå…¬å¼è¯­æ³•æ±‡æ€»"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/10.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-01-10</div><div class="title">Markdownå…¬å¼è¯­æ³•æ±‡æ€»</div></div></a></div><div><a href="/post/5fac20c9.html" title="Numpyå…¥é—¨ï¼ˆä¸€ï¼‰"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/71.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-07-31</div><div class="title">Numpyå…¥é—¨ï¼ˆä¸€ï¼‰</div></div></a></div><div><a href="/post/22a46f43.html" title="Numpyå…¥é—¨ï¼ˆä¸‰ï¼‰"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/74.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-08-09</div><div class="title">Numpyå…¥é—¨ï¼ˆä¸‰ï¼‰</div></div></a></div><div><a href="/post/6fbacc11.html" title="Numpyå…¥é—¨ï¼ˆäºŒï¼‰"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/72.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-07-31</div><div class="title">Numpyå…¥é—¨ï¼ˆäºŒï¼‰</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> è¯„è®º</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">åŒ¿åè¯„è®º</a></div><div class="comment-tips" id="comment-tips"><span>âœ… ä½ æ— éœ€åˆ é™¤ç©ºè¡Œï¼Œç›´æ¥è¯„è®ºä»¥è·å–æœ€ä½³å±•ç¤ºæ•ˆæœ</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author-info-top"> <div class="card-info-avatar"><a class="avatar-img" href="/about"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></a><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="writing_hand" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/270d.png">âœï¸</g-emoji><span>on Studying</span></div></div></div></div><div class="author-info__sayhi" id="author-info__sayhi"></div><h1 class="author-info__name">GanSer</h1><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(11, 231, 255);">ï¼ˆã¥ï¿£3ï¿£ï¼‰ã¥â•­â¤ï½æ­å–œå°ä¼™ä¼´å‘ç°åšå®¢ä¸–ç•Œçš„ä¸€è§’ï¼Œè¿™æ˜¯ä¸€åæ™®é€šå¤§å­¦ç”Ÿå…³äº<b style="color:#078B99">çŸ¥è¯†ã€ç§‘æŠ€ã€ç”Ÿæ´»</b>ç›¸å…³çš„è®°å½•å’Œåˆ†äº«ï¼Œè¿˜æœ‰<b style="color:#078B99">è¯¾å¤–å­¦ä¹ </b>å’Œ<b style="color:#078B99">ææ€ª</b>ã€‚</div></div><div class="banner-button-group"><a class="banner-button" onclick="pjax.loadUrl(&quot;/about/&quot;)"><span class="banner-button-text">äº†è§£æ›´å¤š</span><i class="anzhiyufont anzhiyu-icon-arrow-circle-right" style="font-size: 1.5rem"></i></a></div><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/Gan1Ser" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=1742158140@qq.com" target="_blank" title="Email"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a><a class="social-icon faa-parent animated-hover" href="/atom.xml" target="_blank" title="RSS"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-RSS"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/628891869" target="_blank" title="BiliBili"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg></a></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://pic.imgdb.cn/item/64ba6cbb1ddac507cc15022b.gif) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://pic.imgdb.cn/item/64ba67aa1ddac507cc03647b.gif) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>æ–‡ç« ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%8D%95%E7%89%87%E6%9C%BA%E5%BC%80%E5%8F%91%E4%B8%8E%E4%BB%BF%E7%9C%9F%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">ä¸€ã€å•ç‰‡æœºå¼€å‘ä¸ä»¿çœŸç¯å¢ƒæ­å»º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Keil-%E8%BD%AF%E4%BB%B6"><span class="toc-text">1.1 Keil è½¯ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-Keil%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-text">1.1.1 Keilè½¯ä»¶çš„ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-Keil-C51%E7%9A%84%E5%B7%A5%E4%BD%9C%E7%95%8C%E9%9D%A2"><span class="toc-text">1.1.2 Keil C51çš„å·¥ä½œç•Œé¢</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-3-Keil-C51%E5%BB%BA%E7%AB%8B%E5%B7%A5%E7%A8%8B"><span class="toc-text">1.1.3 Keil C51å»ºç«‹å·¥ç¨‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-4-%E5%BB%BA%E7%AB%8B-%E7%BC%96%E8%BE%91C%E8%AF%AD%E8%A8%80%E6%BA%90%E7%A8%8B%E5%BA%8F%E6%96%87%E4%BB%B6"><span class="toc-text">1.1.4 å»ºç«‹&#x2F;ç¼–è¾‘Cè¯­è¨€æºç¨‹åºæ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-5-%E5%B7%A5%E7%A8%8B%E7%9A%84%E8%AE%BE%E7%BD%AE"><span class="toc-text">1.1.5 å·¥ç¨‹çš„è®¾ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-6-Keil-C51-%E7%9A%84Debug"><span class="toc-text">1.1.6 Keil C51 çš„Debug</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-7-%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E8%B5%84%E6%BA%90%E7%9A%84%E6%9F%A5%E7%9C%8B%E5%92%8C%E4%BF%AE%E6%94%B9"><span class="toc-text">1.1.7 å­˜å‚¨ç©ºé—´èµ„æºçš„æŸ¥çœ‹å’Œä¿®æ”¹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Proteus%E8%BD%AF%E4%BB%B6"><span class="toc-text">1.2 Proteusè½¯ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-Proteus%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-text">1.2.1 Proteusè½¯ä»¶çš„ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-Proteus%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-text">1.2.2 Proteusç®€å•ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-3-Proteus-8-%E4%B8%8E-Keil-C51-%E7%9A%84%E8%81%94%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-text">1.2.3 Proteus 8 ä¸ Keil C51 çš„è”åˆä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-4-Proteus-%E7%94%BB%E5%87%BA%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E6%9C%80%E5%B0%8F%E7%B3%BB%E7%BB%9F"><span class="toc-text">1.2.4 Proteus ç”»å‡ºå•ç‰‡æœºçš„æœ€å°ç³»ç»Ÿ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-5-%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%EF%BC%9A%E6%B5%81%E6%B0%B4%E7%81%AF%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">1.2.5 å®æˆ˜æ•™å­¦ï¼šæµæ°´ç¯çš„å®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-STC-ISP%E8%BD%AF%E4%BB%B6"><span class="toc-text">1.3 STC-ISPè½¯ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-1-STC-ISP%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="toc-text">1.3.1 STC-ISPè½¯ä»¶çš„ç®€ä»‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-2-STC-ISP%E8%BD%AF%E4%BB%B6%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.3.2 STC-ISPè½¯ä»¶çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-3-%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%EF%BC%9A-%E7%82%B9%E4%BA%AE%E7%AC%AC%E4%B8%80%E4%B8%AALED%E7%81%AF"><span class="toc-text">1.3.3 å®æˆ˜æ•™å­¦ï¼š ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-%E5%8D%95%E7%89%87%E6%9C%BA%E6%9C%80%E5%B0%8F%E7%B3%BB%E7%BB%9F"><span class="toc-text">1.4 å•ç‰‡æœºæœ€å°ç³»ç»Ÿ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-1-%E7%94%B5%E6%BA%90"><span class="toc-text">1.4.1 ç”µæº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-2-%E6%99%B6%E6%8C%AF"><span class="toc-text">1.4.2 æ™¶æŒ¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-3-%E5%A4%8D%E4%BD%8D%E7%94%B5%E8%B7%AF"><span class="toc-text">1.4.3 å¤ä½ç”µè·¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-4-%E5%8D%95%E7%89%87%E6%9C%BA%E7%9C%8B%E9%97%A8%E7%8B%97"><span class="toc-text">1.4.4 å•ç‰‡æœºçœ‹é—¨ç‹—</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-LED%E5%B0%8F%E7%81%AF%E5%8E%9F%E7%90%86"><span class="toc-text">1.5 LEDå°ç¯åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-1-USB%E6%8E%A5%E5%8F%A3%E7%94%B5%E8%B7%AF"><span class="toc-text">1.5.1 USBæ¥å£ç”µè·¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-2-LED%E5%B0%8F%E7%81%AF%E7%94%B5%E8%B7%AF"><span class="toc-text">1.5.2 LEDå°ç¯ç”µè·¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-3-%E5%8D%95%E7%89%87%E6%9C%BA%E7%AB%AF%E5%8F%A3"><span class="toc-text">1.5.3 å•ç‰‡æœºç«¯å£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-4-%E5%AE%9E%E9%99%85LED%E7%A1%AC%E4%BB%B6%E8%BF%9E%E6%8E%A5"><span class="toc-text">1.5.4 å®é™…LEDç¡¬ä»¶è¿æ¥</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-4-1-%E4%B8%89%E6%9E%81%E7%AE%A1%E8%AE%A4%E8%AF%86"><span class="toc-text">1.5.4.1 ä¸‰æç®¡è®¤è¯†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-4-2-%E4%B8%89%E5%85%AB%E8%AF%91%E7%A0%81%E5%99%A8"><span class="toc-text">1.5.4.2 ä¸‰å…«è¯‘ç å™¨</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6-%E8%9C%82%E9%B8%A3%E5%99%A8%E5%8E%9F%E7%90%86"><span class="toc-text">1.6 èœ‚é¸£å™¨åŸç†</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-1-%E5%8D%95%E7%89%87%E6%9C%BAIO%E7%AB%AF%E5%8F%A3%E7%94%B5%E6%B5%81"><span class="toc-text">1.6.1 å•ç‰‡æœºIOç«¯å£ç”µæµ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-2-%E6%9C%89%E6%BA%90%E8%9C%82%E9%B8%A3%E5%99%A8"><span class="toc-text">1.6.2 æœ‰æºèœ‚é¸£å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-3-%E6%97%A0%E6%BA%90%E8%9C%82%E9%B8%A3%E5%99%A8"><span class="toc-text">1.6.3 æ— æºèœ‚é¸£å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-4-%E6%97%A0%E6%BA%90%E8%9C%82%E9%B8%A3%E5%99%A8%E9%B8%A3%E5%8F%AB"><span class="toc-text">1.6.4 æ— æºèœ‚é¸£å™¨é¸£å«</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-7-%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE"><span class="toc-text">1.7 ç‹¬ç«‹æŒ‰é”®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-1-%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE%E4%B8%8E%E7%9F%A9%E9%98%B5%E6%8C%89%E9%94%AE"><span class="toc-text">1.7.1 ç‹¬ç«‹æŒ‰é”®ä¸çŸ©é˜µæŒ‰é”®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-2-%E6%8C%89%E9%94%AE%E7%9A%84%E5%8E%9F%E7%90%86"><span class="toc-text">1.7.2 æŒ‰é”®çš„åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-3-%E6%8C%89%E9%94%AE%E7%94%A8%E6%B3%95"><span class="toc-text">1.7.3 æŒ‰é”®ç”¨æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-4-%E6%8C%89%E9%94%AE%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.7.4 æŒ‰é”®æ¨¡å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-5-%E4%B8%8D%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.7.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-6-%E5%9B%9E%E5%BD%92%E6%8C%89%E9%94%AE"><span class="toc-text">1.7.6 å›å½’æŒ‰é”®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-7-%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%EF%BC%88%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%EF%BC%89"><span class="toc-text">1.7.7 æ”¯æŒè¿æŒ‰ï¼ˆå…¨å±€å˜é‡ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-8-%E5%8F%8C%E6%A8%A1%E5%BC%8F%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85"><span class="toc-text">1.7.8 åŒæ¨¡å¼å‡½æ•°å°è£…</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-8-%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD"><span class="toc-text">1.8 å¤–éƒ¨ä¸­æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-1-%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">1.8.1 å¯„å­˜å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-1-1-%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E5%86%85%E9%83%A8%E8%B5%84%E6%BA%90"><span class="toc-text">1.8.1.1 å•ç‰‡æœºçš„å†…éƒ¨èµ„æº</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-1-2-IE0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">1.8.1.2 IE0çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-1-3-IT0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">1.8.1.3 IT0çš„ä½œç”¨</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-2-%E4%B8%AD%E6%96%AD%E5%87%BD%E6%95%B0"><span class="toc-text">1.8.2 ä¸­æ–­å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-2-1-%E4%B8%AD%E6%96%AD%E5%87%BD%E6%95%B0%E7%9A%84%E4%B9%A6%E5%86%99"><span class="toc-text">1.8.2.1 ä¸­æ–­å‡½æ•°çš„ä¹¦å†™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-2-2-EX0%E5%92%8CEA"><span class="toc-text">1.8.2.2 EX0å’ŒEA</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-3-%E8%BF%9B%E4%B8%80%E6%AD%A5%E7%90%86%E8%A7%A3%E4%B8%AD%E6%96%AD%E5%87%BD%E6%95%B0"><span class="toc-text">1.8.3 è¿›ä¸€æ­¥ç†è§£ä¸­æ–­å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-3-1-%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD1"><span class="toc-text">1.8.3.1 å¤–éƒ¨ä¸­æ–­1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-3-2-%E6%8C%89%E9%94%AE%E8%A7%A6%E5%8F%91%E4%B8%AD%E6%96%AD"><span class="toc-text">1.8.3.2 æŒ‰é”®è§¦å‘ä¸­æ–­</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-3-3-%E6%8C%89%E9%94%AE%E8%A7%A6%E5%8F%91%E4%B8%AD%E6%96%AD%E6%B6%88%E6%8A%96"><span class="toc-text">1.8.3.3 æŒ‰é”®è§¦å‘ä¸­æ–­æ¶ˆæŠ–</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-9-%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-text">1.9 å®šæ—¶å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-1-%E6%BA%A2%E5%87%BA"><span class="toc-text">1.9.1 æº¢å‡º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-2-%E4%B8%A4%E7%A7%8D%E5%AE%9A%E6%97%B6%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.9.2 ä¸¤ç§å®šæ—¶æ¨¡å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-3-%E5%AE%9A%E6%97%B6%E5%99%A8%E6%A8%A1%E5%BC%8F%E7%9A%84%E9%80%89%E6%8B%A9"><span class="toc-text">1.9.3 å®šæ—¶å™¨æ¨¡å¼çš„é€‰æ‹©</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-4-%E5%AE%9A%E6%97%B6%E6%97%B6%E9%95%BF%E7%9A%84%E5%81%9A%E6%B3%95"><span class="toc-text">1.9.4 å®šæ—¶æ—¶é•¿çš„åšæ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-5-%E5%AE%9A%E6%97%B6%E5%99%A8%E7%AE%80%E5%8D%95%E8%BF%90%E7%94%A8"><span class="toc-text">1.9.5 å®šæ—¶å™¨ç®€å•è¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-6-%E5%AE%9A%E6%97%B6%E5%99%A8%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F2"><span class="toc-text">1.9.6 å®šæ—¶å™¨å·¥ä½œæ¨¡å¼2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-7-%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%AD%E6%96%AD%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">1.9.7 å®šæ—¶å™¨ä¸­æ–­å‡½æ•°çš„ä½¿ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-8-%E5%AE%9A%E6%97%B6%E5%99%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E4%BC%98%E5%8C%96"><span class="toc-text">1.9.8 å®šæ—¶å™¨åˆå§‹åŒ–ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-9-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E7%82%B9"><span class="toc-text">1.9.9 åˆå§‹åŒ–éœ€è¦æ³¨æ„çš„ç‚¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-10-%E4%BB%A3%E7%A0%81%E5%8F%82%E8%80%83"><span class="toc-text">1.9.10 ä»£ç å‚è€ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-11-%E5%BE%AE%E8%B0%83%E5%AE%9A%E6%97%B6%E7%B2%BE%E7%A1%AE%E6%97%B6%E9%97%B4"><span class="toc-text">1.9.11 å¾®è°ƒå®šæ—¶ç²¾ç¡®æ—¶é—´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-12-%E5%B0%81%E8%A3%85%E5%87%BD%E6%95%B0"><span class="toc-text">1.9.12 å°è£…å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-13-%E5%91%BC%E5%90%B8%E7%81%AF"><span class="toc-text">1.9.13 å‘¼å¸ç¯</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-10-%E8%88%B5%E6%9C%BA"><span class="toc-text">1.10 èˆµæœº</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-1-%E8%AE%A4%E8%AF%86%E8%88%B5%E6%9C%BA"><span class="toc-text">1.10.1 è®¤è¯†èˆµæœº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-2-%E8%88%B5%E6%9C%BA%E6%8E%A7%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-text">1.10.2 èˆµæœºæ§åˆ¶åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-3-%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E8%88%B5%E6%9C%BA"><span class="toc-text">1.10.3 æŒ‰é”®æ§åˆ¶èˆµæœº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-10-4-%E5%91%BC%E5%90%B8%E7%81%AF%E4%B8%8E%E8%88%B5%E6%9C%BA"><span class="toc-text">1.10.4 å‘¼å¸ç¯ä¸èˆµæœº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-11-%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1"><span class="toc-text">1.11 ä¸²å£é€šä¿¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-1-%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E5%85%A5%E9%97%A8"><span class="toc-text">1.11.1 ä¸²å£é€šä¿¡å…¥é—¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-2-%E8%BD%AF%E4%BB%B6%E8%AE%BE%E7%BD%AE"><span class="toc-text">1.11.2 è½¯ä»¶è®¾ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-3-%E4%B8%B2%E5%8F%A3%E9%85%8D%E7%BD%AE%E5%87%BD%E6%95%B0"><span class="toc-text">1.11.3 ä¸²å£é…ç½®å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-4-ASCII%E7%A0%81%E4%B8%8E%E9%80%9A%E4%BF%A1%E6%95%B0%E6%8D%AE"><span class="toc-text">1.11.4 ASCIIç ä¸é€šä¿¡æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-11-5-printf%E7%B3%BB%E5%88%97%E7%9A%84%E5%87%BD%E6%95%B0%E5%AE%9E%E7%8E%B0"><span class="toc-text">1.11.5 printfç³»åˆ—çš„å‡½æ•°å®ç°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-12-1602%E6%B6%B2%E6%99%B6%E5%B1%8F"><span class="toc-text">1.12 1602æ¶²æ™¶å±</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%9E%E6%88%98%E6%95%99%E5%AD%A6%E4%BB%A5%E5%8F%8A%E4%BD%9C%E5%93%81%E5%B1%95%E7%A4%BA"><span class="toc-text">äºŒã€å®æˆ˜æ•™å­¦ä»¥åŠä½œå“å±•ç¤º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-LED"><span class="toc-text">2.1 LED</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E7%82%B9%E4%BA%AE%E7%AC%AC%E4%B8%80%E4%B8%AALED%E7%81%AF"><span class="toc-text">2.1.1 ç‚¹äº®ç¬¬ä¸€ä¸ªLEDç¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.1.1.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.1.1.2 ä»¿çœŸ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-3-%E5%AE%9E%E7%89%A9"><span class="toc-text">2.1.1.3 å®ç‰©</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E9%97%AA%E7%83%81%E7%9A%84LED%E7%81%AF"><span class="toc-text">2.1.2 é—ªçƒçš„LEDç¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.1.2.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.1.2.2 ä»¿çœŸ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-3-%E5%AE%9E%E7%89%A9"><span class="toc-text">2.1.2.3 å®ç‰©</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-%E4%B8%89%E4%B8%AA%E5%B0%8F%E7%81%AF%E5%90%8C%E6%97%B6%E9%97%AA%E7%83%81"><span class="toc-text">2.1.3 ä¸‰ä¸ªå°ç¯åŒæ—¶é—ªçƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-3-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.1.3.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-3-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.1.3.2 ä»¿çœŸ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-3-3-%E5%AE%9E%E7%89%A9"><span class="toc-text">2.1.3.3 å®ç‰©</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-3-4-%E4%BC%98%E5%8C%96"><span class="toc-text">2.1.3.4 ä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.1.4 æµæ°´ç¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.1.4.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.1.4.2 ä»¿çœŸ</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-3-%E5%AE%9E%E7%89%A9"><span class="toc-text">2.1.4.3 å®ç‰©</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-4-%E4%BC%98%E5%8C%96"><span class="toc-text">2.1.4.4 ä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-%E4%BA%A4%E9%80%9A%E7%81%AF%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">2.1.4 äº¤é€šç¯çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-1-%E6%BA%90%E7%A0%81-1"><span class="toc-text">2.1.4.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-4-2-%E4%BB%BF%E7%9C%9F-1"><span class="toc-text">2.1.4.2 ä»¿çœŸ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-5-%E8%8A%B1%E5%BC%8F%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.1.5 èŠ±å¼æµæ°´ç¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-5-1-%E5%8F%B3%E7%A7%BB%E6%B5%81%E6%B0%B4%E7%81%AF%E6%BA%90%E7%A0%81"><span class="toc-text">2.1.5.1 å³ç§»æµæ°´ç¯æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-5-2-%E5%BE%AA%E7%8E%AF%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.1.5.2 å¾ªç¯æµæ°´ç¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-5-3-%E5%A5%87%E5%81%B6%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.1.5.3 å¥‡å¶æµæ°´ç¯</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-5-4-%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.1.5.4 æŒ‰é”®æ§åˆ¶æµæ°´ç¯</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E8%9C%82%E9%B8%A3%E5%99%A8"><span class="toc-text">2.2 èœ‚é¸£å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E8%9C%82%E9%B8%A3%E5%99%A8%E9%A9%B1%E5%8A%A8%E4%BB%A3%E7%A0%81"><span class="toc-text">2.2.1 èœ‚é¸£å™¨é©±åŠ¨ä»£ç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E8%9C%82%E9%B8%A3%E5%99%A8%E9%B8%A3%E5%8F%AB"><span class="toc-text">2.2.2 èœ‚é¸£å™¨é¸£å«</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E6%8E%A7%E5%88%B6%E8%9C%82%E9%B8%A3%E5%99%A8"><span class="toc-text">2.2.3 æ§åˆ¶èœ‚é¸£å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-%E8%9C%82%E9%B8%A3%E5%99%A8-LED%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B"><span class="toc-text">2.2.4 èœ‚é¸£å™¨+LEDå®é™…æ¡ˆä¾‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-%E6%95%B0%E7%A0%81%E7%AE%A1"><span class="toc-text">2.3 æ•°ç ç®¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-%E6%95%B0%E7%A0%81%E7%AE%A1%E5%8E%9F%E7%90%86"><span class="toc-text">2.3.1 æ•°ç ç®¡åŸç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-%E9%9D%99%E6%80%81%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA"><span class="toc-text">2.3.2 é™æ€æ•°ç ç®¡æ˜¾ç¤º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-%E5%8A%A8%E6%80%81%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA"><span class="toc-text">2.3.3 åŠ¨æ€æ•°ç ç®¡æ˜¾ç¤º</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-4%E5%8F%AA%E6%95%B0%E7%A0%81%E7%AE%A1%E6%BB%9A%E5%8A%A8%E6%98%BE%E7%A4%BA0-3"><span class="toc-text">2.3.4 4åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º0~3</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-4-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.3.4.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-4-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.3.4.2 ä»¿çœŸ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5-8%E5%8F%AA%E6%95%B0%E7%A0%81%E7%AE%A1%E6%BB%9A%E5%8A%A8%E6%98%BE%E7%A4%BA8-F"><span class="toc-text">2.3.5 8åªæ•°ç ç®¡æ»šåŠ¨æ˜¾ç¤º8~F</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-5-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.3.5.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-5-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.3.5.2 ä»¿çœŸ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-6-8%E5%8F%AA%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%90%8C%E5%AD%97%E7%AC%A6"><span class="toc-text">2.3.6 8åªæ•°ç ç®¡æ˜¾ç¤ºä¸åŒå­—ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-6-1-%E6%BA%90%E7%A0%81"><span class="toc-text">2.3.6.1 æºç </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-6-2-%E4%BB%BF%E7%9C%9F"><span class="toc-text">2.3.6.2 ä»¿çœŸ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-%E7%8B%AC%E7%AB%8B%E6%8C%89%E9%94%AE"><span class="toc-text">2.4 ç‹¬ç«‹æŒ‰é”®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-%E6%8C%89%E4%B8%8B%E6%8C%89%E9%94%AELED%E5%B0%8F%E7%81%AF%E4%BA%AE"><span class="toc-text">2.4.1 æŒ‰ä¸‹æŒ‰é”®LEDå°ç¯äº®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-2-%E6%8C%89%E9%94%AE%E6%8C%89%E4%B8%8B%E8%9C%82%E9%B8%A3%E5%99%A8%E9%B8%A3%E5%93%8D"><span class="toc-text">2.4.2 æŒ‰é”®æŒ‰ä¸‹èœ‚é¸£å™¨é¸£å“</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-3-%E6%B5%8B%E8%AF%95%E2%80%9C%E6%8C%89%E9%94%AE%E6%8C%89%E4%B8%8B%E6%97%B6P2-7%E7%9A%84%E7%8A%B6%E6%80%81%E2%80%9D%E6%8C%81%E7%BB%AD%E7%9A%84%E6%97%B6%E9%97%B4%E5%88%B0%E5%BA%95%E6%98%AF%E5%A4%9A%E9%95%BF"><span class="toc-text">2.4.3 æµ‹è¯•â€œæŒ‰é”®æŒ‰ä¸‹æ—¶P2.7çš„çŠ¶æ€â€æŒç»­çš„æ—¶é—´åˆ°åº•æ˜¯å¤šé•¿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-4-%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E7%81%AF%E4%BA%AE%E7%81%AF%E7%81%AD"><span class="toc-text">2.4.4 æŒ‰é”®æ§åˆ¶ç¯äº®ç¯ç­</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-5-%E4%B8%8D%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%E6%A8%A1%E5%BC%8F"><span class="toc-text">2.4.5 ä¸æ”¯æŒè¿æŒ‰æ¨¡å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-6-%E5%9B%9E%E5%BD%92%E6%8C%89%E9%94%AE"><span class="toc-text">2.4.6 å›å½’æŒ‰é”®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-7-%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89"><span class="toc-text">2.4.7 æ”¯æŒè¿æŒ‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-8-%E4%BC%98%E5%8C%96%E4%B8%8D%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-text">2.4.8 ä¼˜åŒ–ä¸æ”¯æŒè¿æŒ‰çš„ä»£ç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-9-%E5%8F%8C%E6%A8%A1%E5%BC%8F%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85"><span class="toc-text">2.4.9 åŒæ¨¡å¼å‡½æ•°å°è£…</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-10-%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B"><span class="toc-text">2.4.10 ç»¼åˆæ¡ˆä¾‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-5-%E5%A4%9A%E6%A8%A1%E5%9D%97%E7%BC%96%E7%A8%8B"><span class="toc-text">2.5 å¤šæ¨¡å—ç¼–ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-1-%E5%B8%A6%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E5%87%BD%E6%95%B0%EF%BC%88%E4%B8%8D%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%E7%9A%84%E6%8C%89%E9%94%AE%EF%BC%89"><span class="toc-text">2.5.1 å¸¦è¿”å›å€¼çš„å‡½æ•°ï¼ˆä¸æ”¯æŒè¿æŒ‰çš„æŒ‰é”®ï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-2-%E6%94%AF%E6%8C%81%E8%BF%9E%E6%8C%89%E7%9A%84%E6%8C%89%E9%94%AE"><span class="toc-text">2.5.2 æ”¯æŒè¿æŒ‰çš„æŒ‰é”®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-3-%E6%9C%80%E7%BB%88%E6%8C%89%E9%94%AE%E7%A8%8B%E5%BA%8F"><span class="toc-text">2.5.3 æœ€ç»ˆæŒ‰é”®ç¨‹åº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-4-%E6%9C%80%E7%BB%88%E7%9A%84Function%E6%96%87%E4%BB%B6"><span class="toc-text">2.5.4 æœ€ç»ˆçš„Functionæ–‡ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6-%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD"><span class="toc-text">2.6 å¤–éƒ¨ä¸­æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-1-IE0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">2.6.1 IE0çš„ä½œç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-2-%E4%B8%AD%E6%96%AD%E5%87%BD%E6%95%B0"><span class="toc-text">2.6.2 ä¸­æ–­å‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-3-%E5%A4%96%E9%83%A8%E4%B8%AD%E6%96%AD1"><span class="toc-text">2.6.3 å¤–éƒ¨ä¸­æ–­1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-4-%E6%8C%89%E9%94%AE%E6%8E%A7%E5%88%B6%E4%B8%AD%E6%96%AD"><span class="toc-text">2.6.4 æŒ‰é”®æ§åˆ¶ä¸­æ–­</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-7-%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-text">2.7 å®šæ—¶å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-1-%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E4%B8%80%E4%B9%8B%E6%B5%81%E6%B0%B4%E7%81%AF"><span class="toc-text">2.7.1 å·¥ä½œæ¨¡å¼ä¸€ä¹‹æµæ°´ç¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-2-%E5%AE%9A%E6%97%B6%E5%99%A8%E4%B8%AD%E6%96%AD"><span class="toc-text">2.7.2 å®šæ—¶å™¨ä¸­æ–­</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%8D%95%E7%89%87%E6%9C%BAC%E8%AF%AD%E8%A8%80"><span class="toc-text">ä¸‰ã€å•ç‰‡æœºCè¯­è¨€</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E7%89%B9%E6%AE%8A%E5%8A%9F%E8%83%BD%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8C%E4%BD%8D%E5%AE%9A%E4%B9%89"><span class="toc-text">3.1 ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨å’Œä½å®šä¹‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-sfr-P0-0x80"><span class="toc-text">3.1.1 sfr P0&#x3D;0x80</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-sbit-LED-P0-0"><span class="toc-text">3.1.2 sbit LED &#x3D; P0^0</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E5%8D%95%E7%89%87%E6%9C%BA%E7%9A%84%E7%89%B9%E6%AE%8A%E5%8A%9F%E8%83%BD%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text">3.1.3 å•ç‰‡æœºçš„ç‰¹æ®ŠåŠŸèƒ½å¯„å­˜å™¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Delay-%E5%87%BD%E6%95%B0"><span class="toc-text">3.2 Delay()å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-%E7%A9%BA%E6%93%8D%E4%BD%9C%E5%BE%AA%E7%8E%AF%E8%BF%90%E8%A1%8C%E7%9A%84%E6%97%B6%E9%97%B4"><span class="toc-text">3.2.1 ç©ºæ“ä½œå¾ªç¯è¿è¡Œçš„æ—¶é—´</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">3.2.2 å­˜åœ¨çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-3-%E8%AE%BE%E8%AE%A1%E7%B2%BE%E7%A1%AE%E7%9A%845s"><span class="toc-text">3.2.3 è®¾è®¡ç²¾ç¡®çš„5s</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-%E7%A7%BB%E4%BD%8D"><span class="toc-text">3.3 ç§»ä½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F"><span class="toc-text">3.4 é™æ€å˜é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-%E5%A4%9A%E6%96%87%E4%BB%B6%E7%BC%96%E7%A8%8B"><span class="toc-text">3.5 å¤šæ–‡ä»¶ç¼–ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-%E5%89%8D%E6%9C%9F%E8%AE%BE%E7%BD%AE"><span class="toc-text">3.5.1 å‰æœŸè®¾ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-%E7%A1%AC%E4%BB%B6%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">3.5.2 ç¡¬ä»¶çš„åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-3-%E5%B0%8F%E7%81%AF%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">3.5.3 å°ç¯çš„åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-4-function-h%E7%9A%84%E5%86%85%E5%AE%B9"><span class="toc-text">3.5.4 function.hçš„å†…å®¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-5-%E6%95%B0%E7%A0%81%E7%AE%A1%E6%98%BE%E7%A4%BA%E5%87%BD%E6%95%B0"><span class="toc-text">3.5.5 æ•°ç ç®¡æ˜¾ç¤ºå‡½æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-6-%E5%B8%A6%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">3.5.6 å¸¦è¿”å›å€¼çš„å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-typedef%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">3.6 typedefå…³é”®å­—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-%E6%8C%87%E9%92%88"><span class="toc-text">3.7 æŒ‡é’ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-1-%E6%8C%87%E9%92%88%E7%9A%84%E6%A6%82%E5%BF%B5%E4%B8%8E%E6%8C%87%E9%92%88%E5%8F%98%E9%87%8F%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="toc-text">3.7.1 æŒ‡é’ˆçš„æ¦‚å¿µä¸æŒ‡é’ˆå˜é‡çš„å£°æ˜</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7-1-1-%E5%8F%98%E9%87%8F%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-text">3.7.1.1 å˜é‡çš„åœ°å€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7-1-2-%E6%8C%87%E9%92%88%E5%8F%98%E9%87%8F%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="toc-text">3.7.1.2 æŒ‡é’ˆå˜é‡çš„å£°æ˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7-1-3-%E7%AE%80%E5%8D%95%E7%A4%BA%E4%BE%8B"><span class="toc-text">3.7.1.3 ç®€å•ç¤ºä¾‹</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-2-%E6%8C%87%E5%90%91%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0%E7%9A%84%E6%8C%87%E9%92%88"><span class="toc-text">3.7.2 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7-2-1-%E6%8C%87%E5%90%91%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0%E7%9A%84%E6%8C%87%E9%92%88%E5%92%8C%E8%BF%90%E7%AE%97%E6%B3%95%E5%88%99"><span class="toc-text">3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå’Œè¿ç®—æ³•åˆ™</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-7-2-1-%E6%8C%87%E5%90%91%E6%95%B0%E7%BB%84%E5%85%83%E7%B4%A0%E6%8C%87%E9%92%88%E7%9A%84%E5%AE%9E%E4%BE%8B"><span class="toc-text">3.7.2.1 æŒ‡å‘æ•°ç»„å…ƒç´ æŒ‡é’ˆçš„å®ä¾‹</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/4c7a50a7.html" title="NLPè°·æ­Œè¯­éŸ³æŒ‡ä»¤è®­ç»ƒå¤§ä½œä¸š"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/119.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="NLPè°·æ­Œè¯­éŸ³æŒ‡ä»¤è®­ç»ƒå¤§ä½œä¸š"/></a><div class="content"><a class="title" href="/post/4c7a50a7.html" title="NLPè°·æ­Œè¯­éŸ³æŒ‡ä»¤è®­ç»ƒå¤§ä½œä¸š">NLPè°·æ­Œè¯­éŸ³æŒ‡ä»¤è®­ç»ƒå¤§ä½œä¸š</a><time datetime="2024-04-29T21:13:00.000Z" title="å‘è¡¨äº 2024-04-29 21:13:00">2024-04-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/f229dda1.html" title="å¤šå¡å¹¶è¡Œ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/118.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å¤šå¡å¹¶è¡Œ"/></a><div class="content"><a class="title" href="/post/f229dda1.html" title="å¤šå¡å¹¶è¡Œ">å¤šå¡å¹¶è¡Œ</a><time datetime="2024-04-17T16:25:00.000Z" title="å‘è¡¨äº 2024-04-17 16:25:00">2024-04-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/3f67bb24.html" title="æ˜¯æ°´è¯¾è¿˜æ˜¯æ°´äº†è¯¾ï¼Ÿ-ä¸€ä¸ªåœ¨å½¹å¤§å­¦ç”Ÿå¯¹â€œæ°´è¯¾â€çš„çœ‹æ³•"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/117.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æ˜¯æ°´è¯¾è¿˜æ˜¯æ°´äº†è¯¾ï¼Ÿ-ä¸€ä¸ªåœ¨å½¹å¤§å­¦ç”Ÿå¯¹â€œæ°´è¯¾â€çš„çœ‹æ³•"/></a><div class="content"><a class="title" href="/post/3f67bb24.html" title="æ˜¯æ°´è¯¾è¿˜æ˜¯æ°´äº†è¯¾ï¼Ÿ-ä¸€ä¸ªåœ¨å½¹å¤§å­¦ç”Ÿå¯¹â€œæ°´è¯¾â€çš„çœ‹æ³•">æ˜¯æ°´è¯¾è¿˜æ˜¯æ°´äº†è¯¾ï¼Ÿ-ä¸€ä¸ªåœ¨å½¹å¤§å­¦ç”Ÿå¯¹â€œæ°´è¯¾â€çš„çœ‹æ³•</a><time datetime="2024-01-21T09:35:00.000Z" title="å‘è¡¨äº 2024-01-21 09:35:00">2024-01-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/d0edc1ed.html" title="Linuxå¸¸ç”¨å‘½ä»¤"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/116.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Linuxå¸¸ç”¨å‘½ä»¤"/></a><div class="content"><a class="title" href="/post/d0edc1ed.html" title="Linuxå¸¸ç”¨å‘½ä»¤">Linuxå¸¸ç”¨å‘½ä»¤</a><time datetime="2024-01-17T17:10:00.000Z" title="å‘è¡¨äº 2024-01-17 17:10:00">2024-01-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/44edbf80.html" title="ç‰¹å¾é‡‘å­—å¡”-FPNç½‘ç»œ3Dç‰ˆæœ¬"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.gan1ser.top/post/115.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ç‰¹å¾é‡‘å­—å¡”-FPNç½‘ç»œ3Dç‰ˆæœ¬"/></a><div class="content"><a class="title" href="/post/44edbf80.html" title="ç‰¹å¾é‡‘å­—å¡”-FPNç½‘ç»œ3Dç‰ˆæœ¬">ç‰¹å¾é‡‘å­—å¡”-FPNç½‘ç»œ3Dç‰ˆæœ¬</a><time datetime="2024-01-16T22:14:00.000Z" title="å‘è¡¨äº 2024-01-16 22:14:00">2024-01-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="shine-footer-bar"><div class="footer-logo"><i class="iconfont icon-GanSer" style="width: 2.5em; height: 1.5em; margin-right: 4px;"><use xlink:href="#icon-GanSer"></use></i></div><div class="footer-bar-description">æ¥è‡ª GanSer - ç´«ç®«åŸæ–­,ç´ ç¬ºæ¨åˆ‡ğŸ’•</div><a class="footer-bar-link" data-pjax-state="" href="/">äº†è§£æ›´å¤š</a></div><div id="footer_deal"><a class="deal_link" href="mailto:1742158140@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://weibo.com/u/7793068106" title="å¾®åš"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://www.facebook.com/profile.php?id=124072204066287&amp;sk=about" title="facebook"><i class="anzhiyufont anzhiyu-icon-facebook1"></i></a><img class="footer_mini_logo" title="è¿”å›é¡¶éƒ¨" onclick="anzhiyu.scrollToDest(0, 500)" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg" size="50px"/><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/Gan1Ser/" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/628891869" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://v.douyin.com/iXbJbQ9/" title="æŠ–éŸ³"><i class="anzhiyufont anzhiyu-icon-tiktok"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">æœåŠ¡</div><div class="footer-links"><a class="footer-item" title="51laç»Ÿè®¡" target="_blank" href="https://v6.51.la/">51laç»Ÿè®¡</a><a class="footer-item" title="åå¹´ä¹‹çº¦" target="_blank" href="https://www.foreverblog.cn/">åå¹´ä¹‹çº¦</a><a class="footer-item" title="å¼€å¾€" target="_blank" href="https://github.com/travellings-link/travellings">å¼€å¾€</a></div></div><div class="footer-group"><div class="footer-title">ä¸»é¢˜</div><div class="footer-links"><a class="footer-item" title="æ–‡æ¡£" target="_blank" href="https://blog.anheyu.com/docs/">æ–‡æ¡£</a><a class="footer-item" title="æºç " target="_blank" href="https://github.com/Gan1Ser/Gan1Ser.github.io">æºç </a><a class="footer-item" title="æ›´æ–°æ—¥å¿—" target="_blank" href="/update/">æ›´æ–°æ—¥å¿—</a></div></div><div class="footer-group"><div class="footer-title">å¯¼èˆª</div><div class="footer-links"><a class="footer-item" title="å³åˆ»çŸ­æ–‡" target="_blank" href="/essay/">å³åˆ»çŸ­æ–‡</a><a class="footer-item" title="å‹é“¾æ–‡ç« " target="_blank" href="/fcircle/">å‹é“¾æ–‡ç« </a><a class="footer-item" title="ç•™è¨€æ¿" target="_blank" href="/comments/">ç•™è¨€æ¿</a></div></div><div class="footer-group"><div class="footer-title">åè®®</div><div class="footer-links"><a class="footer-item" title="éšç§åè®®" target="_blank" href="/privacy/">éšç§åè®®</a><a class="footer-item" title="Cookies" target="_blank" href="/cookies/">Cookies</a><a class="footer-item" title="ç‰ˆæƒåè®®" target="_blank" href="/copyright/">ç‰ˆæƒåè®®</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">å‹é“¾</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="æ¢ä¸€æ‰¹å‹æƒ…é“¾æ¥"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><div class="copyright">&copy;2022 - 2024 By GanSer</div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0" title="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="åšå®¢æ¡†æ¶ä¸ºHexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://anheyu.com/" style="margin-inline:5px" data-title="æœ¬ç«™ä½¿ç”¨AnZhiYuä¸»é¢˜" title="æœ¬ç«™ä½¿ç”¨AnZhiYuä¸»é¢˜"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="æœ¬ç«™ä½¿ç”¨AnZhiYuä¸»é¢˜"/></a><a class="github-badge" target="_blank" href="https://www.dogecloud.com/" style="margin-inline:5px" data-title="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ" title="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/CDN-å¤šå‰äº‘-3693F3.svg" alt="æœ¬ç«™ä½¿ç”¨å¤šå‰äº‘ä¸ºé™æ€èµ„æºæä¾›CDNåŠ é€Ÿ"/></a><a class="github-badge" target="_blank" href="https://beian.miit.gov.cn/" style="margin-inline:5px" data-title="æœ¬ç«™å·²åœ¨è±«è¿›è¡Œå¤‡æ¡ˆ" title="æœ¬ç«™å·²åœ¨è±«è¿›è¡Œå¤‡æ¡ˆ"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/65140754c458853aef47c0b4.jpg" alt="æœ¬ç«™å·²åœ¨è±«è¿›è¡Œå¤‡æ¡ˆ"/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡" title="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="æœ¬ç«™é¡¹ç›®ç”±Githubæ‰˜ç®¡"/></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.2.0/img/badge/Copyright-BY-NC-SA.svg" alt="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"/></a></p></div></footer></div></div></div><div id="sidebar"><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic.imgdb.cn/item/63f16cddf144a010070697c8.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">æ–‡ç« </div><div class="length-num">126</div></a><a href="/tags/" title="tag"><div class="headline">æ ‡ç­¾</div><div class="length-num">29</div></a><a href="/categories/" title="category"><div class="headline">åˆ†ç±»</div><div class="length-num">31</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æ–‡ç« </span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> éš§é“</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/memos/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> å³åˆ»çŸ­æ–‡</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> æ ‡ç­¾</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å‹é“¾</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size: 0.9em;"></i><span> æœ‹å‹åœˆ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> ç•™è¨€æ¿</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> æˆ‘çš„</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=7750616521&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> éŸ³ä¹é¦†</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/collect/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> å½±æ¼«ä½³é€‰</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/album/"><i class="anzhiyufont anzhiyu-icon-images faa-tada" style="font-size: 0.9em;"></i><span> ç›¸å†Œé›†</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><span> å…³äº</span></a><ul class="menus_item_child" style="left:-79px;"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> å…³äºæœ¬äºº</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/todolist/"><i class="anzhiyufont anzhiyu-icon-lightbulb faa-tada" style="font-size: 0.9em;"></i><span> å¾…åŠæ¸…å•</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> éšä¾¿é€›é€›</span></a></li></ul></div></div></div></div><div id="keyboard-tips"><div class="keyboardTitle">åšå®¢å¿«æ·é”®</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">shift K</div></div><div class="keyContent"><div class="content">å…³é—­å¿«æ·é”®åŠŸèƒ½</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift A</div></div><div class="keyContent"><div class="content">æ‰“å¼€ä¸­æ§å°</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift M</div></div><div class="keyContent"><div class="content">æ’­æ”¾/æš‚åœéŸ³ä¹</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift D</div></div><div class="keyContent"><div class="content">æ·±è‰²/æµ…è‰²æ˜¾ç¤ºæ¨¡å¼</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift S</div></div><div class="keyContent"><div class="content">ç«™å†…æœç´¢</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift R</div></div><div class="keyContent"><div class="content">éšæœºè®¿é—®</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift H</div></div><div class="keyContent"><div class="content">è¿”å›é¦–é¡µ</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift F</div></div><div class="keyContent"><div class="content">å‹é“¾é±¼å¡˜</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift L</div></div><div class="keyContent"><div class="content">å‹é“¾é¡µé¢</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift P</div></div><div class="keyContent"><div class="content">å…³äºæœ¬ç«™</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">shift I</div></div><div class="keyContent"><div class="content">åŸç‰ˆå³é”®èœå•</div></div></div></div></div><script>var anzhiyu_intype = false
var anzhiyu_keyUpEvent_timeoutId = null
var anzhiyu_keyUpShiftDelayEvent_timeoutId = null
function addKeyShotListener() {
  const windowObject = window;
  windowObject.removeEventListener("keydown", keyDownEvent);
  windowObject.removeEventListener("keyup", keyUpEvent);
  windowObject.addEventListener("keydown", keyDownEvent);
  windowObject.addEventListener("keyup", keyUpEvent);
}

function keyDownEvent(event) {
  const isEscapeKeyPressed = event.keyCode === 27;
  const isShiftKeyPressed = event.shiftKey;
  const isKeyboardEnabled = anzhiyu_keyboard;
  const isInInputField = anzhiyu_intype;

  if (isEscapeKeyPressed) {
    anzhiyu.hideLoading();
    anzhiyu.hideConsole();
    rm.hideRightMenu();
  }

  if (isKeyboardEnabled && isShiftKeyPressed && !isInInputField) {
    anzhiyu_keyUpShiftDelayEvent_timeoutId = setTimeout(()=>{
      switch (event.keyCode) {
        case 16:
          anzhiyu_keyUpEvent_timeoutId = setTimeout(()=>{
            document.querySelector("#keyboard-tips").classList.add("show");
          }, 200);
          break;
        case 65:
          anzhiyu.showConsole();
          break;
        case 77:
          anzhiyu.musicToggle();
          break;
        case 75:
          anzhiyu.keyboardToggle();
          break;
        case 73:
          anzhiyu.rightMenuToggle();
          break;
        case 82:
          toRandomPost();
          break;
        case 72:
          pjax.loadUrl("/");
          break;
        case 68:
          anzhiyu.switchDarkMode();
          break;
        case 70:
          pjax.loadUrl("/fcircle/");
          break;
        case 76:
          pjax.loadUrl("/link/");
          break;
        case 80:
          pjax.loadUrl("/about/");
          break;
        default:
          break;
      }

      event.preventDefault();
    }, 100);
  }
}

addKeyShotListener();

window.onfocus = function() {
  document.getElementById("keyboard-tips").classList.remove("show")
}

function setInputFocusListener() {
  const inputs = document.querySelectorAll("input, textarea");

  inputs.forEach((input) => {
    input.addEventListener("focus", () => {
      setAnzhiyuIntype(true);
    });

    input.addEventListener("blur", () => {
      setAnzhiyuIntype(false);
    });
  });
}

function setanzhiyuIntype(value) {
  anzhiyu_intype = value;
}

function keyUpEvent(event) {
  anzhiyu_keyUpEvent_timeoutId && clearTimeout(anzhiyu_keyUpEvent_timeoutId);
  anzhiyu_keyUpShiftDelayEvent_timeoutId && clearTimeout(anzhiyu_keyUpShiftDelayEvent_timeoutId);
  if (event.keyCode === 16) {
    const keyboardTips = document.querySelector("#keyboard-tips");
    keyboardTips.classList.remove("show");
  }
}

function listenToPageInputPress() {
  const inputElement = document.getElementById("toPageText");
  const buttonElement = document.getElementById("toPageButton");

  if (!inputElement) {
    return;
  }

  inputElement.addEventListener("keydown", (event) => {
    if (event.keyCode === 13) {
      event.preventDefault();
      anzhiyu.toPage();
      pjax.loadUrl(buttonElement.href);
    }
  });

  inputElement.addEventListener("input", () => {
    const value = inputElement.value;
    if (!value || value === "0") {
      buttonElement.classList.remove("haveValue");
    } else {
      buttonElement.classList.add("haveValue");
    }

    const pageNumbers = document.querySelectorAll(".page-number");
    const maxPageNumber = +pageNumbers[pageNumbers.length - 1].innerHTML;

    if (+value > maxPageNumber) {
      inputElement.value = maxPageNumber;
    }
  });
}

setInputFocusListener()</script><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch_commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="å¼€å…³å¼¹å¹•"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">æ’­æ”¾éŸ³ä¹</a><div id="console-music-bg"></div><meting-js id="7750616521" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶é€‰ä¸­æ–‡æœ¬</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>ç²˜è´´æ–‡æœ¬</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>å¼•ç”¨åˆ°è¯„è®º</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>å¤åˆ¶é“¾æ¥åœ°å€</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>å¤åˆ¶æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>ä¸‹è½½æ­¤å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>æ–°çª—å£æ‰“å¼€å›¾ç‰‡</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç«™å†…æœç´¢</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>ç™¾åº¦æœç´¢</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>æ’­æ”¾éŸ³ä¹</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>åˆ‡æ¢åˆ°ä¸Šä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>åˆ‡æ¢åˆ°ä¸‹ä¸€é¦–</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>æŸ¥çœ‹æ‰€æœ‰æ­Œæ›²</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶æ­Œå</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>éšä¾¿é€›é€›</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>åšå®¢åˆ†ç±»</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>æ–‡ç« æ ‡ç­¾</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>å¤åˆ¶åœ°å€</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">å…³é—­çƒ­è¯„</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">æ·±è‰²æ¨¡å¼</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>è½‰ç‚ºç¹é«”</span></a></div></div><div id="rightmenu-mask"></div><div><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.4.0/source/js/utils.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.4.0/source/js/main.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.4.0/source/js/tw_cn.js"></script><script src="https://npm.elemecdn.com/@fancyapps/ui@4.0.31/dist/fancybox.umd.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// æ¶ˆé™¤æ§åˆ¶å°æ‰“å°
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //åœ¨æ¢å¤å‰è¾“å‡ºæ—¥å¿—
  const grt = new Date("04/01/2021 00:00:00"); //æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´æˆ–è€…ç½‘ç«™ä¸Šçº¿æ—¶é—´
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `æ¬¢è¿ä½¿ç”¨å®‰çŸ¥é±¼!`,
    `ç”Ÿæ´»æ˜æœ—, ä¸‡ç‰©å¯çˆ±`,
    `
        
       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—
      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘
      â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
      â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•   â•šâ•â•    â•šâ•â•â•â•â•â•
        
        `,
    "å·²ä¸Šçº¿",
    dnum,
    "å¤©",
    "Â©2022 By å®‰çŸ¥é±¼ 1.4.0",
  ];
  const ascll2 = [`NCC2-036`, `è°ƒç”¨å‰ç½®æ‘„åƒå¤´æ‹ç…§æˆåŠŸï¼Œè¯†åˆ«ä¸ºã€å°ç¬¨è›‹ã€‘.`, `Photo captured: `, `ğŸ¤ª`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#465855",
      "",
      "color:#465855",
      "color:#465855",
      "",
      "color:#465855",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c ä½ å¥½ï¼Œå°ç¬¨è›‹.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c âš¡ Powered by å®‰çŸ¥é±¼ %c ä½ æ­£åœ¨è®¿é—® GanSer çš„åšå®¢.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c ä½ å·²æ‰“å¼€æ§åˆ¶å°.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c ä½ ç°åœ¨æ­£å¤„äºç›‘æ§ä¸­.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><script src="https://npm.elemecdn.com/algoliasearch@4.14.2/dist/algoliasearch-lite.umd.js"></script><script src="https://npm.elemecdn.com/instantsearch.js@4.46.1/dist/instantsearch.production.min.js"></script><script src="https://npm.elemecdn.com/hexo-theme-anzhiyu@1.4.0/source/js/search/algolia.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://npm.elemecdn.com/mathjax@3.2.2/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://twikoo.gan1ser.top/',
      region: '',
      onCommentLoaded: function () {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.gan1ser.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init();
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/twikoo/1.4.18/twikoo.all.min.js').then(runFn)
  }
  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[å›¾ç‰‡]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[é“¾æ¥]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[ä»£ç ]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://twikoo.gan1ser.top/',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.innerHTML= "æ— æ³•è·å–è¯„è®ºï¼Œè¯·ç¡®è®¤ç›¸å…³é…ç½®æ˜¯å¦æ­£ç¡®"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/twikoo/1.4.18/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick}</span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += 'æ²¡æœ‰è¯„è®º'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom.innerHTML= result
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "1742158140@qq.com";</script><script>//åŠ¨æ€æ ‡é¢˜
let leaveTitle = 'w(ï¾ŸĞ”ï¾Ÿ)w ä¸è¦èµ°ï¼å†çœ‹çœ‹å˜›ï¼';
let backTitle = 'â™ª(^âˆ‡^*)æ¬¢è¿è‚¥æ¥ï¼';
let OriginTitile = document.title
let titleTime
document.addEventListener('visibilitychange', function () {
  if (document.hidden) {
    //ç¦»å¼€å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹
    document.title = leaveTitle
    clearTimeout(titleTime)
  } else {
    //è¿”å›å½“å‰é¡µé¢æ—¶æ ‡ç­¾æ˜¾ç¤ºå†…å®¹
    document.title = backTitle + OriginTitile
    //ä¸¤ç§’åå˜å›æ­£å¸¸æ ‡é¢˜
    titleTime = setTimeout(function () {
      document.title = OriginTitile
    }, 2000)
  }
})</script><script data-pjax="true">if (document.querySelector(".comment-barrage")){
  var commentBarrageConfig = {
    maxBarrage: 1,
    barrageTime: 4000,
    twikooUrl: "https://twikoo.gan1ser.top/",
    accessToken: "034aa2035fc6c553efefed34b8041214",
    mailMd5: "",
    pageUrl: window.location.pathname,
    barrageTimer: [],
    barrageList: [],
    barrageIndex: 0,
    dom: document.querySelector(".comment-barrage"),
  };
  var commentInterval = null;
  var hoverOnCommentBarrage = false;
  
  document.querySelector(".comment-barrage").addEventListener("mouseenter", function() {
    hoverOnCommentBarrage = true;
  });
  document.querySelector(".comment-barrage").addEventListener("mouseleave", function() {
    hoverOnCommentBarrage = false;
  });

  function initCommentBarrage() {
    if (!commentBarrageConfig.dom) return;

    var data = JSON.stringify({
      event: "COMMENT_GET",
      "commentBarrageConfig.accessToken": commentBarrageConfig.accessToken,
      url: commentBarrageConfig.pageUrl,
    });
    var xhr = new XMLHttpRequest();
    xhr.withCredentials = true;
    xhr.addEventListener("readystatechange", function () {
      if (this.readyState === 4 && this.responseText) {
        commentBarrageConfig.barrageList = commentLinkFilter(JSON.parse(this.responseText).data);
        commentBarrageConfig.dom.innerHTML = "";
      }
    });
    xhr.open("POST", commentBarrageConfig.twikooUrl);
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.send(data);

    clearInterval(commentInterval);
    commentInterval = null;

    commentInterval = setInterval(() => {
      if (commentBarrageConfig.barrageList.length && !hoverOnCommentBarrage) {
        popCommentBarrage(commentBarrageConfig.barrageList[commentBarrageConfig.barrageIndex]);
        commentBarrageConfig.barrageIndex += 1;
        commentBarrageConfig.barrageIndex %= commentBarrageConfig.barrageList.length;
      }
      if (
        commentBarrageConfig.barrageTimer.length >
          (commentBarrageConfig.barrageList.length > commentBarrageConfig.maxBarrage
            ? commentBarrageConfig.maxBarrage
            : commentBarrageConfig.barrageList.length) &&
        !hoverOnCommentBarrage
      ) {
        removeCommentBarrage(commentBarrageConfig.barrageTimer.shift());
      }
    }, commentBarrageConfig.barrageTime);
  }

  function commentLinkFilter(data) {
    data.sort((a, b) => {
      return a.created - b.created;
    });
    let newData = [];
    data.forEach(item => {
      newData.push(...getCommentReplies(item));
    });
    return newData;
  }

  function getCommentReplies(item) {
    if (item.replies) {
      let replies = [item];
      item.replies.forEach(item => {
        replies.push(...getCommentReplies(item));
      });
      return replies;
    } else {
      return [];
    }
  }

  function popCommentBarrage(data) {
    let barrage = document.createElement("div");
    barrage.className = "comment-barrage-item";
    barrage.innerHTML = `
        <div class="barrageHead">
          <a class="barrageTitle ${
            data.mailMd5 === commentBarrageConfig.mailMd5 ? "barrageBloggerTitle" : ""
          }" href="javascript:anzhiyu.scrollTo('#post-comment')"">
            ${data.mailMd5 === commentBarrageConfig.mailMd5 ? "åšä¸»" : "çƒ­è¯„"}
          </a>
          <div class="barrageNick">${data.nick}</div>
          <img class="nolazyload barrageAvatar" src="https://cravatar.cn/avatar/${data.mailMd5}"/>
          <a class="comment-barrage-close" href="javascript:anzhiyu.switchCommentBarrage()"><i class="anzhiyufont anzhiyu-icon-xmark"></i></a>
        </div>
        <a class="barrageContent" href="#${data.id}">
          <object>${data.comment}</object>
        </a>
      `;
    commentBarrageConfig.barrageTimer.push(barrage);
    commentBarrageConfig.dom.append(barrage);
  }

  function removeCommentBarrage(barrage) {
    barrage.className = "comment-barrage-item out";

    setTimeout(() => {
      if (commentBarrageConfig.dom && commentBarrageConfig.dom.contains(barrage)) {
        commentBarrageConfig.dom.removeChild(barrage);
      }
      }, 1000);
    }

    // è‡ªåŠ¨éšè—
    const commentEntryCallback = (entries) => {
      const commentBarrage = document.querySelector(".comment-barrage");
      const postComment = document.getElementById("post-comment");

      entries.forEach(entry => {
        if (postComment && commentBarrage && document.body.clientWidth > 768) {
          commentBarrage.style.bottom = entry.isIntersecting ? "-200px" : "0";
        }
      });
    };
    // åˆ›å»ºIntersectionObserverå®ä¾‹
    const observer = new IntersectionObserver(commentEntryCallback, {
      root: null,
      rootMargin: "0px",
      threshold: 0
    });
    // ç›‘è§†ç›®æ ‡å…ƒç´ 
    const postCommentTarget = document.getElementById("post-comment");
    if (postCommentTarget) {
      observer.observe(postCommentTarget);
    }

    initCommentBarrage();

    if (localStorage.getItem("commentBarrageSwitch") !== "false") {
      document.querySelector(".comment-barrage").style.display = "flex";
      document.querySelector(".menu-commentBarrage-text").textContent = "å…³é—­çƒ­è¯„";
    } else {
      document.querySelector(".comment-barrage").style.display = "none";
      document.querySelector(".menu-commentBarrage-text").textContent = "æ˜¾ç¤ºçƒ­è¯„";
    }

    document.addEventListener("pjax:send", function () {
      clearInterval(commentInterval);
    });

  }</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script>// åˆå§‹åŒ–å‡½æ•°
let rm = {};

//ç¦æ­¢å›¾ç‰‡ä¸è¶…é“¾æ¥æ‹–æ‹½
let aElements = document.getElementsByTagName("a");
for (let i = 0; i < aElements.length; i++) {
  aElements[i].setAttribute("draggable", "false");
  let imgElements = aElements[i].getElementsByTagName("img");
  for (let j = 0; j < imgElements.length; j++) {
    imgElements[j].setAttribute("draggable", "false");
  }
}

// æ˜¾ç¤ºèœå•
rm.showRightMenu = function (isTrue, x = 0, y = 0) {
  console.info(x, y)
  let rightMenu = document.getElementById("rightMenu");
  rightMenu.style.top = x + "px";
  rightMenu.style.left = y + "px";
  if (isTrue) {
    rightMenu.style.display = "block";
    stopMaskScroll();
  } else {
    rightMenu.style.display = "none";
  }
};

// éšè—èœå•
rm.hideRightMenu = function () {
  rm.showRightMenu(false);
  let rightMenuMask = document.querySelector("#rightmenu-mask");
  rightMenuMask.style.display = "none";
};

// å°ºå¯¸
let rmWidth = document.getElementById("rightMenu").offsetWidth;
let rmHeight = document.getElementById("rightMenu").offsetHeight;

// é‡æ–°å®šä¹‰å°ºå¯¸
rm.reloadrmSize = function () {
  rightMenu.style.visibility = "hidden";
  rightMenu.style.display = "block";
  // è·å–å®½åº¦å’Œé«˜åº¦
  rmWidth = document.getElementById("rightMenu").offsetWidth;
  rmHeight = document.getElementById("rightMenu").offsetHeight;
  rightMenu.style.visibility = "visible";
};

// è·å–ç‚¹å‡»çš„href
let domhref = "";
let domImgSrc = "";
let globalEvent = null;

var oncontextmenuFunction = function (event) {
  if (document.body.clientWidth > 768) {
    let pageX = event.clientX + 10; //åŠ 10æ˜¯ä¸ºäº†é˜²æ­¢æ˜¾ç¤ºæ—¶é¼ æ ‡é®åœ¨èœå•ä¸Š
    let pageY = event.clientY;

    //å…¶ä»–é¢å¤–èœå•
    const $rightMenuOther = document.querySelector(".rightMenuOther");
    const $rightMenuPlugin = document.querySelector(".rightMenuPlugin");
    const $rightMenuCopyText = document.querySelector("#menu-copytext");
    const $rightMenuPasteText = document.querySelector("#menu-pastetext");
    const $rightMenuCommentText = document.querySelector("#menu-commenttext");
    const $rightMenuNewWindow = document.querySelector("#menu-newwindow");
    const $rightMenuNewWindowImg = document.querySelector("#menu-newwindowimg");
    const $rightMenuCopyLink = document.querySelector("#menu-copylink");
    const $rightMenuCopyImg = document.querySelector("#menu-copyimg");
    const $rightMenuDownloadImg = document.querySelector("#menu-downloadimg");
    const $rightMenuSearch = document.querySelector("#menu-search");
    const $rightMenuSearchBaidu = document.querySelector("#menu-searchBaidu");
    const $rightMenuMusicToggle = document.querySelector("#menu-music-toggle");
    const $rightMenuMusicBack = document.querySelector("#menu-music-back");
    const $rightMenuMusicForward = document.querySelector("#menu-music-forward");
    const $rightMenuMusicPlaylist = document.querySelector("#menu-music-playlist");
    const $rightMenuMusicCopyMusicName = document.querySelector("#menu-music-copyMusicName");

    let href = event.target.href;
    let imgsrc = event.target.currentSrc;

    // åˆ¤æ–­æ¨¡å¼ æ‰©å±•æ¨¡å¼ä¸ºæœ‰äº‹ä»¶
    let pluginMode = false;
    $rightMenuOther.style.display = "block";
    globalEvent = event;

    // æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶ æ˜¯å¦æœ‰é€‰ä¸­æ–‡æœ¬
    if (selectTextNow && window.getSelection()) {
      pluginMode = true;
      $rightMenuCopyText.style.display = "block";
      $rightMenuCommentText.style.display = "block";
      $rightMenuSearch.style.display = "block";
      $rightMenuSearchBaidu.style.display = "block";
    } else {
      $rightMenuCopyText.style.display = "none";
      $rightMenuCommentText.style.display = "none";
      $rightMenuSearchBaidu.style.display = "none";
      $rightMenuSearch.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦å³é”®ç‚¹å‡»äº†é“¾æ¥aæ ‡ç­¾
    if (href) {
      pluginMode = true;
      $rightMenuNewWindow.style.display = "block";
      $rightMenuCopyLink.style.display = "block";
      domhref = href;
    } else {
      $rightMenuNewWindow.style.display = "none";
      $rightMenuCopyLink.style.display = "none";
    }

    //æ£€æŸ¥æ˜¯å¦éœ€è¦å¤åˆ¶å›¾ç‰‡
    if (imgsrc) {
      pluginMode = true;
      $rightMenuCopyImg.style.display = "block";
      $rightMenuDownloadImg.style.display = "block";
      $rightMenuNewWindowImg.style.display = "block";
      document.getElementById("rightMenu").style.width="12rem"
      domImgSrc = imgsrc;
    } else {
      $rightMenuCopyImg.style.display = "none";
      $rightMenuDownloadImg.style.display = "none";
      $rightMenuNewWindowImg.style.display = "none";
    }

    // åˆ¤æ–­æ˜¯å¦ä¸ºè¾“å…¥æ¡†
    if (event.target.tagName.toLowerCase() === "input" || event.target.tagName.toLowerCase() === "textarea") {
      pluginMode = true;
      $rightMenuPasteText.style.display = "block";
    } else {
      $rightMenuPasteText.style.display = "none";
    }
    const navMusicEl = document.querySelector("#nav-music");
    //åˆ¤æ–­æ˜¯å¦æ˜¯éŸ³ä¹
    if (navMusicEl && navMusicEl.contains(event.target)) {
      pluginMode = true;
      $rightMenuMusicToggle.style.display = "block";
      $rightMenuMusicBack.style.display = "block";
      $rightMenuMusicForward.style.display = "block";
      $rightMenuMusicPlaylist.style.display = "block";
      $rightMenuMusicCopyMusicName.style.display = "block";
    } else {
      $rightMenuMusicToggle.style.display = "none";
      $rightMenuMusicBack.style.display = "none";
      $rightMenuMusicForward.style.display = "none";
      $rightMenuMusicPlaylist.style.display = "none";
      $rightMenuMusicCopyMusicName.style.display = "none";
    }

    // å¦‚æœä¸æ˜¯æ‰©å±•æ¨¡å¼åˆ™éšè—æ‰©å±•æ¨¡å—
    if (pluginMode) {
      $rightMenuOther.style.display = "none";
      $rightMenuPlugin.style.display = "block";
    } else {
      $rightMenuPlugin.style.display = "none";
    }

    rm.reloadrmSize();

    // é¼ æ ‡é»˜è®¤æ˜¾ç¤ºåœ¨é¼ æ ‡å³ä¸‹æ–¹ï¼Œå½“é¼ æ ‡é å³æˆ–é ä¸‹æ—¶ï¼Œå°†èœå•æ˜¾ç¤ºåœ¨é¼ æ ‡å·¦æ–¹\ä¸Šæ–¹
    if (pageX + rmWidth > window.innerWidth) {
      pageX -= rmWidth + 10;
    }
    if (pageY + rmHeight > window.innerHeight) {
      pageY -= pageY + rmHeight - window.innerHeight;
    }

    rm.showRightMenu(true, pageY, pageX);
    document.getElementById("rightmenu-mask").style.display = "flex";
    return false;
  }
};

// ç›‘å¬å³é”®åˆå§‹åŒ–
window.oncontextmenu = oncontextmenuFunction

// ä¸‹è½½å›¾ç‰‡çŠ¶æ€
rm.downloadimging = false;

// å¤åˆ¶å›¾ç‰‡åˆ°å‰ªè´´æ¿
rm.writeClipImg = function (imgsrc) {
  console.log("æŒ‰ä¸‹å¤åˆ¶");
  rm.hideRightMenu();
  anzhiyu.snackbarShow("æ­£åœ¨ä¸‹è½½ä¸­ï¼Œè¯·ç¨å", false, 10000);
  if (rm.downloadimging == false) {
    rm.downloadimging = true;
    setTimeout(function () {
      copyImage(imgsrc);
      anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼å›¾ç‰‡å·²æ·»åŠ ç›²æ°´å°ï¼Œè¯·éµå®ˆç‰ˆæƒåè®®");
      rm.downloadimging = false;
    }, "10000");
  }
};

function imageToBlob(imageURL) {
  const img = new Image();
  const c = document.createElement("canvas");
  const ctx = c.getContext("2d");
  img.crossOrigin = "";
  img.src = imageURL;
  return new Promise(resolve => {
    img.onload = function () {
      c.width = this.naturalWidth;
      c.height = this.naturalHeight;
      ctx.drawImage(this, 0, 0);
      c.toBlob(
        blob => {
          // here the image is a blob
          resolve(blob);
        },
        "image/png",
        0.75
      );
    };
  });
}

async function copyImage(imageURL) {
  const blob = await imageToBlob(imageURL);
  const item = new ClipboardItem({ "image/png": blob });
  navigator.clipboard.write([item]);
}

rm.copyUrl = function (id) {
  const input = document.createElement("input"); // Create a new <input> element
  input.id = "copyVal"; // Set the id of the new element to "copyVal"
  document.body.appendChild(input); // Append the new element to the end of the <body> element
  
  const text = id;
  input.value = text;
  input.select();
  input.setSelectionRange(0, input.value.length);
  document.execCommand("copy");
  
  input.remove(); // Remove the <input> element from the DOM
};

function stopMaskScroll() {
  if (document.getElementById("rightmenu-mask")) {
    let xscroll = document.getElementById("rightmenu-mask");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
  if (document.getElementById("rightMenu")) {
    let xscroll = document.getElementById("rightMenu");
    xscroll.addEventListener(
      "mousewheel",
      function (e) {
        //é˜»æ­¢æµè§ˆå™¨é»˜è®¤æ–¹æ³•
        rm.hideRightMenu();
        // e.preventDefault();
      },
      { passive: true }
    );
  }
}

rm.rightmenuCopyText = function (txt) {
  if (navigator.clipboard) {
    navigator.clipboard.writeText(txt);
  }
  rm.hideRightMenu();
};

rm.copyPageUrl = function (url) {
  if (!url) {
    url = window.location.href;
  }
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

rm.sharePage = function () {
  var content = window.location.href;
  rm.copyUrl(url);
  anzhiyu.snackbarShow("å¤åˆ¶æœ¬é¡µé“¾æ¥åœ°å€æˆåŠŸ", false, 2000);
  rm.hideRightMenu();
};

// å¤åˆ¶å½“å‰é€‰ä¸­æ–‡æœ¬
var selectTextNow = "";
document.onmouseup = document.ondblclick = selceText;

function selceText() {
  var txt;
  if (document.selection) {
    txt = document.selection.createRange().text;
  } else {
    txt = window.getSelection().toString();
  }
  selectTextNow = txt !== "" ? txt : "";
}

// è¯»å–å‰ªåˆ‡æ¿
rm.readClipboard = function () {
  if (navigator.clipboard) {
    navigator.clipboard.readText().then(clipText => rm.insertAtCaret(globalEvent.target, clipText));
  }
};

// ç²˜è´´æ–‡æœ¬åˆ°ç„¦ç‚¹
rm.insertAtCaret = function (elemt, value) {
  const startPos = elemt.selectionStart,
    endPos = elemt.selectionEnd;
  if (document.selection) {
    elemt.focus();
    var sel = document.selection.createRange();
    sel.text = value;
    elemt.focus();
  } else {
    if (startPos || startPos == "0") {
      var scrollTop = elemt.scrollTop;
      elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);
      elemt.focus();
      elemt.selectionStart = startPos + value.length;
      elemt.selectionEnd = startPos + value.length;
      elemt.scrollTop = scrollTop;
    } else {
      elemt.value += value;
      elemt.focus();
    }
  }
};

//ç²˜è´´æ–‡æœ¬
rm.pasteText = function () {
  const result = rm.readClipboard() || "";
  rm.hideRightMenu();
};

//å¼•ç”¨åˆ°è¯„è®º
rm.rightMenuCommentText = function (txt) {
  rm.hideRightMenu();
  const postCommentDom = document.getElementById("post-comment");
  var domTop = postCommentDom.offsetTop;
  window.scrollTo(0, domTop - 80);
  if (txt == "undefined" || txt == "null") txt = "å¥½æ£’ï¼";
  function setText() {
    setTimeout(() => {
      var input = document.getElementsByClassName("el-textarea__inner")[0];
      if (!input) setText();
      let evt = document.createEvent("HTMLEvents");
      evt.initEvent("input", true, true);
      let inputValue = replaceAll(txt, "\n", "\n> ");
      input.value = "> " + inputValue + "\n\n";
      input.dispatchEvent(evt);
      input.focus();
      input.setSelectionRange(-1, -1);
      if (document.getElementById("comment-tips")) {
        document.getElementById("comment-tips").classList.add("show");
      }
    }, 100);
  }
  setText();
};

//æ›¿æ¢æ‰€æœ‰å†…å®¹
function replaceAll(string, search, replace) {
  return string.split(search).join(replace);
}

// ç™¾åº¦æœç´¢
rm.searchBaidu = function () {
  anzhiyu.snackbarShow("å³å°†è·³è½¬åˆ°ç™¾åº¦æœç´¢", false, 2000);
  setTimeout(function () {
    window.open("https://www.baidu.com/s?wd=" + selectTextNow);
  }, "2000");
  rm.hideRightMenu();
};

//åˆ†äº«é“¾æ¥
rm.copyLink = function () {
  rm.rightmenuCopyText(domhref);
  anzhiyu.snackbarShow("å·²å¤åˆ¶é“¾æ¥åœ°å€");
};

function addRightMenuClickEvent() {
  // æ·»åŠ ç‚¹å‡»äº‹ä»¶
  document.getElementById("menu-backward").addEventListener("click", function () {
  window.history.back();
    rm.hideRightMenu();
  });

  document.getElementById("menu-forward").addEventListener("click", function () {
    window.history.forward();
    rm.hideRightMenu();
  });

  document.getElementById("menu-refresh").addEventListener("click", function () {
    window.location.reload();
  });

  document.getElementById("menu-top").addEventListener("click", function () {
    anzhiyu.scrollToDest(0, 500);
    rm.hideRightMenu();
  });

  const menuLinks = document.querySelectorAll(".menu-link");
  menuLinks.forEach(function (link) {
    link.addEventListener("click", rm.hideRightMenu);
  });

  document.getElementById("menu-darkmode").addEventListener("click", anzhiyu.switchDarkMode);

  document.getElementById("menu-home") && document.getElementById("menu-home").addEventListener("click", function () {
    window.location.href = window.location.origin;
  });

  document.getElementById("menu-randomPost").addEventListener("click", function () {
    toRandomPost();
  });

  document.getElementById("menu-commentBarrage").addEventListener("click", anzhiyu.switchCommentBarrage);

  document.getElementById("rightmenu-mask").addEventListener("click", rm.hideRightMenu);

  document.getElementById("rightmenu-mask").addEventListener("contextmenu", function (event) {
    rm.hideRightMenu();
    event.preventDefault(); // Prevent the default context menu from appearing
  });

  document.getElementById("menu-copy").addEventListener("click", rm.copyPageUrl);

  document.getElementById("menu-pastetext").addEventListener("click", rm.pasteText);

  document.getElementById("menu-copytext").addEventListener("click", function () {
    rm.rightmenuCopyText(selectTextNow);
    anzhiyu.snackbarShow("å¤åˆ¶æˆåŠŸï¼Œå¤åˆ¶å’Œè½¬è½½è¯·æ ‡æ³¨æœ¬æ–‡åœ°å€");
  });

  document.getElementById("menu-commenttext").addEventListener("click", function () {
    rm.rightMenuCommentText(selectTextNow);
  });

  document.getElementById("menu-newwindow").addEventListener("click", function () {
    window.open(domhref, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copylink").addEventListener("click", rm.copyLink);

  document.getElementById("menu-downloadimg").addEventListener("click", function () {
    anzhiyu.downloadImage(domImgSrc, "anzhiyu");
  });

  document.getElementById("menu-newwindowimg").addEventListener("click", function () {
    window.open(domImgSrc, "_blank");
    rm.hideRightMenu();
  });

  document.getElementById("menu-copyimg").addEventListener("click", function () {
    rm.writeClipImg(domImgSrc);
  });

  document.getElementById("menu-searchBaidu").addEventListener("click", rm.searchBaidu);

  //éŸ³ä¹
  document.getElementById("menu-music-toggle").addEventListener("click", anzhiyu.musicToggle);

  document.getElementById("menu-music-back").addEventListener("click", anzhiyu.musicSkipBack);

  document.getElementById("menu-music-forward").addEventListener("click", anzhiyu.musicSkipForward);

  document.getElementById("menu-music-copyMusicName").addEventListener("click", function () {
    rm.rightmenuCopyText(anzhiyu.musicGetName());
    anzhiyu.snackbarShow("å¤åˆ¶æ­Œæ›²åç§°æˆåŠŸ", false, 3000);
  });

}

addRightMenuClickEvent();</script><script data-pjax>var themeColorMeta = document.querySelector('meta[name="theme-color"]');
var pageHeaderEl = document.getElementById("page-header");
var navMusicEl = document.getElementById("nav-music");
var consoleEl = document.getElementById("console");
// å·²éšæœºçš„æ­Œæ›²
var selectRandomSong = [];
// éŸ³ä¹é»˜è®¤å£°éŸ³å¤§å°
var musicVolume = 0.8;
// æ˜¯å¦åˆ‡æ¢äº†å‘¨æ°ä¼¦éŸ³ä¹åˆ—è¡¨
var changeMusicListFlag = false;
// å½“å‰é»˜è®¤æ’­æ”¾åˆ—è¡¨
var defaultPlayMusicList = [];

document.getElementById("page-name").innerText = document.title.split(" | GanSer")[0];
anzhiyu.initIndexEssay();
anzhiyu.changeTimeInEssay();
anzhiyu.removeBodyPaceClass();
anzhiyu.qrcodeCreate();
anzhiyu.changeTimeInAlbumDetail();
anzhiyu.reflashEssayWaterFall();
anzhiyu.sayhi();
anzhiyu.stopImgRightDrag();
anzhiyu.addNavBackgroundInit();
anzhiyu.setValueToBodyType();
anzhiyu.catalogActive();
anzhiyu.tagsPageActive();
anzhiyu.categoriesBarActive();
anzhiyu.topCategoriesBarScroll();
anzhiyu.switchRightClickMenuHotReview();
anzhiyu.getCustomPlayList();
anzhiyu.addEventListenerConsoleMusicList(false);
setTimeout(() => {
  if (typeof addFriendLinksInFooter === "function") {
    addFriendLinksInFooter();
  }
}, 200)</script><script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script>LA.init({id: "K2Vkt1ZVOZBb2pOv", ck: "K2Vkt1ZVOZBb2pOv"});
new LingQue.Monitor().init({id: "K2Vkt1ZVOZBb2pOv", sendSuspicious:true});</script><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.1.4/icon/ali_iconfont_css.css"><script async data-pjax src="/js/imgloaded.js?1"></script><script defer src="//at.alicdn.com/t/c/font_3816086_jveqqa1cjpg.js"></script><script data-pace-options='{ "restartOnRequestAfter":false,"eventLag":false}' src="https://cdn.jsdelivr.net/npm/pace-js@latest/pace.min.js"></script><script async src="https://npm.onmicrosoft.cn/naokuo-blog@1.2.10/js/SmoothScroll.min.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://npm.elemecdn.com/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><!-- hexo injector body_end start --><script async src="//at.alicdn.com/t/font_2032782_8d5kxvn09md.js"></script><!-- hexo injector body_end end --></body></html>